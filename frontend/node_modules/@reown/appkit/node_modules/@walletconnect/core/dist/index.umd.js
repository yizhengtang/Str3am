(function(U,Pt){typeof exports=="object"&&typeof module<"u"?Pt(exports):typeof define=="function"&&define.amd?define(["exports"],Pt):(U=typeof globalThis<"u"?globalThis:U||self,Pt(U["@walletconnect/core"]={}))})(this,function(U){"use strict";var Pt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Bs(t){var e=t.default;if(typeof e=="function"){var r=function(){return e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(t).forEach(function(n){var i=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(r,n,i.get?i:{enumerable:!0,get:function(){return t[n]}})}),r}var At={exports:{}},Zr=typeof Reflect=="object"?Reflect:null,pc=Zr&&typeof Zr.apply=="function"?Zr.apply:function(e,r,n){return Function.prototype.apply.call(e,r,n)},Ei;Zr&&typeof Zr.ownKeys=="function"?Ei=Zr.ownKeys:Object.getOwnPropertySymbols?Ei=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Ei=function(e){return Object.getOwnPropertyNames(e)};function y0(t){console&&console.warn&&console.warn(t)}var gc=Number.isNaN||function(e){return e!==e};function ne(){ne.init.call(this)}At.exports=ne,At.exports.once=E0,ne.EventEmitter=ne,ne.prototype._events=void 0,ne.prototype._eventsCount=0,ne.prototype._maxListeners=void 0;var vc=10;function xi(t){if(typeof t!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}Object.defineProperty(ne,"defaultMaxListeners",{enumerable:!0,get:function(){return vc},set:function(t){if(typeof t!="number"||t<0||gc(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");vc=t}}),ne.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},ne.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||gc(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function yc(t){return t._maxListeners===void 0?ne.defaultMaxListeners:t._maxListeners}ne.prototype.getMaxListeners=function(){return yc(this)},ne.prototype.emit=function(e){for(var r=[],n=1;n<arguments.length;n++)r.push(arguments[n]);var i=e==="error",s=this._events;if(s!==void 0)i=i&&s.error===void 0;else if(!i)return!1;if(i){var o;if(r.length>0&&(o=r[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var c=s[e];if(c===void 0)return!1;if(typeof c=="function")pc(c,this,r);else for(var f=c.length,h=xc(c,f),n=0;n<f;++n)pc(h[n],this,r);return!0};function mc(t,e,r,n){var i,s,o;if(xi(r),s=t._events,s===void 0?(s=t._events=Object.create(null),t._eventsCount=0):(s.newListener!==void 0&&(t.emit("newListener",e,r.listener?r.listener:r),s=t._events),o=s[e]),o===void 0)o=s[e]=r,++t._eventsCount;else if(typeof o=="function"?o=s[e]=n?[r,o]:[o,r]:n?o.unshift(r):o.push(r),i=yc(t),i>0&&o.length>i&&!o.warned){o.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=t,a.type=e,a.count=o.length,y0(a)}return t}ne.prototype.addListener=function(e,r){return mc(this,e,r,!1)},ne.prototype.on=ne.prototype.addListener,ne.prototype.prependListener=function(e,r){return mc(this,e,r,!0)};function m0(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function wc(t,e,r){var n={fired:!1,wrapFn:void 0,target:t,type:e,listener:r},i=m0.bind(n);return i.listener=r,n.wrapFn=i,i}ne.prototype.once=function(e,r){return xi(r),this.on(e,wc(this,e,r)),this},ne.prototype.prependOnceListener=function(e,r){return xi(r),this.prependListener(e,wc(this,e,r)),this},ne.prototype.removeListener=function(e,r){var n,i,s,o,a;if(xi(r),i=this._events,i===void 0)return this;if(n=i[e],n===void 0)return this;if(n===r||n.listener===r)--this._eventsCount===0?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,n.listener||r));else if(typeof n!="function"){for(s=-1,o=n.length-1;o>=0;o--)if(n[o]===r||n[o].listener===r){a=n[o].listener,s=o;break}if(s<0)return this;s===0?n.shift():w0(n,s),n.length===1&&(i[e]=n[0]),i.removeListener!==void 0&&this.emit("removeListener",e,a||r)}return this},ne.prototype.off=ne.prototype.removeListener,ne.prototype.removeAllListeners=function(e){var r,n,i;if(n=this._events,n===void 0)return this;if(n.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):n[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete n[e]),this;if(arguments.length===0){var s=Object.keys(n),o;for(i=0;i<s.length;++i)o=s[i],o!=="removeListener"&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(r=n[e],typeof r=="function")this.removeListener(e,r);else if(r!==void 0)for(i=r.length-1;i>=0;i--)this.removeListener(e,r[i]);return this};function _c(t,e,r){var n=t._events;if(n===void 0)return[];var i=n[e];return i===void 0?[]:typeof i=="function"?r?[i.listener||i]:[i]:r?_0(i):xc(i,i.length)}ne.prototype.listeners=function(e){return _c(this,e,!0)},ne.prototype.rawListeners=function(e){return _c(this,e,!1)},ne.listenerCount=function(t,e){return typeof t.listenerCount=="function"?t.listenerCount(e):Ec.call(t,e)},ne.prototype.listenerCount=Ec;function Ec(t){var e=this._events;if(e!==void 0){var r=e[t];if(typeof r=="function")return 1;if(r!==void 0)return r.length}return 0}ne.prototype.eventNames=function(){return this._eventsCount>0?Ei(this._events):[]};function xc(t,e){for(var r=new Array(e),n=0;n<e;++n)r[n]=t[n];return r}function w0(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function _0(t){for(var e=new Array(t.length),r=0;r<e.length;++r)e[r]=t[r].listener||t[r];return e}function E0(t,e){return new Promise(function(r,n){function i(o){t.removeListener(e,s),n(o)}function s(){typeof t.removeListener=="function"&&t.removeListener("error",i),r([].slice.call(arguments))}Sc(t,e,s,{once:!0}),e!=="error"&&x0(t,i,{once:!0})})}function x0(t,e,r){typeof t.on=="function"&&Sc(t,"error",e,r)}function Sc(t,e,r,n){if(typeof t.on=="function")n.once?t.once(e,r):t.on(e,r);else if(typeof t.addEventListener=="function")t.addEventListener(e,function i(s){n.once&&t.removeEventListener(e,i),r(s)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t)}var H={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var Ns=function(t,e){return Ns=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},Ns(t,e)};function S0(t,e){Ns(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var Ps=function(){return Ps=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Ps.apply(this,arguments)};function I0(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}function A0(t,e,r,n){var i=arguments.length,s=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,r):n,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,r,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,r,s):o(e,r))||s);return i>3&&s&&Object.defineProperty(e,r,s),s}function D0(t,e){return function(r,n){e(r,n,t)}}function O0(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function M0(t,e,r,n){function i(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function a(h){try{f(n.next(h))}catch(l){o(l)}}function c(h){try{f(n.throw(h))}catch(l){o(l)}}function f(h){h.done?s(h.value):i(h.value).then(a,c)}f((n=n.apply(t,e||[])).next())})}function T0(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(f){return function(h){return c([f,h])}}function c(f){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(s=f[0]&2?i.return:f[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,f[1])).done)return s;switch(i=0,s&&(f=[f[0]&2,s.value]),f[0]){case 0:case 1:s=f;break;case 4:return r.label++,{value:f[1],done:!1};case 5:r.label++,i=f[1],f=[0];continue;case 7:f=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(f[0]===6||f[0]===2)){r=0;continue}if(f[0]===3&&(!s||f[1]>s[0]&&f[1]<s[3])){r.label=f[1];break}if(f[0]===6&&r.label<s[1]){r.label=s[1],s=f;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(f);break}s[2]&&r.ops.pop(),r.trys.pop();continue}f=e.call(t,r)}catch(h){f=[6,h],i=0}finally{n=s=0}if(f[0]&5)throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}}function R0(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}function B0(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function Cs(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ic(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),i,s=[],o;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(a){o={error:a}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return s}function N0(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(Ic(arguments[e]));return t}function P0(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var n=Array(t),i=0,e=0;e<r;e++)for(var s=arguments[e],o=0,a=s.length;o<a;o++,i++)n[i]=s[o];return n}function $n(t){return this instanceof $n?(this.v=t,this):new $n(t)}function C0(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(t,e||[]),i,s=[];return i={},o("next"),o("throw"),o("return"),i[Symbol.asyncIterator]=function(){return this},i;function o(y){n[y]&&(i[y]=function(_){return new Promise(function(w,A){s.push([y,_,w,A])>1||a(y,_)})})}function a(y,_){try{c(n[y](_))}catch(w){l(s[0][3],w)}}function c(y){y.value instanceof $n?Promise.resolve(y.value.v).then(f,h):l(s[0][2],y)}function f(y){a("next",y)}function h(y){a("throw",y)}function l(y,_){y(_),s.shift(),s.length&&a(s[0][0],s[0][1])}}function $0(t){var e,r;return e={},n("next"),n("throw",function(i){throw i}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(i,s){e[i]=t[i]?function(o){return(r=!r)?{value:$n(t[i](o)),done:i==="return"}:s?s(o):o}:s}}function L0(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof Cs=="function"?Cs(t):t[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(s){r[s]=t[s]&&function(o){return new Promise(function(a,c){o=t[s](o),i(a,c,o.done,o.value)})}}function i(s,o,a,c){Promise.resolve(c).then(function(f){s({value:f,done:a})},o)}}function F0(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function z0(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function U0(t){return t&&t.__esModule?t:{default:t}}function k0(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function j0(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}var q0=Object.freeze({__proto__:null,__extends:S0,get __assign(){return Ps},__rest:I0,__decorate:A0,__param:D0,__metadata:O0,__awaiter:M0,__generator:T0,__createBinding:R0,__exportStar:B0,__values:Cs,__read:Ic,__spread:N0,__spreadArrays:P0,__await:$n,__asyncGenerator:C0,__asyncDelegator:$0,__asyncValues:L0,__makeTemplateObject:F0,__importStar:z0,__importDefault:U0,__classPrivateFieldGet:k0,__classPrivateFieldSet:j0}),Si=Bs(q0),$s={},Ln={},Ac;function H0(){if(Ac)return Ln;Ac=1,Object.defineProperty(Ln,"__esModule",{value:!0}),Ln.delay=void 0;function t(e){return new Promise(r=>{setTimeout(()=>{r(!0)},e)})}return Ln.delay=t,Ln}var Rr={},Ls={},Br={},Dc;function K0(){return Dc||(Dc=1,Object.defineProperty(Br,"__esModule",{value:!0}),Br.ONE_THOUSAND=Br.ONE_HUNDRED=void 0,Br.ONE_HUNDRED=100,Br.ONE_THOUSAND=1e3),Br}var Fs={},Oc;function V0(){return Oc||(Oc=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.ONE_YEAR=t.FOUR_WEEKS=t.THREE_WEEKS=t.TWO_WEEKS=t.ONE_WEEK=t.THIRTY_DAYS=t.SEVEN_DAYS=t.FIVE_DAYS=t.THREE_DAYS=t.ONE_DAY=t.TWENTY_FOUR_HOURS=t.TWELVE_HOURS=t.SIX_HOURS=t.THREE_HOURS=t.ONE_HOUR=t.SIXTY_MINUTES=t.THIRTY_MINUTES=t.TEN_MINUTES=t.FIVE_MINUTES=t.ONE_MINUTE=t.SIXTY_SECONDS=t.THIRTY_SECONDS=t.TEN_SECONDS=t.FIVE_SECONDS=t.ONE_SECOND=void 0,t.ONE_SECOND=1,t.FIVE_SECONDS=5,t.TEN_SECONDS=10,t.THIRTY_SECONDS=30,t.SIXTY_SECONDS=60,t.ONE_MINUTE=t.SIXTY_SECONDS,t.FIVE_MINUTES=t.ONE_MINUTE*5,t.TEN_MINUTES=t.ONE_MINUTE*10,t.THIRTY_MINUTES=t.ONE_MINUTE*30,t.SIXTY_MINUTES=t.ONE_MINUTE*60,t.ONE_HOUR=t.SIXTY_MINUTES,t.THREE_HOURS=t.ONE_HOUR*3,t.SIX_HOURS=t.ONE_HOUR*6,t.TWELVE_HOURS=t.ONE_HOUR*12,t.TWENTY_FOUR_HOURS=t.ONE_HOUR*24,t.ONE_DAY=t.TWENTY_FOUR_HOURS,t.THREE_DAYS=t.ONE_DAY*3,t.FIVE_DAYS=t.ONE_DAY*5,t.SEVEN_DAYS=t.ONE_DAY*7,t.THIRTY_DAYS=t.ONE_DAY*30,t.ONE_WEEK=t.SEVEN_DAYS,t.TWO_WEEKS=t.ONE_WEEK*2,t.THREE_WEEKS=t.ONE_WEEK*3,t.FOUR_WEEKS=t.ONE_WEEK*4,t.ONE_YEAR=t.ONE_DAY*365}(Fs)),Fs}var Mc;function Tc(){return Mc||(Mc=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Si;e.__exportStar(K0(),t),e.__exportStar(V0(),t)}(Ls)),Ls}var Rc;function W0(){if(Rc)return Rr;Rc=1,Object.defineProperty(Rr,"__esModule",{value:!0}),Rr.fromMiliseconds=Rr.toMiliseconds=void 0;const t=Tc();function e(n){return n*t.ONE_THOUSAND}Rr.toMiliseconds=e;function r(n){return Math.floor(n/t.ONE_THOUSAND)}return Rr.fromMiliseconds=r,Rr}var Bc;function Y0(){return Bc||(Bc=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Si;e.__exportStar(H0(),t),e.__exportStar(W0(),t)}($s)),$s}var Jr={},Nc;function G0(){if(Nc)return Jr;Nc=1,Object.defineProperty(Jr,"__esModule",{value:!0}),Jr.Watch=void 0;class t{constructor(){this.timestamps=new Map}start(r){if(this.timestamps.has(r))throw new Error(`Watch already started for label: ${r}`);this.timestamps.set(r,{started:Date.now()})}stop(r){const n=this.get(r);if(typeof n.elapsed<"u")throw new Error(`Watch already stopped for label: ${r}`);const i=Date.now()-n.started;this.timestamps.set(r,{started:n.started,elapsed:i})}get(r){const n=this.timestamps.get(r);if(typeof n>"u")throw new Error(`No timestamp found for label: ${r}`);return n}elapsed(r){const n=this.get(r);return n.elapsed||Date.now()-n.started}}return Jr.Watch=t,Jr.default=t,Jr}var zs={},Fn={},Pc;function X0(){if(Pc)return Fn;Pc=1,Object.defineProperty(Fn,"__esModule",{value:!0}),Fn.IWatch=void 0;class t{}return Fn.IWatch=t,Fn}var Cc;function Z0(){return Cc||(Cc=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),Si.__exportStar(X0(),t)}(zs)),zs}(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Si;e.__exportStar(Y0(),t),e.__exportStar(G0(),t),e.__exportStar(Z0(),t),e.__exportStar(Tc(),t)})(H);class Nr{}class J0 extends Nr{constructor(e){super()}}const $c=H.FIVE_SECONDS,Qr={pulse:"heartbeat_pulse"};class Us extends J0{constructor(e){super(e),this.events=new At.exports.EventEmitter,this.interval=$c,this.interval=e?.interval||$c}static async init(e){const r=new Us(e);return await r.init(),r}async init(){await this.initialize()}stop(){clearInterval(this.intervalRef)}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async initialize(){this.intervalRef=setInterval(()=>this.pulse(),H.toMiliseconds(this.interval))}pulse(){this.events.emit(Qr.pulse)}}const Q0=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,e1=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,t1=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function r1(t,e){if(t==="__proto__"||t==="constructor"&&e&&typeof e=="object"&&"prototype"in e){n1(t);return}return e}function n1(t){console.warn(`[destr] Dropping "${t}" key to prevent prototype pollution.`)}function Ii(t,e={}){if(typeof t!="string")return t;const r=t.trim();if(t[0]==='"'&&t.endsWith('"')&&!t.includes("\\"))return r.slice(1,-1);if(r.length<=9){const n=r.toLowerCase();if(n==="true")return!0;if(n==="false")return!1;if(n==="undefined")return;if(n==="null")return null;if(n==="nan")return Number.NaN;if(n==="infinity")return Number.POSITIVE_INFINITY;if(n==="-infinity")return Number.NEGATIVE_INFINITY}if(!t1.test(t)){if(e.strict)throw new SyntaxError("[destr] Invalid JSON");return t}try{if(Q0.test(t)||e1.test(t)){if(e.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(t,r1)}return JSON.parse(t)}catch(n){if(e.strict)throw n;return t}}function i1(t){return!t||typeof t.then!="function"?Promise.resolve(t):t}function Ke(t,...e){try{return i1(t(...e))}catch(r){return Promise.reject(r)}}function s1(t){const e=typeof t;return t===null||e!=="object"&&e!=="function"}function o1(t){const e=Object.getPrototypeOf(t);return!e||e.isPrototypeOf(Object)}function Ai(t){if(s1(t))return String(t);if(o1(t)||Array.isArray(t))return JSON.stringify(t);if(typeof t.toJSON=="function")return Ai(t.toJSON());throw new Error("[unstorage] Cannot stringify value!")}const ks="base64:";function a1(t){return typeof t=="string"?t:ks+u1(t)}function c1(t){return typeof t!="string"||!t.startsWith(ks)?t:f1(t.slice(ks.length))}function f1(t){return globalThis.Buffer?Buffer.from(t,"base64"):Uint8Array.from(globalThis.atob(t),e=>e.codePointAt(0))}function u1(t){return globalThis.Buffer?Buffer.from(t).toString("base64"):globalThis.btoa(String.fromCodePoint(...t))}function dt(t){return t&&t.split("?")[0]?.replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,"")||""}function h1(...t){return dt(t.join(":"))}function Di(t){return t=dt(t),t?t+":":""}function k9(t){return t}const d1="memory",l1=()=>{const t=new Map;return{name:d1,getInstance:()=>t,hasItem(e){return t.has(e)},getItem(e){return t.get(e)??null},getItemRaw(e){return t.get(e)??null},setItem(e,r){t.set(e,r)},setItemRaw(e,r){t.set(e,r)},removeItem(e){t.delete(e)},getKeys(){return[...t.keys()]},clear(){t.clear()},dispose(){t.clear()}}};function b1(t={}){const e={mounts:{"":t.driver||l1()},mountpoints:[""],watching:!1,watchListeners:[],unwatch:{}},r=f=>{for(const h of e.mountpoints)if(f.startsWith(h))return{base:h,relativeKey:f.slice(h.length),driver:e.mounts[h]};return{base:"",relativeKey:f,driver:e.mounts[""]}},n=(f,h)=>e.mountpoints.filter(l=>l.startsWith(f)||h&&f.startsWith(l)).map(l=>({relativeBase:f.length>l.length?f.slice(l.length):void 0,mountpoint:l,driver:e.mounts[l]})),i=(f,h)=>{if(e.watching){h=dt(h);for(const l of e.watchListeners)l(f,h)}},s=async()=>{if(!e.watching){e.watching=!0;for(const f in e.mounts)e.unwatch[f]=await Lc(e.mounts[f],i,f)}},o=async()=>{if(e.watching){for(const f in e.unwatch)await e.unwatch[f]();e.unwatch={},e.watching=!1}},a=(f,h,l)=>{const y=new Map,_=w=>{let A=y.get(w.base);return A||(A={driver:w.driver,base:w.base,items:[]},y.set(w.base,A)),A};for(const w of f){const A=typeof w=="string",D=dt(A?w:w.key),M=A?void 0:w.value,O=A||!w.options?h:{...h,...w.options},T=r(D);_(T).items.push({key:D,value:M,relativeKey:T.relativeKey,options:O})}return Promise.all([...y.values()].map(w=>l(w))).then(w=>w.flat())},c={hasItem(f,h={}){f=dt(f);const{relativeKey:l,driver:y}=r(f);return Ke(y.hasItem,l,h)},getItem(f,h={}){f=dt(f);const{relativeKey:l,driver:y}=r(f);return Ke(y.getItem,l,h).then(_=>Ii(_))},getItems(f,h={}){return a(f,h,l=>l.driver.getItems?Ke(l.driver.getItems,l.items.map(y=>({key:y.relativeKey,options:y.options})),h).then(y=>y.map(_=>({key:h1(l.base,_.key),value:Ii(_.value)}))):Promise.all(l.items.map(y=>Ke(l.driver.getItem,y.relativeKey,y.options).then(_=>({key:y.key,value:Ii(_)})))))},getItemRaw(f,h={}){f=dt(f);const{relativeKey:l,driver:y}=r(f);return y.getItemRaw?Ke(y.getItemRaw,l,h):Ke(y.getItem,l,h).then(_=>c1(_))},async setItem(f,h,l={}){if(h===void 0)return c.removeItem(f);f=dt(f);const{relativeKey:y,driver:_}=r(f);_.setItem&&(await Ke(_.setItem,y,Ai(h),l),_.watch||i("update",f))},async setItems(f,h){await a(f,h,async l=>{if(l.driver.setItems)return Ke(l.driver.setItems,l.items.map(y=>({key:y.relativeKey,value:Ai(y.value),options:y.options})),h);l.driver.setItem&&await Promise.all(l.items.map(y=>Ke(l.driver.setItem,y.relativeKey,Ai(y.value),y.options)))})},async setItemRaw(f,h,l={}){if(h===void 0)return c.removeItem(f,l);f=dt(f);const{relativeKey:y,driver:_}=r(f);if(_.setItemRaw)await Ke(_.setItemRaw,y,h,l);else if(_.setItem)await Ke(_.setItem,y,a1(h),l);else return;_.watch||i("update",f)},async removeItem(f,h={}){typeof h=="boolean"&&(h={removeMeta:h}),f=dt(f);const{relativeKey:l,driver:y}=r(f);y.removeItem&&(await Ke(y.removeItem,l,h),(h.removeMeta||h.removeMata)&&await Ke(y.removeItem,l+"$",h),y.watch||i("remove",f))},async getMeta(f,h={}){typeof h=="boolean"&&(h={nativeOnly:h}),f=dt(f);const{relativeKey:l,driver:y}=r(f),_=Object.create(null);if(y.getMeta&&Object.assign(_,await Ke(y.getMeta,l,h)),!h.nativeOnly){const w=await Ke(y.getItem,l+"$",h).then(A=>Ii(A));w&&typeof w=="object"&&(typeof w.atime=="string"&&(w.atime=new Date(w.atime)),typeof w.mtime=="string"&&(w.mtime=new Date(w.mtime)),Object.assign(_,w))}return _},setMeta(f,h,l={}){return this.setItem(f+"$",h,l)},removeMeta(f,h={}){return this.removeItem(f+"$",h)},async getKeys(f,h={}){f=Di(f);const l=n(f,!0);let y=[];const _=[];for(const w of l){const A=await Ke(w.driver.getKeys,w.relativeBase,h);for(const D of A){const M=w.mountpoint+dt(D);y.some(O=>M.startsWith(O))||_.push(M)}y=[w.mountpoint,...y.filter(D=>!D.startsWith(w.mountpoint))]}return f?_.filter(w=>w.startsWith(f)&&w[w.length-1]!=="$"):_.filter(w=>w[w.length-1]!=="$")},async clear(f,h={}){f=Di(f),await Promise.all(n(f,!1).map(async l=>{if(l.driver.clear)return Ke(l.driver.clear,l.relativeBase,h);if(l.driver.removeItem){const y=await l.driver.getKeys(l.relativeBase||"",h);return Promise.all(y.map(_=>l.driver.removeItem(_,h)))}}))},async dispose(){await Promise.all(Object.values(e.mounts).map(f=>Fc(f)))},async watch(f){return await s(),e.watchListeners.push(f),async()=>{e.watchListeners=e.watchListeners.filter(h=>h!==f),e.watchListeners.length===0&&await o()}},async unwatch(){e.watchListeners=[],await o()},mount(f,h){if(f=Di(f),f&&e.mounts[f])throw new Error(`already mounted at ${f}`);return f&&(e.mountpoints.push(f),e.mountpoints.sort((l,y)=>y.length-l.length)),e.mounts[f]=h,e.watching&&Promise.resolve(Lc(h,i,f)).then(l=>{e.unwatch[f]=l}).catch(console.error),c},async unmount(f,h=!0){f=Di(f),!(!f||!e.mounts[f])&&(e.watching&&f in e.unwatch&&(e.unwatch[f]?.(),delete e.unwatch[f]),h&&await Fc(e.mounts[f]),e.mountpoints=e.mountpoints.filter(l=>l!==f),delete e.mounts[f])},getMount(f=""){f=dt(f)+":";const h=r(f);return{driver:h.driver,base:h.base}},getMounts(f="",h={}){return f=dt(f),n(f,h.parents).map(y=>({driver:y.driver,base:y.mountpoint}))},keys:(f,h={})=>c.getKeys(f,h),get:(f,h={})=>c.getItem(f,h),set:(f,h,l={})=>c.setItem(f,h,l),has:(f,h={})=>c.hasItem(f,h),del:(f,h={})=>c.removeItem(f,h),remove:(f,h={})=>c.removeItem(f,h)};return c}function Lc(t,e,r){return t.watch?t.watch((n,i)=>e(n,r+i)):()=>{}}async function Fc(t){typeof t.dispose=="function"&&await Ke(t.dispose)}function Pr(t){return new Promise((e,r)=>{t.oncomplete=t.onsuccess=()=>e(t.result),t.onabort=t.onerror=()=>r(t.error)})}function zc(t,e){const r=indexedDB.open(t);r.onupgradeneeded=()=>r.result.createObjectStore(e);const n=Pr(r);return(i,s)=>n.then(o=>s(o.transaction(e,i).objectStore(e)))}let js;function zn(){return js||(js=zc("keyval-store","keyval")),js}function Uc(t,e=zn()){return e("readonly",r=>Pr(r.get(t)))}function p1(t,e,r=zn()){return r("readwrite",n=>(n.put(e,t),Pr(n.transaction)))}function g1(t,e=zn()){return e("readwrite",r=>(r.delete(t),Pr(r.transaction)))}function v1(t=zn()){return t("readwrite",e=>(e.clear(),Pr(e.transaction)))}function y1(t,e){return t.openCursor().onsuccess=function(){this.result&&(e(this.result),this.result.continue())},Pr(t.transaction)}function m1(t=zn()){return t("readonly",e=>{if(e.getAllKeys)return Pr(e.getAllKeys());const r=[];return y1(e,n=>r.push(n.key)).then(()=>r)})}const w1=t=>JSON.stringify(t,(e,r)=>typeof r=="bigint"?r.toString()+"n":r),_1=t=>{const e=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,r=t.replace(e,'$1"$2n"$3');return JSON.parse(r,(n,i)=>typeof i=="string"&&i.match(/^\d+n$/)?BigInt(i.substring(0,i.length-1)):i)};function en(t){if(typeof t!="string")throw new Error(`Cannot safe json parse value of type ${typeof t}`);try{return _1(t)}catch{return t}}function Cr(t){return typeof t=="string"?t:w1(t)||""}const E1="idb-keyval";var x1=(t={})=>{const e=t.base&&t.base.length>0?`${t.base}:`:"",r=i=>e+i;let n;return t.dbName&&t.storeName&&(n=zc(t.dbName,t.storeName)),{name:E1,options:t,async hasItem(i){return!(typeof await Uc(r(i),n)>"u")},async getItem(i){return await Uc(r(i),n)??null},setItem(i,s){return p1(r(i),s,n)},removeItem(i){return g1(r(i),n)},getKeys(){return m1(n)},clear(){return v1(n)}}};const S1="WALLET_CONNECT_V2_INDEXED_DB",I1="keyvaluestorage";class A1{constructor(){this.indexedDb=b1({driver:x1({dbName:S1,storeName:I1})})}async getKeys(){return this.indexedDb.getKeys()}async getEntries(){return(await this.indexedDb.getItems(await this.indexedDb.getKeys())).map(e=>[e.key,e.value])}async getItem(e){const r=await this.indexedDb.getItem(e);if(r!==null)return r}async setItem(e,r){await this.indexedDb.setItem(e,Cr(r))}async removeItem(e){await this.indexedDb.removeItem(e)}}var qs=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Oi={exports:{}};(function(){let t;function e(){}t=e,t.prototype.getItem=function(r){return this.hasOwnProperty(r)?String(this[r]):null},t.prototype.setItem=function(r,n){this[r]=String(n)},t.prototype.removeItem=function(r){delete this[r]},t.prototype.clear=function(){const r=this;Object.keys(r).forEach(function(n){r[n]=void 0,delete r[n]})},t.prototype.key=function(r){return r=r||0,Object.keys(this)[r]},t.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof qs<"u"&&qs.localStorage?Oi.exports=qs.localStorage:typeof window<"u"&&window.localStorage?Oi.exports=window.localStorage:Oi.exports=new e})();function D1(t){var e;return[t[0],en((e=t[1])!=null?e:"")]}class O1{constructor(){this.localStorage=Oi.exports}async getKeys(){return Object.keys(this.localStorage)}async getEntries(){return Object.entries(this.localStorage).map(D1)}async getItem(e){const r=this.localStorage.getItem(e);if(r!==null)return en(r)}async setItem(e,r){this.localStorage.setItem(e,Cr(r))}async removeItem(e){this.localStorage.removeItem(e)}}const M1="wc_storage_version",kc=1,T1=async(t,e,r)=>{const n=M1,i=await e.getItem(n);if(i&&i>=kc){r(e);return}const s=await t.getKeys();if(!s.length){r(e);return}const o=[];for(;s.length;){const a=s.shift();if(!a)continue;const c=a.toLowerCase();if(c.includes("wc@")||c.includes("walletconnect")||c.includes("wc_")||c.includes("wallet_connect")){const f=await t.getItem(a);await e.setItem(a,f),o.push(a)}}await e.setItem(n,kc),r(e),R1(t,o)},R1=async(t,e)=>{e.length&&e.forEach(async r=>{await t.removeItem(r)})};class B1{constructor(){this.initialized=!1,this.setInitialized=r=>{this.storage=r,this.initialized=!0};const e=new O1;this.storage=e;try{const r=new A1;T1(e,r,this.setInitialized)}catch{this.initialized=!0}}async getKeys(){return await this.initialize(),this.storage.getKeys()}async getEntries(){return await this.initialize(),this.storage.getEntries()}async getItem(e){return await this.initialize(),this.storage.getItem(e)}async setItem(e,r){return await this.initialize(),this.storage.setItem(e,r)}async removeItem(e){return await this.initialize(),this.storage.removeItem(e)}async initialize(){this.initialized||await new Promise(e=>{const r=setInterval(()=>{this.initialized&&(clearInterval(r),e())},20)})}}function N1(t){try{return JSON.stringify(t)}catch{return'"[Circular]"'}}var P1=C1;function C1(t,e,r){var n=r&&r.stringify||N1,i=1;if(typeof t=="object"&&t!==null){var s=e.length+i;if(s===1)return t;var o=new Array(s);o[0]=n(t);for(var a=1;a<s;a++)o[a]=n(e[a]);return o.join(" ")}if(typeof t!="string")return t;var c=e.length;if(c===0)return t;for(var f="",h=1-i,l=-1,y=t&&t.length||0,_=0;_<y;){if(t.charCodeAt(_)===37&&_+1<y){switch(l=l>-1?l:0,t.charCodeAt(_+1)){case 100:case 102:if(h>=c||e[h]==null)break;l<_&&(f+=t.slice(l,_)),f+=Number(e[h]),l=_+2,_++;break;case 105:if(h>=c||e[h]==null)break;l<_&&(f+=t.slice(l,_)),f+=Math.floor(Number(e[h])),l=_+2,_++;break;case 79:case 111:case 106:if(h>=c||e[h]===void 0)break;l<_&&(f+=t.slice(l,_));var w=typeof e[h];if(w==="string"){f+="'"+e[h]+"'",l=_+2,_++;break}if(w==="function"){f+=e[h].name||"<anonymous>",l=_+2,_++;break}f+=n(e[h]),l=_+2,_++;break;case 115:if(h>=c)break;l<_&&(f+=t.slice(l,_)),f+=String(e[h]),l=_+2,_++;break;case 37:l<_&&(f+=t.slice(l,_)),f+="%",l=_+2,_++,h--;break}++h}++_}return l===-1?t:(l<y&&(f+=t.slice(l)),f)}const jc=P1;var yr=Ht;const Un=K1().console||{},$1={mapHttpRequest:Ti,mapHttpResponse:Ti,wrapRequestSerializer:Ks,wrapResponseSerializer:Ks,wrapErrorSerializer:Ks,req:Ti,res:Ti,err:k1};function L1(t,e){return Array.isArray(t)?t.filter(function(n){return n!=="!stdSerializers.err"}):t===!0?Object.keys(e):!1}function Ht(t){t=t||{},t.browser=t.browser||{};const e=t.browser.transmit;if(e&&typeof e.send!="function")throw Error("pino: transmit option must have a send function");const r=t.browser.write||Un;t.browser.write&&(t.browser.asObject=!0);const n=t.serializers||{},i=L1(t.browser.serialize,n);let s=t.browser.serialize;Array.isArray(t.browser.serialize)&&t.browser.serialize.indexOf("!stdSerializers.err")>-1&&(s=!1);const o=["error","fatal","warn","info","debug","trace"];typeof r=="function"&&(r.error=r.fatal=r.warn=r.info=r.debug=r.trace=r),t.enabled===!1&&(t.level="silent");const a=t.level||"info",c=Object.create(r);c.log||(c.log=kn),Object.defineProperty(c,"levelVal",{get:h}),Object.defineProperty(c,"level",{get:l,set:y});const f={transmit:e,serialize:i,asObject:t.browser.asObject,levels:o,timestamp:j1(t)};c.levels=Ht.levels,c.level=a,c.setMaxListeners=c.getMaxListeners=c.emit=c.addListener=c.on=c.prependListener=c.once=c.prependOnceListener=c.removeListener=c.removeAllListeners=c.listeners=c.listenerCount=c.eventNames=c.write=c.flush=kn,c.serializers=n,c._serialize=i,c._stdErrSerialize=s,c.child=_,e&&(c._logEvent=Hs());function h(){return this.level==="silent"?1/0:this.levels.values[this.level]}function l(){return this._level}function y(w){if(w!=="silent"&&!this.levels.values[w])throw Error("unknown level "+w);this._level=w,tn(f,c,"error","log"),tn(f,c,"fatal","error"),tn(f,c,"warn","error"),tn(f,c,"info","log"),tn(f,c,"debug","log"),tn(f,c,"trace","log")}function _(w,A){if(!w)throw new Error("missing bindings for child Pino");A=A||{},i&&w.serializers&&(A.serializers=w.serializers);const D=A.serializers;if(i&&D){var M=Object.assign({},n,D),O=t.browser.serialize===!0?Object.keys(M):i;delete w.serializers,Mi([w],O,M,this._stdErrSerialize)}function T(R){this._childLevel=(R._childLevel|0)+1,this.error=rn(R,w,"error"),this.fatal=rn(R,w,"fatal"),this.warn=rn(R,w,"warn"),this.info=rn(R,w,"info"),this.debug=rn(R,w,"debug"),this.trace=rn(R,w,"trace"),M&&(this.serializers=M,this._serialize=O),e&&(this._logEvent=Hs([].concat(R._logEvent.bindings,w)))}return T.prototype=this,new T(this)}return c}Ht.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},Ht.stdSerializers=$1,Ht.stdTimeFunctions=Object.assign({},{nullTime:qc,epochTime:Hc,unixTime:q1,isoTime:H1});function tn(t,e,r,n){const i=Object.getPrototypeOf(e);e[r]=e.levelVal>e.levels.values[r]?kn:i[r]?i[r]:Un[r]||Un[n]||kn,F1(t,e,r)}function F1(t,e,r){!t.transmit&&e[r]===kn||(e[r]=function(n){return function(){const s=t.timestamp(),o=new Array(arguments.length),a=Object.getPrototypeOf&&Object.getPrototypeOf(this)===Un?Un:this;for(var c=0;c<o.length;c++)o[c]=arguments[c];if(t.serialize&&!t.asObject&&Mi(o,this._serialize,this.serializers,this._stdErrSerialize),t.asObject?n.call(a,z1(this,r,o,s)):n.apply(a,o),t.transmit){const f=t.transmit.level||e.level,h=Ht.levels.values[f],l=Ht.levels.values[r];if(l<h)return;U1(this,{ts:s,methodLevel:r,methodValue:l,transmitLevel:f,transmitValue:Ht.levels.values[t.transmit.level||e.level],send:t.transmit.send,val:e.levelVal},o)}}}(e[r]))}function z1(t,e,r,n){t._serialize&&Mi(r,t._serialize,t.serializers,t._stdErrSerialize);const i=r.slice();let s=i[0];const o={};n&&(o.time=n),o.level=Ht.levels.values[e];let a=(t._childLevel|0)+1;if(a<1&&(a=1),s!==null&&typeof s=="object"){for(;a--&&typeof i[0]=="object";)Object.assign(o,i.shift());s=i.length?jc(i.shift(),i):void 0}else typeof s=="string"&&(s=jc(i.shift(),i));return s!==void 0&&(o.msg=s),o}function Mi(t,e,r,n){for(const i in t)if(n&&t[i]instanceof Error)t[i]=Ht.stdSerializers.err(t[i]);else if(typeof t[i]=="object"&&!Array.isArray(t[i]))for(const s in t[i])e&&e.indexOf(s)>-1&&s in r&&(t[i][s]=r[s](t[i][s]))}function rn(t,e,r){return function(){const n=new Array(1+arguments.length);n[0]=e;for(var i=1;i<n.length;i++)n[i]=arguments[i-1];return t[r].apply(this,n)}}function U1(t,e,r){const n=e.send,i=e.ts,s=e.methodLevel,o=e.methodValue,a=e.val,c=t._logEvent.bindings;Mi(r,t._serialize||Object.keys(t.serializers),t.serializers,t._stdErrSerialize===void 0?!0:t._stdErrSerialize),t._logEvent.ts=i,t._logEvent.messages=r.filter(function(f){return c.indexOf(f)===-1}),t._logEvent.level.label=s,t._logEvent.level.value=o,n(s,t._logEvent,a),t._logEvent=Hs(c)}function Hs(t){return{ts:0,messages:[],bindings:t||[],level:{label:"",value:0}}}function k1(t){const e={type:t.constructor.name,msg:t.message,stack:t.stack};for(const r in t)e[r]===void 0&&(e[r]=t[r]);return e}function j1(t){return typeof t.timestamp=="function"?t.timestamp:t.timestamp===!1?qc:Hc}function Ti(){return{}}function Ks(t){return t}function kn(){}function qc(){return!1}function Hc(){return Date.now()}function q1(){return Math.round(Date.now()/1e3)}function H1(){return new Date(Date.now()).toISOString()}function K1(){function t(e){return typeof e<"u"&&e}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return t(self)||t(window)||t(this)||{}}}const V1={level:"info"},jn="custom_context",Vs=1e3*1024;class W1{constructor(e){this.nodeValue=e,this.sizeInBytes=new TextEncoder().encode(this.nodeValue).length,this.next=null}get value(){return this.nodeValue}get size(){return this.sizeInBytes}}class Kc{constructor(e){this.head=null,this.tail=null,this.lengthInNodes=0,this.maxSizeInBytes=e,this.sizeInBytes=0}append(e){const r=new W1(e);if(r.size>this.maxSizeInBytes)throw new Error(`[LinkedList] Value too big to insert into list: ${e} with size ${r.size}`);for(;this.size+r.size>this.maxSizeInBytes;)this.shift();this.head?(this.tail&&(this.tail.next=r),this.tail=r):(this.head=r,this.tail=r),this.lengthInNodes++,this.sizeInBytes+=r.size}shift(){if(!this.head)return;const e=this.head;this.head=this.head.next,this.head||(this.tail=null),this.lengthInNodes--,this.sizeInBytes-=e.size}toArray(){const e=[];let r=this.head;for(;r!==null;)e.push(r.value),r=r.next;return e}get length(){return this.lengthInNodes}get size(){return this.sizeInBytes}toOrderedArray(){return Array.from(this)}[Symbol.iterator](){let e=this.head;return{next:()=>{if(!e)return{done:!0,value:null};const r=e.value;return e=e.next,{done:!1,value:r}}}}}class Vc{constructor(e,r=Vs){this.level=e??"error",this.levelValue=yr.levels.values[this.level],this.MAX_LOG_SIZE_IN_BYTES=r,this.logs=new Kc(this.MAX_LOG_SIZE_IN_BYTES)}forwardToConsole(e,r){r===yr.levels.values.error?console.error(e):r===yr.levels.values.warn?console.warn(e):r===yr.levels.values.debug?console.debug(e):r===yr.levels.values.trace?console.trace(e):console.log(e)}appendToLogs(e){this.logs.append(Cr({timestamp:new Date().toISOString(),log:e}));const r=typeof e=="string"?JSON.parse(e).level:e.level;r>=this.levelValue&&this.forwardToConsole(e,r)}getLogs(){return this.logs}clearLogs(){this.logs=new Kc(this.MAX_LOG_SIZE_IN_BYTES)}getLogArray(){return Array.from(this.logs)}logsToBlob(e){const r=this.getLogArray();return r.push(Cr({extraMetadata:e})),new Blob(r,{type:"application/json"})}}class Y1{constructor(e,r=Vs){this.baseChunkLogger=new Vc(e,r)}write(e){this.baseChunkLogger.appendToLogs(e)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(e){return this.baseChunkLogger.logsToBlob(e)}downloadLogsBlobInBrowser(e){const r=URL.createObjectURL(this.logsToBlob(e)),n=document.createElement("a");n.href=r,n.download=`walletconnect-logs-${new Date().toISOString()}.txt`,document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(r)}}class G1{constructor(e,r=Vs){this.baseChunkLogger=new Vc(e,r)}write(e){this.baseChunkLogger.appendToLogs(e)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(e){return this.baseChunkLogger.logsToBlob(e)}}var X1=Object.defineProperty,Z1=Object.defineProperties,J1=Object.getOwnPropertyDescriptors,Wc=Object.getOwnPropertySymbols,Q1=Object.prototype.hasOwnProperty,eb=Object.prototype.propertyIsEnumerable,Yc=(t,e,r)=>e in t?X1(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Ri=(t,e)=>{for(var r in e||(e={}))Q1.call(e,r)&&Yc(t,r,e[r]);if(Wc)for(var r of Wc(e))eb.call(e,r)&&Yc(t,r,e[r]);return t},Bi=(t,e)=>Z1(t,J1(e));function Gc(t){return Bi(Ri({},t),{level:t?.level||V1.level})}function tb(t,e=jn){return t[e]||""}function rb(t,e,r=jn){return t[r]=e,t}function wt(t,e=jn){let r="";return typeof t.bindings>"u"?r=tb(t,e):r=t.bindings().context||"",r}function nb(t,e,r=jn){const n=wt(t,r);return n.trim()?`${n}/${e}`:e}function lt(t,e,r=jn){const n=nb(t,e,r),i=t.child({context:n});return rb(i,n,r)}function ib(t){var e,r;const n=new Y1((e=t.opts)==null?void 0:e.level,t.maxSizeInBytes);return{logger:yr(Bi(Ri({},t.opts),{level:"trace",browser:Bi(Ri({},(r=t.opts)==null?void 0:r.browser),{write:i=>n.write(i)})})),chunkLoggerController:n}}function sb(t){var e;const r=new G1((e=t.opts)==null?void 0:e.level,t.maxSizeInBytes);return{logger:yr(Bi(Ri({},t.opts),{level:"trace"})),chunkLoggerController:r}}function ob(t){return typeof t.loggerOverride<"u"&&typeof t.loggerOverride!="string"?{logger:t.loggerOverride,chunkLoggerController:null}:typeof window<"u"?ib(t):sb(t)}var ab=Object.defineProperty,cb=(t,e,r)=>e in t?ab(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Xc=(t,e,r)=>cb(t,typeof e!="symbol"?e+"":e,r);class fb extends Nr{constructor(e){super(),this.opts=e,Xc(this,"protocol","wc"),Xc(this,"version",2)}}var ub=Object.defineProperty,hb=(t,e,r)=>e in t?ub(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,db=(t,e,r)=>hb(t,typeof e!="symbol"?e+"":e,r);class lb extends Nr{constructor(e,r){super(),this.core=e,this.logger=r,db(this,"records",new Map)}}class bb{constructor(e,r){this.logger=e,this.core=r}}class pb extends Nr{constructor(e,r){super(),this.relayer=e,this.logger=r}}class gb extends Nr{constructor(e){super()}}class vb{constructor(e,r,n,i){this.core=e,this.logger=r,this.name=n}}class yb extends Nr{constructor(e,r){super(),this.relayer=e,this.logger=r}}class mb extends Nr{constructor(e,r){super(),this.core=e,this.logger=r}}class wb{constructor(e,r,n){this.core=e,this.logger=r,this.store=n}}class _b{constructor(e,r){this.projectId=e,this.logger=r}}class Eb{constructor(e,r,n){this.core=e,this.logger=r,this.telemetryEnabled=n}}const Ws="wc",Ys=2,qn="core",Ct=`${Ws}@2:${qn}:`,Zc={name:qn,logger:"error"},Jc={database:":memory:"},Qc="crypto",Gs="client_ed25519_seed",ef=H.ONE_DAY,tf="keychain",rf="0.3",nf="messages",sf="0.3",Xs=H.SIX_HOURS,of="publisher",af="irn",cf="error",Zs="wss://relay.walletconnect.org",ff="relayer",Qe={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},uf="_subscription",_t={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},hf=.1,xb={database:":memory:"},Ni="2.19.1",Sb=1e4,$r={link_mode:"link_mode",relay:"relay"},Hn={inbound:"inbound",outbound:"outbound"},df="0.3",lf="WALLETCONNECT_CLIENT_ID",Js="WALLETCONNECT_LINK_MODE_APPS",bt={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},Ib=H.THIRTY_DAYS,bf="subscription",pf="0.3",Ab=H.FIVE_SECONDS*1e3,gf="pairing",vf="0.3",Db=H.THIRTY_DAYS,nn={wc_pairingDelete:{req:{ttl:H.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:H.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:H.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:H.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:H.ONE_DAY,prompt:!1,tag:0},res:{ttl:H.ONE_DAY,prompt:!1,tag:0}}},sn={create:"pairing_create",expire:"pairing_expire",delete:"pairing_delete",ping:"pairing_ping"},Dt={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},yf="history",mf="0.3",wf="expirer",Ot={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},_f="0.3",Ob=H.ONE_DAY,Ef="verify-api",Mb="https://verify.walletconnect.com",xf="https://verify.walletconnect.org",Kn=xf,Sf=`${Kn}/v3`,If=[Mb,xf],Af="echo",Df="https://echo.walletconnect.com",Tb="event-client",Kt={pairing_started:"pairing_started",pairing_uri_validation_success:"pairing_uri_validation_success",pairing_uri_not_expired:"pairing_uri_not_expired",store_new_pairing:"store_new_pairing",subscribing_pairing_topic:"subscribing_pairing_topic",subscribe_pairing_topic_success:"subscribe_pairing_topic_success",existing_pairing:"existing_pairing",pairing_not_expired:"pairing_not_expired",emit_inactive_pairing:"emit_inactive_pairing",emit_session_proposal:"emit_session_proposal",subscribing_to_pairing_topic:"subscribing_to_pairing_topic"},sr={no_wss_connection:"no_wss_connection",no_internet_connection:"no_internet_connection",malformed_pairing_uri:"malformed_pairing_uri",active_pairing_already_exists:"active_pairing_already_exists",subscribe_pairing_topic_failure:"subscribe_pairing_topic_failure",pairing_expired:"pairing_expired",proposal_expired:"proposal_expired",proposal_listener_not_found:"proposal_listener_not_found"},Rb={session_approve_started:"session_approve_started",proposal_not_expired:"proposal_not_expired",session_namespaces_validation_success:"session_namespaces_validation_success",create_session_topic:"create_session_topic",subscribing_session_topic:"subscribing_session_topic",subscribe_session_topic_success:"subscribe_session_topic_success",publishing_session_approve:"publishing_session_approve",session_approve_publish_success:"session_approve_publish_success",store_session:"store_session",publishing_session_settle:"publishing_session_settle",session_settle_publish_success:"session_settle_publish_success"},Bb={no_internet_connection:"no_internet_connection",no_wss_connection:"no_wss_connection",proposal_expired:"proposal_expired",subscribe_session_topic_failure:"subscribe_session_topic_failure",session_approve_publish_failure:"session_approve_publish_failure",session_settle_publish_failure:"session_settle_publish_failure",session_approve_namespace_validation_failure:"session_approve_namespace_validation_failure",proposal_not_found:"proposal_not_found"},Nb={authenticated_session_approve_started:"authenticated_session_approve_started",authenticated_session_not_expired:"authenticated_session_not_expired",chains_caip2_compliant:"chains_caip2_compliant",chains_evm_compliant:"chains_evm_compliant",create_authenticated_session_topic:"create_authenticated_session_topic",cacaos_verified:"cacaos_verified",store_authenticated_session:"store_authenticated_session",subscribing_authenticated_session_topic:"subscribing_authenticated_session_topic",subscribe_authenticated_session_topic_success:"subscribe_authenticated_session_topic_success",publishing_authenticated_session_approve:"publishing_authenticated_session_approve",authenticated_session_approve_publish_success:"authenticated_session_approve_publish_success"},Pb={no_internet_connection:"no_internet_connection",no_wss_connection:"no_wss_connection",missing_session_authenticate_request:"missing_session_authenticate_request",session_authenticate_request_expired:"session_authenticate_request_expired",chains_caip2_compliant_failure:"chains_caip2_compliant_failure",chains_evm_compliant_failure:"chains_evm_compliant_failure",invalid_cacao:"invalid_cacao",subscribe_authenticated_session_topic_failure:"subscribe_authenticated_session_topic_failure",authenticated_session_approve_publish_failure:"authenticated_session_approve_publish_failure",authenticated_session_pending_request_not_found:"authenticated_session_pending_request_not_found"},Of=.1,Mf="event-client",Tf=86400,Rf="https://pulse.walletconnect.org/batch";function Cb(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function Bf(t,...e){if(!Cb(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function Nf(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function $b(t,e){Bf(t);const r=e.outputLen;if(t.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}const on=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Qs=t=>new DataView(t.buffer,t.byteOffset,t.byteLength);function Lb(t){if(typeof t!="string")throw new Error("utf8ToBytes expected string, got "+typeof t);return new Uint8Array(new TextEncoder().encode(t))}function Pf(t){return typeof t=="string"&&(t=Lb(t)),Bf(t),t}class Fb{clone(){return this._cloneInto()}}function zb(t){const e=n=>t().update(Pf(n)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e}function Cf(t=32){if(on&&typeof on.getRandomValues=="function")return on.getRandomValues(new Uint8Array(t));if(on&&typeof on.randomBytes=="function")return on.randomBytes(t);throw new Error("crypto.getRandomValues must be defined")}function Ub(t,e,r,n){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,r,n);const i=BigInt(32),s=BigInt(4294967295),o=Number(r>>i&s),a=Number(r&s),c=n?4:0,f=n?0:4;t.setUint32(e+c,o,n),t.setUint32(e+f,a,n)}class kb extends Fb{constructor(e,r,n,i){super(),this.blockLen=e,this.outputLen=r,this.padOffset=n,this.isLE=i,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=Qs(this.buffer)}update(e){Nf(this);const{view:r,buffer:n,blockLen:i}=this;e=Pf(e);const s=e.length;for(let o=0;o<s;){const a=Math.min(i-this.pos,s-o);if(a===i){const c=Qs(e);for(;i<=s-o;o+=i)this.process(c,o);continue}n.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===i&&(this.process(r,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){Nf(this),$b(e,this),this.finished=!0;const{buffer:r,view:n,blockLen:i,isLE:s}=this;let{pos:o}=this;r[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>i-o&&(this.process(n,0),o=0);for(let l=o;l<i;l++)r[l]=0;Ub(n,i-8,BigInt(this.length*8),s),this.process(n,0);const a=Qs(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const f=c/4,h=this.get();if(f>h.length)throw new Error("_sha2: outputLen bigger than state");for(let l=0;l<f;l++)a.setUint32(4*l,h[l],s)}digest(){const{buffer:e,outputLen:r}=this;this.digestInto(e);const n=e.slice(0,r);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:r,buffer:n,length:i,finished:s,destroyed:o,pos:a}=this;return e.length=i,e.pos=a,e.finished=s,e.destroyed=o,i%r&&e.buffer.set(n),e}}const Pi=BigInt(2**32-1),eo=BigInt(32);function $f(t,e=!1){return e?{h:Number(t&Pi),l:Number(t>>eo&Pi)}:{h:Number(t>>eo&Pi)|0,l:Number(t&Pi)|0}}function jb(t,e=!1){let r=new Uint32Array(t.length),n=new Uint32Array(t.length);for(let i=0;i<t.length;i++){const{h:s,l:o}=$f(t[i],e);[r[i],n[i]]=[s,o]}return[r,n]}const qb=(t,e)=>BigInt(t>>>0)<<eo|BigInt(e>>>0),Hb=(t,e,r)=>t>>>r,Kb=(t,e,r)=>t<<32-r|e>>>r,Vb=(t,e,r)=>t>>>r|e<<32-r,Wb=(t,e,r)=>t<<32-r|e>>>r,Yb=(t,e,r)=>t<<64-r|e>>>r-32,Gb=(t,e,r)=>t>>>r-32|e<<64-r,Xb=(t,e)=>e,Zb=(t,e)=>t,Jb=(t,e,r)=>t<<r|e>>>32-r,Qb=(t,e,r)=>e<<r|t>>>32-r,ep=(t,e,r)=>e<<r-32|t>>>64-r,tp=(t,e,r)=>t<<r-32|e>>>64-r;function rp(t,e,r,n){const i=(e>>>0)+(n>>>0);return{h:t+r+(i/2**32|0)|0,l:i|0}}const np=(t,e,r)=>(t>>>0)+(e>>>0)+(r>>>0),ip=(t,e,r,n)=>e+r+n+(t/2**32|0)|0,sp=(t,e,r,n)=>(t>>>0)+(e>>>0)+(r>>>0)+(n>>>0),op=(t,e,r,n,i)=>e+r+n+i+(t/2**32|0)|0,ap=(t,e,r,n,i)=>(t>>>0)+(e>>>0)+(r>>>0)+(n>>>0)+(i>>>0),cp=(t,e,r,n,i,s)=>e+r+n+i+s+(t/2**32|0)|0,W={fromBig:$f,split:jb,toBig:qb,shrSH:Hb,shrSL:Kb,rotrSH:Vb,rotrSL:Wb,rotrBH:Yb,rotrBL:Gb,rotr32H:Xb,rotr32L:Zb,rotlSH:Jb,rotlSL:Qb,rotlBH:ep,rotlBL:tp,add:rp,add3L:np,add3H:ip,add4L:sp,add4H:op,add5H:cp,add5L:ap},[fp,up]=W.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(t=>BigInt(t))),mr=new Uint32Array(80),wr=new Uint32Array(80);class hp extends kb{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:e,Al:r,Bh:n,Bl:i,Ch:s,Cl:o,Dh:a,Dl:c,Eh:f,El:h,Fh:l,Fl:y,Gh:_,Gl:w,Hh:A,Hl:D}=this;return[e,r,n,i,s,o,a,c,f,h,l,y,_,w,A,D]}set(e,r,n,i,s,o,a,c,f,h,l,y,_,w,A,D){this.Ah=e|0,this.Al=r|0,this.Bh=n|0,this.Bl=i|0,this.Ch=s|0,this.Cl=o|0,this.Dh=a|0,this.Dl=c|0,this.Eh=f|0,this.El=h|0,this.Fh=l|0,this.Fl=y|0,this.Gh=_|0,this.Gl=w|0,this.Hh=A|0,this.Hl=D|0}process(e,r){for(let T=0;T<16;T++,r+=4)mr[T]=e.getUint32(r),wr[T]=e.getUint32(r+=4);for(let T=16;T<80;T++){const R=mr[T-15]|0,z=wr[T-15]|0,L=W.rotrSH(R,z,1)^W.rotrSH(R,z,8)^W.shrSH(R,z,7),P=W.rotrSL(R,z,1)^W.rotrSL(R,z,8)^W.shrSL(R,z,7),$=mr[T-2]|0,B=wr[T-2]|0,j=W.rotrSH($,B,19)^W.rotrBH($,B,61)^W.shrSH($,B,6),S=W.rotrSL($,B,19)^W.rotrBL($,B,61)^W.shrSL($,B,6),u=W.add4L(P,S,wr[T-7],wr[T-16]),b=W.add4H(u,L,j,mr[T-7],mr[T-16]);mr[T]=b|0,wr[T]=u|0}let{Ah:n,Al:i,Bh:s,Bl:o,Ch:a,Cl:c,Dh:f,Dl:h,Eh:l,El:y,Fh:_,Fl:w,Gh:A,Gl:D,Hh:M,Hl:O}=this;for(let T=0;T<80;T++){const R=W.rotrSH(l,y,14)^W.rotrSH(l,y,18)^W.rotrBH(l,y,41),z=W.rotrSL(l,y,14)^W.rotrSL(l,y,18)^W.rotrBL(l,y,41),L=l&_^~l&A,P=y&w^~y&D,$=W.add5L(O,z,P,up[T],wr[T]),B=W.add5H($,M,R,L,fp[T],mr[T]),j=$|0,S=W.rotrSH(n,i,28)^W.rotrBH(n,i,34)^W.rotrBH(n,i,39),u=W.rotrSL(n,i,28)^W.rotrBL(n,i,34)^W.rotrBL(n,i,39),b=n&s^n&a^s&a,g=i&o^i&c^o&c;M=A|0,O=D|0,A=_|0,D=w|0,_=l|0,w=y|0,{h:l,l:y}=W.add(f|0,h|0,B|0,j|0),f=a|0,h=c|0,a=s|0,c=o|0,s=n|0,o=i|0;const p=W.add3L(j,u,g);n=W.add3H(p,B,S,b),i=p|0}({h:n,l:i}=W.add(this.Ah|0,this.Al|0,n|0,i|0)),{h:s,l:o}=W.add(this.Bh|0,this.Bl|0,s|0,o|0),{h:a,l:c}=W.add(this.Ch|0,this.Cl|0,a|0,c|0),{h:f,l:h}=W.add(this.Dh|0,this.Dl|0,f|0,h|0),{h:l,l:y}=W.add(this.Eh|0,this.El|0,l|0,y|0),{h:_,l:w}=W.add(this.Fh|0,this.Fl|0,_|0,w|0),{h:A,l:D}=W.add(this.Gh|0,this.Gl|0,A|0,D|0),{h:M,l:O}=W.add(this.Hh|0,this.Hl|0,M|0,O|0),this.set(n,i,s,o,a,c,f,h,l,y,_,w,A,D,M,O)}roundClean(){mr.fill(0),wr.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const dp=zb(()=>new hp);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const to=BigInt(0),Lf=BigInt(1),lp=BigInt(2);function ro(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function no(t){if(!ro(t))throw new Error("Uint8Array expected")}function io(t,e){if(typeof e!="boolean")throw new Error(t+" boolean expected, got "+e)}const bp=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function so(t){no(t);let e="";for(let r=0;r<t.length;r++)e+=bp[t[r]];return e}function Ff(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return t===""?to:BigInt("0x"+t)}const or={_0:48,_9:57,A:65,F:70,a:97,f:102};function zf(t){if(t>=or._0&&t<=or._9)return t-or._0;if(t>=or.A&&t<=or.F)return t-(or.A-10);if(t>=or.a&&t<=or.f)return t-(or.a-10)}function Uf(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);const e=t.length,r=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);const n=new Uint8Array(r);for(let i=0,s=0;i<r;i++,s+=2){const o=zf(t.charCodeAt(s)),a=zf(t.charCodeAt(s+1));if(o===void 0||a===void 0){const c=t[s]+t[s+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+s)}n[i]=o*16+a}return n}function pp(t){return Ff(so(t))}function Ci(t){return no(t),Ff(so(Uint8Array.from(t).reverse()))}function kf(t,e){return Uf(t.toString(16).padStart(e*2,"0"))}function oo(t,e){return kf(t,e).reverse()}function ar(t,e,r){let n;if(typeof e=="string")try{n=Uf(e)}catch(s){throw new Error(t+" must be hex string or Uint8Array, cause: "+s)}else if(ro(e))n=Uint8Array.from(e);else throw new Error(t+" must be hex string or Uint8Array");const i=n.length;if(typeof r=="number"&&i!==r)throw new Error(t+" of length "+r+" expected, got "+i);return n}function jf(...t){let e=0;for(let n=0;n<t.length;n++){const i=t[n];no(i),e+=i.length}const r=new Uint8Array(e);for(let n=0,i=0;n<t.length;n++){const s=t[n];r.set(s,i),i+=s.length}return r}const ao=t=>typeof t=="bigint"&&to<=t;function gp(t,e,r){return ao(t)&&ao(e)&&ao(r)&&e<=t&&t<r}function Vn(t,e,r,n){if(!gp(e,r,n))throw new Error("expected valid "+t+": "+r+" <= n < "+n+", got "+e)}function vp(t){let e;for(e=0;t>to;t>>=Lf,e+=1);return e}const yp=t=>(lp<<BigInt(t-1))-Lf,mp={bigint:t=>typeof t=="bigint",function:t=>typeof t=="function",boolean:t=>typeof t=="boolean",string:t=>typeof t=="string",stringOrUint8Array:t=>typeof t=="string"||ro(t),isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>typeof t=="function"&&Number.isSafeInteger(t.outputLen)};function co(t,e,r={}){const n=(i,s,o)=>{const a=mp[s];if(typeof a!="function")throw new Error("invalid validator function");const c=t[i];if(!(o&&c===void 0)&&!a(c,t))throw new Error("param "+String(i)+" is invalid. Expected "+s+", got "+c)};for(const[i,s]of Object.entries(e))n(i,s,!1);for(const[i,s]of Object.entries(r))n(i,s,!0);return t}function qf(t){const e=new WeakMap;return(r,...n)=>{const i=e.get(r);if(i!==void 0)return i;const s=t(r,...n);return e.set(r,s),s}}const Ve=BigInt(0),we=BigInt(1),Lr=BigInt(2),wp=BigInt(3),fo=BigInt(4),Hf=BigInt(5),Kf=BigInt(8);function He(t,e){const r=t%e;return r>=Ve?r:e+r}function _p(t,e,r){if(e<Ve)throw new Error("invalid exponent, negatives unsupported");if(r<=Ve)throw new Error("invalid modulus");if(r===we)return Ve;let n=we;for(;e>Ve;)e&we&&(n=n*t%r),t=t*t%r,e>>=we;return n}function Vt(t,e,r){let n=t;for(;e-- >Ve;)n*=n,n%=r;return n}function Vf(t,e){if(t===Ve)throw new Error("invert: expected non-zero number");if(e<=Ve)throw new Error("invert: expected positive modulus, got "+e);let r=He(t,e),n=e,i=Ve,s=we;for(;r!==Ve;){const o=n/r,a=n%r,c=i-s*o;n=r,r=a,i=s,s=c}if(n!==we)throw new Error("invert: does not exist");return He(i,e)}function Ep(t){const e=(t-we)/Lr;let r,n,i;for(r=t-we,n=0;r%Lr===Ve;r/=Lr,n++);for(i=Lr;i<t&&_p(i,e,t)!==t-we;i++)if(i>1e3)throw new Error("Cannot find square root: likely non-prime P");if(n===1){const o=(t+we)/fo;return function(a,c){const f=a.pow(c,o);if(!a.eql(a.sqr(f),c))throw new Error("Cannot find square root");return f}}const s=(r+we)/Lr;return function(o,a){if(o.pow(a,e)===o.neg(o.ONE))throw new Error("Cannot find square root");let c=n,f=o.pow(o.mul(o.ONE,i),r),h=o.pow(a,s),l=o.pow(a,r);for(;!o.eql(l,o.ONE);){if(o.eql(l,o.ZERO))return o.ZERO;let y=1;for(let w=o.sqr(l);y<c&&!o.eql(w,o.ONE);y++)w=o.sqr(w);const _=o.pow(f,we<<BigInt(c-y-1));f=o.sqr(_),h=o.mul(h,_),l=o.mul(l,f),c=y}return h}}function xp(t){if(t%fo===wp){const e=(t+we)/fo;return function(r,n){const i=r.pow(n,e);if(!r.eql(r.sqr(i),n))throw new Error("Cannot find square root");return i}}if(t%Kf===Hf){const e=(t-Hf)/Kf;return function(r,n){const i=r.mul(n,Lr),s=r.pow(i,e),o=r.mul(n,s),a=r.mul(r.mul(o,Lr),s),c=r.mul(o,r.sub(a,r.ONE));if(!r.eql(r.sqr(c),n))throw new Error("Cannot find square root");return c}}return Ep(t)}const Sp=(t,e)=>(He(t,e)&we)===we,Ip=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function Ap(t){const e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},r=Ip.reduce((n,i)=>(n[i]="function",n),e);return co(t,r)}function Dp(t,e,r){if(r<Ve)throw new Error("invalid exponent, negatives unsupported");if(r===Ve)return t.ONE;if(r===we)return e;let n=t.ONE,i=e;for(;r>Ve;)r&we&&(n=t.mul(n,i)),i=t.sqr(i),r>>=we;return n}function Op(t,e){const r=new Array(e.length),n=e.reduce((s,o,a)=>t.is0(o)?s:(r[a]=s,t.mul(s,o)),t.ONE),i=t.inv(n);return e.reduceRight((s,o,a)=>t.is0(o)?s:(r[a]=t.mul(s,r[a]),t.mul(s,o)),i),r}function Wf(t,e){const r=e!==void 0?e:t.toString(2).length,n=Math.ceil(r/8);return{nBitLength:r,nByteLength:n}}function Yf(t,e,r=!1,n={}){if(t<=Ve)throw new Error("invalid field: expected ORDER > 0, got "+t);const{nBitLength:i,nByteLength:s}=Wf(t,e);if(s>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let o;const a=Object.freeze({ORDER:t,isLE:r,BITS:i,BYTES:s,MASK:yp(i),ZERO:Ve,ONE:we,create:c=>He(c,t),isValid:c=>{if(typeof c!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof c);return Ve<=c&&c<t},is0:c=>c===Ve,isOdd:c=>(c&we)===we,neg:c=>He(-c,t),eql:(c,f)=>c===f,sqr:c=>He(c*c,t),add:(c,f)=>He(c+f,t),sub:(c,f)=>He(c-f,t),mul:(c,f)=>He(c*f,t),pow:(c,f)=>Dp(a,c,f),div:(c,f)=>He(c*Vf(f,t),t),sqrN:c=>c*c,addN:(c,f)=>c+f,subN:(c,f)=>c-f,mulN:(c,f)=>c*f,inv:c=>Vf(c,t),sqrt:n.sqrt||(c=>(o||(o=xp(t)),o(a,c))),invertBatch:c=>Op(a,c),cmov:(c,f,h)=>h?f:c,toBytes:c=>r?oo(c,s):kf(c,s),fromBytes:c=>{if(c.length!==s)throw new Error("Field.fromBytes: expected "+s+" bytes, got "+c.length);return r?Ci(c):pp(c)}});return Object.freeze(a)}const Gf=BigInt(0),$i=BigInt(1);function uo(t,e){const r=e.negate();return t?r:e}function Xf(t,e){if(!Number.isSafeInteger(t)||t<=0||t>e)throw new Error("invalid window size, expected [1.."+e+"], got W="+t)}function ho(t,e){Xf(t,e);const r=Math.ceil(e/t)+1,n=2**(t-1);return{windows:r,windowSize:n}}function Mp(t,e){if(!Array.isArray(t))throw new Error("array expected");t.forEach((r,n)=>{if(!(r instanceof e))throw new Error("invalid point at index "+n)})}function Tp(t,e){if(!Array.isArray(t))throw new Error("array of scalars expected");t.forEach((r,n)=>{if(!e.isValid(r))throw new Error("invalid scalar at index "+n)})}const lo=new WeakMap,Zf=new WeakMap;function bo(t){return Zf.get(t)||1}function Rp(t,e){return{constTimeNegate:uo,hasPrecomputes(r){return bo(r)!==1},unsafeLadder(r,n,i=t.ZERO){let s=r;for(;n>Gf;)n&$i&&(i=i.add(s)),s=s.double(),n>>=$i;return i},precomputeWindow(r,n){const{windows:i,windowSize:s}=ho(n,e),o=[];let a=r,c=a;for(let f=0;f<i;f++){c=a,o.push(c);for(let h=1;h<s;h++)c=c.add(a),o.push(c);a=c.double()}return o},wNAF(r,n,i){const{windows:s,windowSize:o}=ho(r,e);let a=t.ZERO,c=t.BASE;const f=BigInt(2**r-1),h=2**r,l=BigInt(r);for(let y=0;y<s;y++){const _=y*o;let w=Number(i&f);i>>=l,w>o&&(w-=h,i+=$i);const A=_,D=_+Math.abs(w)-1,M=y%2!==0,O=w<0;w===0?c=c.add(uo(M,n[A])):a=a.add(uo(O,n[D]))}return{p:a,f:c}},wNAFUnsafe(r,n,i,s=t.ZERO){const{windows:o,windowSize:a}=ho(r,e),c=BigInt(2**r-1),f=2**r,h=BigInt(r);for(let l=0;l<o;l++){const y=l*a;if(i===Gf)break;let _=Number(i&c);if(i>>=h,_>a&&(_-=f,i+=$i),_===0)continue;let w=n[y+Math.abs(_)-1];_<0&&(w=w.negate()),s=s.add(w)}return s},getPrecomputes(r,n,i){let s=lo.get(n);return s||(s=this.precomputeWindow(n,r),r!==1&&lo.set(n,i(s))),s},wNAFCached(r,n,i){const s=bo(r);return this.wNAF(s,this.getPrecomputes(s,r,i),n)},wNAFCachedUnsafe(r,n,i,s){const o=bo(r);return o===1?this.unsafeLadder(r,n,s):this.wNAFUnsafe(o,this.getPrecomputes(o,r,i),n,s)},setWindowSize(r,n){Xf(n,e),Zf.set(r,n),lo.delete(r)}}}function Bp(t,e,r,n){if(Mp(r,t),Tp(n,e),r.length!==n.length)throw new Error("arrays of points and scalars must have equal length");const i=t.ZERO,s=vp(BigInt(r.length)),o=s>12?s-3:s>4?s-2:s?2:1,a=(1<<o)-1,c=new Array(a+1).fill(i),f=Math.floor((e.BITS-1)/o)*o;let h=i;for(let l=f;l>=0;l-=o){c.fill(i);for(let _=0;_<n.length;_++){const w=n[_],A=Number(w>>BigInt(l)&BigInt(a));c[A]=c[A].add(r[_])}let y=i;for(let _=c.length-1,w=i;_>0;_--)w=w.add(c[_]),y=y.add(w);if(h=h.add(y),l!==0)for(let _=0;_<o;_++)h=h.double()}return h}function Np(t){return Ap(t.Fp),co(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...Wf(t.n,t.nBitLength),...t,p:t.Fp.ORDER})}const $t=BigInt(0),pt=BigInt(1),Li=BigInt(2),Pp=BigInt(8),Cp={zip215:!0};function $p(t){const e=Np(t);return co(t,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...e})}function Lp(t){const e=$p(t),{Fp:r,n,prehash:i,hash:s,randomBytes:o,nByteLength:a,h:c}=e,f=Li<<BigInt(a*8)-pt,h=r.create,l=Yf(e.n,e.nBitLength),y=e.uvRatio||((p,v)=>{try{return{isValid:!0,value:r.sqrt(p*r.inv(v))}}catch{return{isValid:!1,value:$t}}}),_=e.adjustScalarBytes||(p=>p),w=e.domain||((p,v,x)=>{if(io("phflag",x),v.length||x)throw new Error("Contexts/pre-hash are not supported");return p});function A(p,v){Vn("coordinate "+p,v,$t,f)}function D(p){if(!(p instanceof T))throw new Error("ExtendedPoint expected")}const M=qf((p,v)=>{const{ex:x,ey:I,ez:m}=p,d=p.is0();v==null&&(v=d?Pp:r.inv(m));const E=h(x*v),N=h(I*v),C=h(m*v);if(d)return{x:$t,y:pt};if(C!==pt)throw new Error("invZ was invalid");return{x:E,y:N}}),O=qf(p=>{const{a:v,d:x}=e;if(p.is0())throw new Error("bad point: ZERO");const{ex:I,ey:m,ez:d,et:E}=p,N=h(I*I),C=h(m*m),F=h(d*d),k=h(F*F),q=h(N*v),V=h(F*h(q+C)),Z=h(k+h(x*h(N*C)));if(V!==Z)throw new Error("bad point: equation left != right (1)");const K=h(I*m),Y=h(d*E);if(K!==Y)throw new Error("bad point: equation left != right (2)");return!0});class T{constructor(v,x,I,m){this.ex=v,this.ey=x,this.ez=I,this.et=m,A("x",v),A("y",x),A("z",I),A("t",m),Object.freeze(this)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(v){if(v instanceof T)throw new Error("extended point not allowed");const{x,y:I}=v||{};return A("x",x),A("y",I),new T(x,I,pt,h(x*I))}static normalizeZ(v){const x=r.invertBatch(v.map(I=>I.ez));return v.map((I,m)=>I.toAffine(x[m])).map(T.fromAffine)}static msm(v,x){return Bp(T,l,v,x)}_setWindowSize(v){L.setWindowSize(this,v)}assertValidity(){O(this)}equals(v){D(v);const{ex:x,ey:I,ez:m}=this,{ex:d,ey:E,ez:N}=v,C=h(x*N),F=h(d*m),k=h(I*N),q=h(E*m);return C===F&&k===q}is0(){return this.equals(T.ZERO)}negate(){return new T(h(-this.ex),this.ey,this.ez,h(-this.et))}double(){const{a:v}=e,{ex:x,ey:I,ez:m}=this,d=h(x*x),E=h(I*I),N=h(Li*h(m*m)),C=h(v*d),F=x+I,k=h(h(F*F)-d-E),q=C+E,V=q-N,Z=C-E,K=h(k*V),Y=h(q*Z),ft=h(k*Z),J=h(V*q);return new T(K,Y,J,ft)}add(v){D(v);const{a:x,d:I}=e,{ex:m,ey:d,ez:E,et:N}=this,{ex:C,ey:F,ez:k,et:q}=v;if(x===BigInt(-1)){const ue=h((d-m)*(F+C)),mi=h((d+m)*(F-C)),fe=h(mi-ue);if(fe===$t)return this.double();const he=h(E*Li*q),wi=h(N*Li*k),de=wi+he,le=mi+ue,_i=wi-he,ve=h(de*fe),ye=h(le*_i),Rs=h(de*_i),me=h(fe*le);return new T(ve,ye,me,Rs)}const V=h(m*C),Z=h(d*F),K=h(N*I*q),Y=h(E*k),ft=h((m+d)*(C+F)-V-Z),J=Y-K,re=Y+K,Nt=h(Z-x*V),ce=h(ft*J),pe=h(re*Nt),Ts=h(ft*Nt),ge=h(J*re);return new T(ce,pe,ge,Ts)}subtract(v){return this.add(v.negate())}wNAF(v){return L.wNAFCached(this,v,T.normalizeZ)}multiply(v){const x=v;Vn("scalar",x,pt,n);const{p:I,f:m}=this.wNAF(x);return T.normalizeZ([I,m])[0]}multiplyUnsafe(v,x=T.ZERO){const I=v;return Vn("scalar",I,$t,n),I===$t?z:this.is0()||I===pt?this:L.wNAFCachedUnsafe(this,I,T.normalizeZ,x)}isSmallOrder(){return this.multiplyUnsafe(c).is0()}isTorsionFree(){return L.unsafeLadder(this,n).is0()}toAffine(v){return M(this,v)}clearCofactor(){const{h:v}=e;return v===pt?this:this.multiplyUnsafe(v)}static fromHex(v,x=!1){const{d:I,a:m}=e,d=r.BYTES;v=ar("pointHex",v,d),io("zip215",x);const E=v.slice(),N=v[d-1];E[d-1]=N&-129;const C=Ci(E),F=x?f:r.ORDER;Vn("pointHex.y",C,$t,F);const k=h(C*C),q=h(k-pt),V=h(I*k-m);let{isValid:Z,value:K}=y(q,V);if(!Z)throw new Error("Point.fromHex: invalid y coordinate");const Y=(K&pt)===pt,ft=(N&128)!==0;if(!x&&K===$t&&ft)throw new Error("Point.fromHex: x=0 and x_0=1");return ft!==Y&&(K=h(-K)),T.fromAffine({x:K,y:C})}static fromPrivateKey(v){return B(v).point}toRawBytes(){const{x:v,y:x}=this.toAffine(),I=oo(x,r.BYTES);return I[I.length-1]|=v&pt?128:0,I}toHex(){return so(this.toRawBytes())}}T.BASE=new T(e.Gx,e.Gy,pt,h(e.Gx*e.Gy)),T.ZERO=new T($t,pt,pt,$t);const{BASE:R,ZERO:z}=T,L=Rp(T,a*8);function P(p){return He(p,n)}function $(p){return P(Ci(p))}function B(p){const v=r.BYTES;p=ar("private key",p,v);const x=ar("hashed private key",s(p),2*v),I=_(x.slice(0,v)),m=x.slice(v,2*v),d=$(I),E=R.multiply(d),N=E.toRawBytes();return{head:I,prefix:m,scalar:d,point:E,pointBytes:N}}function j(p){return B(p).pointBytes}function S(p=new Uint8Array,...v){const x=jf(...v);return $(s(w(x,ar("context",p),!!i)))}function u(p,v,x={}){p=ar("message",p),i&&(p=i(p));const{prefix:I,scalar:m,pointBytes:d}=B(v),E=S(x.context,I,p),N=R.multiply(E).toRawBytes(),C=S(x.context,N,d,p),F=P(E+C*m);Vn("signature.s",F,$t,n);const k=jf(N,oo(F,r.BYTES));return ar("result",k,r.BYTES*2)}const b=Cp;function g(p,v,x,I=b){const{context:m,zip215:d}=I,E=r.BYTES;p=ar("signature",p,2*E),v=ar("message",v),x=ar("publicKey",x,E),d!==void 0&&io("zip215",d),i&&(v=i(v));const N=Ci(p.slice(E,2*E));let C,F,k;try{C=T.fromHex(x,d),F=T.fromHex(p.slice(0,E),d),k=R.multiplyUnsafe(N)}catch{return!1}if(!d&&C.isSmallOrder())return!1;const q=S(m,F.toRawBytes(),C.toRawBytes(),v);return F.add(C.multiplyUnsafe(q)).subtract(k).clearCofactor().equals(T.ZERO)}return R._setWindowSize(8),{CURVE:e,getPublicKey:j,sign:u,verify:g,ExtendedPoint:T,utils:{getExtendedPublicKey:B,randomPrivateKey:()=>o(r.BYTES),precompute(p=8,v=T.BASE){return v._setWindowSize(p),v.multiply(BigInt(3)),v}}}}BigInt(0),BigInt(1);const po=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),Jf=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");BigInt(0);const Fp=BigInt(1),Qf=BigInt(2);BigInt(3);const zp=BigInt(5),Up=BigInt(8);function kp(t){const e=BigInt(10),r=BigInt(20),n=BigInt(40),i=BigInt(80),s=po,o=t*t%s*t%s,a=Vt(o,Qf,s)*o%s,c=Vt(a,Fp,s)*t%s,f=Vt(c,zp,s)*c%s,h=Vt(f,e,s)*f%s,l=Vt(h,r,s)*h%s,y=Vt(l,n,s)*l%s,_=Vt(y,i,s)*y%s,w=Vt(_,i,s)*y%s,A=Vt(w,e,s)*f%s;return{pow_p_5_8:Vt(A,Qf,s)*t%s,b2:o}}function jp(t){return t[0]&=248,t[31]&=127,t[31]|=64,t}function qp(t,e){const r=po,n=He(e*e*e,r),i=He(n*n*e,r),s=kp(t*i).pow_p_5_8;let o=He(t*n*s,r);const a=He(e*o*o,r),c=o,f=He(o*Jf,r),h=a===t,l=a===He(-t,r),y=a===He(-t*Jf,r);return h&&(o=c),(l||y)&&(o=f),Sp(o,r)&&(o=He(-o,r)),{isValid:h||l,value:o}}const Hp=Yf(po,void 0,!0),Kp={a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:Hp,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:Up,Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:dp,randomBytes:Cf,adjustScalarBytes:jp,uvRatio:qp},eu=Lp(Kp),Vp="EdDSA",Wp="JWT",Fi=".",zi="base64url",tu="utf8",ru="utf8",Yp=":",Gp="did",Xp="key",nu="base58btc",Zp="z",Jp="K36",Qp=32;function go(t){return globalThis.Buffer!=null?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}function iu(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?go(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}function su(t,e){e||(e=t.reduce((i,s)=>i+s.length,0));const r=iu(e);let n=0;for(const i of t)r.set(i,n),n+=i.length;return go(r)}function eg(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<t.length;i++){var s=t.charAt(i),o=s.charCodeAt(0);if(r[o]!==255)throw new TypeError(s+" is ambiguous");r[o]=i}var a=t.length,c=t.charAt(0),f=Math.log(a)/Math.log(256),h=Math.log(256)/Math.log(a);function l(w){if(w instanceof Uint8Array||(ArrayBuffer.isView(w)?w=new Uint8Array(w.buffer,w.byteOffset,w.byteLength):Array.isArray(w)&&(w=Uint8Array.from(w))),!(w instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(w.length===0)return"";for(var A=0,D=0,M=0,O=w.length;M!==O&&w[M]===0;)M++,A++;for(var T=(O-M)*h+1>>>0,R=new Uint8Array(T);M!==O;){for(var z=w[M],L=0,P=T-1;(z!==0||L<D)&&P!==-1;P--,L++)z+=256*R[P]>>>0,R[P]=z%a>>>0,z=z/a>>>0;if(z!==0)throw new Error("Non-zero carry");D=L,M++}for(var $=T-D;$!==T&&R[$]===0;)$++;for(var B=c.repeat(A);$<T;++$)B+=t.charAt(R[$]);return B}function y(w){if(typeof w!="string")throw new TypeError("Expected String");if(w.length===0)return new Uint8Array;var A=0;if(w[A]!==" "){for(var D=0,M=0;w[A]===c;)D++,A++;for(var O=(w.length-A)*f+1>>>0,T=new Uint8Array(O);w[A];){var R=r[w.charCodeAt(A)];if(R===255)return;for(var z=0,L=O-1;(R!==0||z<M)&&L!==-1;L--,z++)R+=a*T[L]>>>0,T[L]=R%256>>>0,R=R/256>>>0;if(R!==0)throw new Error("Non-zero carry");M=z,A++}if(w[A]!==" "){for(var P=O-M;P!==O&&T[P]===0;)P++;for(var $=new Uint8Array(D+(O-P)),B=D;P!==O;)$[B++]=T[P++];return $}}}function _(w){var A=y(w);if(A)return A;throw new Error(`Non-${e} character`)}return{encode:l,decodeUnsafe:y,decode:_}}var tg=eg,rg=tg;const ou=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},ng=t=>new TextEncoder().encode(t),ig=t=>new TextDecoder().decode(t);class sg{constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class og{constructor(e,r,n){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return au(this,e)}}class ag{constructor(e){this.decoders=e}or(e){return au(this,e)}decode(e){const r=e[0],n=this.decoders[r];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const au=(t,e)=>new ag({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});class cg{constructor(e,r,n,i){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=i,this.encoder=new sg(e,r,n),this.decoder=new og(e,r,i)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const Ui=({name:t,prefix:e,encode:r,decode:n})=>new cg(t,e,r,n),Wn=({prefix:t,name:e,alphabet:r})=>{const{encode:n,decode:i}=rg(r,e);return Ui({prefix:t,name:e,encode:n,decode:s=>ou(i(s))})},fg=(t,e,r,n)=>{const i={};for(let h=0;h<e.length;++h)i[e[h]]=h;let s=t.length;for(;t[s-1]==="=";)--s;const o=new Uint8Array(s*r/8|0);let a=0,c=0,f=0;for(let h=0;h<s;++h){const l=i[t[h]];if(l===void 0)throw new SyntaxError(`Non-${n} character`);c=c<<r|l,a+=r,a>=8&&(a-=8,o[f++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},ug=(t,e,r)=>{const n=e[e.length-1]==="=",i=(1<<r)-1;let s="",o=0,a=0;for(let c=0;c<t.length;++c)for(a=a<<8|t[c],o+=8;o>r;)o-=r,s+=e[i&a>>o];if(o&&(s+=e[i&a<<r-o]),n)for(;s.length*r&7;)s+="=";return s},et=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>Ui({prefix:e,name:t,encode(i){return ug(i,n,r)},decode(i){return fg(i,n,r,t)}}),hg=Ui({prefix:"\0",name:"identity",encode:t=>ig(t),decode:t=>ng(t)});var dg=Object.freeze({__proto__:null,identity:hg});const lg=et({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var bg=Object.freeze({__proto__:null,base2:lg});const pg=et({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var gg=Object.freeze({__proto__:null,base8:pg});const vg=Wn({prefix:"9",name:"base10",alphabet:"0123456789"});var yg=Object.freeze({__proto__:null,base10:vg});const mg=et({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),wg=et({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var _g=Object.freeze({__proto__:null,base16:mg,base16upper:wg});const Eg=et({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),xg=et({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Sg=et({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Ig=et({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Ag=et({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Dg=et({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Og=et({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Mg=et({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Tg=et({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var Rg=Object.freeze({__proto__:null,base32:Eg,base32upper:xg,base32pad:Sg,base32padupper:Ig,base32hex:Ag,base32hexupper:Dg,base32hexpad:Og,base32hexpadupper:Mg,base32z:Tg});const Bg=Wn({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Ng=Wn({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var Pg=Object.freeze({__proto__:null,base36:Bg,base36upper:Ng});const Cg=Wn({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),$g=Wn({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Lg=Object.freeze({__proto__:null,base58btc:Cg,base58flickr:$g});const Fg=et({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),zg=et({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Ug=et({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),kg=et({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var jg=Object.freeze({__proto__:null,base64:Fg,base64pad:zg,base64url:Ug,base64urlpad:kg});const cu=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),qg=cu.reduce((t,e,r)=>(t[r]=e,t),[]),Hg=cu.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function Kg(t){return t.reduce((e,r)=>(e+=qg[r],e),"")}function Vg(t){const e=[];for(const r of t){const n=Hg[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(n)}return new Uint8Array(e)}const Wg=Ui({prefix:"\u{1F680}",name:"base256emoji",encode:Kg,decode:Vg});var Yg=Object.freeze({__proto__:null,base256emoji:Wg}),Gg=uu,fu=128,Xg=127,Zg=~Xg,Jg=Math.pow(2,31);function uu(t,e,r){e=e||[],r=r||0;for(var n=r;t>=Jg;)e[r++]=t&255|fu,t/=128;for(;t&Zg;)e[r++]=t&255|fu,t>>>=7;return e[r]=t|0,uu.bytes=r-n+1,e}var Qg=vo,e2=128,hu=127;function vo(t,n){var r=0,n=n||0,i=0,s=n,o,a=t.length;do{if(s>=a)throw vo.bytes=0,new RangeError("Could not decode varint");o=t[s++],r+=i<28?(o&hu)<<i:(o&hu)*Math.pow(2,i),i+=7}while(o>=e2);return vo.bytes=s-n,r}var t2=Math.pow(2,7),r2=Math.pow(2,14),n2=Math.pow(2,21),i2=Math.pow(2,28),s2=Math.pow(2,35),o2=Math.pow(2,42),a2=Math.pow(2,49),c2=Math.pow(2,56),f2=Math.pow(2,63),u2=function(t){return t<t2?1:t<r2?2:t<n2?3:t<i2?4:t<s2?5:t<o2?6:t<a2?7:t<c2?8:t<f2?9:10},h2={encode:Gg,decode:Qg,encodingLength:u2},du=h2;const lu=(t,e,r=0)=>(du.encode(t,e,r),e),bu=t=>du.encodingLength(t),yo=(t,e)=>{const r=e.byteLength,n=bu(t),i=n+bu(r),s=new Uint8Array(i+r);return lu(t,s,0),lu(r,s,n),s.set(e,i),new d2(t,r,e,s)};class d2{constructor(e,r,n,i){this.code=e,this.size=r,this.digest=n,this.bytes=i}}const pu=({name:t,code:e,encode:r})=>new l2(t,e,r);class l2{constructor(e,r,n){this.name=e,this.code=r,this.encode=n}digest(e){if(e instanceof Uint8Array){const r=this.encode(e);return r instanceof Uint8Array?yo(this.code,r):r.then(n=>yo(this.code,n))}else throw Error("Unknown type, must be binary type")}}const gu=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),b2=pu({name:"sha2-256",code:18,encode:gu("SHA-256")}),p2=pu({name:"sha2-512",code:19,encode:gu("SHA-512")});var g2=Object.freeze({__proto__:null,sha256:b2,sha512:p2});const vu=0,v2="identity",yu=ou;var y2=Object.freeze({__proto__:null,identity:{code:vu,name:v2,encode:yu,digest:t=>yo(vu,yu(t))}});new TextEncoder,new TextDecoder;const mu={...dg,...bg,...gg,...yg,..._g,...Rg,...Pg,...Lg,...jg,...Yg};({...g2,...y2});function wu(t,e,r,n){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:n}}}const _u=wu("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),mo=wu("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);const e=iu(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),Eu={utf8:_u,"utf-8":_u,hex:mu.base16,latin1:mo,ascii:mo,binary:mo,...mu};function ki(t,e="utf8"){const r=Eu[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8"):r.encoder.encode(t).substring(1)}function an(t,e="utf8"){const r=Eu[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?go(globalThis.Buffer.from(t,"utf-8")):r.decoder.decode(`${r.prefix}${t}`)}function xu(t){return en(ki(an(t,zi),tu))}function ji(t){return ki(an(Cr(t),tu),zi)}function Su(t){const e=an(Jp,nu),r=Zp+ki(su([e,t]),nu);return[Gp,Xp,r].join(Yp)}function m2(t){return ki(t,zi)}function w2(t){return an(t,zi)}function _2(t){return an([ji(t.header),ji(t.payload)].join(Fi),ru)}function E2(t){return[ji(t.header),ji(t.payload),m2(t.signature)].join(Fi)}function wo(t){const e=t.split(Fi),r=xu(e[0]),n=xu(e[1]),i=w2(e[2]),s=an(e.slice(0,2).join(Fi),ru);return{header:r,payload:n,signature:i,data:s}}function Iu(t=Cf(Qp)){const e=eu.getPublicKey(t);return{secretKey:su([t,e]),publicKey:e}}async function x2(t,e,r,n,i=H.fromMiliseconds(Date.now())){const s={alg:Vp,typ:Wp},o=Su(n.publicKey),a=i+r,c={iss:o,sub:t,aud:e,iat:i,exp:a},f=_2({header:s,payload:c}),h=eu.sign(f,n.secretKey.slice(0,32));return E2({header:s,payload:c,signature:h})}function S2(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<t.length;i++){var s=t.charAt(i),o=s.charCodeAt(0);if(r[o]!==255)throw new TypeError(s+" is ambiguous");r[o]=i}var a=t.length,c=t.charAt(0),f=Math.log(a)/Math.log(256),h=Math.log(256)/Math.log(a);function l(w){if(w instanceof Uint8Array||(ArrayBuffer.isView(w)?w=new Uint8Array(w.buffer,w.byteOffset,w.byteLength):Array.isArray(w)&&(w=Uint8Array.from(w))),!(w instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(w.length===0)return"";for(var A=0,D=0,M=0,O=w.length;M!==O&&w[M]===0;)M++,A++;for(var T=(O-M)*h+1>>>0,R=new Uint8Array(T);M!==O;){for(var z=w[M],L=0,P=T-1;(z!==0||L<D)&&P!==-1;P--,L++)z+=256*R[P]>>>0,R[P]=z%a>>>0,z=z/a>>>0;if(z!==0)throw new Error("Non-zero carry");D=L,M++}for(var $=T-D;$!==T&&R[$]===0;)$++;for(var B=c.repeat(A);$<T;++$)B+=t.charAt(R[$]);return B}function y(w){if(typeof w!="string")throw new TypeError("Expected String");if(w.length===0)return new Uint8Array;var A=0;if(w[A]!==" "){for(var D=0,M=0;w[A]===c;)D++,A++;for(var O=(w.length-A)*f+1>>>0,T=new Uint8Array(O);w[A];){var R=r[w.charCodeAt(A)];if(R===255)return;for(var z=0,L=O-1;(R!==0||z<M)&&L!==-1;L--,z++)R+=a*T[L]>>>0,T[L]=R%256>>>0,R=R/256>>>0;if(R!==0)throw new Error("Non-zero carry");M=z,A++}if(w[A]!==" "){for(var P=O-M;P!==O&&T[P]===0;)P++;for(var $=new Uint8Array(D+(O-P)),B=D;P!==O;)$[B++]=T[P++];return $}}}function _(w){var A=y(w);if(A)return A;throw new Error(`Non-${e} character`)}return{encode:l,decodeUnsafe:y,decode:_}}var I2=S2,A2=I2;const Au=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},D2=t=>new TextEncoder().encode(t),O2=t=>new TextDecoder().decode(t);class M2{constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class T2{constructor(e,r,n){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return Du(this,e)}}class R2{constructor(e){this.decoders=e}or(e){return Du(this,e)}decode(e){const r=e[0],n=this.decoders[r];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Du=(t,e)=>new R2({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});class B2{constructor(e,r,n,i){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=i,this.encoder=new M2(e,r,n),this.decoder=new T2(e,r,i)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const qi=({name:t,prefix:e,encode:r,decode:n})=>new B2(t,e,r,n),Yn=({prefix:t,name:e,alphabet:r})=>{const{encode:n,decode:i}=A2(r,e);return qi({prefix:t,name:e,encode:n,decode:s=>Au(i(s))})},N2=(t,e,r,n)=>{const i={};for(let h=0;h<e.length;++h)i[e[h]]=h;let s=t.length;for(;t[s-1]==="=";)--s;const o=new Uint8Array(s*r/8|0);let a=0,c=0,f=0;for(let h=0;h<s;++h){const l=i[t[h]];if(l===void 0)throw new SyntaxError(`Non-${n} character`);c=c<<r|l,a+=r,a>=8&&(a-=8,o[f++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},P2=(t,e,r)=>{const n=e[e.length-1]==="=",i=(1<<r)-1;let s="",o=0,a=0;for(let c=0;c<t.length;++c)for(a=a<<8|t[c],o+=8;o>r;)o-=r,s+=e[i&a>>o];if(o&&(s+=e[i&a<<r-o]),n)for(;s.length*r&7;)s+="=";return s},tt=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>qi({prefix:e,name:t,encode(i){return P2(i,n,r)},decode(i){return N2(i,n,r,t)}}),C2=qi({prefix:"\0",name:"identity",encode:t=>O2(t),decode:t=>D2(t)});var $2=Object.freeze({__proto__:null,identity:C2});const L2=tt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var F2=Object.freeze({__proto__:null,base2:L2});const z2=tt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var U2=Object.freeze({__proto__:null,base8:z2});const k2=Yn({prefix:"9",name:"base10",alphabet:"0123456789"});var j2=Object.freeze({__proto__:null,base10:k2});const q2=tt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),H2=tt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var K2=Object.freeze({__proto__:null,base16:q2,base16upper:H2});const V2=tt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),W2=tt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Y2=tt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),G2=tt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),X2=tt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Z2=tt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),J2=tt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Q2=tt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),ev=tt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var tv=Object.freeze({__proto__:null,base32:V2,base32upper:W2,base32pad:Y2,base32padupper:G2,base32hex:X2,base32hexupper:Z2,base32hexpad:J2,base32hexpadupper:Q2,base32z:ev});const rv=Yn({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),nv=Yn({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var iv=Object.freeze({__proto__:null,base36:rv,base36upper:nv});const sv=Yn({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),ov=Yn({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var av=Object.freeze({__proto__:null,base58btc:sv,base58flickr:ov});const cv=tt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),fv=tt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),uv=tt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),hv=tt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var dv=Object.freeze({__proto__:null,base64:cv,base64pad:fv,base64url:uv,base64urlpad:hv});const Ou=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),lv=Ou.reduce((t,e,r)=>(t[r]=e,t),[]),bv=Ou.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function pv(t){return t.reduce((e,r)=>(e+=lv[r],e),"")}function gv(t){const e=[];for(const r of t){const n=bv[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(n)}return new Uint8Array(e)}const vv=qi({prefix:"\u{1F680}",name:"base256emoji",encode:pv,decode:gv});var yv=Object.freeze({__proto__:null,base256emoji:vv}),mv=Tu,Mu=128,wv=127,_v=~wv,Ev=Math.pow(2,31);function Tu(t,e,r){e=e||[],r=r||0;for(var n=r;t>=Ev;)e[r++]=t&255|Mu,t/=128;for(;t&_v;)e[r++]=t&255|Mu,t>>>=7;return e[r]=t|0,Tu.bytes=r-n+1,e}var xv=_o,Sv=128,Ru=127;function _o(t,n){var r=0,n=n||0,i=0,s=n,o,a=t.length;do{if(s>=a)throw _o.bytes=0,new RangeError("Could not decode varint");o=t[s++],r+=i<28?(o&Ru)<<i:(o&Ru)*Math.pow(2,i),i+=7}while(o>=Sv);return _o.bytes=s-n,r}var Iv=Math.pow(2,7),Av=Math.pow(2,14),Dv=Math.pow(2,21),Ov=Math.pow(2,28),Mv=Math.pow(2,35),Tv=Math.pow(2,42),Rv=Math.pow(2,49),Bv=Math.pow(2,56),Nv=Math.pow(2,63),Pv=function(t){return t<Iv?1:t<Av?2:t<Dv?3:t<Ov?4:t<Mv?5:t<Tv?6:t<Rv?7:t<Bv?8:t<Nv?9:10},Cv={encode:mv,decode:xv,encodingLength:Pv},Bu=Cv;const Nu=(t,e,r=0)=>(Bu.encode(t,e,r),e),Pu=t=>Bu.encodingLength(t),Eo=(t,e)=>{const r=e.byteLength,n=Pu(t),i=n+Pu(r),s=new Uint8Array(i+r);return Nu(t,s,0),Nu(r,s,n),s.set(e,i),new $v(t,r,e,s)};class $v{constructor(e,r,n,i){this.code=e,this.size=r,this.digest=n,this.bytes=i}}const Cu=({name:t,code:e,encode:r})=>new Lv(t,e,r);class Lv{constructor(e,r,n){this.name=e,this.code=r,this.encode=n}digest(e){if(e instanceof Uint8Array){const r=this.encode(e);return r instanceof Uint8Array?Eo(this.code,r):r.then(n=>Eo(this.code,n))}else throw Error("Unknown type, must be binary type")}}const $u=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),Fv=Cu({name:"sha2-256",code:18,encode:$u("SHA-256")}),zv=Cu({name:"sha2-512",code:19,encode:$u("SHA-512")});var Uv=Object.freeze({__proto__:null,sha256:Fv,sha512:zv});const Lu=0,kv="identity",Fu=Au;var jv=Object.freeze({__proto__:null,identity:{code:Lu,name:kv,encode:Fu,digest:t=>Eo(Lu,Fu(t))}});new TextEncoder,new TextDecoder;const zu={...$2,...F2,...U2,...j2,...K2,...tv,...iv,...av,...dv,...yv};({...Uv,...jv});function Uu(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?globalThis.Buffer.allocUnsafe(t):new Uint8Array(t)}function ku(t,e,r,n){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:n}}}const ju=ku("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),xo=ku("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);const e=Uu(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),qu={utf8:ju,"utf-8":ju,hex:zu.base16,latin1:xo,ascii:xo,binary:xo,...zu};function Et(t,e="utf8"){const r=qu[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t,"utf8"):r.decoder.decode(`${r.prefix}${t}`)}var Hu=function(t,e,r){if(r||arguments.length===2)for(var n=0,i=e.length,s;n<i;n++)(s||!(n in e))&&(s||(s=Array.prototype.slice.call(e,0,n)),s[n]=e[n]);return t.concat(s||Array.prototype.slice.call(e))},qv=function(){function t(e,r,n){this.name=e,this.version=r,this.os=n,this.type="browser"}return t}(),Hv=function(){function t(e){this.version=e,this.type="node",this.name="node",this.os=process.platform}return t}(),Kv=function(){function t(e,r,n,i){this.name=e,this.version=r,this.os=n,this.bot=i,this.type="bot-device"}return t}(),Vv=function(){function t(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return t}(),Wv=function(){function t(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return t}(),Yv=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,Gv=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,Ku=3,Xv=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",Yv]],Vu=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function Zv(t){return t?Wu(t):typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new Wv:typeof navigator<"u"?Wu(navigator.userAgent):e3()}function Jv(t){return t!==""&&Xv.reduce(function(e,r){var n=r[0],i=r[1];if(e)return e;var s=i.exec(t);return!!s&&[n,s]},!1)}function Wu(t){var e=Jv(t);if(!e)return null;var r=e[0],n=e[1];if(r==="searchbot")return new Vv;var i=n[1]&&n[1].split(".").join("_").split("_").slice(0,3);i?i.length<Ku&&(i=Hu(Hu([],i,!0),t3(Ku-i.length),!0)):i=[];var s=i.join("."),o=Qv(t),a=Gv.exec(t);return a&&a[1]?new Kv(r,s,o,a[1]):new qv(r,s,o)}function Qv(t){for(var e=0,r=Vu.length;e<r;e++){var n=Vu[e],i=n[0],s=n[1],o=s.exec(t);if(o)return i}return null}function e3(){var t=typeof process<"u"&&process.version;return t?new Hv(process.version.slice(1)):null}function t3(t){for(var e=[],r=0;r<t;r++)e.push("0");return e}var se={};Object.defineProperty(se,"__esModule",{value:!0}),se.getLocalStorage=se.getLocalStorageOrThrow=se.getCrypto=se.getCryptoOrThrow=Yu=se.getLocation=se.getLocationOrThrow=So=se.getNavigator=se.getNavigatorOrThrow=Hi=se.getDocument=se.getDocumentOrThrow=se.getFromWindowOrThrow=se.getFromWindow=void 0;function Fr(t){let e;return typeof window<"u"&&typeof window[t]<"u"&&(e=window[t]),e}se.getFromWindow=Fr;function cn(t){const e=Fr(t);if(!e)throw new Error(`${t} is not defined in Window`);return e}se.getFromWindowOrThrow=cn;function r3(){return cn("document")}se.getDocumentOrThrow=r3;function n3(){return Fr("document")}var Hi=se.getDocument=n3;function i3(){return cn("navigator")}se.getNavigatorOrThrow=i3;function s3(){return Fr("navigator")}var So=se.getNavigator=s3;function o3(){return cn("location")}se.getLocationOrThrow=o3;function a3(){return Fr("location")}var Yu=se.getLocation=a3;function c3(){return cn("crypto")}se.getCryptoOrThrow=c3;function f3(){return Fr("crypto")}se.getCrypto=f3;function u3(){return cn("localStorage")}se.getLocalStorageOrThrow=u3;function h3(){return Fr("localStorage")}se.getLocalStorage=h3;var Io={};Object.defineProperty(Io,"__esModule",{value:!0});var Gu=Io.getWindowMetadata=void 0;const Xu=se;function d3(){let t,e;try{t=Xu.getDocumentOrThrow(),e=Xu.getLocationOrThrow()}catch{return null}function r(){const l=t.getElementsByTagName("link"),y=[];for(let _=0;_<l.length;_++){const w=l[_],A=w.getAttribute("rel");if(A&&A.toLowerCase().indexOf("icon")>-1){const D=w.getAttribute("href");if(D)if(D.toLowerCase().indexOf("https:")===-1&&D.toLowerCase().indexOf("http:")===-1&&D.indexOf("//")!==0){let M=e.protocol+"//"+e.host;if(D.indexOf("/")===0)M+=D;else{const O=e.pathname.split("/");O.pop();const T=O.join("/");M+=T+"/"+D}y.push(M)}else if(D.indexOf("//")===0){const M=e.protocol+D;y.push(M)}else y.push(D)}}return y}function n(...l){const y=t.getElementsByTagName("meta");for(let _=0;_<y.length;_++){const w=y[_],A=["itemprop","property","name"].map(D=>w.getAttribute(D)).filter(D=>D?l.includes(D):!1);if(A.length&&A){const D=w.getAttribute("content");if(D)return D}}return""}function i(){let l=n("name","og:site_name","og:title","twitter:title");return l||(l=t.title),l}function s(){return n("description","og:description","twitter:description","keywords")}const o=i(),a=s(),c=e.origin,f=r();return{description:a,url:c,icons:f,name:o}}Gu=Io.getWindowMetadata=d3;function Ki(t){if(!Number.isSafeInteger(t)||t<0)throw new Error("positive integer expected, got "+t)}function l3(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function Gn(t,...e){if(!l3(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function b3(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");Ki(t.outputLen),Ki(t.blockLen)}function fn(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function Zu(t,e){Gn(t);const r=e.outputLen;if(t.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}const Vi=BigInt(2**32-1),Ju=BigInt(32);function p3(t,e=!1){return e?{h:Number(t&Vi),l:Number(t>>Ju&Vi)}:{h:Number(t>>Ju&Vi)|0,l:Number(t&Vi)|0}}function g3(t,e=!1){let r=new Uint32Array(t.length),n=new Uint32Array(t.length);for(let i=0;i<t.length;i++){const{h:s,l:o}=p3(t[i],e);[r[i],n[i]]=[s,o]}return[r,n]}const v3=(t,e,r)=>t<<r|e>>>32-r,y3=(t,e,r)=>e<<r|t>>>32-r,m3=(t,e,r)=>e<<r-32|t>>>64-r,w3=(t,e,r)=>t<<r-32|e>>>64-r,un=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;function _3(t){return new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4))}function Ao(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function Wt(t,e){return t<<32-e|t>>>e}const Qu=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function E3(t){return t<<24&4278190080|t<<8&16711680|t>>>8&65280|t>>>24&255}function eh(t){for(let e=0;e<t.length;e++)t[e]=E3(t[e])}function x3(t){if(typeof t!="string")throw new Error("utf8ToBytes expected string, got "+typeof t);return new Uint8Array(new TextEncoder().encode(t))}function Wi(t){return typeof t=="string"&&(t=x3(t)),Gn(t),t}function S3(...t){let e=0;for(let n=0;n<t.length;n++){const i=t[n];Gn(i),e+=i.length}const r=new Uint8Array(e);for(let n=0,i=0;n<t.length;n++){const s=t[n];r.set(s,i),i+=s.length}return r}class Do{clone(){return this._cloneInto()}}function th(t){const e=n=>t().update(Wi(n)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e}function I3(t=32){if(un&&typeof un.getRandomValues=="function")return un.getRandomValues(new Uint8Array(t));if(un&&typeof un.randomBytes=="function")return un.randomBytes(t);throw new Error("crypto.getRandomValues must be defined")}const rh=[],nh=[],ih=[],A3=BigInt(0),Xn=BigInt(1),D3=BigInt(2),O3=BigInt(7),M3=BigInt(256),T3=BigInt(113);for(let t=0,e=Xn,r=1,n=0;t<24;t++){[r,n]=[n,(2*r+3*n)%5],rh.push(2*(5*n+r)),nh.push((t+1)*(t+2)/2%64);let i=A3;for(let s=0;s<7;s++)e=(e<<Xn^(e>>O3)*T3)%M3,e&D3&&(i^=Xn<<(Xn<<BigInt(s))-Xn);ih.push(i)}const[R3,B3]=g3(ih,!0),sh=(t,e,r)=>r>32?m3(t,e,r):v3(t,e,r),oh=(t,e,r)=>r>32?w3(t,e,r):y3(t,e,r);function N3(t,e=24){const r=new Uint32Array(10);for(let n=24-e;n<24;n++){for(let o=0;o<10;o++)r[o]=t[o]^t[o+10]^t[o+20]^t[o+30]^t[o+40];for(let o=0;o<10;o+=2){const a=(o+8)%10,c=(o+2)%10,f=r[c],h=r[c+1],l=sh(f,h,1)^r[a],y=oh(f,h,1)^r[a+1];for(let _=0;_<50;_+=10)t[o+_]^=l,t[o+_+1]^=y}let i=t[2],s=t[3];for(let o=0;o<24;o++){const a=nh[o],c=sh(i,s,a),f=oh(i,s,a),h=rh[o];i=t[h],s=t[h+1],t[h]=c,t[h+1]=f}for(let o=0;o<50;o+=10){for(let a=0;a<10;a++)r[a]=t[o+a];for(let a=0;a<10;a++)t[o+a]^=~r[(a+2)%10]&r[(a+4)%10]}t[0]^=R3[n],t[1]^=B3[n]}r.fill(0)}class Oo extends Do{constructor(e,r,n,i=!1,s=24){if(super(),this.blockLen=e,this.suffix=r,this.outputLen=n,this.enableXOF=i,this.rounds=s,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,Ki(n),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=_3(this.state)}keccak(){Qu||eh(this.state32),N3(this.state32,this.rounds),Qu||eh(this.state32),this.posOut=0,this.pos=0}update(e){fn(this);const{blockLen:r,state:n}=this;e=Wi(e);const i=e.length;for(let s=0;s<i;){const o=Math.min(r-this.pos,i-s);for(let a=0;a<o;a++)n[this.pos++]^=e[s++];this.pos===r&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:r,pos:n,blockLen:i}=this;e[n]^=r,(r&128)!==0&&n===i-1&&this.keccak(),e[i-1]^=128,this.keccak()}writeInto(e){fn(this,!1),Gn(e),this.finish();const r=this.state,{blockLen:n}=this;for(let i=0,s=e.length;i<s;){this.posOut>=n&&this.keccak();const o=Math.min(n-this.posOut,s-i);e.set(r.subarray(this.posOut,this.posOut+o),i),this.posOut+=o,i+=o}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return Ki(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(Zu(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(e){const{blockLen:r,suffix:n,outputLen:i,rounds:s,enableXOF:o}=this;return e||(e=new Oo(r,n,i,o,s)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=s,e.suffix=n,e.outputLen=i,e.enableXOF=o,e.destroyed=this.destroyed,e}}const P3=((t,e,r)=>th(()=>new Oo(e,t,r)))(1,136,256/8);class C3 extends Map{constructor(e){super(),Object.defineProperty(this,"maxSize",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxSize=e}get(e){const r=super.get(e);return super.has(e)&&r!==void 0&&(this.delete(e),super.set(e,r)),r}set(e,r){if(super.set(e,r),this.maxSize&&this.size>this.maxSize){const n=this.keys().next().value;n&&this.delete(n)}return this}}function $3(t,e,r,n){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,r,n);const i=BigInt(32),s=BigInt(4294967295),o=Number(r>>i&s),a=Number(r&s),c=n?4:0,f=n?0:4;t.setUint32(e+c,o,n),t.setUint32(e+f,a,n)}function L3(t,e,r){return t&e^~t&r}function F3(t,e,r){return t&e^t&r^e&r}class z3 extends Do{constructor(e,r,n,i){super(),this.blockLen=e,this.outputLen=r,this.padOffset=n,this.isLE=i,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=Ao(this.buffer)}update(e){fn(this);const{view:r,buffer:n,blockLen:i}=this;e=Wi(e);const s=e.length;for(let o=0;o<s;){const a=Math.min(i-this.pos,s-o);if(a===i){const c=Ao(e);for(;i<=s-o;o+=i)this.process(c,o);continue}n.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===i&&(this.process(r,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){fn(this),Zu(e,this),this.finished=!0;const{buffer:r,view:n,blockLen:i,isLE:s}=this;let{pos:o}=this;r[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>i-o&&(this.process(n,0),o=0);for(let l=o;l<i;l++)r[l]=0;$3(n,i-8,BigInt(this.length*8),s),this.process(n,0);const a=Ao(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const f=c/4,h=this.get();if(f>h.length)throw new Error("_sha2: outputLen bigger than state");for(let l=0;l<f;l++)a.setUint32(4*l,h[l],s)}digest(){const{buffer:e,outputLen:r}=this;this.digestInto(e);const n=e.slice(0,r);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:r,buffer:n,length:i,finished:s,destroyed:o,pos:a}=this;return e.length=i,e.pos=a,e.finished=s,e.destroyed=o,i%r&&e.buffer.set(n),e}}const U3=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),_r=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Er=new Uint32Array(64);class k3 extends z3{constructor(){super(64,32,8,!1),this.A=_r[0]|0,this.B=_r[1]|0,this.C=_r[2]|0,this.D=_r[3]|0,this.E=_r[4]|0,this.F=_r[5]|0,this.G=_r[6]|0,this.H=_r[7]|0}get(){const{A:e,B:r,C:n,D:i,E:s,F:o,G:a,H:c}=this;return[e,r,n,i,s,o,a,c]}set(e,r,n,i,s,o,a,c){this.A=e|0,this.B=r|0,this.C=n|0,this.D=i|0,this.E=s|0,this.F=o|0,this.G=a|0,this.H=c|0}process(e,r){for(let l=0;l<16;l++,r+=4)Er[l]=e.getUint32(r,!1);for(let l=16;l<64;l++){const y=Er[l-15],_=Er[l-2],w=Wt(y,7)^Wt(y,18)^y>>>3,A=Wt(_,17)^Wt(_,19)^_>>>10;Er[l]=A+Er[l-7]+w+Er[l-16]|0}let{A:n,B:i,C:s,D:o,E:a,F:c,G:f,H:h}=this;for(let l=0;l<64;l++){const y=Wt(a,6)^Wt(a,11)^Wt(a,25),_=h+y+L3(a,c,f)+U3[l]+Er[l]|0,A=(Wt(n,2)^Wt(n,13)^Wt(n,22))+F3(n,i,s)|0;h=f,f=c,c=a,a=o+_|0,o=s,s=i,i=n,n=_+A|0}n=n+this.A|0,i=i+this.B|0,s=s+this.C|0,o=o+this.D|0,a=a+this.E|0,c=c+this.F|0,f=f+this.G|0,h=h+this.H|0,this.set(n,i,s,o,a,c,f,h)}roundClean(){Er.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}const j3=th(()=>new k3);new C3(128);const q3=new Uint8Array([7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8]),ah=new Uint8Array(new Array(16).fill(0).map((t,e)=>e)),H3=ah.map(t=>(9*t+5)%16);let K3=[ah],V3=[H3];for(let t=0;t<4;t++)for(let e of[K3,V3])e.push(e[t].map(r=>q3[r]));/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Yi=BigInt(0),Gi=BigInt(1),W3=BigInt(2);function zr(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function Zn(t){if(!zr(t))throw new Error("Uint8Array expected")}function hn(t,e){if(typeof e!="boolean")throw new Error(t+" boolean expected, got "+e)}const Y3=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function dn(t){Zn(t);let e="";for(let r=0;r<t.length;r++)e+=Y3[t[r]];return e}function ln(t){const e=t.toString(16);return e.length&1?"0"+e:e}function Mo(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return t===""?Yi:BigInt("0x"+t)}const cr={_0:48,_9:57,A:65,F:70,a:97,f:102};function ch(t){if(t>=cr._0&&t<=cr._9)return t-cr._0;if(t>=cr.A&&t<=cr.F)return t-(cr.A-10);if(t>=cr.a&&t<=cr.f)return t-(cr.a-10)}function bn(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);const e=t.length,r=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);const n=new Uint8Array(r);for(let i=0,s=0;i<r;i++,s+=2){const o=ch(t.charCodeAt(s)),a=ch(t.charCodeAt(s+1));if(o===void 0||a===void 0){const c=t[s]+t[s+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+s)}n[i]=o*16+a}return n}function Ur(t){return Mo(dn(t))}function To(t){return Zn(t),Mo(dn(Uint8Array.from(t).reverse()))}function pn(t,e){return bn(t.toString(16).padStart(e*2,"0"))}function Ro(t,e){return pn(t,e).reverse()}function G3(t){return bn(ln(t))}function Lt(t,e,r){let n;if(typeof e=="string")try{n=bn(e)}catch(s){throw new Error(t+" must be hex string or Uint8Array, cause: "+s)}else if(zr(e))n=Uint8Array.from(e);else throw new Error(t+" must be hex string or Uint8Array");const i=n.length;if(typeof r=="number"&&i!==r)throw new Error(t+" of length "+r+" expected, got "+i);return n}function Jn(...t){let e=0;for(let n=0;n<t.length;n++){const i=t[n];Zn(i),e+=i.length}const r=new Uint8Array(e);for(let n=0,i=0;n<t.length;n++){const s=t[n];r.set(s,i),i+=s.length}return r}function X3(t,e){if(t.length!==e.length)return!1;let r=0;for(let n=0;n<t.length;n++)r|=t[n]^e[n];return r===0}function Z3(t){if(typeof t!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(t))}const Bo=t=>typeof t=="bigint"&&Yi<=t;function Xi(t,e,r){return Bo(t)&&Bo(e)&&Bo(r)&&e<=t&&t<r}function kr(t,e,r,n){if(!Xi(e,r,n))throw new Error("expected valid "+t+": "+r+" <= n < "+n+", got "+e)}function fh(t){let e;for(e=0;t>Yi;t>>=Gi,e+=1);return e}function J3(t,e){return t>>BigInt(e)&Gi}function Q3(t,e,r){return t|(r?Gi:Yi)<<BigInt(e)}const No=t=>(W3<<BigInt(t-1))-Gi,Po=t=>new Uint8Array(t),uh=t=>Uint8Array.from(t);function hh(t,e,r){if(typeof t!="number"||t<2)throw new Error("hashLen must be a number");if(typeof e!="number"||e<2)throw new Error("qByteLen must be a number");if(typeof r!="function")throw new Error("hmacFn must be a function");let n=Po(t),i=Po(t),s=0;const o=()=>{n.fill(1),i.fill(0),s=0},a=(...l)=>r(i,n,...l),c=(l=Po())=>{i=a(uh([0]),l),n=a(),l.length!==0&&(i=a(uh([1]),l),n=a())},f=()=>{if(s++>=1e3)throw new Error("drbg: tried 1000 values");let l=0;const y=[];for(;l<e;){n=a();const _=n.slice();y.push(_),l+=n.length}return Jn(...y)};return(l,y)=>{o(),c(l);let _;for(;!(_=y(f()));)c();return o(),_}}const ey={bigint:t=>typeof t=="bigint",function:t=>typeof t=="function",boolean:t=>typeof t=="boolean",string:t=>typeof t=="string",stringOrUint8Array:t=>typeof t=="string"||zr(t),isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>typeof t=="function"&&Number.isSafeInteger(t.outputLen)};function Qn(t,e,r={}){const n=(i,s,o)=>{const a=ey[s];if(typeof a!="function")throw new Error("invalid validator function");const c=t[i];if(!(o&&c===void 0)&&!a(c,t))throw new Error("param "+String(i)+" is invalid. Expected "+s+", got "+c)};for(const[i,s]of Object.entries(e))n(i,s,!1);for(const[i,s]of Object.entries(r))n(i,s,!0);return t}const ty=()=>{throw new Error("not implemented")};function Co(t){const e=new WeakMap;return(r,...n)=>{const i=e.get(r);if(i!==void 0)return i;const s=t(r,...n);return e.set(r,s),s}}var ry=Object.freeze({__proto__:null,isBytes:zr,abytes:Zn,abool:hn,bytesToHex:dn,numberToHexUnpadded:ln,hexToNumber:Mo,hexToBytes:bn,bytesToNumberBE:Ur,bytesToNumberLE:To,numberToBytesBE:pn,numberToBytesLE:Ro,numberToVarBytesBE:G3,ensureBytes:Lt,concatBytes:Jn,equalBytes:X3,utf8ToBytes:Z3,inRange:Xi,aInRange:kr,bitLen:fh,bitGet:J3,bitSet:Q3,bitMask:No,createHmacDrbg:hh,validateObject:Qn,notImplemented:ty,memoized:Co});const ny="0.1.1";function iy(){return ny}class ut extends Error{constructor(e,r={}){const n=(()=>{if(r.cause instanceof ut){if(r.cause.details)return r.cause.details;if(r.cause.shortMessage)return r.cause.shortMessage}return r.cause?.message?r.cause.message:r.details})(),i=r.cause instanceof ut&&r.cause.docsPath||r.docsPath,o=`https://oxlib.sh${i??""}`,a=[e||"An error occurred.",...r.metaMessages?["",...r.metaMessages]:[],...n||i?["",n?`Details: ${n}`:void 0,i?`See: ${o}`:void 0]:[]].filter(c=>typeof c=="string").join(`
`);super(a,r.cause?{cause:r.cause}:void 0),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"cause",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"BaseError"}),Object.defineProperty(this,"version",{enumerable:!0,configurable:!0,writable:!0,value:`ox@${iy()}`}),this.cause=r.cause,this.details=n,this.docs=o,this.docsPath=i,this.shortMessage=e}walk(e){return dh(this,e)}}function dh(t,e){return e?.(t)?t:t&&typeof t=="object"&&"cause"in t&&t.cause?dh(t.cause,e):e?null:t}function sy(t,e){if(ph(t)>e)throw new ly({givenSize:ph(t),maxSize:e})}const fr={zero:48,nine:57,A:65,F:70,a:97,f:102};function lh(t){if(t>=fr.zero&&t<=fr.nine)return t-fr.zero;if(t>=fr.A&&t<=fr.F)return t-(fr.A-10);if(t>=fr.a&&t<=fr.f)return t-(fr.a-10)}function oy(t,e={}){const{dir:r,size:n=32}=e;if(n===0)return t;if(t.length>n)throw new by({size:t.length,targetSize:n,type:"Bytes"});const i=new Uint8Array(n);for(let s=0;s<n;s++){const o=r==="right";i[o?s:n-s-1]=t[o?s:t.length-s-1]}return i}function $o(t,e){if(Fo(t)>e)throw new _y({givenSize:Fo(t),maxSize:e})}function bh(t,e={}){const{dir:r,size:n=32}=e;if(n===0)return t;const i=t.replace("0x","");if(i.length>n*2)throw new Ey({size:Math.ceil(i.length/2),targetSize:n,type:"Hex"});return`0x${i[r==="right"?"padEnd":"padStart"](n*2,"0")}`}const ay=new TextEncoder;function cy(t){return t instanceof Uint8Array?t:typeof t=="string"?uy(t):fy(t)}function fy(t){return t instanceof Uint8Array?t:new Uint8Array(t)}function uy(t,e={}){const{size:r}=e;let n=t;r&&($o(t,r),n=Lo(t,r));let i=n.slice(2);i.length%2&&(i=`0${i}`);const s=i.length/2,o=new Uint8Array(s);for(let a=0,c=0;a<s;a++){const f=lh(i.charCodeAt(c++)),h=lh(i.charCodeAt(c++));if(f===void 0||h===void 0)throw new ut(`Invalid byte sequence ("${i[c-2]}${i[c-1]}" in "${i}").`);o[a]=f*16+h}return o}function hy(t,e={}){const{size:r}=e,n=ay.encode(t);return typeof r=="number"?(sy(n,r),dy(n,r)):n}function dy(t,e){return oy(t,{dir:"right",size:e})}function ph(t){return t.length}class ly extends ut{constructor({givenSize:e,maxSize:r}){super(`Size cannot exceed \`${r}\` bytes. Given size: \`${e}\` bytes.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Bytes.SizeOverflowError"})}}class by extends ut{constructor({size:e,targetSize:r,type:n}){super(`${n.charAt(0).toUpperCase()}${n.slice(1).toLowerCase()} size (\`${e}\`) exceeds padding size (\`${r}\`).`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Bytes.SizeExceedsPaddingSizeError"})}}const py=new TextEncoder,gy=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function gh(...t){return`0x${t.reduce((e,r)=>e+r.replace("0x",""),"")}`}function vy(t,e={}){const r=`0x${Number(t)}`;return typeof e.size=="number"?($o(r,e.size),Zi(r,e.size)):r}function vh(t,e={}){let r="";for(let i=0;i<t.length;i++)r+=gy[t[i]];const n=`0x${r}`;return typeof e.size=="number"?($o(n,e.size),Lo(n,e.size)):n}function yy(t,e={}){const{signed:r,size:n}=e,i=BigInt(t);let s;n?r?s=(1n<<BigInt(n)*8n-1n)-1n:s=2n**(BigInt(n)*8n)-1n:typeof t=="number"&&(s=BigInt(Number.MAX_SAFE_INTEGER));const o=typeof s=="bigint"&&r?-s-1n:0;if(s&&i>s||i<o){const f=typeof t=="bigint"?"n":"";throw new wy({max:s?`${s}${f}`:void 0,min:`${o}${f}`,signed:r,size:n,value:`${t}${f}`})}const c=`0x${(r&&i<0?(1n<<BigInt(n*8))+BigInt(i):i).toString(16)}`;return n?Zi(c,n):c}function my(t,e={}){return vh(py.encode(t),e)}function Zi(t,e){return bh(t,{dir:"left",size:e})}function Lo(t,e){return bh(t,{dir:"right",size:e})}function Fo(t){return Math.ceil((t.length-2)/2)}class wy extends ut{constructor({max:e,min:r,signed:n,size:i,value:s}){super(`Number \`${s}\` is not in safe${i?` ${i*8}-bit`:""}${n?" signed":" unsigned"} integer range ${e?`(\`${r}\` to \`${e}\`)`:`(above \`${r}\`)`}`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.IntegerOutOfRangeError"})}}class _y extends ut{constructor({givenSize:e,maxSize:r}){super(`Size cannot exceed \`${r}\` bytes. Given size: \`${e}\` bytes.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.SizeOverflowError"})}}class Ey extends ut{constructor({size:e,targetSize:r,type:n}){super(`${n.charAt(0).toUpperCase()}${n.slice(1).toLowerCase()} size (\`${e}\`) exceeds padding size (\`${r}\`).`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.SizeExceedsPaddingSizeError"})}}function xy(t,e={}){const{as:r=typeof t=="string"?"Hex":"Bytes"}=e,n=P3(cy(t));return r==="Bytes"?n:vh(n)}class Sy extends Map{constructor(e){super(),Object.defineProperty(this,"maxSize",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxSize=e}get(e){const r=super.get(e);return super.has(e)&&r!==void 0&&(this.delete(e),super.set(e,r)),r}set(e,r){if(super.set(e,r),this.maxSize&&this.size>this.maxSize){const n=this.keys().next().value;n&&this.delete(n)}return this}}const zo={checksum:new Sy(8192)}.checksum,Iy=/^0x[a-fA-F0-9]{40}$/;function yh(t,e={}){const{strict:r=!0}=e;if(!Iy.test(t))throw new mh({address:t,cause:new Dy});if(r){if(t.toLowerCase()===t)return;if(Ay(t)!==t)throw new mh({address:t,cause:new Oy})}}function Ay(t){if(zo.has(t))return zo.get(t);yh(t,{strict:!1});const e=t.substring(2).toLowerCase(),r=xy(hy(e),{as:"Bytes"}),n=e.split("");for(let s=0;s<40;s+=2)r[s>>1]>>4>=8&&n[s]&&(n[s]=n[s].toUpperCase()),(r[s>>1]&15)>=8&&n[s+1]&&(n[s+1]=n[s+1].toUpperCase());const i=`0x${n.join("")}`;return zo.set(t,i),i}class mh extends ut{constructor({address:e,cause:r}){super(`Address "${e}" is invalid.`,{cause:r}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Address.InvalidAddressError"})}}class Dy extends ut{constructor(){super("Address is not a 20 byte (40 hexadecimal character) value."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Address.InvalidInputError"})}}class Oy extends ut{constructor(){super("Address does not match its checksum counterpart."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Address.InvalidChecksumError"})}}const My=/^(.*)\[([0-9]*)\]$/,Ty=/^bytes([1-9]|1[0-9]|2[0-9]|3[0-2])?$/,Ry=/^(u?int)(8|16|24|32|40|48|56|64|72|80|88|96|104|112|120|128|136|144|152|160|168|176|184|192|200|208|216|224|232|240|248|256)?$/;function Uo(t,e){if(t.length!==e.length)throw new Ny({expectedLength:t.length,givenLength:e.length});const r=[];for(let n=0;n<t.length;n++){const i=t[n],s=e[n];r.push(Uo.encode(i,s))}return gh(...r)}(function(t){function e(r,n,i=!1){if(r==="address"){const c=n;return yh(c),Zi(c.toLowerCase(),i?32:0)}if(r==="string")return my(n);if(r==="bytes")return n;if(r==="bool")return Zi(vy(n),i?32:1);const s=r.match(Ry);if(s){const[c,f,h="256"]=s,l=Number.parseInt(h)/8;return yy(n,{size:i?32:l,signed:f==="int"})}const o=r.match(Ty);if(o){const[c,f]=o;if(Number.parseInt(f)!==(n.length-2)/2)throw new By({expectedSize:Number.parseInt(f),value:n});return Lo(n,i?32:0)}const a=r.match(My);if(a&&Array.isArray(n)){const[c,f]=a,h=[];for(let l=0;l<n.length;l++)h.push(e(f,n[l],!0));return h.length===0?"0x":gh(...h)}throw new Py(r)}t.encode=e})(Uo||(Uo={}));class By extends ut{constructor({expectedSize:e,value:r}){super(`Size of bytes "${r}" (bytes${Fo(r)}) does not match expected size (bytes${e}).`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"AbiParameters.BytesSizeMismatchError"})}}class Ny extends ut{constructor({expectedLength:e,givenLength:r}){super(["ABI encoding parameters/values length mismatch.",`Expected length (parameters): ${e}`,`Given length (values): ${r}`].join(`
`)),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"AbiParameters.LengthMismatchError"})}}class Py extends ut{constructor(e){super(`Type \`${e}\` is not a valid ABI Type.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"AbiParameters.InvalidTypeError"})}}class wh extends Do{constructor(e,r){super(),this.finished=!1,this.destroyed=!1,b3(e);const n=Wi(r);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const i=this.blockLen,s=new Uint8Array(i);s.set(n.length>i?e.create().update(n).digest():n);for(let o=0;o<s.length;o++)s[o]^=54;this.iHash.update(s),this.oHash=e.create();for(let o=0;o<s.length;o++)s[o]^=106;this.oHash.update(s),s.fill(0)}update(e){return fn(this),this.iHash.update(e),this}digestInto(e){fn(this),Gn(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:r,iHash:n,finished:i,destroyed:s,blockLen:o,outputLen:a}=this;return e=e,e.finished=i,e.destroyed=s,e.blockLen=o,e.outputLen=a,e.oHash=r._cloneInto(e.oHash),e.iHash=n._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const _h=(t,e,r)=>new wh(t,e).update(r).digest();_h.create=(t,e)=>new wh(t,e);const We=BigInt(0),_e=BigInt(1),jr=BigInt(2),Cy=BigInt(3),ko=BigInt(4),Eh=BigInt(5),xh=BigInt(8);function gt(t,e){const r=t%e;return r>=We?r:e+r}function $y(t,e,r){if(e<We)throw new Error("invalid exponent, negatives unsupported");if(r<=We)throw new Error("invalid modulus");if(r===_e)return We;let n=_e;for(;e>We;)e&_e&&(n=n*t%r),t=t*t%r,e>>=_e;return n}function Mt(t,e,r){let n=t;for(;e-- >We;)n*=n,n%=r;return n}function jo(t,e){if(t===We)throw new Error("invert: expected non-zero number");if(e<=We)throw new Error("invert: expected positive modulus, got "+e);let r=gt(t,e),n=e,i=We,s=_e;for(;r!==We;){const a=n/r,c=n%r,f=i-s*a;n=r,r=c,i=s,s=f}if(n!==_e)throw new Error("invert: does not exist");return gt(i,e)}function Ly(t){const e=(t-_e)/jr;let r,n,i;for(r=t-_e,n=0;r%jr===We;r/=jr,n++);for(i=jr;i<t&&$y(i,e,t)!==t-_e;i++)if(i>1e3)throw new Error("Cannot find square root: likely non-prime P");if(n===1){const o=(t+_e)/ko;return function(c,f){const h=c.pow(f,o);if(!c.eql(c.sqr(h),f))throw new Error("Cannot find square root");return h}}const s=(r+_e)/jr;return function(a,c){if(a.pow(c,e)===a.neg(a.ONE))throw new Error("Cannot find square root");let f=n,h=a.pow(a.mul(a.ONE,i),r),l=a.pow(c,s),y=a.pow(c,r);for(;!a.eql(y,a.ONE);){if(a.eql(y,a.ZERO))return a.ZERO;let _=1;for(let A=a.sqr(y);_<f&&!a.eql(A,a.ONE);_++)A=a.sqr(A);const w=a.pow(h,_e<<BigInt(f-_-1));h=a.sqr(w),l=a.mul(l,w),y=a.mul(y,h),f=_}return l}}function Fy(t){if(t%ko===Cy){const e=(t+_e)/ko;return function(n,i){const s=n.pow(i,e);if(!n.eql(n.sqr(s),i))throw new Error("Cannot find square root");return s}}if(t%xh===Eh){const e=(t-Eh)/xh;return function(n,i){const s=n.mul(i,jr),o=n.pow(s,e),a=n.mul(i,o),c=n.mul(n.mul(a,jr),o),f=n.mul(a,n.sub(c,n.ONE));if(!n.eql(n.sqr(f),i))throw new Error("Cannot find square root");return f}}return Ly(t)}const zy=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function Uy(t){const e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},r=zy.reduce((n,i)=>(n[i]="function",n),e);return Qn(t,r)}function ky(t,e,r){if(r<We)throw new Error("invalid exponent, negatives unsupported");if(r===We)return t.ONE;if(r===_e)return e;let n=t.ONE,i=e;for(;r>We;)r&_e&&(n=t.mul(n,i)),i=t.sqr(i),r>>=_e;return n}function jy(t,e){const r=new Array(e.length),n=e.reduce((s,o,a)=>t.is0(o)?s:(r[a]=s,t.mul(s,o)),t.ONE),i=t.inv(n);return e.reduceRight((s,o,a)=>t.is0(o)?s:(r[a]=t.mul(s,r[a]),t.mul(s,o)),i),r}function Sh(t,e){const r=e!==void 0?e:t.toString(2).length,n=Math.ceil(r/8);return{nBitLength:r,nByteLength:n}}function Ih(t,e,r=!1,n={}){if(t<=We)throw new Error("invalid field: expected ORDER > 0, got "+t);const{nBitLength:i,nByteLength:s}=Sh(t,e);if(s>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let o;const a=Object.freeze({ORDER:t,isLE:r,BITS:i,BYTES:s,MASK:No(i),ZERO:We,ONE:_e,create:c=>gt(c,t),isValid:c=>{if(typeof c!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof c);return We<=c&&c<t},is0:c=>c===We,isOdd:c=>(c&_e)===_e,neg:c=>gt(-c,t),eql:(c,f)=>c===f,sqr:c=>gt(c*c,t),add:(c,f)=>gt(c+f,t),sub:(c,f)=>gt(c-f,t),mul:(c,f)=>gt(c*f,t),pow:(c,f)=>ky(a,c,f),div:(c,f)=>gt(c*jo(f,t),t),sqrN:c=>c*c,addN:(c,f)=>c+f,subN:(c,f)=>c-f,mulN:(c,f)=>c*f,inv:c=>jo(c,t),sqrt:n.sqrt||(c=>(o||(o=Fy(t)),o(a,c))),invertBatch:c=>jy(a,c),cmov:(c,f,h)=>h?f:c,toBytes:c=>r?Ro(c,s):pn(c,s),fromBytes:c=>{if(c.length!==s)throw new Error("Field.fromBytes: expected "+s+" bytes, got "+c.length);return r?To(c):Ur(c)}});return Object.freeze(a)}function Ah(t){if(typeof t!="bigint")throw new Error("field order must be bigint");const e=t.toString(2).length;return Math.ceil(e/8)}function Dh(t){const e=Ah(t);return e+Math.ceil(e/2)}function qy(t,e,r=!1){const n=t.length,i=Ah(e),s=Dh(e);if(n<16||n<s||n>1024)throw new Error("expected "+s+"-1024 bytes of input, got "+n);const o=r?To(t):Ur(t),a=gt(o,e-_e)+_e;return r?Ro(a,i):pn(a,i)}const Oh=BigInt(0),Ji=BigInt(1);function qo(t,e){const r=e.negate();return t?r:e}function Mh(t,e){if(!Number.isSafeInteger(t)||t<=0||t>e)throw new Error("invalid window size, expected [1.."+e+"], got W="+t)}function Ho(t,e){Mh(t,e);const r=Math.ceil(e/t)+1,n=2**(t-1);return{windows:r,windowSize:n}}function Hy(t,e){if(!Array.isArray(t))throw new Error("array expected");t.forEach((r,n)=>{if(!(r instanceof e))throw new Error("invalid point at index "+n)})}function Ky(t,e){if(!Array.isArray(t))throw new Error("array of scalars expected");t.forEach((r,n)=>{if(!e.isValid(r))throw new Error("invalid scalar at index "+n)})}const Ko=new WeakMap,Th=new WeakMap;function Vo(t){return Th.get(t)||1}function Vy(t,e){return{constTimeNegate:qo,hasPrecomputes(r){return Vo(r)!==1},unsafeLadder(r,n,i=t.ZERO){let s=r;for(;n>Oh;)n&Ji&&(i=i.add(s)),s=s.double(),n>>=Ji;return i},precomputeWindow(r,n){const{windows:i,windowSize:s}=Ho(n,e),o=[];let a=r,c=a;for(let f=0;f<i;f++){c=a,o.push(c);for(let h=1;h<s;h++)c=c.add(a),o.push(c);a=c.double()}return o},wNAF(r,n,i){const{windows:s,windowSize:o}=Ho(r,e);let a=t.ZERO,c=t.BASE;const f=BigInt(2**r-1),h=2**r,l=BigInt(r);for(let y=0;y<s;y++){const _=y*o;let w=Number(i&f);i>>=l,w>o&&(w-=h,i+=Ji);const A=_,D=_+Math.abs(w)-1,M=y%2!==0,O=w<0;w===0?c=c.add(qo(M,n[A])):a=a.add(qo(O,n[D]))}return{p:a,f:c}},wNAFUnsafe(r,n,i,s=t.ZERO){const{windows:o,windowSize:a}=Ho(r,e),c=BigInt(2**r-1),f=2**r,h=BigInt(r);for(let l=0;l<o;l++){const y=l*a;if(i===Oh)break;let _=Number(i&c);if(i>>=h,_>a&&(_-=f,i+=Ji),_===0)continue;let w=n[y+Math.abs(_)-1];_<0&&(w=w.negate()),s=s.add(w)}return s},getPrecomputes(r,n,i){let s=Ko.get(n);return s||(s=this.precomputeWindow(n,r),r!==1&&Ko.set(n,i(s))),s},wNAFCached(r,n,i){const s=Vo(r);return this.wNAF(s,this.getPrecomputes(s,r,i),n)},wNAFCachedUnsafe(r,n,i,s){const o=Vo(r);return o===1?this.unsafeLadder(r,n,s):this.wNAFUnsafe(o,this.getPrecomputes(o,r,i),n,s)},setWindowSize(r,n){Mh(n,e),Th.set(r,n),Ko.delete(r)}}}function Wy(t,e,r,n){if(Hy(r,t),Ky(n,e),r.length!==n.length)throw new Error("arrays of points and scalars must have equal length");const i=t.ZERO,s=fh(BigInt(r.length)),o=s>12?s-3:s>4?s-2:s?2:1,a=(1<<o)-1,c=new Array(a+1).fill(i),f=Math.floor((e.BITS-1)/o)*o;let h=i;for(let l=f;l>=0;l-=o){c.fill(i);for(let _=0;_<n.length;_++){const w=n[_],A=Number(w>>BigInt(l)&BigInt(a));c[A]=c[A].add(r[_])}let y=i;for(let _=c.length-1,w=i;_>0;_--)w=w.add(c[_]),y=y.add(w);if(h=h.add(y),l!==0)for(let _=0;_<o;_++)h=h.double()}return h}function Rh(t){return Uy(t.Fp),Qn(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...Sh(t.n,t.nBitLength),...t,p:t.Fp.ORDER})}function Bh(t){t.lowS!==void 0&&hn("lowS",t.lowS),t.prehash!==void 0&&hn("prehash",t.prehash)}function Yy(t){const e=Rh(t);Qn(e,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:r,Fp:n,a:i}=e;if(r){if(!n.eql(i,n.ZERO))throw new Error("invalid endomorphism, can only be defined for Koblitz curves that have a=0");if(typeof r!="object"||typeof r.beta!="bigint"||typeof r.splitScalar!="function")throw new Error("invalid endomorphism, expected beta: bigint and splitScalar: function")}return Object.freeze({...e})}const{bytesToNumberBE:Gy,hexToBytes:Xy}=ry;class Zy extends Error{constructor(e=""){super(e)}}const ur={Err:Zy,_tlv:{encode:(t,e)=>{const{Err:r}=ur;if(t<0||t>256)throw new r("tlv.encode: wrong tag");if(e.length&1)throw new r("tlv.encode: unpadded data");const n=e.length/2,i=ln(n);if(i.length/2&128)throw new r("tlv.encode: long form length too big");const s=n>127?ln(i.length/2|128):"";return ln(t)+s+i+e},decode(t,e){const{Err:r}=ur;let n=0;if(t<0||t>256)throw new r("tlv.encode: wrong tag");if(e.length<2||e[n++]!==t)throw new r("tlv.decode: wrong tlv");const i=e[n++],s=!!(i&128);let o=0;if(!s)o=i;else{const c=i&127;if(!c)throw new r("tlv.decode(long): indefinite length not supported");if(c>4)throw new r("tlv.decode(long): byte length is too big");const f=e.subarray(n,n+c);if(f.length!==c)throw new r("tlv.decode: length bytes not complete");if(f[0]===0)throw new r("tlv.decode(long): zero leftmost byte");for(const h of f)o=o<<8|h;if(n+=c,o<128)throw new r("tlv.decode(long): not minimal encoding")}const a=e.subarray(n,n+o);if(a.length!==o)throw new r("tlv.decode: wrong value length");return{v:a,l:e.subarray(n+o)}}},_int:{encode(t){const{Err:e}=ur;if(t<hr)throw new e("integer: negative integers are not allowed");let r=ln(t);if(Number.parseInt(r[0],16)&8&&(r="00"+r),r.length&1)throw new e("unexpected DER parsing assertion: unpadded hex");return r},decode(t){const{Err:e}=ur;if(t[0]&128)throw new e("invalid signature integer: negative");if(t[0]===0&&!(t[1]&128))throw new e("invalid signature integer: unnecessary leading zero");return Gy(t)}},toSig(t){const{Err:e,_int:r,_tlv:n}=ur,i=typeof t=="string"?Xy(t):t;Zn(i);const{v:s,l:o}=n.decode(48,i);if(o.length)throw new e("invalid signature: left bytes after parsing");const{v:a,l:c}=n.decode(2,s),{v:f,l:h}=n.decode(2,c);if(h.length)throw new e("invalid signature: left bytes after parsing");return{r:r.decode(a),s:r.decode(f)}},hexFromSig(t){const{_tlv:e,_int:r}=ur,n=e.encode(2,r.encode(t.r)),i=e.encode(2,r.encode(t.s)),s=n+i;return e.encode(48,s)}},hr=BigInt(0),Ye=BigInt(1);BigInt(2);const Nh=BigInt(3);BigInt(4);function Jy(t){const e=Yy(t),{Fp:r}=e,n=Ih(e.n,e.nBitLength),i=e.toBytes||((A,D,M)=>{const O=D.toAffine();return Jn(Uint8Array.from([4]),r.toBytes(O.x),r.toBytes(O.y))}),s=e.fromBytes||(A=>{const D=A.subarray(1),M=r.fromBytes(D.subarray(0,r.BYTES)),O=r.fromBytes(D.subarray(r.BYTES,2*r.BYTES));return{x:M,y:O}});function o(A){const{a:D,b:M}=e,O=r.sqr(A),T=r.mul(O,A);return r.add(r.add(T,r.mul(A,D)),M)}if(!r.eql(r.sqr(e.Gy),o(e.Gx)))throw new Error("bad generator point: equation left != right");function a(A){return Xi(A,Ye,e.n)}function c(A){const{allowedPrivateKeyLengths:D,nByteLength:M,wrapPrivateKey:O,n:T}=e;if(D&&typeof A!="bigint"){if(zr(A)&&(A=dn(A)),typeof A!="string"||!D.includes(A.length))throw new Error("invalid private key");A=A.padStart(M*2,"0")}let R;try{R=typeof A=="bigint"?A:Ur(Lt("private key",A,M))}catch{throw new Error("invalid private key, expected hex or "+M+" bytes, got "+typeof A)}return O&&(R=gt(R,T)),kr("private key",R,Ye,T),R}function f(A){if(!(A instanceof y))throw new Error("ProjectivePoint expected")}const h=Co((A,D)=>{const{px:M,py:O,pz:T}=A;if(r.eql(T,r.ONE))return{x:M,y:O};const R=A.is0();D==null&&(D=R?r.ONE:r.inv(T));const z=r.mul(M,D),L=r.mul(O,D),P=r.mul(T,D);if(R)return{x:r.ZERO,y:r.ZERO};if(!r.eql(P,r.ONE))throw new Error("invZ was invalid");return{x:z,y:L}}),l=Co(A=>{if(A.is0()){if(e.allowInfinityPoint&&!r.is0(A.py))return;throw new Error("bad point: ZERO")}const{x:D,y:M}=A.toAffine();if(!r.isValid(D)||!r.isValid(M))throw new Error("bad point: x or y not FE");const O=r.sqr(M),T=o(D);if(!r.eql(O,T))throw new Error("bad point: equation left != right");if(!A.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});class y{constructor(D,M,O){if(this.px=D,this.py=M,this.pz=O,D==null||!r.isValid(D))throw new Error("x required");if(M==null||!r.isValid(M))throw new Error("y required");if(O==null||!r.isValid(O))throw new Error("z required");Object.freeze(this)}static fromAffine(D){const{x:M,y:O}=D||{};if(!D||!r.isValid(M)||!r.isValid(O))throw new Error("invalid affine point");if(D instanceof y)throw new Error("projective point not allowed");const T=R=>r.eql(R,r.ZERO);return T(M)&&T(O)?y.ZERO:new y(M,O,r.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(D){const M=r.invertBatch(D.map(O=>O.pz));return D.map((O,T)=>O.toAffine(M[T])).map(y.fromAffine)}static fromHex(D){const M=y.fromAffine(s(Lt("pointHex",D)));return M.assertValidity(),M}static fromPrivateKey(D){return y.BASE.multiply(c(D))}static msm(D,M){return Wy(y,n,D,M)}_setWindowSize(D){w.setWindowSize(this,D)}assertValidity(){l(this)}hasEvenY(){const{y:D}=this.toAffine();if(r.isOdd)return!r.isOdd(D);throw new Error("Field doesn't support isOdd")}equals(D){f(D);const{px:M,py:O,pz:T}=this,{px:R,py:z,pz:L}=D,P=r.eql(r.mul(M,L),r.mul(R,T)),$=r.eql(r.mul(O,L),r.mul(z,T));return P&&$}negate(){return new y(this.px,r.neg(this.py),this.pz)}double(){const{a:D,b:M}=e,O=r.mul(M,Nh),{px:T,py:R,pz:z}=this;let L=r.ZERO,P=r.ZERO,$=r.ZERO,B=r.mul(T,T),j=r.mul(R,R),S=r.mul(z,z),u=r.mul(T,R);return u=r.add(u,u),$=r.mul(T,z),$=r.add($,$),L=r.mul(D,$),P=r.mul(O,S),P=r.add(L,P),L=r.sub(j,P),P=r.add(j,P),P=r.mul(L,P),L=r.mul(u,L),$=r.mul(O,$),S=r.mul(D,S),u=r.sub(B,S),u=r.mul(D,u),u=r.add(u,$),$=r.add(B,B),B=r.add($,B),B=r.add(B,S),B=r.mul(B,u),P=r.add(P,B),S=r.mul(R,z),S=r.add(S,S),B=r.mul(S,u),L=r.sub(L,B),$=r.mul(S,j),$=r.add($,$),$=r.add($,$),new y(L,P,$)}add(D){f(D);const{px:M,py:O,pz:T}=this,{px:R,py:z,pz:L}=D;let P=r.ZERO,$=r.ZERO,B=r.ZERO;const j=e.a,S=r.mul(e.b,Nh);let u=r.mul(M,R),b=r.mul(O,z),g=r.mul(T,L),p=r.add(M,O),v=r.add(R,z);p=r.mul(p,v),v=r.add(u,b),p=r.sub(p,v),v=r.add(M,T);let x=r.add(R,L);return v=r.mul(v,x),x=r.add(u,g),v=r.sub(v,x),x=r.add(O,T),P=r.add(z,L),x=r.mul(x,P),P=r.add(b,g),x=r.sub(x,P),B=r.mul(j,v),P=r.mul(S,g),B=r.add(P,B),P=r.sub(b,B),B=r.add(b,B),$=r.mul(P,B),b=r.add(u,u),b=r.add(b,u),g=r.mul(j,g),v=r.mul(S,v),b=r.add(b,g),g=r.sub(u,g),g=r.mul(j,g),v=r.add(v,g),u=r.mul(b,v),$=r.add($,u),u=r.mul(x,v),P=r.mul(p,P),P=r.sub(P,u),u=r.mul(p,b),B=r.mul(x,B),B=r.add(B,u),new y(P,$,B)}subtract(D){return this.add(D.negate())}is0(){return this.equals(y.ZERO)}wNAF(D){return w.wNAFCached(this,D,y.normalizeZ)}multiplyUnsafe(D){const{endo:M,n:O}=e;kr("scalar",D,hr,O);const T=y.ZERO;if(D===hr)return T;if(this.is0()||D===Ye)return this;if(!M||w.hasPrecomputes(this))return w.wNAFCachedUnsafe(this,D,y.normalizeZ);let{k1neg:R,k1:z,k2neg:L,k2:P}=M.splitScalar(D),$=T,B=T,j=this;for(;z>hr||P>hr;)z&Ye&&($=$.add(j)),P&Ye&&(B=B.add(j)),j=j.double(),z>>=Ye,P>>=Ye;return R&&($=$.negate()),L&&(B=B.negate()),B=new y(r.mul(B.px,M.beta),B.py,B.pz),$.add(B)}multiply(D){const{endo:M,n:O}=e;kr("scalar",D,Ye,O);let T,R;if(M){const{k1neg:z,k1:L,k2neg:P,k2:$}=M.splitScalar(D);let{p:B,f:j}=this.wNAF(L),{p:S,f:u}=this.wNAF($);B=w.constTimeNegate(z,B),S=w.constTimeNegate(P,S),S=new y(r.mul(S.px,M.beta),S.py,S.pz),T=B.add(S),R=j.add(u)}else{const{p:z,f:L}=this.wNAF(D);T=z,R=L}return y.normalizeZ([T,R])[0]}multiplyAndAddUnsafe(D,M,O){const T=y.BASE,R=(L,P)=>P===hr||P===Ye||!L.equals(T)?L.multiplyUnsafe(P):L.multiply(P),z=R(this,M).add(R(D,O));return z.is0()?void 0:z}toAffine(D){return h(this,D)}isTorsionFree(){const{h:D,isTorsionFree:M}=e;if(D===Ye)return!0;if(M)return M(y,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:D,clearCofactor:M}=e;return D===Ye?this:M?M(y,this):this.multiplyUnsafe(e.h)}toRawBytes(D=!0){return hn("isCompressed",D),this.assertValidity(),i(y,this,D)}toHex(D=!0){return hn("isCompressed",D),dn(this.toRawBytes(D))}}y.BASE=new y(e.Gx,e.Gy,r.ONE),y.ZERO=new y(r.ZERO,r.ONE,r.ZERO);const _=e.nBitLength,w=Vy(y,e.endo?Math.ceil(_/2):_);return{CURVE:e,ProjectivePoint:y,normPrivateKeyToScalar:c,weierstrassEquation:o,isWithinCurveOrder:a}}function Qy(t){const e=Rh(t);return Qn(e,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...e})}function e8(t){const e=Qy(t),{Fp:r,n}=e,i=r.BYTES+1,s=2*r.BYTES+1;function o(g){return gt(g,n)}function a(g){return jo(g,n)}const{ProjectivePoint:c,normPrivateKeyToScalar:f,weierstrassEquation:h,isWithinCurveOrder:l}=Jy({...e,toBytes(g,p,v){const x=p.toAffine(),I=r.toBytes(x.x),m=Jn;return hn("isCompressed",v),v?m(Uint8Array.from([p.hasEvenY()?2:3]),I):m(Uint8Array.from([4]),I,r.toBytes(x.y))},fromBytes(g){const p=g.length,v=g[0],x=g.subarray(1);if(p===i&&(v===2||v===3)){const I=Ur(x);if(!Xi(I,Ye,r.ORDER))throw new Error("Point is not on curve");const m=h(I);let d;try{d=r.sqrt(m)}catch(C){const F=C instanceof Error?": "+C.message:"";throw new Error("Point is not on curve"+F)}const E=(d&Ye)===Ye;return(v&1)===1!==E&&(d=r.neg(d)),{x:I,y:d}}else if(p===s&&v===4){const I=r.fromBytes(x.subarray(0,r.BYTES)),m=r.fromBytes(x.subarray(r.BYTES,2*r.BYTES));return{x:I,y:m}}else{const I=i,m=s;throw new Error("invalid Point, expected length of "+I+", or uncompressed "+m+", got "+p)}}}),y=g=>dn(pn(g,e.nByteLength));function _(g){const p=n>>Ye;return g>p}function w(g){return _(g)?o(-g):g}const A=(g,p,v)=>Ur(g.slice(p,v));class D{constructor(p,v,x){this.r=p,this.s=v,this.recovery=x,this.assertValidity()}static fromCompact(p){const v=e.nByteLength;return p=Lt("compactSignature",p,v*2),new D(A(p,0,v),A(p,v,2*v))}static fromDER(p){const{r:v,s:x}=ur.toSig(Lt("DER",p));return new D(v,x)}assertValidity(){kr("r",this.r,Ye,n),kr("s",this.s,Ye,n)}addRecoveryBit(p){return new D(this.r,this.s,p)}recoverPublicKey(p){const{r:v,s:x,recovery:I}=this,m=L(Lt("msgHash",p));if(I==null||![0,1,2,3].includes(I))throw new Error("recovery id invalid");const d=I===2||I===3?v+e.n:v;if(d>=r.ORDER)throw new Error("recovery id 2 or 3 invalid");const E=(I&1)===0?"02":"03",N=c.fromHex(E+y(d)),C=a(d),F=o(-m*C),k=o(x*C),q=c.BASE.multiplyAndAddUnsafe(N,F,k);if(!q)throw new Error("point at infinify");return q.assertValidity(),q}hasHighS(){return _(this.s)}normalizeS(){return this.hasHighS()?new D(this.r,o(-this.s),this.recovery):this}toDERRawBytes(){return bn(this.toDERHex())}toDERHex(){return ur.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return bn(this.toCompactHex())}toCompactHex(){return y(this.r)+y(this.s)}}const M={isValidPrivateKey(g){try{return f(g),!0}catch{return!1}},normPrivateKeyToScalar:f,randomPrivateKey:()=>{const g=Dh(e.n);return qy(e.randomBytes(g),e.n)},precompute(g=8,p=c.BASE){return p._setWindowSize(g),p.multiply(BigInt(3)),p}};function O(g,p=!0){return c.fromPrivateKey(g).toRawBytes(p)}function T(g){const p=zr(g),v=typeof g=="string",x=(p||v)&&g.length;return p?x===i||x===s:v?x===2*i||x===2*s:g instanceof c}function R(g,p,v=!0){if(T(g))throw new Error("first arg must be private key");if(!T(p))throw new Error("second arg must be public key");return c.fromHex(p).multiply(f(g)).toRawBytes(v)}const z=e.bits2int||function(g){if(g.length>8192)throw new Error("input is too large");const p=Ur(g),v=g.length*8-e.nBitLength;return v>0?p>>BigInt(v):p},L=e.bits2int_modN||function(g){return o(z(g))},P=No(e.nBitLength);function $(g){return kr("num < 2^"+e.nBitLength,g,hr,P),pn(g,e.nByteLength)}function B(g,p,v=j){if(["recovered","canonical"].some(Z=>Z in v))throw new Error("sign() legacy options not supported");const{hash:x,randomBytes:I}=e;let{lowS:m,prehash:d,extraEntropy:E}=v;m==null&&(m=!0),g=Lt("msgHash",g),Bh(v),d&&(g=Lt("prehashed msgHash",x(g)));const N=L(g),C=f(p),F=[$(C),$(N)];if(E!=null&&E!==!1){const Z=E===!0?I(r.BYTES):E;F.push(Lt("extraEntropy",Z))}const k=Jn(...F),q=N;function V(Z){const K=z(Z);if(!l(K))return;const Y=a(K),ft=c.BASE.multiply(K).toAffine(),J=o(ft.x);if(J===hr)return;const re=o(Y*o(q+J*C));if(re===hr)return;let Nt=(ft.x===J?0:2)|Number(ft.y&Ye),ce=re;return m&&_(re)&&(ce=w(re),Nt^=1),new D(J,ce,Nt)}return{seed:k,k2sig:V}}const j={lowS:e.lowS,prehash:!1},S={lowS:e.lowS,prehash:!1};function u(g,p,v=j){const{seed:x,k2sig:I}=B(g,p,v),m=e;return hh(m.hash.outputLen,m.nByteLength,m.hmac)(x,I)}c.BASE._setWindowSize(8);function b(g,p,v,x=S){const I=g;p=Lt("msgHash",p),v=Lt("publicKey",v);const{lowS:m,prehash:d,format:E}=x;if(Bh(x),"strict"in x)throw new Error("options.strict was renamed to lowS");if(E!==void 0&&E!=="compact"&&E!=="der")throw new Error("format must be compact or der");const N=typeof I=="string"||zr(I),C=!N&&!E&&typeof I=="object"&&I!==null&&typeof I.r=="bigint"&&typeof I.s=="bigint";if(!N&&!C)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");let F,k;try{if(C&&(F=new D(I.r,I.s)),N){try{E!=="compact"&&(F=D.fromDER(I))}catch(Nt){if(!(Nt instanceof ur.Err))throw Nt}!F&&E!=="der"&&(F=D.fromCompact(I))}k=c.fromHex(v)}catch{return!1}if(!F||m&&F.hasHighS())return!1;d&&(p=e.hash(p));const{r:q,s:V}=F,Z=L(p),K=a(V),Y=o(Z*K),ft=o(q*K),J=c.BASE.multiplyAndAddUnsafe(k,Y,ft)?.toAffine();return J?o(J.x)===q:!1}return{CURVE:e,getPublicKey:O,getSharedSecret:R,sign:u,verify:b,ProjectivePoint:c,Signature:D,utils:M}}function t8(t){return{hash:t,hmac:(e,...r)=>_h(t,e,S3(...r)),randomBytes:I3}}function r8(t,e){const r=n=>e8({...t,...t8(n)});return{...r(e),create:r}}const Ph=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),Ch=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),n8=BigInt(1),Wo=BigInt(2),$h=(t,e)=>(t+e/Wo)/e;function i8(t){const e=Ph,r=BigInt(3),n=BigInt(6),i=BigInt(11),s=BigInt(22),o=BigInt(23),a=BigInt(44),c=BigInt(88),f=t*t*t%e,h=f*f*t%e,l=Mt(h,r,e)*h%e,y=Mt(l,r,e)*h%e,_=Mt(y,Wo,e)*f%e,w=Mt(_,i,e)*_%e,A=Mt(w,s,e)*w%e,D=Mt(A,a,e)*A%e,M=Mt(D,c,e)*D%e,O=Mt(M,a,e)*A%e,T=Mt(O,r,e)*h%e,R=Mt(T,o,e)*w%e,z=Mt(R,n,e)*f%e,L=Mt(z,Wo,e);if(!Yo.eql(Yo.sqr(L),t))throw new Error("Cannot find square root");return L}const Yo=Ih(Ph,void 0,void 0,{sqrt:i8});r8({a:BigInt(0),b:BigInt(7),Fp:Yo,n:Ch,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:t=>{const e=Ch,r=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-n8*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),i=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),s=r,o=BigInt("0x100000000000000000000000000000000"),a=$h(s*t,e),c=$h(-n*t,e);let f=gt(t-a*r-c*i,e),h=gt(-a*n-c*s,e);const l=f>o,y=h>o;if(l&&(f=e-f),y&&(h=e-h),f>o||h>o)throw new Error("splitScalar: Endomorphism failed, k="+t);return{k1neg:l,k1:f,k2neg:y,k2:h}}}},j3),BigInt(0);function s8(t){if(t.length>=255)throw new TypeError("Alphabet too long");const e=new Uint8Array(256);for(let f=0;f<e.length;f++)e[f]=255;for(let f=0;f<t.length;f++){const h=t.charAt(f),l=h.charCodeAt(0);if(e[l]!==255)throw new TypeError(h+" is ambiguous");e[l]=f}const r=t.length,n=t.charAt(0),i=Math.log(r)/Math.log(256),s=Math.log(256)/Math.log(r);function o(f){if(f instanceof Uint8Array||(ArrayBuffer.isView(f)?f=new Uint8Array(f.buffer,f.byteOffset,f.byteLength):Array.isArray(f)&&(f=Uint8Array.from(f))),!(f instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(f.length===0)return"";let h=0,l=0,y=0;const _=f.length;for(;y!==_&&f[y]===0;)y++,h++;const w=(_-y)*s+1>>>0,A=new Uint8Array(w);for(;y!==_;){let O=f[y],T=0;for(let R=w-1;(O!==0||T<l)&&R!==-1;R--,T++)O+=256*A[R]>>>0,A[R]=O%r>>>0,O=O/r>>>0;if(O!==0)throw new Error("Non-zero carry");l=T,y++}let D=w-l;for(;D!==w&&A[D]===0;)D++;let M=n.repeat(h);for(;D<w;++D)M+=t.charAt(A[D]);return M}function a(f){if(typeof f!="string")throw new TypeError("Expected String");if(f.length===0)return new Uint8Array;let h=0,l=0,y=0;for(;f[h]===n;)l++,h++;const _=(f.length-h)*i+1>>>0,w=new Uint8Array(_);for(;f[h];){let O=e[f.charCodeAt(h)];if(O===255)return;let T=0;for(let R=_-1;(O!==0||T<y)&&R!==-1;R--,T++)O+=r*w[R]>>>0,w[R]=O%256>>>0,O=O/256>>>0;if(O!==0)throw new Error("Non-zero carry");y=T,h++}let A=_-y;for(;A!==_&&w[A]===0;)A++;const D=new Uint8Array(l+(_-A));let M=l;for(;A!==_;)D[M++]=w[A++];return D}function c(f){const h=a(f);if(h)return h;throw new Error("Non-base"+r+" character")}return{encode:o,decodeUnsafe:a,decode:c}}var o8="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";s8(o8);function Go(t,e){e||(e=t.reduce((i,s)=>i+s.length,0));const r=Uu(e);let n=0;for(const i of t)r.set(i,n),n+=i.length;return r}function ht(t,e="utf8"){const r=qu[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8"):r.encoder.encode(t).substring(1)}var Lh={},a8="elliptic",c8="6.6.1",f8="EC cryptography",u8="lib/elliptic.js",h8=["lib"],d8={lint:"eslint lib test","lint:fix":"npm run lint -- --fix",unit:"istanbul test _mocha --reporter=spec test/index.js",test:"npm run lint && npm run unit",version:"grunt dist && git add dist/"},l8={type:"git",url:"git@github.com:indutny/elliptic"},b8=["EC","Elliptic","curve","Cryptography"],p8="Fedor Indutny <fedor@indutny.com>",g8="MIT",v8={url:"https://github.com/indutny/elliptic/issues"},y8="https://github.com/indutny/elliptic",m8={brfs:"^2.0.2",coveralls:"^3.1.0",eslint:"^7.6.0",grunt:"^1.2.1","grunt-browserify":"^5.3.0","grunt-cli":"^1.3.2","grunt-contrib-connect":"^3.0.0","grunt-contrib-copy":"^1.0.0","grunt-contrib-uglify":"^5.0.0","grunt-mocha-istanbul":"^5.0.2","grunt-saucelabs":"^9.0.1",istanbul:"^0.4.5",mocha:"^8.0.1"},w8={"bn.js":"^4.11.9",brorand:"^1.1.0","hash.js":"^1.0.0","hmac-drbg":"^1.0.1",inherits:"^2.0.4","minimalistic-assert":"^1.0.1","minimalistic-crypto-utils":"^1.0.1"},_8={name:a8,version:c8,description:f8,main:u8,files:h8,scripts:d8,repository:l8,keywords:b8,author:p8,license:g8,bugs:v8,homepage:y8,devDependencies:m8,dependencies:w8},xt={},Yt={exports:{}},E8={},x8=Object.freeze({__proto__:null,default:E8}),Fh=Bs(x8);(function(t){(function(e,r){function n(S,u){if(!S)throw new Error(u||"Assertion failed")}function i(S,u){S.super_=u;var b=function(){};b.prototype=u.prototype,S.prototype=new b,S.prototype.constructor=S}function s(S,u,b){if(s.isBN(S))return S;this.negative=0,this.words=null,this.length=0,this.red=null,S!==null&&((u==="le"||u==="be")&&(b=u,u=10),this._init(S||0,u||10,b||"be"))}typeof e=="object"?e.exports=s:r.BN=s,s.BN=s,s.wordSize=26;var o;try{typeof window<"u"&&typeof window.Buffer<"u"?o=window.Buffer:o=Fh.Buffer}catch{}s.isBN=function(u){return u instanceof s?!0:u!==null&&typeof u=="object"&&u.constructor.wordSize===s.wordSize&&Array.isArray(u.words)},s.max=function(u,b){return u.cmp(b)>0?u:b},s.min=function(u,b){return u.cmp(b)<0?u:b},s.prototype._init=function(u,b,g){if(typeof u=="number")return this._initNumber(u,b,g);if(typeof u=="object")return this._initArray(u,b,g);b==="hex"&&(b=16),n(b===(b|0)&&b>=2&&b<=36),u=u.toString().replace(/\s+/g,"");var p=0;u[0]==="-"&&(p++,this.negative=1),p<u.length&&(b===16?this._parseHex(u,p,g):(this._parseBase(u,b,p),g==="le"&&this._initArray(this.toArray(),b,g)))},s.prototype._initNumber=function(u,b,g){u<0&&(this.negative=1,u=-u),u<67108864?(this.words=[u&67108863],this.length=1):u<4503599627370496?(this.words=[u&67108863,u/67108864&67108863],this.length=2):(n(u<9007199254740992),this.words=[u&67108863,u/67108864&67108863,1],this.length=3),g==="le"&&this._initArray(this.toArray(),b,g)},s.prototype._initArray=function(u,b,g){if(n(typeof u.length=="number"),u.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(u.length/3),this.words=new Array(this.length);for(var p=0;p<this.length;p++)this.words[p]=0;var v,x,I=0;if(g==="be")for(p=u.length-1,v=0;p>=0;p-=3)x=u[p]|u[p-1]<<8|u[p-2]<<16,this.words[v]|=x<<I&67108863,this.words[v+1]=x>>>26-I&67108863,I+=24,I>=26&&(I-=26,v++);else if(g==="le")for(p=0,v=0;p<u.length;p+=3)x=u[p]|u[p+1]<<8|u[p+2]<<16,this.words[v]|=x<<I&67108863,this.words[v+1]=x>>>26-I&67108863,I+=24,I>=26&&(I-=26,v++);return this.strip()};function a(S,u){var b=S.charCodeAt(u);return b>=65&&b<=70?b-55:b>=97&&b<=102?b-87:b-48&15}function c(S,u,b){var g=a(S,b);return b-1>=u&&(g|=a(S,b-1)<<4),g}s.prototype._parseHex=function(u,b,g){this.length=Math.ceil((u.length-b)/6),this.words=new Array(this.length);for(var p=0;p<this.length;p++)this.words[p]=0;var v=0,x=0,I;if(g==="be")for(p=u.length-1;p>=b;p-=2)I=c(u,b,p)<<v,this.words[x]|=I&67108863,v>=18?(v-=18,x+=1,this.words[x]|=I>>>26):v+=8;else{var m=u.length-b;for(p=m%2===0?b+1:b;p<u.length;p+=2)I=c(u,b,p)<<v,this.words[x]|=I&67108863,v>=18?(v-=18,x+=1,this.words[x]|=I>>>26):v+=8}this.strip()};function f(S,u,b,g){for(var p=0,v=Math.min(S.length,b),x=u;x<v;x++){var I=S.charCodeAt(x)-48;p*=g,I>=49?p+=I-49+10:I>=17?p+=I-17+10:p+=I}return p}s.prototype._parseBase=function(u,b,g){this.words=[0],this.length=1;for(var p=0,v=1;v<=67108863;v*=b)p++;p--,v=v/b|0;for(var x=u.length-g,I=x%p,m=Math.min(x,x-I)+g,d=0,E=g;E<m;E+=p)d=f(u,E,E+p,b),this.imuln(v),this.words[0]+d<67108864?this.words[0]+=d:this._iaddn(d);if(I!==0){var N=1;for(d=f(u,E,u.length,b),E=0;E<I;E++)N*=b;this.imuln(N),this.words[0]+d<67108864?this.words[0]+=d:this._iaddn(d)}this.strip()},s.prototype.copy=function(u){u.words=new Array(this.length);for(var b=0;b<this.length;b++)u.words[b]=this.words[b];u.length=this.length,u.negative=this.negative,u.red=this.red},s.prototype.clone=function(){var u=new s(null);return this.copy(u),u},s.prototype._expand=function(u){for(;this.length<u;)this.words[this.length++]=0;return this},s.prototype.strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},s.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},s.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var h=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],l=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],y=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];s.prototype.toString=function(u,b){u=u||10,b=b|0||1;var g;if(u===16||u==="hex"){g="";for(var p=0,v=0,x=0;x<this.length;x++){var I=this.words[x],m=((I<<p|v)&16777215).toString(16);v=I>>>24-p&16777215,p+=2,p>=26&&(p-=26,x--),v!==0||x!==this.length-1?g=h[6-m.length]+m+g:g=m+g}for(v!==0&&(g=v.toString(16)+g);g.length%b!==0;)g="0"+g;return this.negative!==0&&(g="-"+g),g}if(u===(u|0)&&u>=2&&u<=36){var d=l[u],E=y[u];g="";var N=this.clone();for(N.negative=0;!N.isZero();){var C=N.modn(E).toString(u);N=N.idivn(E),N.isZero()?g=C+g:g=h[d-C.length]+C+g}for(this.isZero()&&(g="0"+g);g.length%b!==0;)g="0"+g;return this.negative!==0&&(g="-"+g),g}n(!1,"Base should be between 2 and 36")},s.prototype.toNumber=function(){var u=this.words[0];return this.length===2?u+=this.words[1]*67108864:this.length===3&&this.words[2]===1?u+=4503599627370496+this.words[1]*67108864:this.length>2&&n(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-u:u},s.prototype.toJSON=function(){return this.toString(16)},s.prototype.toBuffer=function(u,b){return n(typeof o<"u"),this.toArrayLike(o,u,b)},s.prototype.toArray=function(u,b){return this.toArrayLike(Array,u,b)},s.prototype.toArrayLike=function(u,b,g){var p=this.byteLength(),v=g||Math.max(1,p);n(p<=v,"byte array longer than desired length"),n(v>0,"Requested array length <= 0"),this.strip();var x=b==="le",I=new u(v),m,d,E=this.clone();if(x){for(d=0;!E.isZero();d++)m=E.andln(255),E.iushrn(8),I[d]=m;for(;d<v;d++)I[d]=0}else{for(d=0;d<v-p;d++)I[d]=0;for(d=0;!E.isZero();d++)m=E.andln(255),E.iushrn(8),I[v-d-1]=m}return I},Math.clz32?s.prototype._countBits=function(u){return 32-Math.clz32(u)}:s.prototype._countBits=function(u){var b=u,g=0;return b>=4096&&(g+=13,b>>>=13),b>=64&&(g+=7,b>>>=7),b>=8&&(g+=4,b>>>=4),b>=2&&(g+=2,b>>>=2),g+b},s.prototype._zeroBits=function(u){if(u===0)return 26;var b=u,g=0;return(b&8191)===0&&(g+=13,b>>>=13),(b&127)===0&&(g+=7,b>>>=7),(b&15)===0&&(g+=4,b>>>=4),(b&3)===0&&(g+=2,b>>>=2),(b&1)===0&&g++,g},s.prototype.bitLength=function(){var u=this.words[this.length-1],b=this._countBits(u);return(this.length-1)*26+b};function _(S){for(var u=new Array(S.bitLength()),b=0;b<u.length;b++){var g=b/26|0,p=b%26;u[b]=(S.words[g]&1<<p)>>>p}return u}s.prototype.zeroBits=function(){if(this.isZero())return 0;for(var u=0,b=0;b<this.length;b++){var g=this._zeroBits(this.words[b]);if(u+=g,g!==26)break}return u},s.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},s.prototype.toTwos=function(u){return this.negative!==0?this.abs().inotn(u).iaddn(1):this.clone()},s.prototype.fromTwos=function(u){return this.testn(u-1)?this.notn(u).iaddn(1).ineg():this.clone()},s.prototype.isNeg=function(){return this.negative!==0},s.prototype.neg=function(){return this.clone().ineg()},s.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},s.prototype.iuor=function(u){for(;this.length<u.length;)this.words[this.length++]=0;for(var b=0;b<u.length;b++)this.words[b]=this.words[b]|u.words[b];return this.strip()},s.prototype.ior=function(u){return n((this.negative|u.negative)===0),this.iuor(u)},s.prototype.or=function(u){return this.length>u.length?this.clone().ior(u):u.clone().ior(this)},s.prototype.uor=function(u){return this.length>u.length?this.clone().iuor(u):u.clone().iuor(this)},s.prototype.iuand=function(u){var b;this.length>u.length?b=u:b=this;for(var g=0;g<b.length;g++)this.words[g]=this.words[g]&u.words[g];return this.length=b.length,this.strip()},s.prototype.iand=function(u){return n((this.negative|u.negative)===0),this.iuand(u)},s.prototype.and=function(u){return this.length>u.length?this.clone().iand(u):u.clone().iand(this)},s.prototype.uand=function(u){return this.length>u.length?this.clone().iuand(u):u.clone().iuand(this)},s.prototype.iuxor=function(u){var b,g;this.length>u.length?(b=this,g=u):(b=u,g=this);for(var p=0;p<g.length;p++)this.words[p]=b.words[p]^g.words[p];if(this!==b)for(;p<b.length;p++)this.words[p]=b.words[p];return this.length=b.length,this.strip()},s.prototype.ixor=function(u){return n((this.negative|u.negative)===0),this.iuxor(u)},s.prototype.xor=function(u){return this.length>u.length?this.clone().ixor(u):u.clone().ixor(this)},s.prototype.uxor=function(u){return this.length>u.length?this.clone().iuxor(u):u.clone().iuxor(this)},s.prototype.inotn=function(u){n(typeof u=="number"&&u>=0);var b=Math.ceil(u/26)|0,g=u%26;this._expand(b),g>0&&b--;for(var p=0;p<b;p++)this.words[p]=~this.words[p]&67108863;return g>0&&(this.words[p]=~this.words[p]&67108863>>26-g),this.strip()},s.prototype.notn=function(u){return this.clone().inotn(u)},s.prototype.setn=function(u,b){n(typeof u=="number"&&u>=0);var g=u/26|0,p=u%26;return this._expand(g+1),b?this.words[g]=this.words[g]|1<<p:this.words[g]=this.words[g]&~(1<<p),this.strip()},s.prototype.iadd=function(u){var b;if(this.negative!==0&&u.negative===0)return this.negative=0,b=this.isub(u),this.negative^=1,this._normSign();if(this.negative===0&&u.negative!==0)return u.negative=0,b=this.isub(u),u.negative=1,b._normSign();var g,p;this.length>u.length?(g=this,p=u):(g=u,p=this);for(var v=0,x=0;x<p.length;x++)b=(g.words[x]|0)+(p.words[x]|0)+v,this.words[x]=b&67108863,v=b>>>26;for(;v!==0&&x<g.length;x++)b=(g.words[x]|0)+v,this.words[x]=b&67108863,v=b>>>26;if(this.length=g.length,v!==0)this.words[this.length]=v,this.length++;else if(g!==this)for(;x<g.length;x++)this.words[x]=g.words[x];return this},s.prototype.add=function(u){var b;return u.negative!==0&&this.negative===0?(u.negative=0,b=this.sub(u),u.negative^=1,b):u.negative===0&&this.negative!==0?(this.negative=0,b=u.sub(this),this.negative=1,b):this.length>u.length?this.clone().iadd(u):u.clone().iadd(this)},s.prototype.isub=function(u){if(u.negative!==0){u.negative=0;var b=this.iadd(u);return u.negative=1,b._normSign()}else if(this.negative!==0)return this.negative=0,this.iadd(u),this.negative=1,this._normSign();var g=this.cmp(u);if(g===0)return this.negative=0,this.length=1,this.words[0]=0,this;var p,v;g>0?(p=this,v=u):(p=u,v=this);for(var x=0,I=0;I<v.length;I++)b=(p.words[I]|0)-(v.words[I]|0)+x,x=b>>26,this.words[I]=b&67108863;for(;x!==0&&I<p.length;I++)b=(p.words[I]|0)+x,x=b>>26,this.words[I]=b&67108863;if(x===0&&I<p.length&&p!==this)for(;I<p.length;I++)this.words[I]=p.words[I];return this.length=Math.max(this.length,I),p!==this&&(this.negative=1),this.strip()},s.prototype.sub=function(u){return this.clone().isub(u)};function w(S,u,b){b.negative=u.negative^S.negative;var g=S.length+u.length|0;b.length=g,g=g-1|0;var p=S.words[0]|0,v=u.words[0]|0,x=p*v,I=x&67108863,m=x/67108864|0;b.words[0]=I;for(var d=1;d<g;d++){for(var E=m>>>26,N=m&67108863,C=Math.min(d,u.length-1),F=Math.max(0,d-S.length+1);F<=C;F++){var k=d-F|0;p=S.words[k]|0,v=u.words[F]|0,x=p*v+N,E+=x/67108864|0,N=x&67108863}b.words[d]=N|0,m=E|0}return m!==0?b.words[d]=m|0:b.length--,b.strip()}var A=function(u,b,g){var p=u.words,v=b.words,x=g.words,I=0,m,d,E,N=p[0]|0,C=N&8191,F=N>>>13,k=p[1]|0,q=k&8191,V=k>>>13,Z=p[2]|0,K=Z&8191,Y=Z>>>13,ft=p[3]|0,J=ft&8191,re=ft>>>13,Nt=p[4]|0,ce=Nt&8191,pe=Nt>>>13,Ts=p[5]|0,ge=Ts&8191,ue=Ts>>>13,mi=p[6]|0,fe=mi&8191,he=mi>>>13,wi=p[7]|0,de=wi&8191,le=wi>>>13,_i=p[8]|0,ve=_i&8191,ye=_i>>>13,Rs=p[9]|0,me=Rs&8191,xe=Rs>>>13,c0=v[0]|0,Se=c0&8191,Ie=c0>>>13,f0=v[1]|0,Ae=f0&8191,De=f0>>>13,u0=v[2]|0,Oe=u0&8191,Me=u0>>>13,h0=v[3]|0,Te=h0&8191,Re=h0>>>13,d0=v[4]|0,Be=d0&8191,Ne=d0>>>13,l0=v[5]|0,Pe=l0&8191,Ce=l0>>>13,b0=v[6]|0,$e=b0&8191,Le=b0>>>13,p0=v[7]|0,Fe=p0&8191,ze=p0>>>13,g0=v[8]|0,Ue=g0&8191,ke=g0>>>13,v0=v[9]|0,je=v0&8191,qe=v0>>>13;g.negative=u.negative^b.negative,g.length=19,m=Math.imul(C,Se),d=Math.imul(C,Ie),d=d+Math.imul(F,Se)|0,E=Math.imul(F,Ie);var Xa=(I+m|0)+((d&8191)<<13)|0;I=(E+(d>>>13)|0)+(Xa>>>26)|0,Xa&=67108863,m=Math.imul(q,Se),d=Math.imul(q,Ie),d=d+Math.imul(V,Se)|0,E=Math.imul(V,Ie),m=m+Math.imul(C,Ae)|0,d=d+Math.imul(C,De)|0,d=d+Math.imul(F,Ae)|0,E=E+Math.imul(F,De)|0;var Za=(I+m|0)+((d&8191)<<13)|0;I=(E+(d>>>13)|0)+(Za>>>26)|0,Za&=67108863,m=Math.imul(K,Se),d=Math.imul(K,Ie),d=d+Math.imul(Y,Se)|0,E=Math.imul(Y,Ie),m=m+Math.imul(q,Ae)|0,d=d+Math.imul(q,De)|0,d=d+Math.imul(V,Ae)|0,E=E+Math.imul(V,De)|0,m=m+Math.imul(C,Oe)|0,d=d+Math.imul(C,Me)|0,d=d+Math.imul(F,Oe)|0,E=E+Math.imul(F,Me)|0;var Ja=(I+m|0)+((d&8191)<<13)|0;I=(E+(d>>>13)|0)+(Ja>>>26)|0,Ja&=67108863,m=Math.imul(J,Se),d=Math.imul(J,Ie),d=d+Math.imul(re,Se)|0,E=Math.imul(re,Ie),m=m+Math.imul(K,Ae)|0,d=d+Math.imul(K,De)|0,d=d+Math.imul(Y,Ae)|0,E=E+Math.imul(Y,De)|0,m=m+Math.imul(q,Oe)|0,d=d+Math.imul(q,Me)|0,d=d+Math.imul(V,Oe)|0,E=E+Math.imul(V,Me)|0,m=m+Math.imul(C,Te)|0,d=d+Math.imul(C,Re)|0,d=d+Math.imul(F,Te)|0,E=E+Math.imul(F,Re)|0;var Qa=(I+m|0)+((d&8191)<<13)|0;I=(E+(d>>>13)|0)+(Qa>>>26)|0,Qa&=67108863,m=Math.imul(ce,Se),d=Math.imul(ce,Ie),d=d+Math.imul(pe,Se)|0,E=Math.imul(pe,Ie),m=m+Math.imul(J,Ae)|0,d=d+Math.imul(J,De)|0,d=d+Math.imul(re,Ae)|0,E=E+Math.imul(re,De)|0,m=m+Math.imul(K,Oe)|0,d=d+Math.imul(K,Me)|0,d=d+Math.imul(Y,Oe)|0,E=E+Math.imul(Y,Me)|0,m=m+Math.imul(q,Te)|0,d=d+Math.imul(q,Re)|0,d=d+Math.imul(V,Te)|0,E=E+Math.imul(V,Re)|0,m=m+Math.imul(C,Be)|0,d=d+Math.imul(C,Ne)|0,d=d+Math.imul(F,Be)|0,E=E+Math.imul(F,Ne)|0;var ec=(I+m|0)+((d&8191)<<13)|0;I=(E+(d>>>13)|0)+(ec>>>26)|0,ec&=67108863,m=Math.imul(ge,Se),d=Math.imul(ge,Ie),d=d+Math.imul(ue,Se)|0,E=Math.imul(ue,Ie),m=m+Math.imul(ce,Ae)|0,d=d+Math.imul(ce,De)|0,d=d+Math.imul(pe,Ae)|0,E=E+Math.imul(pe,De)|0,m=m+Math.imul(J,Oe)|0,d=d+Math.imul(J,Me)|0,d=d+Math.imul(re,Oe)|0,E=E+Math.imul(re,Me)|0,m=m+Math.imul(K,Te)|0,d=d+Math.imul(K,Re)|0,d=d+Math.imul(Y,Te)|0,E=E+Math.imul(Y,Re)|0,m=m+Math.imul(q,Be)|0,d=d+Math.imul(q,Ne)|0,d=d+Math.imul(V,Be)|0,E=E+Math.imul(V,Ne)|0,m=m+Math.imul(C,Pe)|0,d=d+Math.imul(C,Ce)|0,d=d+Math.imul(F,Pe)|0,E=E+Math.imul(F,Ce)|0;var tc=(I+m|0)+((d&8191)<<13)|0;I=(E+(d>>>13)|0)+(tc>>>26)|0,tc&=67108863,m=Math.imul(fe,Se),d=Math.imul(fe,Ie),d=d+Math.imul(he,Se)|0,E=Math.imul(he,Ie),m=m+Math.imul(ge,Ae)|0,d=d+Math.imul(ge,De)|0,d=d+Math.imul(ue,Ae)|0,E=E+Math.imul(ue,De)|0,m=m+Math.imul(ce,Oe)|0,d=d+Math.imul(ce,Me)|0,d=d+Math.imul(pe,Oe)|0,E=E+Math.imul(pe,Me)|0,m=m+Math.imul(J,Te)|0,d=d+Math.imul(J,Re)|0,d=d+Math.imul(re,Te)|0,E=E+Math.imul(re,Re)|0,m=m+Math.imul(K,Be)|0,d=d+Math.imul(K,Ne)|0,d=d+Math.imul(Y,Be)|0,E=E+Math.imul(Y,Ne)|0,m=m+Math.imul(q,Pe)|0,d=d+Math.imul(q,Ce)|0,d=d+Math.imul(V,Pe)|0,E=E+Math.imul(V,Ce)|0,m=m+Math.imul(C,$e)|0,d=d+Math.imul(C,Le)|0,d=d+Math.imul(F,$e)|0,E=E+Math.imul(F,Le)|0;var rc=(I+m|0)+((d&8191)<<13)|0;I=(E+(d>>>13)|0)+(rc>>>26)|0,rc&=67108863,m=Math.imul(de,Se),d=Math.imul(de,Ie),d=d+Math.imul(le,Se)|0,E=Math.imul(le,Ie),m=m+Math.imul(fe,Ae)|0,d=d+Math.imul(fe,De)|0,d=d+Math.imul(he,Ae)|0,E=E+Math.imul(he,De)|0,m=m+Math.imul(ge,Oe)|0,d=d+Math.imul(ge,Me)|0,d=d+Math.imul(ue,Oe)|0,E=E+Math.imul(ue,Me)|0,m=m+Math.imul(ce,Te)|0,d=d+Math.imul(ce,Re)|0,d=d+Math.imul(pe,Te)|0,E=E+Math.imul(pe,Re)|0,m=m+Math.imul(J,Be)|0,d=d+Math.imul(J,Ne)|0,d=d+Math.imul(re,Be)|0,E=E+Math.imul(re,Ne)|0,m=m+Math.imul(K,Pe)|0,d=d+Math.imul(K,Ce)|0,d=d+Math.imul(Y,Pe)|0,E=E+Math.imul(Y,Ce)|0,m=m+Math.imul(q,$e)|0,d=d+Math.imul(q,Le)|0,d=d+Math.imul(V,$e)|0,E=E+Math.imul(V,Le)|0,m=m+Math.imul(C,Fe)|0,d=d+Math.imul(C,ze)|0,d=d+Math.imul(F,Fe)|0,E=E+Math.imul(F,ze)|0;var nc=(I+m|0)+((d&8191)<<13)|0;I=(E+(d>>>13)|0)+(nc>>>26)|0,nc&=67108863,m=Math.imul(ve,Se),d=Math.imul(ve,Ie),d=d+Math.imul(ye,Se)|0,E=Math.imul(ye,Ie),m=m+Math.imul(de,Ae)|0,d=d+Math.imul(de,De)|0,d=d+Math.imul(le,Ae)|0,E=E+Math.imul(le,De)|0,m=m+Math.imul(fe,Oe)|0,d=d+Math.imul(fe,Me)|0,d=d+Math.imul(he,Oe)|0,E=E+Math.imul(he,Me)|0,m=m+Math.imul(ge,Te)|0,d=d+Math.imul(ge,Re)|0,d=d+Math.imul(ue,Te)|0,E=E+Math.imul(ue,Re)|0,m=m+Math.imul(ce,Be)|0,d=d+Math.imul(ce,Ne)|0,d=d+Math.imul(pe,Be)|0,E=E+Math.imul(pe,Ne)|0,m=m+Math.imul(J,Pe)|0,d=d+Math.imul(J,Ce)|0,d=d+Math.imul(re,Pe)|0,E=E+Math.imul(re,Ce)|0,m=m+Math.imul(K,$e)|0,d=d+Math.imul(K,Le)|0,d=d+Math.imul(Y,$e)|0,E=E+Math.imul(Y,Le)|0,m=m+Math.imul(q,Fe)|0,d=d+Math.imul(q,ze)|0,d=d+Math.imul(V,Fe)|0,E=E+Math.imul(V,ze)|0,m=m+Math.imul(C,Ue)|0,d=d+Math.imul(C,ke)|0,d=d+Math.imul(F,Ue)|0,E=E+Math.imul(F,ke)|0;var ic=(I+m|0)+((d&8191)<<13)|0;I=(E+(d>>>13)|0)+(ic>>>26)|0,ic&=67108863,m=Math.imul(me,Se),d=Math.imul(me,Ie),d=d+Math.imul(xe,Se)|0,E=Math.imul(xe,Ie),m=m+Math.imul(ve,Ae)|0,d=d+Math.imul(ve,De)|0,d=d+Math.imul(ye,Ae)|0,E=E+Math.imul(ye,De)|0,m=m+Math.imul(de,Oe)|0,d=d+Math.imul(de,Me)|0,d=d+Math.imul(le,Oe)|0,E=E+Math.imul(le,Me)|0,m=m+Math.imul(fe,Te)|0,d=d+Math.imul(fe,Re)|0,d=d+Math.imul(he,Te)|0,E=E+Math.imul(he,Re)|0,m=m+Math.imul(ge,Be)|0,d=d+Math.imul(ge,Ne)|0,d=d+Math.imul(ue,Be)|0,E=E+Math.imul(ue,Ne)|0,m=m+Math.imul(ce,Pe)|0,d=d+Math.imul(ce,Ce)|0,d=d+Math.imul(pe,Pe)|0,E=E+Math.imul(pe,Ce)|0,m=m+Math.imul(J,$e)|0,d=d+Math.imul(J,Le)|0,d=d+Math.imul(re,$e)|0,E=E+Math.imul(re,Le)|0,m=m+Math.imul(K,Fe)|0,d=d+Math.imul(K,ze)|0,d=d+Math.imul(Y,Fe)|0,E=E+Math.imul(Y,ze)|0,m=m+Math.imul(q,Ue)|0,d=d+Math.imul(q,ke)|0,d=d+Math.imul(V,Ue)|0,E=E+Math.imul(V,ke)|0,m=m+Math.imul(C,je)|0,d=d+Math.imul(C,qe)|0,d=d+Math.imul(F,je)|0,E=E+Math.imul(F,qe)|0;var sc=(I+m|0)+((d&8191)<<13)|0;I=(E+(d>>>13)|0)+(sc>>>26)|0,sc&=67108863,m=Math.imul(me,Ae),d=Math.imul(me,De),d=d+Math.imul(xe,Ae)|0,E=Math.imul(xe,De),m=m+Math.imul(ve,Oe)|0,d=d+Math.imul(ve,Me)|0,d=d+Math.imul(ye,Oe)|0,E=E+Math.imul(ye,Me)|0,m=m+Math.imul(de,Te)|0,d=d+Math.imul(de,Re)|0,d=d+Math.imul(le,Te)|0,E=E+Math.imul(le,Re)|0,m=m+Math.imul(fe,Be)|0,d=d+Math.imul(fe,Ne)|0,d=d+Math.imul(he,Be)|0,E=E+Math.imul(he,Ne)|0,m=m+Math.imul(ge,Pe)|0,d=d+Math.imul(ge,Ce)|0,d=d+Math.imul(ue,Pe)|0,E=E+Math.imul(ue,Ce)|0,m=m+Math.imul(ce,$e)|0,d=d+Math.imul(ce,Le)|0,d=d+Math.imul(pe,$e)|0,E=E+Math.imul(pe,Le)|0,m=m+Math.imul(J,Fe)|0,d=d+Math.imul(J,ze)|0,d=d+Math.imul(re,Fe)|0,E=E+Math.imul(re,ze)|0,m=m+Math.imul(K,Ue)|0,d=d+Math.imul(K,ke)|0,d=d+Math.imul(Y,Ue)|0,E=E+Math.imul(Y,ke)|0,m=m+Math.imul(q,je)|0,d=d+Math.imul(q,qe)|0,d=d+Math.imul(V,je)|0,E=E+Math.imul(V,qe)|0;var oc=(I+m|0)+((d&8191)<<13)|0;I=(E+(d>>>13)|0)+(oc>>>26)|0,oc&=67108863,m=Math.imul(me,Oe),d=Math.imul(me,Me),d=d+Math.imul(xe,Oe)|0,E=Math.imul(xe,Me),m=m+Math.imul(ve,Te)|0,d=d+Math.imul(ve,Re)|0,d=d+Math.imul(ye,Te)|0,E=E+Math.imul(ye,Re)|0,m=m+Math.imul(de,Be)|0,d=d+Math.imul(de,Ne)|0,d=d+Math.imul(le,Be)|0,E=E+Math.imul(le,Ne)|0,m=m+Math.imul(fe,Pe)|0,d=d+Math.imul(fe,Ce)|0,d=d+Math.imul(he,Pe)|0,E=E+Math.imul(he,Ce)|0,m=m+Math.imul(ge,$e)|0,d=d+Math.imul(ge,Le)|0,d=d+Math.imul(ue,$e)|0,E=E+Math.imul(ue,Le)|0,m=m+Math.imul(ce,Fe)|0,d=d+Math.imul(ce,ze)|0,d=d+Math.imul(pe,Fe)|0,E=E+Math.imul(pe,ze)|0,m=m+Math.imul(J,Ue)|0,d=d+Math.imul(J,ke)|0,d=d+Math.imul(re,Ue)|0,E=E+Math.imul(re,ke)|0,m=m+Math.imul(K,je)|0,d=d+Math.imul(K,qe)|0,d=d+Math.imul(Y,je)|0,E=E+Math.imul(Y,qe)|0;var ac=(I+m|0)+((d&8191)<<13)|0;I=(E+(d>>>13)|0)+(ac>>>26)|0,ac&=67108863,m=Math.imul(me,Te),d=Math.imul(me,Re),d=d+Math.imul(xe,Te)|0,E=Math.imul(xe,Re),m=m+Math.imul(ve,Be)|0,d=d+Math.imul(ve,Ne)|0,d=d+Math.imul(ye,Be)|0,E=E+Math.imul(ye,Ne)|0,m=m+Math.imul(de,Pe)|0,d=d+Math.imul(de,Ce)|0,d=d+Math.imul(le,Pe)|0,E=E+Math.imul(le,Ce)|0,m=m+Math.imul(fe,$e)|0,d=d+Math.imul(fe,Le)|0,d=d+Math.imul(he,$e)|0,E=E+Math.imul(he,Le)|0,m=m+Math.imul(ge,Fe)|0,d=d+Math.imul(ge,ze)|0,d=d+Math.imul(ue,Fe)|0,E=E+Math.imul(ue,ze)|0,m=m+Math.imul(ce,Ue)|0,d=d+Math.imul(ce,ke)|0,d=d+Math.imul(pe,Ue)|0,E=E+Math.imul(pe,ke)|0,m=m+Math.imul(J,je)|0,d=d+Math.imul(J,qe)|0,d=d+Math.imul(re,je)|0,E=E+Math.imul(re,qe)|0;var cc=(I+m|0)+((d&8191)<<13)|0;I=(E+(d>>>13)|0)+(cc>>>26)|0,cc&=67108863,m=Math.imul(me,Be),d=Math.imul(me,Ne),d=d+Math.imul(xe,Be)|0,E=Math.imul(xe,Ne),m=m+Math.imul(ve,Pe)|0,d=d+Math.imul(ve,Ce)|0,d=d+Math.imul(ye,Pe)|0,E=E+Math.imul(ye,Ce)|0,m=m+Math.imul(de,$e)|0,d=d+Math.imul(de,Le)|0,d=d+Math.imul(le,$e)|0,E=E+Math.imul(le,Le)|0,m=m+Math.imul(fe,Fe)|0,d=d+Math.imul(fe,ze)|0,d=d+Math.imul(he,Fe)|0,E=E+Math.imul(he,ze)|0,m=m+Math.imul(ge,Ue)|0,d=d+Math.imul(ge,ke)|0,d=d+Math.imul(ue,Ue)|0,E=E+Math.imul(ue,ke)|0,m=m+Math.imul(ce,je)|0,d=d+Math.imul(ce,qe)|0,d=d+Math.imul(pe,je)|0,E=E+Math.imul(pe,qe)|0;var fc=(I+m|0)+((d&8191)<<13)|0;I=(E+(d>>>13)|0)+(fc>>>26)|0,fc&=67108863,m=Math.imul(me,Pe),d=Math.imul(me,Ce),d=d+Math.imul(xe,Pe)|0,E=Math.imul(xe,Ce),m=m+Math.imul(ve,$e)|0,d=d+Math.imul(ve,Le)|0,d=d+Math.imul(ye,$e)|0,E=E+Math.imul(ye,Le)|0,m=m+Math.imul(de,Fe)|0,d=d+Math.imul(de,ze)|0,d=d+Math.imul(le,Fe)|0,E=E+Math.imul(le,ze)|0,m=m+Math.imul(fe,Ue)|0,d=d+Math.imul(fe,ke)|0,d=d+Math.imul(he,Ue)|0,E=E+Math.imul(he,ke)|0,m=m+Math.imul(ge,je)|0,d=d+Math.imul(ge,qe)|0,d=d+Math.imul(ue,je)|0,E=E+Math.imul(ue,qe)|0;var uc=(I+m|0)+((d&8191)<<13)|0;I=(E+(d>>>13)|0)+(uc>>>26)|0,uc&=67108863,m=Math.imul(me,$e),d=Math.imul(me,Le),d=d+Math.imul(xe,$e)|0,E=Math.imul(xe,Le),m=m+Math.imul(ve,Fe)|0,d=d+Math.imul(ve,ze)|0,d=d+Math.imul(ye,Fe)|0,E=E+Math.imul(ye,ze)|0,m=m+Math.imul(de,Ue)|0,d=d+Math.imul(de,ke)|0,d=d+Math.imul(le,Ue)|0,E=E+Math.imul(le,ke)|0,m=m+Math.imul(fe,je)|0,d=d+Math.imul(fe,qe)|0,d=d+Math.imul(he,je)|0,E=E+Math.imul(he,qe)|0;var hc=(I+m|0)+((d&8191)<<13)|0;I=(E+(d>>>13)|0)+(hc>>>26)|0,hc&=67108863,m=Math.imul(me,Fe),d=Math.imul(me,ze),d=d+Math.imul(xe,Fe)|0,E=Math.imul(xe,ze),m=m+Math.imul(ve,Ue)|0,d=d+Math.imul(ve,ke)|0,d=d+Math.imul(ye,Ue)|0,E=E+Math.imul(ye,ke)|0,m=m+Math.imul(de,je)|0,d=d+Math.imul(de,qe)|0,d=d+Math.imul(le,je)|0,E=E+Math.imul(le,qe)|0;var dc=(I+m|0)+((d&8191)<<13)|0;I=(E+(d>>>13)|0)+(dc>>>26)|0,dc&=67108863,m=Math.imul(me,Ue),d=Math.imul(me,ke),d=d+Math.imul(xe,Ue)|0,E=Math.imul(xe,ke),m=m+Math.imul(ve,je)|0,d=d+Math.imul(ve,qe)|0,d=d+Math.imul(ye,je)|0,E=E+Math.imul(ye,qe)|0;var lc=(I+m|0)+((d&8191)<<13)|0;I=(E+(d>>>13)|0)+(lc>>>26)|0,lc&=67108863,m=Math.imul(me,je),d=Math.imul(me,qe),d=d+Math.imul(xe,je)|0,E=Math.imul(xe,qe);var bc=(I+m|0)+((d&8191)<<13)|0;return I=(E+(d>>>13)|0)+(bc>>>26)|0,bc&=67108863,x[0]=Xa,x[1]=Za,x[2]=Ja,x[3]=Qa,x[4]=ec,x[5]=tc,x[6]=rc,x[7]=nc,x[8]=ic,x[9]=sc,x[10]=oc,x[11]=ac,x[12]=cc,x[13]=fc,x[14]=uc,x[15]=hc,x[16]=dc,x[17]=lc,x[18]=bc,I!==0&&(x[19]=I,g.length++),g};Math.imul||(A=w);function D(S,u,b){b.negative=u.negative^S.negative,b.length=S.length+u.length;for(var g=0,p=0,v=0;v<b.length-1;v++){var x=p;p=0;for(var I=g&67108863,m=Math.min(v,u.length-1),d=Math.max(0,v-S.length+1);d<=m;d++){var E=v-d,N=S.words[E]|0,C=u.words[d]|0,F=N*C,k=F&67108863;x=x+(F/67108864|0)|0,k=k+I|0,I=k&67108863,x=x+(k>>>26)|0,p+=x>>>26,x&=67108863}b.words[v]=I,g=x,x=p}return g!==0?b.words[v]=g:b.length--,b.strip()}function M(S,u,b){var g=new O;return g.mulp(S,u,b)}s.prototype.mulTo=function(u,b){var g,p=this.length+u.length;return this.length===10&&u.length===10?g=A(this,u,b):p<63?g=w(this,u,b):p<1024?g=D(this,u,b):g=M(this,u,b),g};function O(S,u){this.x=S,this.y=u}O.prototype.makeRBT=function(u){for(var b=new Array(u),g=s.prototype._countBits(u)-1,p=0;p<u;p++)b[p]=this.revBin(p,g,u);return b},O.prototype.revBin=function(u,b,g){if(u===0||u===g-1)return u;for(var p=0,v=0;v<b;v++)p|=(u&1)<<b-v-1,u>>=1;return p},O.prototype.permute=function(u,b,g,p,v,x){for(var I=0;I<x;I++)p[I]=b[u[I]],v[I]=g[u[I]]},O.prototype.transform=function(u,b,g,p,v,x){this.permute(x,u,b,g,p,v);for(var I=1;I<v;I<<=1)for(var m=I<<1,d=Math.cos(2*Math.PI/m),E=Math.sin(2*Math.PI/m),N=0;N<v;N+=m)for(var C=d,F=E,k=0;k<I;k++){var q=g[N+k],V=p[N+k],Z=g[N+k+I],K=p[N+k+I],Y=C*Z-F*K;K=C*K+F*Z,Z=Y,g[N+k]=q+Z,p[N+k]=V+K,g[N+k+I]=q-Z,p[N+k+I]=V-K,k!==m&&(Y=d*C-E*F,F=d*F+E*C,C=Y)}},O.prototype.guessLen13b=function(u,b){var g=Math.max(b,u)|1,p=g&1,v=0;for(g=g/2|0;g;g=g>>>1)v++;return 1<<v+1+p},O.prototype.conjugate=function(u,b,g){if(!(g<=1))for(var p=0;p<g/2;p++){var v=u[p];u[p]=u[g-p-1],u[g-p-1]=v,v=b[p],b[p]=-b[g-p-1],b[g-p-1]=-v}},O.prototype.normalize13b=function(u,b){for(var g=0,p=0;p<b/2;p++){var v=Math.round(u[2*p+1]/b)*8192+Math.round(u[2*p]/b)+g;u[p]=v&67108863,v<67108864?g=0:g=v/67108864|0}return u},O.prototype.convert13b=function(u,b,g,p){for(var v=0,x=0;x<b;x++)v=v+(u[x]|0),g[2*x]=v&8191,v=v>>>13,g[2*x+1]=v&8191,v=v>>>13;for(x=2*b;x<p;++x)g[x]=0;n(v===0),n((v&-8192)===0)},O.prototype.stub=function(u){for(var b=new Array(u),g=0;g<u;g++)b[g]=0;return b},O.prototype.mulp=function(u,b,g){var p=2*this.guessLen13b(u.length,b.length),v=this.makeRBT(p),x=this.stub(p),I=new Array(p),m=new Array(p),d=new Array(p),E=new Array(p),N=new Array(p),C=new Array(p),F=g.words;F.length=p,this.convert13b(u.words,u.length,I,p),this.convert13b(b.words,b.length,E,p),this.transform(I,x,m,d,p,v),this.transform(E,x,N,C,p,v);for(var k=0;k<p;k++){var q=m[k]*N[k]-d[k]*C[k];d[k]=m[k]*C[k]+d[k]*N[k],m[k]=q}return this.conjugate(m,d,p),this.transform(m,d,F,x,p,v),this.conjugate(F,x,p),this.normalize13b(F,p),g.negative=u.negative^b.negative,g.length=u.length+b.length,g.strip()},s.prototype.mul=function(u){var b=new s(null);return b.words=new Array(this.length+u.length),this.mulTo(u,b)},s.prototype.mulf=function(u){var b=new s(null);return b.words=new Array(this.length+u.length),M(this,u,b)},s.prototype.imul=function(u){return this.clone().mulTo(u,this)},s.prototype.imuln=function(u){n(typeof u=="number"),n(u<67108864);for(var b=0,g=0;g<this.length;g++){var p=(this.words[g]|0)*u,v=(p&67108863)+(b&67108863);b>>=26,b+=p/67108864|0,b+=v>>>26,this.words[g]=v&67108863}return b!==0&&(this.words[g]=b,this.length++),this},s.prototype.muln=function(u){return this.clone().imuln(u)},s.prototype.sqr=function(){return this.mul(this)},s.prototype.isqr=function(){return this.imul(this.clone())},s.prototype.pow=function(u){var b=_(u);if(b.length===0)return new s(1);for(var g=this,p=0;p<b.length&&b[p]===0;p++,g=g.sqr());if(++p<b.length)for(var v=g.sqr();p<b.length;p++,v=v.sqr())b[p]!==0&&(g=g.mul(v));return g},s.prototype.iushln=function(u){n(typeof u=="number"&&u>=0);var b=u%26,g=(u-b)/26,p=67108863>>>26-b<<26-b,v;if(b!==0){var x=0;for(v=0;v<this.length;v++){var I=this.words[v]&p,m=(this.words[v]|0)-I<<b;this.words[v]=m|x,x=I>>>26-b}x&&(this.words[v]=x,this.length++)}if(g!==0){for(v=this.length-1;v>=0;v--)this.words[v+g]=this.words[v];for(v=0;v<g;v++)this.words[v]=0;this.length+=g}return this.strip()},s.prototype.ishln=function(u){return n(this.negative===0),this.iushln(u)},s.prototype.iushrn=function(u,b,g){n(typeof u=="number"&&u>=0);var p;b?p=(b-b%26)/26:p=0;var v=u%26,x=Math.min((u-v)/26,this.length),I=67108863^67108863>>>v<<v,m=g;if(p-=x,p=Math.max(0,p),m){for(var d=0;d<x;d++)m.words[d]=this.words[d];m.length=x}if(x!==0)if(this.length>x)for(this.length-=x,d=0;d<this.length;d++)this.words[d]=this.words[d+x];else this.words[0]=0,this.length=1;var E=0;for(d=this.length-1;d>=0&&(E!==0||d>=p);d--){var N=this.words[d]|0;this.words[d]=E<<26-v|N>>>v,E=N&I}return m&&E!==0&&(m.words[m.length++]=E),this.length===0&&(this.words[0]=0,this.length=1),this.strip()},s.prototype.ishrn=function(u,b,g){return n(this.negative===0),this.iushrn(u,b,g)},s.prototype.shln=function(u){return this.clone().ishln(u)},s.prototype.ushln=function(u){return this.clone().iushln(u)},s.prototype.shrn=function(u){return this.clone().ishrn(u)},s.prototype.ushrn=function(u){return this.clone().iushrn(u)},s.prototype.testn=function(u){n(typeof u=="number"&&u>=0);var b=u%26,g=(u-b)/26,p=1<<b;if(this.length<=g)return!1;var v=this.words[g];return!!(v&p)},s.prototype.imaskn=function(u){n(typeof u=="number"&&u>=0);var b=u%26,g=(u-b)/26;if(n(this.negative===0,"imaskn works only with positive numbers"),this.length<=g)return this;if(b!==0&&g++,this.length=Math.min(g,this.length),b!==0){var p=67108863^67108863>>>b<<b;this.words[this.length-1]&=p}return this.strip()},s.prototype.maskn=function(u){return this.clone().imaskn(u)},s.prototype.iaddn=function(u){return n(typeof u=="number"),n(u<67108864),u<0?this.isubn(-u):this.negative!==0?this.length===1&&(this.words[0]|0)<u?(this.words[0]=u-(this.words[0]|0),this.negative=0,this):(this.negative=0,this.isubn(u),this.negative=1,this):this._iaddn(u)},s.prototype._iaddn=function(u){this.words[0]+=u;for(var b=0;b<this.length&&this.words[b]>=67108864;b++)this.words[b]-=67108864,b===this.length-1?this.words[b+1]=1:this.words[b+1]++;return this.length=Math.max(this.length,b+1),this},s.prototype.isubn=function(u){if(n(typeof u=="number"),n(u<67108864),u<0)return this.iaddn(-u);if(this.negative!==0)return this.negative=0,this.iaddn(u),this.negative=1,this;if(this.words[0]-=u,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var b=0;b<this.length&&this.words[b]<0;b++)this.words[b]+=67108864,this.words[b+1]-=1;return this.strip()},s.prototype.addn=function(u){return this.clone().iaddn(u)},s.prototype.subn=function(u){return this.clone().isubn(u)},s.prototype.iabs=function(){return this.negative=0,this},s.prototype.abs=function(){return this.clone().iabs()},s.prototype._ishlnsubmul=function(u,b,g){var p=u.length+g,v;this._expand(p);var x,I=0;for(v=0;v<u.length;v++){x=(this.words[v+g]|0)+I;var m=(u.words[v]|0)*b;x-=m&67108863,I=(x>>26)-(m/67108864|0),this.words[v+g]=x&67108863}for(;v<this.length-g;v++)x=(this.words[v+g]|0)+I,I=x>>26,this.words[v+g]=x&67108863;if(I===0)return this.strip();for(n(I===-1),I=0,v=0;v<this.length;v++)x=-(this.words[v]|0)+I,I=x>>26,this.words[v]=x&67108863;return this.negative=1,this.strip()},s.prototype._wordDiv=function(u,b){var g=this.length-u.length,p=this.clone(),v=u,x=v.words[v.length-1]|0,I=this._countBits(x);g=26-I,g!==0&&(v=v.ushln(g),p.iushln(g),x=v.words[v.length-1]|0);var m=p.length-v.length,d;if(b!=="mod"){d=new s(null),d.length=m+1,d.words=new Array(d.length);for(var E=0;E<d.length;E++)d.words[E]=0}var N=p.clone()._ishlnsubmul(v,1,m);N.negative===0&&(p=N,d&&(d.words[m]=1));for(var C=m-1;C>=0;C--){var F=(p.words[v.length+C]|0)*67108864+(p.words[v.length+C-1]|0);for(F=Math.min(F/x|0,67108863),p._ishlnsubmul(v,F,C);p.negative!==0;)F--,p.negative=0,p._ishlnsubmul(v,1,C),p.isZero()||(p.negative^=1);d&&(d.words[C]=F)}return d&&d.strip(),p.strip(),b!=="div"&&g!==0&&p.iushrn(g),{div:d||null,mod:p}},s.prototype.divmod=function(u,b,g){if(n(!u.isZero()),this.isZero())return{div:new s(0),mod:new s(0)};var p,v,x;return this.negative!==0&&u.negative===0?(x=this.neg().divmod(u,b),b!=="mod"&&(p=x.div.neg()),b!=="div"&&(v=x.mod.neg(),g&&v.negative!==0&&v.iadd(u)),{div:p,mod:v}):this.negative===0&&u.negative!==0?(x=this.divmod(u.neg(),b),b!=="mod"&&(p=x.div.neg()),{div:p,mod:x.mod}):(this.negative&u.negative)!==0?(x=this.neg().divmod(u.neg(),b),b!=="div"&&(v=x.mod.neg(),g&&v.negative!==0&&v.isub(u)),{div:x.div,mod:v}):u.length>this.length||this.cmp(u)<0?{div:new s(0),mod:this}:u.length===1?b==="div"?{div:this.divn(u.words[0]),mod:null}:b==="mod"?{div:null,mod:new s(this.modn(u.words[0]))}:{div:this.divn(u.words[0]),mod:new s(this.modn(u.words[0]))}:this._wordDiv(u,b)},s.prototype.div=function(u){return this.divmod(u,"div",!1).div},s.prototype.mod=function(u){return this.divmod(u,"mod",!1).mod},s.prototype.umod=function(u){return this.divmod(u,"mod",!0).mod},s.prototype.divRound=function(u){var b=this.divmod(u);if(b.mod.isZero())return b.div;var g=b.div.negative!==0?b.mod.isub(u):b.mod,p=u.ushrn(1),v=u.andln(1),x=g.cmp(p);return x<0||v===1&&x===0?b.div:b.div.negative!==0?b.div.isubn(1):b.div.iaddn(1)},s.prototype.modn=function(u){n(u<=67108863);for(var b=(1<<26)%u,g=0,p=this.length-1;p>=0;p--)g=(b*g+(this.words[p]|0))%u;return g},s.prototype.idivn=function(u){n(u<=67108863);for(var b=0,g=this.length-1;g>=0;g--){var p=(this.words[g]|0)+b*67108864;this.words[g]=p/u|0,b=p%u}return this.strip()},s.prototype.divn=function(u){return this.clone().idivn(u)},s.prototype.egcd=function(u){n(u.negative===0),n(!u.isZero());var b=this,g=u.clone();b.negative!==0?b=b.umod(u):b=b.clone();for(var p=new s(1),v=new s(0),x=new s(0),I=new s(1),m=0;b.isEven()&&g.isEven();)b.iushrn(1),g.iushrn(1),++m;for(var d=g.clone(),E=b.clone();!b.isZero();){for(var N=0,C=1;(b.words[0]&C)===0&&N<26;++N,C<<=1);if(N>0)for(b.iushrn(N);N-- >0;)(p.isOdd()||v.isOdd())&&(p.iadd(d),v.isub(E)),p.iushrn(1),v.iushrn(1);for(var F=0,k=1;(g.words[0]&k)===0&&F<26;++F,k<<=1);if(F>0)for(g.iushrn(F);F-- >0;)(x.isOdd()||I.isOdd())&&(x.iadd(d),I.isub(E)),x.iushrn(1),I.iushrn(1);b.cmp(g)>=0?(b.isub(g),p.isub(x),v.isub(I)):(g.isub(b),x.isub(p),I.isub(v))}return{a:x,b:I,gcd:g.iushln(m)}},s.prototype._invmp=function(u){n(u.negative===0),n(!u.isZero());var b=this,g=u.clone();b.negative!==0?b=b.umod(u):b=b.clone();for(var p=new s(1),v=new s(0),x=g.clone();b.cmpn(1)>0&&g.cmpn(1)>0;){for(var I=0,m=1;(b.words[0]&m)===0&&I<26;++I,m<<=1);if(I>0)for(b.iushrn(I);I-- >0;)p.isOdd()&&p.iadd(x),p.iushrn(1);for(var d=0,E=1;(g.words[0]&E)===0&&d<26;++d,E<<=1);if(d>0)for(g.iushrn(d);d-- >0;)v.isOdd()&&v.iadd(x),v.iushrn(1);b.cmp(g)>=0?(b.isub(g),p.isub(v)):(g.isub(b),v.isub(p))}var N;return b.cmpn(1)===0?N=p:N=v,N.cmpn(0)<0&&N.iadd(u),N},s.prototype.gcd=function(u){if(this.isZero())return u.abs();if(u.isZero())return this.abs();var b=this.clone(),g=u.clone();b.negative=0,g.negative=0;for(var p=0;b.isEven()&&g.isEven();p++)b.iushrn(1),g.iushrn(1);do{for(;b.isEven();)b.iushrn(1);for(;g.isEven();)g.iushrn(1);var v=b.cmp(g);if(v<0){var x=b;b=g,g=x}else if(v===0||g.cmpn(1)===0)break;b.isub(g)}while(!0);return g.iushln(p)},s.prototype.invm=function(u){return this.egcd(u).a.umod(u)},s.prototype.isEven=function(){return(this.words[0]&1)===0},s.prototype.isOdd=function(){return(this.words[0]&1)===1},s.prototype.andln=function(u){return this.words[0]&u},s.prototype.bincn=function(u){n(typeof u=="number");var b=u%26,g=(u-b)/26,p=1<<b;if(this.length<=g)return this._expand(g+1),this.words[g]|=p,this;for(var v=p,x=g;v!==0&&x<this.length;x++){var I=this.words[x]|0;I+=v,v=I>>>26,I&=67108863,this.words[x]=I}return v!==0&&(this.words[x]=v,this.length++),this},s.prototype.isZero=function(){return this.length===1&&this.words[0]===0},s.prototype.cmpn=function(u){var b=u<0;if(this.negative!==0&&!b)return-1;if(this.negative===0&&b)return 1;this.strip();var g;if(this.length>1)g=1;else{b&&(u=-u),n(u<=67108863,"Number is too big");var p=this.words[0]|0;g=p===u?0:p<u?-1:1}return this.negative!==0?-g|0:g},s.prototype.cmp=function(u){if(this.negative!==0&&u.negative===0)return-1;if(this.negative===0&&u.negative!==0)return 1;var b=this.ucmp(u);return this.negative!==0?-b|0:b},s.prototype.ucmp=function(u){if(this.length>u.length)return 1;if(this.length<u.length)return-1;for(var b=0,g=this.length-1;g>=0;g--){var p=this.words[g]|0,v=u.words[g]|0;if(p!==v){p<v?b=-1:p>v&&(b=1);break}}return b},s.prototype.gtn=function(u){return this.cmpn(u)===1},s.prototype.gt=function(u){return this.cmp(u)===1},s.prototype.gten=function(u){return this.cmpn(u)>=0},s.prototype.gte=function(u){return this.cmp(u)>=0},s.prototype.ltn=function(u){return this.cmpn(u)===-1},s.prototype.lt=function(u){return this.cmp(u)===-1},s.prototype.lten=function(u){return this.cmpn(u)<=0},s.prototype.lte=function(u){return this.cmp(u)<=0},s.prototype.eqn=function(u){return this.cmpn(u)===0},s.prototype.eq=function(u){return this.cmp(u)===0},s.red=function(u){return new B(u)},s.prototype.toRed=function(u){return n(!this.red,"Already a number in reduction context"),n(this.negative===0,"red works only with positives"),u.convertTo(this)._forceRed(u)},s.prototype.fromRed=function(){return n(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},s.prototype._forceRed=function(u){return this.red=u,this},s.prototype.forceRed=function(u){return n(!this.red,"Already a number in reduction context"),this._forceRed(u)},s.prototype.redAdd=function(u){return n(this.red,"redAdd works only with red numbers"),this.red.add(this,u)},s.prototype.redIAdd=function(u){return n(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,u)},s.prototype.redSub=function(u){return n(this.red,"redSub works only with red numbers"),this.red.sub(this,u)},s.prototype.redISub=function(u){return n(this.red,"redISub works only with red numbers"),this.red.isub(this,u)},s.prototype.redShl=function(u){return n(this.red,"redShl works only with red numbers"),this.red.shl(this,u)},s.prototype.redMul=function(u){return n(this.red,"redMul works only with red numbers"),this.red._verify2(this,u),this.red.mul(this,u)},s.prototype.redIMul=function(u){return n(this.red,"redMul works only with red numbers"),this.red._verify2(this,u),this.red.imul(this,u)},s.prototype.redSqr=function(){return n(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},s.prototype.redISqr=function(){return n(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},s.prototype.redSqrt=function(){return n(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},s.prototype.redInvm=function(){return n(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},s.prototype.redNeg=function(){return n(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},s.prototype.redPow=function(u){return n(this.red&&!u.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,u)};var T={k256:null,p224:null,p192:null,p25519:null};function R(S,u){this.name=S,this.p=new s(u,16),this.n=this.p.bitLength(),this.k=new s(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}R.prototype._tmp=function(){var u=new s(null);return u.words=new Array(Math.ceil(this.n/13)),u},R.prototype.ireduce=function(u){var b=u,g;do this.split(b,this.tmp),b=this.imulK(b),b=b.iadd(this.tmp),g=b.bitLength();while(g>this.n);var p=g<this.n?-1:b.ucmp(this.p);return p===0?(b.words[0]=0,b.length=1):p>0?b.isub(this.p):b.strip!==void 0?b.strip():b._strip(),b},R.prototype.split=function(u,b){u.iushrn(this.n,0,b)},R.prototype.imulK=function(u){return u.imul(this.k)};function z(){R.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}i(z,R),z.prototype.split=function(u,b){for(var g=4194303,p=Math.min(u.length,9),v=0;v<p;v++)b.words[v]=u.words[v];if(b.length=p,u.length<=9){u.words[0]=0,u.length=1;return}var x=u.words[9];for(b.words[b.length++]=x&g,v=10;v<u.length;v++){var I=u.words[v]|0;u.words[v-10]=(I&g)<<4|x>>>22,x=I}x>>>=22,u.words[v-10]=x,x===0&&u.length>10?u.length-=10:u.length-=9},z.prototype.imulK=function(u){u.words[u.length]=0,u.words[u.length+1]=0,u.length+=2;for(var b=0,g=0;g<u.length;g++){var p=u.words[g]|0;b+=p*977,u.words[g]=b&67108863,b=p*64+(b/67108864|0)}return u.words[u.length-1]===0&&(u.length--,u.words[u.length-1]===0&&u.length--),u};function L(){R.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}i(L,R);function P(){R.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}i(P,R);function $(){R.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}i($,R),$.prototype.imulK=function(u){for(var b=0,g=0;g<u.length;g++){var p=(u.words[g]|0)*19+b,v=p&67108863;p>>>=26,u.words[g]=v,b=p}return b!==0&&(u.words[u.length++]=b),u},s._prime=function(u){if(T[u])return T[u];var b;if(u==="k256")b=new z;else if(u==="p224")b=new L;else if(u==="p192")b=new P;else if(u==="p25519")b=new $;else throw new Error("Unknown prime "+u);return T[u]=b,b};function B(S){if(typeof S=="string"){var u=s._prime(S);this.m=u.p,this.prime=u}else n(S.gtn(1),"modulus must be greater than 1"),this.m=S,this.prime=null}B.prototype._verify1=function(u){n(u.negative===0,"red works only with positives"),n(u.red,"red works only with red numbers")},B.prototype._verify2=function(u,b){n((u.negative|b.negative)===0,"red works only with positives"),n(u.red&&u.red===b.red,"red works only with red numbers")},B.prototype.imod=function(u){return this.prime?this.prime.ireduce(u)._forceRed(this):u.umod(this.m)._forceRed(this)},B.prototype.neg=function(u){return u.isZero()?u.clone():this.m.sub(u)._forceRed(this)},B.prototype.add=function(u,b){this._verify2(u,b);var g=u.add(b);return g.cmp(this.m)>=0&&g.isub(this.m),g._forceRed(this)},B.prototype.iadd=function(u,b){this._verify2(u,b);var g=u.iadd(b);return g.cmp(this.m)>=0&&g.isub(this.m),g},B.prototype.sub=function(u,b){this._verify2(u,b);var g=u.sub(b);return g.cmpn(0)<0&&g.iadd(this.m),g._forceRed(this)},B.prototype.isub=function(u,b){this._verify2(u,b);var g=u.isub(b);return g.cmpn(0)<0&&g.iadd(this.m),g},B.prototype.shl=function(u,b){return this._verify1(u),this.imod(u.ushln(b))},B.prototype.imul=function(u,b){return this._verify2(u,b),this.imod(u.imul(b))},B.prototype.mul=function(u,b){return this._verify2(u,b),this.imod(u.mul(b))},B.prototype.isqr=function(u){return this.imul(u,u.clone())},B.prototype.sqr=function(u){return this.mul(u,u)},B.prototype.sqrt=function(u){if(u.isZero())return u.clone();var b=this.m.andln(3);if(n(b%2===1),b===3){var g=this.m.add(new s(1)).iushrn(2);return this.pow(u,g)}for(var p=this.m.subn(1),v=0;!p.isZero()&&p.andln(1)===0;)v++,p.iushrn(1);n(!p.isZero());var x=new s(1).toRed(this),I=x.redNeg(),m=this.m.subn(1).iushrn(1),d=this.m.bitLength();for(d=new s(2*d*d).toRed(this);this.pow(d,m).cmp(I)!==0;)d.redIAdd(I);for(var E=this.pow(d,p),N=this.pow(u,p.addn(1).iushrn(1)),C=this.pow(u,p),F=v;C.cmp(x)!==0;){for(var k=C,q=0;k.cmp(x)!==0;q++)k=k.redSqr();n(q<F);var V=this.pow(E,new s(1).iushln(F-q-1));N=N.redMul(V),E=V.redSqr(),C=C.redMul(E),F=q}return N},B.prototype.invm=function(u){var b=u._invmp(this.m);return b.negative!==0?(b.negative=0,this.imod(b).redNeg()):this.imod(b)},B.prototype.pow=function(u,b){if(b.isZero())return new s(1).toRed(this);if(b.cmpn(1)===0)return u.clone();var g=4,p=new Array(1<<g);p[0]=new s(1).toRed(this),p[1]=u;for(var v=2;v<p.length;v++)p[v]=this.mul(p[v-1],u);var x=p[0],I=0,m=0,d=b.bitLength()%26;for(d===0&&(d=26),v=b.length-1;v>=0;v--){for(var E=b.words[v],N=d-1;N>=0;N--){var C=E>>N&1;if(x!==p[0]&&(x=this.sqr(x)),C===0&&I===0){m=0;continue}I<<=1,I|=C,m++,!(m!==g&&(v!==0||N!==0))&&(x=this.mul(x,p[I]),m=0,I=0)}d=26}return x},B.prototype.convertTo=function(u){var b=u.umod(this.m);return b===u?b.clone():b},B.prototype.convertFrom=function(u){var b=u.clone();return b.red=null,b},s.mont=function(u){return new j(u)};function j(S){B.call(this,S),this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new s(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}i(j,B),j.prototype.convertTo=function(u){return this.imod(u.ushln(this.shift))},j.prototype.convertFrom=function(u){var b=this.imod(u.mul(this.rinv));return b.red=null,b},j.prototype.imul=function(u,b){if(u.isZero()||b.isZero())return u.words[0]=0,u.length=1,u;var g=u.imul(b),p=g.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),v=g.isub(p).iushrn(this.shift),x=v;return v.cmp(this.m)>=0?x=v.isub(this.m):v.cmpn(0)<0&&(x=v.iadd(this.m)),x._forceRed(this)},j.prototype.mul=function(u,b){if(u.isZero()||b.isZero())return new s(0)._forceRed(this);var g=u.mul(b),p=g.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),v=g.isub(p).iushrn(this.shift),x=v;return v.cmp(this.m)>=0?x=v.isub(this.m):v.cmpn(0)<0&&(x=v.iadd(this.m)),x._forceRed(this)},j.prototype.invm=function(u){var b=this.imod(u._invmp(this.m).mul(this.r2));return b._forceRed(this)}})(t,Pt)})(Yt);var qr=zh;function zh(t,e){if(!t)throw new Error(e||"Assertion failed")}zh.equal=function(e,r,n){if(e!=r)throw new Error(n||"Assertion failed: "+e+" != "+r)};var Xo={};(function(t){var e=t;function r(s,o){if(Array.isArray(s))return s.slice();if(!s)return[];var a=[];if(typeof s!="string"){for(var c=0;c<s.length;c++)a[c]=s[c]|0;return a}if(o==="hex"){s=s.replace(/[^a-z0-9]+/ig,""),s.length%2!==0&&(s="0"+s);for(var c=0;c<s.length;c+=2)a.push(parseInt(s[c]+s[c+1],16))}else for(var c=0;c<s.length;c++){var f=s.charCodeAt(c),h=f>>8,l=f&255;h?a.push(h,l):a.push(l)}return a}e.toArray=r;function n(s){return s.length===1?"0"+s:s}e.zero2=n;function i(s){for(var o="",a=0;a<s.length;a++)o+=n(s[a].toString(16));return o}e.toHex=i,e.encode=function(o,a){return a==="hex"?i(o):o}})(Xo),function(t){var e=t,r=Yt.exports,n=qr,i=Xo;e.assert=n,e.toArray=i.toArray,e.zero2=i.zero2,e.toHex=i.toHex,e.encode=i.encode;function s(h,l,y){var _=new Array(Math.max(h.bitLength(),y)+1),w;for(w=0;w<_.length;w+=1)_[w]=0;var A=1<<l+1,D=h.clone();for(w=0;w<_.length;w++){var M,O=D.andln(A-1);D.isOdd()?(O>(A>>1)-1?M=(A>>1)-O:M=O,D.isubn(M)):M=0,_[w]=M,D.iushrn(1)}return _}e.getNAF=s;function o(h,l){var y=[[],[]];h=h.clone(),l=l.clone();for(var _=0,w=0,A;h.cmpn(-_)>0||l.cmpn(-w)>0;){var D=h.andln(3)+_&3,M=l.andln(3)+w&3;D===3&&(D=-1),M===3&&(M=-1);var O;(D&1)===0?O=0:(A=h.andln(7)+_&7,(A===3||A===5)&&M===2?O=-D:O=D),y[0].push(O);var T;(M&1)===0?T=0:(A=l.andln(7)+w&7,(A===3||A===5)&&D===2?T=-M:T=M),y[1].push(T),2*_===O+1&&(_=1-_),2*w===T+1&&(w=1-w),h.iushrn(1),l.iushrn(1)}return y}e.getJSF=o;function a(h,l,y){var _="_"+l;h.prototype[l]=function(){return this[_]!==void 0?this[_]:this[_]=y.call(this)}}e.cachedProperty=a;function c(h){return typeof h=="string"?e.toArray(h,"hex"):h}e.parseBytes=c;function f(h){return new r(h,"hex","le")}e.intFromLE=f}(xt);var Qi={exports:{}},Zo;Qi.exports=function(e){return Zo||(Zo=new xr(null)),Zo.generate(e)};function xr(t){this.rand=t}if(Qi.exports.Rand=xr,xr.prototype.generate=function(e){return this._rand(e)},xr.prototype._rand=function(e){if(this.rand.getBytes)return this.rand.getBytes(e);for(var r=new Uint8Array(e),n=0;n<r.length;n++)r[n]=this.rand.getByte();return r},typeof self=="object")self.crypto&&self.crypto.getRandomValues?xr.prototype._rand=function(e){var r=new Uint8Array(e);return self.crypto.getRandomValues(r),r}:self.msCrypto&&self.msCrypto.getRandomValues?xr.prototype._rand=function(e){var r=new Uint8Array(e);return self.msCrypto.getRandomValues(r),r}:typeof window=="object"&&(xr.prototype._rand=function(){throw new Error("Not implemented yet")});else try{var Uh=Fh;if(typeof Uh.randomBytes!="function")throw new Error("Not supported");xr.prototype._rand=function(e){return Uh.randomBytes(e)}}catch{}var Jo={},Hr=Yt.exports,ei=xt,es=ei.getNAF,S8=ei.getJSF,ts=ei.assert;function Sr(t,e){this.type=t,this.p=new Hr(e.p,16),this.red=e.prime?Hr.red(e.prime):Hr.mont(this.p),this.zero=new Hr(0).toRed(this.red),this.one=new Hr(1).toRed(this.red),this.two=new Hr(2).toRed(this.red),this.n=e.n&&new Hr(e.n,16),this.g=e.g&&this.pointFromJSON(e.g,e.gRed),this._wnafT1=new Array(4),this._wnafT2=new Array(4),this._wnafT3=new Array(4),this._wnafT4=new Array(4),this._bitLength=this.n?this.n.bitLength():0;var r=this.n&&this.p.div(this.n);!r||r.cmpn(100)>0?this.redN=null:(this._maxwellTrick=!0,this.redN=this.n.toRed(this.red))}var rs=Sr;Sr.prototype.point=function(){throw new Error("Not implemented")},Sr.prototype.validate=function(){throw new Error("Not implemented")},Sr.prototype._fixedNafMul=function(e,r){ts(e.precomputed);var n=e._getDoubles(),i=es(r,1,this._bitLength),s=(1<<n.step+1)-(n.step%2===0?2:1);s/=3;var o=[],a,c;for(a=0;a<i.length;a+=n.step){c=0;for(var f=a+n.step-1;f>=a;f--)c=(c<<1)+i[f];o.push(c)}for(var h=this.jpoint(null,null,null),l=this.jpoint(null,null,null),y=s;y>0;y--){for(a=0;a<o.length;a++)c=o[a],c===y?l=l.mixedAdd(n.points[a]):c===-y&&(l=l.mixedAdd(n.points[a].neg()));h=h.add(l)}return h.toP()},Sr.prototype._wnafMul=function(e,r){var n=4,i=e._getNAFPoints(n);n=i.wnd;for(var s=i.points,o=es(r,n,this._bitLength),a=this.jpoint(null,null,null),c=o.length-1;c>=0;c--){for(var f=0;c>=0&&o[c]===0;c--)f++;if(c>=0&&f++,a=a.dblp(f),c<0)break;var h=o[c];ts(h!==0),e.type==="affine"?h>0?a=a.mixedAdd(s[h-1>>1]):a=a.mixedAdd(s[-h-1>>1].neg()):h>0?a=a.add(s[h-1>>1]):a=a.add(s[-h-1>>1].neg())}return e.type==="affine"?a.toP():a},Sr.prototype._wnafMulAdd=function(e,r,n,i,s){var o=this._wnafT1,a=this._wnafT2,c=this._wnafT3,f=0,h,l,y;for(h=0;h<i;h++){y=r[h];var _=y._getNAFPoints(e);o[h]=_.wnd,a[h]=_.points}for(h=i-1;h>=1;h-=2){var w=h-1,A=h;if(o[w]!==1||o[A]!==1){c[w]=es(n[w],o[w],this._bitLength),c[A]=es(n[A],o[A],this._bitLength),f=Math.max(c[w].length,f),f=Math.max(c[A].length,f);continue}var D=[r[w],null,null,r[A]];r[w].y.cmp(r[A].y)===0?(D[1]=r[w].add(r[A]),D[2]=r[w].toJ().mixedAdd(r[A].neg())):r[w].y.cmp(r[A].y.redNeg())===0?(D[1]=r[w].toJ().mixedAdd(r[A]),D[2]=r[w].add(r[A].neg())):(D[1]=r[w].toJ().mixedAdd(r[A]),D[2]=r[w].toJ().mixedAdd(r[A].neg()));var M=[-3,-1,-5,-7,0,7,5,1,3],O=S8(n[w],n[A]);for(f=Math.max(O[0].length,f),c[w]=new Array(f),c[A]=new Array(f),l=0;l<f;l++){var T=O[0][l]|0,R=O[1][l]|0;c[w][l]=M[(T+1)*3+(R+1)],c[A][l]=0,a[w]=D}}var z=this.jpoint(null,null,null),L=this._wnafT4;for(h=f;h>=0;h--){for(var P=0;h>=0;){var $=!0;for(l=0;l<i;l++)L[l]=c[l][h]|0,L[l]!==0&&($=!1);if(!$)break;P++,h--}if(h>=0&&P++,z=z.dblp(P),h<0)break;for(l=0;l<i;l++){var B=L[l];B!==0&&(B>0?y=a[l][B-1>>1]:B<0&&(y=a[l][-B-1>>1].neg()),y.type==="affine"?z=z.mixedAdd(y):z=z.add(y))}}for(h=0;h<i;h++)a[h]=null;return s?z:z.toP()};function Tt(t,e){this.curve=t,this.type=e,this.precomputed=null}Sr.BasePoint=Tt,Tt.prototype.eq=function(){throw new Error("Not implemented")},Tt.prototype.validate=function(){return this.curve.validate(this)},Sr.prototype.decodePoint=function(e,r){e=ei.toArray(e,r);var n=this.p.byteLength();if((e[0]===4||e[0]===6||e[0]===7)&&e.length-1===2*n){e[0]===6?ts(e[e.length-1]%2===0):e[0]===7&&ts(e[e.length-1]%2===1);var i=this.point(e.slice(1,1+n),e.slice(1+n,1+2*n));return i}else if((e[0]===2||e[0]===3)&&e.length-1===n)return this.pointFromX(e.slice(1,1+n),e[0]===3);throw new Error("Unknown point format")},Tt.prototype.encodeCompressed=function(e){return this.encode(e,!0)},Tt.prototype._encode=function(e){var r=this.curve.p.byteLength(),n=this.getX().toArray("be",r);return e?[this.getY().isEven()?2:3].concat(n):[4].concat(n,this.getY().toArray("be",r))},Tt.prototype.encode=function(e,r){return ei.encode(this._encode(r),e)},Tt.prototype.precompute=function(e){if(this.precomputed)return this;var r={doubles:null,naf:null,beta:null};return r.naf=this._getNAFPoints(8),r.doubles=this._getDoubles(4,e),r.beta=this._getBeta(),this.precomputed=r,this},Tt.prototype._hasDoubles=function(e){if(!this.precomputed)return!1;var r=this.precomputed.doubles;return r?r.points.length>=Math.ceil((e.bitLength()+1)/r.step):!1},Tt.prototype._getDoubles=function(e,r){if(this.precomputed&&this.precomputed.doubles)return this.precomputed.doubles;for(var n=[this],i=this,s=0;s<r;s+=e){for(var o=0;o<e;o++)i=i.dbl();n.push(i)}return{step:e,points:n}},Tt.prototype._getNAFPoints=function(e){if(this.precomputed&&this.precomputed.naf)return this.precomputed.naf;for(var r=[this],n=(1<<e)-1,i=n===1?null:this.dbl(),s=1;s<n;s++)r[s]=r[s-1].add(i);return{wnd:e,points:r}},Tt.prototype._getBeta=function(){return null},Tt.prototype.dblp=function(e){for(var r=this,n=0;n<e;n++)r=r.dbl();return r};var gn={exports:{}};typeof Object.create=="function"?gn.exports=function(e,r){r&&(e.super_=r,e.prototype=Object.create(r.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:gn.exports=function(e,r){if(r){e.super_=r;var n=function(){};n.prototype=r.prototype,e.prototype=new n,e.prototype.constructor=e}};var I8=xt,be=Yt.exports,Qo=gn.exports,vn=rs,A8=I8.assert;function Rt(t){vn.call(this,"short",t),this.a=new be(t.a,16).toRed(this.red),this.b=new be(t.b,16).toRed(this.red),this.tinv=this.two.redInvm(),this.zeroA=this.a.fromRed().cmpn(0)===0,this.threeA=this.a.fromRed().sub(this.p).cmpn(-3)===0,this.endo=this._getEndomorphism(t),this._endoWnafT1=new Array(4),this._endoWnafT2=new Array(4)}Qo(Rt,vn);var D8=Rt;Rt.prototype._getEndomorphism=function(e){if(!(!this.zeroA||!this.g||!this.n||this.p.modn(3)!==1)){var r,n;if(e.beta)r=new be(e.beta,16).toRed(this.red);else{var i=this._getEndoRoots(this.p);r=i[0].cmp(i[1])<0?i[0]:i[1],r=r.toRed(this.red)}if(e.lambda)n=new be(e.lambda,16);else{var s=this._getEndoRoots(this.n);this.g.mul(s[0]).x.cmp(this.g.x.redMul(r))===0?n=s[0]:(n=s[1],A8(this.g.mul(n).x.cmp(this.g.x.redMul(r))===0))}var o;return e.basis?o=e.basis.map(function(a){return{a:new be(a.a,16),b:new be(a.b,16)}}):o=this._getEndoBasis(n),{beta:r,lambda:n,basis:o}}},Rt.prototype._getEndoRoots=function(e){var r=e===this.p?this.red:be.mont(e),n=new be(2).toRed(r).redInvm(),i=n.redNeg(),s=new be(3).toRed(r).redNeg().redSqrt().redMul(n),o=i.redAdd(s).fromRed(),a=i.redSub(s).fromRed();return[o,a]},Rt.prototype._getEndoBasis=function(e){for(var r=this.n.ushrn(Math.floor(this.n.bitLength()/2)),n=e,i=this.n.clone(),s=new be(1),o=new be(0),a=new be(0),c=new be(1),f,h,l,y,_,w,A,D=0,M,O;n.cmpn(0)!==0;){var T=i.div(n);M=i.sub(T.mul(n)),O=a.sub(T.mul(s));var R=c.sub(T.mul(o));if(!l&&M.cmp(r)<0)f=A.neg(),h=s,l=M.neg(),y=O;else if(l&&++D===2)break;A=M,i=n,n=M,a=s,s=O,c=o,o=R}_=M.neg(),w=O;var z=l.sqr().add(y.sqr()),L=_.sqr().add(w.sqr());return L.cmp(z)>=0&&(_=f,w=h),l.negative&&(l=l.neg(),y=y.neg()),_.negative&&(_=_.neg(),w=w.neg()),[{a:l,b:y},{a:_,b:w}]},Rt.prototype._endoSplit=function(e){var r=this.endo.basis,n=r[0],i=r[1],s=i.b.mul(e).divRound(this.n),o=n.b.neg().mul(e).divRound(this.n),a=s.mul(n.a),c=o.mul(i.a),f=s.mul(n.b),h=o.mul(i.b),l=e.sub(a).sub(c),y=f.add(h).neg();return{k1:l,k2:y}},Rt.prototype.pointFromX=function(e,r){e=new be(e,16),e.red||(e=e.toRed(this.red));var n=e.redSqr().redMul(e).redIAdd(e.redMul(this.a)).redIAdd(this.b),i=n.redSqrt();if(i.redSqr().redSub(n).cmp(this.zero)!==0)throw new Error("invalid point");var s=i.fromRed().isOdd();return(r&&!s||!r&&s)&&(i=i.redNeg()),this.point(e,i)},Rt.prototype.validate=function(e){if(e.inf)return!0;var r=e.x,n=e.y,i=this.a.redMul(r),s=r.redSqr().redMul(r).redIAdd(i).redIAdd(this.b);return n.redSqr().redISub(s).cmpn(0)===0},Rt.prototype._endoWnafMulAdd=function(e,r,n){for(var i=this._endoWnafT1,s=this._endoWnafT2,o=0;o<e.length;o++){var a=this._endoSplit(r[o]),c=e[o],f=c._getBeta();a.k1.negative&&(a.k1.ineg(),c=c.neg(!0)),a.k2.negative&&(a.k2.ineg(),f=f.neg(!0)),i[o*2]=c,i[o*2+1]=f,s[o*2]=a.k1,s[o*2+1]=a.k2}for(var h=this._wnafMulAdd(1,i,s,o*2,n),l=0;l<o*2;l++)i[l]=null,s[l]=null;return h};function Ge(t,e,r,n){vn.BasePoint.call(this,t,"affine"),e===null&&r===null?(this.x=null,this.y=null,this.inf=!0):(this.x=new be(e,16),this.y=new be(r,16),n&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}Qo(Ge,vn.BasePoint),Rt.prototype.point=function(e,r,n){return new Ge(this,e,r,n)},Rt.prototype.pointFromJSON=function(e,r){return Ge.fromJSON(this,e,r)},Ge.prototype._getBeta=function(){if(this.curve.endo){var e=this.precomputed;if(e&&e.beta)return e.beta;var r=this.curve.point(this.x.redMul(this.curve.endo.beta),this.y);if(e){var n=this.curve,i=function(s){return n.point(s.x.redMul(n.endo.beta),s.y)};e.beta=r,r.precomputed={beta:null,naf:e.naf&&{wnd:e.naf.wnd,points:e.naf.points.map(i)},doubles:e.doubles&&{step:e.doubles.step,points:e.doubles.points.map(i)}}}return r}},Ge.prototype.toJSON=function(){return this.precomputed?[this.x,this.y,this.precomputed&&{doubles:this.precomputed.doubles&&{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)},naf:this.precomputed.naf&&{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}}]:[this.x,this.y]},Ge.fromJSON=function(e,r,n){typeof r=="string"&&(r=JSON.parse(r));var i=e.point(r[0],r[1],n);if(!r[2])return i;function s(a){return e.point(a[0],a[1],n)}var o=r[2];return i.precomputed={beta:null,doubles:o.doubles&&{step:o.doubles.step,points:[i].concat(o.doubles.points.map(s))},naf:o.naf&&{wnd:o.naf.wnd,points:[i].concat(o.naf.points.map(s))}},i},Ge.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+">"},Ge.prototype.isInfinity=function(){return this.inf},Ge.prototype.add=function(e){if(this.inf)return e;if(e.inf)return this;if(this.eq(e))return this.dbl();if(this.neg().eq(e))return this.curve.point(null,null);if(this.x.cmp(e.x)===0)return this.curve.point(null,null);var r=this.y.redSub(e.y);r.cmpn(0)!==0&&(r=r.redMul(this.x.redSub(e.x).redInvm()));var n=r.redSqr().redISub(this.x).redISub(e.x),i=r.redMul(this.x.redSub(n)).redISub(this.y);return this.curve.point(n,i)},Ge.prototype.dbl=function(){if(this.inf)return this;var e=this.y.redAdd(this.y);if(e.cmpn(0)===0)return this.curve.point(null,null);var r=this.curve.a,n=this.x.redSqr(),i=e.redInvm(),s=n.redAdd(n).redIAdd(n).redIAdd(r).redMul(i),o=s.redSqr().redISub(this.x.redAdd(this.x)),a=s.redMul(this.x.redSub(o)).redISub(this.y);return this.curve.point(o,a)},Ge.prototype.getX=function(){return this.x.fromRed()},Ge.prototype.getY=function(){return this.y.fromRed()},Ge.prototype.mul=function(e){return e=new be(e,16),this.isInfinity()?this:this._hasDoubles(e)?this.curve._fixedNafMul(this,e):this.curve.endo?this.curve._endoWnafMulAdd([this],[e]):this.curve._wnafMul(this,e)},Ge.prototype.mulAdd=function(e,r,n){var i=[this,r],s=[e,n];return this.curve.endo?this.curve._endoWnafMulAdd(i,s):this.curve._wnafMulAdd(1,i,s,2)},Ge.prototype.jmulAdd=function(e,r,n){var i=[this,r],s=[e,n];return this.curve.endo?this.curve._endoWnafMulAdd(i,s,!0):this.curve._wnafMulAdd(1,i,s,2,!0)},Ge.prototype.eq=function(e){return this===e||this.inf===e.inf&&(this.inf||this.x.cmp(e.x)===0&&this.y.cmp(e.y)===0)},Ge.prototype.neg=function(e){if(this.inf)return this;var r=this.curve.point(this.x,this.y.redNeg());if(e&&this.precomputed){var n=this.precomputed,i=function(s){return s.neg()};r.precomputed={naf:n.naf&&{wnd:n.naf.wnd,points:n.naf.points.map(i)},doubles:n.doubles&&{step:n.doubles.step,points:n.doubles.points.map(i)}}}return r},Ge.prototype.toJ=function(){if(this.inf)return this.curve.jpoint(null,null,null);var e=this.curve.jpoint(this.x,this.y,this.curve.one);return e};function rt(t,e,r,n){vn.BasePoint.call(this,t,"jacobian"),e===null&&r===null&&n===null?(this.x=this.curve.one,this.y=this.curve.one,this.z=new be(0)):(this.x=new be(e,16),this.y=new be(r,16),this.z=new be(n,16)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z===this.curve.one}Qo(rt,vn.BasePoint),Rt.prototype.jpoint=function(e,r,n){return new rt(this,e,r,n)},rt.prototype.toP=function(){if(this.isInfinity())return this.curve.point(null,null);var e=this.z.redInvm(),r=e.redSqr(),n=this.x.redMul(r),i=this.y.redMul(r).redMul(e);return this.curve.point(n,i)},rt.prototype.neg=function(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)},rt.prototype.add=function(e){if(this.isInfinity())return e;if(e.isInfinity())return this;var r=e.z.redSqr(),n=this.z.redSqr(),i=this.x.redMul(r),s=e.x.redMul(n),o=this.y.redMul(r.redMul(e.z)),a=e.y.redMul(n.redMul(this.z)),c=i.redSub(s),f=o.redSub(a);if(c.cmpn(0)===0)return f.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var h=c.redSqr(),l=h.redMul(c),y=i.redMul(h),_=f.redSqr().redIAdd(l).redISub(y).redISub(y),w=f.redMul(y.redISub(_)).redISub(o.redMul(l)),A=this.z.redMul(e.z).redMul(c);return this.curve.jpoint(_,w,A)},rt.prototype.mixedAdd=function(e){if(this.isInfinity())return e.toJ();if(e.isInfinity())return this;var r=this.z.redSqr(),n=this.x,i=e.x.redMul(r),s=this.y,o=e.y.redMul(r).redMul(this.z),a=n.redSub(i),c=s.redSub(o);if(a.cmpn(0)===0)return c.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var f=a.redSqr(),h=f.redMul(a),l=n.redMul(f),y=c.redSqr().redIAdd(h).redISub(l).redISub(l),_=c.redMul(l.redISub(y)).redISub(s.redMul(h)),w=this.z.redMul(a);return this.curve.jpoint(y,_,w)},rt.prototype.dblp=function(e){if(e===0)return this;if(this.isInfinity())return this;if(!e)return this.dbl();var r;if(this.curve.zeroA||this.curve.threeA){var n=this;for(r=0;r<e;r++)n=n.dbl();return n}var i=this.curve.a,s=this.curve.tinv,o=this.x,a=this.y,c=this.z,f=c.redSqr().redSqr(),h=a.redAdd(a);for(r=0;r<e;r++){var l=o.redSqr(),y=h.redSqr(),_=y.redSqr(),w=l.redAdd(l).redIAdd(l).redIAdd(i.redMul(f)),A=o.redMul(y),D=w.redSqr().redISub(A.redAdd(A)),M=A.redISub(D),O=w.redMul(M);O=O.redIAdd(O).redISub(_);var T=h.redMul(c);r+1<e&&(f=f.redMul(_)),o=D,c=T,h=O}return this.curve.jpoint(o,h.redMul(s),c)},rt.prototype.dbl=function(){return this.isInfinity()?this:this.curve.zeroA?this._zeroDbl():this.curve.threeA?this._threeDbl():this._dbl()},rt.prototype._zeroDbl=function(){var e,r,n;if(this.zOne){var i=this.x.redSqr(),s=this.y.redSqr(),o=s.redSqr(),a=this.x.redAdd(s).redSqr().redISub(i).redISub(o);a=a.redIAdd(a);var c=i.redAdd(i).redIAdd(i),f=c.redSqr().redISub(a).redISub(a),h=o.redIAdd(o);h=h.redIAdd(h),h=h.redIAdd(h),e=f,r=c.redMul(a.redISub(f)).redISub(h),n=this.y.redAdd(this.y)}else{var l=this.x.redSqr(),y=this.y.redSqr(),_=y.redSqr(),w=this.x.redAdd(y).redSqr().redISub(l).redISub(_);w=w.redIAdd(w);var A=l.redAdd(l).redIAdd(l),D=A.redSqr(),M=_.redIAdd(_);M=M.redIAdd(M),M=M.redIAdd(M),e=D.redISub(w).redISub(w),r=A.redMul(w.redISub(e)).redISub(M),n=this.y.redMul(this.z),n=n.redIAdd(n)}return this.curve.jpoint(e,r,n)},rt.prototype._threeDbl=function(){var e,r,n;if(this.zOne){var i=this.x.redSqr(),s=this.y.redSqr(),o=s.redSqr(),a=this.x.redAdd(s).redSqr().redISub(i).redISub(o);a=a.redIAdd(a);var c=i.redAdd(i).redIAdd(i).redIAdd(this.curve.a),f=c.redSqr().redISub(a).redISub(a);e=f;var h=o.redIAdd(o);h=h.redIAdd(h),h=h.redIAdd(h),r=c.redMul(a.redISub(f)).redISub(h),n=this.y.redAdd(this.y)}else{var l=this.z.redSqr(),y=this.y.redSqr(),_=this.x.redMul(y),w=this.x.redSub(l).redMul(this.x.redAdd(l));w=w.redAdd(w).redIAdd(w);var A=_.redIAdd(_);A=A.redIAdd(A);var D=A.redAdd(A);e=w.redSqr().redISub(D),n=this.y.redAdd(this.z).redSqr().redISub(y).redISub(l);var M=y.redSqr();M=M.redIAdd(M),M=M.redIAdd(M),M=M.redIAdd(M),r=w.redMul(A.redISub(e)).redISub(M)}return this.curve.jpoint(e,r,n)},rt.prototype._dbl=function(){var e=this.curve.a,r=this.x,n=this.y,i=this.z,s=i.redSqr().redSqr(),o=r.redSqr(),a=n.redSqr(),c=o.redAdd(o).redIAdd(o).redIAdd(e.redMul(s)),f=r.redAdd(r);f=f.redIAdd(f);var h=f.redMul(a),l=c.redSqr().redISub(h.redAdd(h)),y=h.redISub(l),_=a.redSqr();_=_.redIAdd(_),_=_.redIAdd(_),_=_.redIAdd(_);var w=c.redMul(y).redISub(_),A=n.redAdd(n).redMul(i);return this.curve.jpoint(l,w,A)},rt.prototype.trpl=function(){if(!this.curve.zeroA)return this.dbl().add(this);var e=this.x.redSqr(),r=this.y.redSqr(),n=this.z.redSqr(),i=r.redSqr(),s=e.redAdd(e).redIAdd(e),o=s.redSqr(),a=this.x.redAdd(r).redSqr().redISub(e).redISub(i);a=a.redIAdd(a),a=a.redAdd(a).redIAdd(a),a=a.redISub(o);var c=a.redSqr(),f=i.redIAdd(i);f=f.redIAdd(f),f=f.redIAdd(f),f=f.redIAdd(f);var h=s.redIAdd(a).redSqr().redISub(o).redISub(c).redISub(f),l=r.redMul(h);l=l.redIAdd(l),l=l.redIAdd(l);var y=this.x.redMul(c).redISub(l);y=y.redIAdd(y),y=y.redIAdd(y);var _=this.y.redMul(h.redMul(f.redISub(h)).redISub(a.redMul(c)));_=_.redIAdd(_),_=_.redIAdd(_),_=_.redIAdd(_);var w=this.z.redAdd(a).redSqr().redISub(n).redISub(c);return this.curve.jpoint(y,_,w)},rt.prototype.mul=function(e,r){return e=new be(e,r),this.curve._wnafMul(this,e)},rt.prototype.eq=function(e){if(e.type==="affine")return this.eq(e.toJ());if(this===e)return!0;var r=this.z.redSqr(),n=e.z.redSqr();if(this.x.redMul(n).redISub(e.x.redMul(r)).cmpn(0)!==0)return!1;var i=r.redMul(this.z),s=n.redMul(e.z);return this.y.redMul(s).redISub(e.y.redMul(i)).cmpn(0)===0},rt.prototype.eqXToP=function(e){var r=this.z.redSqr(),n=e.toRed(this.curve.red).redMul(r);if(this.x.cmp(n)===0)return!0;for(var i=e.clone(),s=this.curve.redN.redMul(r);;){if(i.iadd(this.curve.n),i.cmp(this.curve.p)>=0)return!1;if(n.redIAdd(s),this.x.cmp(n)===0)return!0}},rt.prototype.inspect=function(){return this.isInfinity()?"<EC JPoint Infinity>":"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"},rt.prototype.isInfinity=function(){return this.z.cmpn(0)===0};var yn=Yt.exports,kh=gn.exports,ns=rs,O8=xt;function mn(t){ns.call(this,"mont",t),this.a=new yn(t.a,16).toRed(this.red),this.b=new yn(t.b,16).toRed(this.red),this.i4=new yn(4).toRed(this.red).redInvm(),this.two=new yn(2).toRed(this.red),this.a24=this.i4.redMul(this.a.redAdd(this.two))}kh(mn,ns);var M8=mn;mn.prototype.validate=function(e){var r=e.normalize().x,n=r.redSqr(),i=n.redMul(r).redAdd(n.redMul(this.a)).redAdd(r),s=i.redSqrt();return s.redSqr().cmp(i)===0};function Xe(t,e,r){ns.BasePoint.call(this,t,"projective"),e===null&&r===null?(this.x=this.curve.one,this.z=this.curve.zero):(this.x=new yn(e,16),this.z=new yn(r,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)))}kh(Xe,ns.BasePoint),mn.prototype.decodePoint=function(e,r){return this.point(O8.toArray(e,r),1)},mn.prototype.point=function(e,r){return new Xe(this,e,r)},mn.prototype.pointFromJSON=function(e){return Xe.fromJSON(this,e)},Xe.prototype.precompute=function(){},Xe.prototype._encode=function(){return this.getX().toArray("be",this.curve.p.byteLength())},Xe.fromJSON=function(e,r){return new Xe(e,r[0],r[1]||e.one)},Xe.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},Xe.prototype.isInfinity=function(){return this.z.cmpn(0)===0},Xe.prototype.dbl=function(){var e=this.x.redAdd(this.z),r=e.redSqr(),n=this.x.redSub(this.z),i=n.redSqr(),s=r.redSub(i),o=r.redMul(i),a=s.redMul(i.redAdd(this.curve.a24.redMul(s)));return this.curve.point(o,a)},Xe.prototype.add=function(){throw new Error("Not supported on Montgomery curve")},Xe.prototype.diffAdd=function(e,r){var n=this.x.redAdd(this.z),i=this.x.redSub(this.z),s=e.x.redAdd(e.z),o=e.x.redSub(e.z),a=o.redMul(n),c=s.redMul(i),f=r.z.redMul(a.redAdd(c).redSqr()),h=r.x.redMul(a.redISub(c).redSqr());return this.curve.point(f,h)},Xe.prototype.mul=function(e){for(var r=e.clone(),n=this,i=this.curve.point(null,null),s=this,o=[];r.cmpn(0)!==0;r.iushrn(1))o.push(r.andln(1));for(var a=o.length-1;a>=0;a--)o[a]===0?(n=n.diffAdd(i,s),i=i.dbl()):(i=n.diffAdd(i,s),n=n.dbl());return i},Xe.prototype.mulAdd=function(){throw new Error("Not supported on Montgomery curve")},Xe.prototype.jumlAdd=function(){throw new Error("Not supported on Montgomery curve")},Xe.prototype.eq=function(e){return this.getX().cmp(e.getX())===0},Xe.prototype.normalize=function(){return this.x=this.x.redMul(this.z.redInvm()),this.z=this.curve.one,this},Xe.prototype.getX=function(){return this.normalize(),this.x.fromRed()};var T8=xt,dr=Yt.exports,jh=gn.exports,is=rs,R8=T8.assert;function Gt(t){this.twisted=(t.a|0)!==1,this.mOneA=this.twisted&&(t.a|0)===-1,this.extended=this.mOneA,is.call(this,"edwards",t),this.a=new dr(t.a,16).umod(this.red.m),this.a=this.a.toRed(this.red),this.c=new dr(t.c,16).toRed(this.red),this.c2=this.c.redSqr(),this.d=new dr(t.d,16).toRed(this.red),this.dd=this.d.redAdd(this.d),R8(!this.twisted||this.c.fromRed().cmpn(1)===0),this.oneC=(t.c|0)===1}jh(Gt,is);var B8=Gt;Gt.prototype._mulA=function(e){return this.mOneA?e.redNeg():this.a.redMul(e)},Gt.prototype._mulC=function(e){return this.oneC?e:this.c.redMul(e)},Gt.prototype.jpoint=function(e,r,n,i){return this.point(e,r,n,i)},Gt.prototype.pointFromX=function(e,r){e=new dr(e,16),e.red||(e=e.toRed(this.red));var n=e.redSqr(),i=this.c2.redSub(this.a.redMul(n)),s=this.one.redSub(this.c2.redMul(this.d).redMul(n)),o=i.redMul(s.redInvm()),a=o.redSqrt();if(a.redSqr().redSub(o).cmp(this.zero)!==0)throw new Error("invalid point");var c=a.fromRed().isOdd();return(r&&!c||!r&&c)&&(a=a.redNeg()),this.point(e,a)},Gt.prototype.pointFromY=function(e,r){e=new dr(e,16),e.red||(e=e.toRed(this.red));var n=e.redSqr(),i=n.redSub(this.c2),s=n.redMul(this.d).redMul(this.c2).redSub(this.a),o=i.redMul(s.redInvm());if(o.cmp(this.zero)===0){if(r)throw new Error("invalid point");return this.point(this.zero,e)}var a=o.redSqrt();if(a.redSqr().redSub(o).cmp(this.zero)!==0)throw new Error("invalid point");return a.fromRed().isOdd()!==r&&(a=a.redNeg()),this.point(a,e)},Gt.prototype.validate=function(e){if(e.isInfinity())return!0;e.normalize();var r=e.x.redSqr(),n=e.y.redSqr(),i=r.redMul(this.a).redAdd(n),s=this.c2.redMul(this.one.redAdd(this.d.redMul(r).redMul(n)));return i.cmp(s)===0};function oe(t,e,r,n,i){is.BasePoint.call(this,t,"projective"),e===null&&r===null&&n===null?(this.x=this.curve.zero,this.y=this.curve.one,this.z=this.curve.one,this.t=this.curve.zero,this.zOne=!0):(this.x=new dr(e,16),this.y=new dr(r,16),this.z=n?new dr(n,16):this.curve.one,this.t=i&&new dr(i,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.t&&!this.t.red&&(this.t=this.t.toRed(this.curve.red)),this.zOne=this.z===this.curve.one,this.curve.extended&&!this.t&&(this.t=this.x.redMul(this.y),this.zOne||(this.t=this.t.redMul(this.z.redInvm()))))}jh(oe,is.BasePoint),Gt.prototype.pointFromJSON=function(e){return oe.fromJSON(this,e)},Gt.prototype.point=function(e,r,n,i){return new oe(this,e,r,n,i)},oe.fromJSON=function(e,r){return new oe(e,r[0],r[1],r[2])},oe.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},oe.prototype.isInfinity=function(){return this.x.cmpn(0)===0&&(this.y.cmp(this.z)===0||this.zOne&&this.y.cmp(this.curve.c)===0)},oe.prototype._extDbl=function(){var e=this.x.redSqr(),r=this.y.redSqr(),n=this.z.redSqr();n=n.redIAdd(n);var i=this.curve._mulA(e),s=this.x.redAdd(this.y).redSqr().redISub(e).redISub(r),o=i.redAdd(r),a=o.redSub(n),c=i.redSub(r),f=s.redMul(a),h=o.redMul(c),l=s.redMul(c),y=a.redMul(o);return this.curve.point(f,h,y,l)},oe.prototype._projDbl=function(){var e=this.x.redAdd(this.y).redSqr(),r=this.x.redSqr(),n=this.y.redSqr(),i,s,o,a,c,f;if(this.curve.twisted){a=this.curve._mulA(r);var h=a.redAdd(n);this.zOne?(i=e.redSub(r).redSub(n).redMul(h.redSub(this.curve.two)),s=h.redMul(a.redSub(n)),o=h.redSqr().redSub(h).redSub(h)):(c=this.z.redSqr(),f=h.redSub(c).redISub(c),i=e.redSub(r).redISub(n).redMul(f),s=h.redMul(a.redSub(n)),o=h.redMul(f))}else a=r.redAdd(n),c=this.curve._mulC(this.z).redSqr(),f=a.redSub(c).redSub(c),i=this.curve._mulC(e.redISub(a)).redMul(f),s=this.curve._mulC(a).redMul(r.redISub(n)),o=a.redMul(f);return this.curve.point(i,s,o)},oe.prototype.dbl=function(){return this.isInfinity()?this:this.curve.extended?this._extDbl():this._projDbl()},oe.prototype._extAdd=function(e){var r=this.y.redSub(this.x).redMul(e.y.redSub(e.x)),n=this.y.redAdd(this.x).redMul(e.y.redAdd(e.x)),i=this.t.redMul(this.curve.dd).redMul(e.t),s=this.z.redMul(e.z.redAdd(e.z)),o=n.redSub(r),a=s.redSub(i),c=s.redAdd(i),f=n.redAdd(r),h=o.redMul(a),l=c.redMul(f),y=o.redMul(f),_=a.redMul(c);return this.curve.point(h,l,_,y)},oe.prototype._projAdd=function(e){var r=this.z.redMul(e.z),n=r.redSqr(),i=this.x.redMul(e.x),s=this.y.redMul(e.y),o=this.curve.d.redMul(i).redMul(s),a=n.redSub(o),c=n.redAdd(o),f=this.x.redAdd(this.y).redMul(e.x.redAdd(e.y)).redISub(i).redISub(s),h=r.redMul(a).redMul(f),l,y;return this.curve.twisted?(l=r.redMul(c).redMul(s.redSub(this.curve._mulA(i))),y=a.redMul(c)):(l=r.redMul(c).redMul(s.redSub(i)),y=this.curve._mulC(a).redMul(c)),this.curve.point(h,l,y)},oe.prototype.add=function(e){return this.isInfinity()?e:e.isInfinity()?this:this.curve.extended?this._extAdd(e):this._projAdd(e)},oe.prototype.mul=function(e){return this._hasDoubles(e)?this.curve._fixedNafMul(this,e):this.curve._wnafMul(this,e)},oe.prototype.mulAdd=function(e,r,n){return this.curve._wnafMulAdd(1,[this,r],[e,n],2,!1)},oe.prototype.jmulAdd=function(e,r,n){return this.curve._wnafMulAdd(1,[this,r],[e,n],2,!0)},oe.prototype.normalize=function(){if(this.zOne)return this;var e=this.z.redInvm();return this.x=this.x.redMul(e),this.y=this.y.redMul(e),this.t&&(this.t=this.t.redMul(e)),this.z=this.curve.one,this.zOne=!0,this},oe.prototype.neg=function(){return this.curve.point(this.x.redNeg(),this.y,this.z,this.t&&this.t.redNeg())},oe.prototype.getX=function(){return this.normalize(),this.x.fromRed()},oe.prototype.getY=function(){return this.normalize(),this.y.fromRed()},oe.prototype.eq=function(e){return this===e||this.getX().cmp(e.getX())===0&&this.getY().cmp(e.getY())===0},oe.prototype.eqXToP=function(e){var r=e.toRed(this.curve.red).redMul(this.z);if(this.x.cmp(r)===0)return!0;for(var n=e.clone(),i=this.curve.redN.redMul(this.z);;){if(n.iadd(this.curve.n),n.cmp(this.curve.p)>=0)return!1;if(r.redIAdd(i),this.x.cmp(r)===0)return!0}},oe.prototype.toP=oe.prototype.normalize,oe.prototype.mixedAdd=oe.prototype.add,function(t){var e=t;e.base=rs,e.short=D8,e.mont=M8,e.edwards=B8}(Jo);var ss={},os={},G={},N8=qr,P8=gn.exports;G.inherits=P8;function C8(t,e){return(t.charCodeAt(e)&64512)!==55296||e<0||e+1>=t.length?!1:(t.charCodeAt(e+1)&64512)===56320}function $8(t,e){if(Array.isArray(t))return t.slice();if(!t)return[];var r=[];if(typeof t=="string")if(e){if(e==="hex")for(t=t.replace(/[^a-z0-9]+/ig,""),t.length%2!==0&&(t="0"+t),i=0;i<t.length;i+=2)r.push(parseInt(t[i]+t[i+1],16))}else for(var n=0,i=0;i<t.length;i++){var s=t.charCodeAt(i);s<128?r[n++]=s:s<2048?(r[n++]=s>>6|192,r[n++]=s&63|128):C8(t,i)?(s=65536+((s&1023)<<10)+(t.charCodeAt(++i)&1023),r[n++]=s>>18|240,r[n++]=s>>12&63|128,r[n++]=s>>6&63|128,r[n++]=s&63|128):(r[n++]=s>>12|224,r[n++]=s>>6&63|128,r[n++]=s&63|128)}else for(i=0;i<t.length;i++)r[i]=t[i]|0;return r}G.toArray=$8;function L8(t){for(var e="",r=0;r<t.length;r++)e+=Hh(t[r].toString(16));return e}G.toHex=L8;function qh(t){var e=t>>>24|t>>>8&65280|t<<8&16711680|(t&255)<<24;return e>>>0}G.htonl=qh;function F8(t,e){for(var r="",n=0;n<t.length;n++){var i=t[n];e==="little"&&(i=qh(i)),r+=Kh(i.toString(16))}return r}G.toHex32=F8;function Hh(t){return t.length===1?"0"+t:t}G.zero2=Hh;function Kh(t){return t.length===7?"0"+t:t.length===6?"00"+t:t.length===5?"000"+t:t.length===4?"0000"+t:t.length===3?"00000"+t:t.length===2?"000000"+t:t.length===1?"0000000"+t:t}G.zero8=Kh;function z8(t,e,r,n){var i=r-e;N8(i%4===0);for(var s=new Array(i/4),o=0,a=e;o<s.length;o++,a+=4){var c;n==="big"?c=t[a]<<24|t[a+1]<<16|t[a+2]<<8|t[a+3]:c=t[a+3]<<24|t[a+2]<<16|t[a+1]<<8|t[a],s[o]=c>>>0}return s}G.join32=z8;function U8(t,e){for(var r=new Array(t.length*4),n=0,i=0;n<t.length;n++,i+=4){var s=t[n];e==="big"?(r[i]=s>>>24,r[i+1]=s>>>16&255,r[i+2]=s>>>8&255,r[i+3]=s&255):(r[i+3]=s>>>24,r[i+2]=s>>>16&255,r[i+1]=s>>>8&255,r[i]=s&255)}return r}G.split32=U8;function k8(t,e){return t>>>e|t<<32-e}G.rotr32=k8;function j8(t,e){return t<<e|t>>>32-e}G.rotl32=j8;function q8(t,e){return t+e>>>0}G.sum32=q8;function H8(t,e,r){return t+e+r>>>0}G.sum32_3=H8;function K8(t,e,r,n){return t+e+r+n>>>0}G.sum32_4=K8;function V8(t,e,r,n,i){return t+e+r+n+i>>>0}G.sum32_5=V8;function W8(t,e,r,n){var i=t[e],s=t[e+1],o=n+s>>>0,a=(o<n?1:0)+r+i;t[e]=a>>>0,t[e+1]=o}G.sum64=W8;function Y8(t,e,r,n){var i=e+n>>>0,s=(i<e?1:0)+t+r;return s>>>0}G.sum64_hi=Y8;function G8(t,e,r,n){var i=e+n;return i>>>0}G.sum64_lo=G8;function X8(t,e,r,n,i,s,o,a){var c=0,f=e;f=f+n>>>0,c+=f<e?1:0,f=f+s>>>0,c+=f<s?1:0,f=f+a>>>0,c+=f<a?1:0;var h=t+r+i+o+c;return h>>>0}G.sum64_4_hi=X8;function Z8(t,e,r,n,i,s,o,a){var c=e+n+s+a;return c>>>0}G.sum64_4_lo=Z8;function J8(t,e,r,n,i,s,o,a,c,f){var h=0,l=e;l=l+n>>>0,h+=l<e?1:0,l=l+s>>>0,h+=l<s?1:0,l=l+a>>>0,h+=l<a?1:0,l=l+f>>>0,h+=l<f?1:0;var y=t+r+i+o+c+h;return y>>>0}G.sum64_5_hi=J8;function Q8(t,e,r,n,i,s,o,a,c,f){var h=e+n+s+a+f;return h>>>0}G.sum64_5_lo=Q8;function em(t,e,r){var n=e<<32-r|t>>>r;return n>>>0}G.rotr64_hi=em;function tm(t,e,r){var n=t<<32-r|e>>>r;return n>>>0}G.rotr64_lo=tm;function rm(t,e,r){return t>>>r}G.shr64_hi=rm;function nm(t,e,r){var n=t<<32-r|e>>>r;return n>>>0}G.shr64_lo=nm;var wn={},Vh=G,im=qr;function as(){this.pending=null,this.pendingTotal=0,this.blockSize=this.constructor.blockSize,this.outSize=this.constructor.outSize,this.hmacStrength=this.constructor.hmacStrength,this.padLength=this.constructor.padLength/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}wn.BlockHash=as,as.prototype.update=function(e,r){if(e=Vh.toArray(e,r),this.pending?this.pending=this.pending.concat(e):this.pending=e,this.pendingTotal+=e.length,this.pending.length>=this._delta8){e=this.pending;var n=e.length%this._delta8;this.pending=e.slice(e.length-n,e.length),this.pending.length===0&&(this.pending=null),e=Vh.join32(e,0,e.length-n,this.endian);for(var i=0;i<e.length;i+=this._delta32)this._update(e,i,i+this._delta32)}return this},as.prototype.digest=function(e){return this.update(this._pad()),im(this.pending===null),this._digest(e)},as.prototype._pad=function(){var e=this.pendingTotal,r=this._delta8,n=r-(e+this.padLength)%r,i=new Array(n+this.padLength);i[0]=128;for(var s=1;s<n;s++)i[s]=0;if(e<<=3,this.endian==="big"){for(var o=8;o<this.padLength;o++)i[s++]=0;i[s++]=0,i[s++]=0,i[s++]=0,i[s++]=0,i[s++]=e>>>24&255,i[s++]=e>>>16&255,i[s++]=e>>>8&255,i[s++]=e&255}else for(i[s++]=e&255,i[s++]=e>>>8&255,i[s++]=e>>>16&255,i[s++]=e>>>24&255,i[s++]=0,i[s++]=0,i[s++]=0,i[s++]=0,o=8;o<this.padLength;o++)i[s++]=0;return i};var _n={},Xt={},sm=G,Zt=sm.rotr32;function om(t,e,r,n){if(t===0)return Wh(e,r,n);if(t===1||t===3)return Gh(e,r,n);if(t===2)return Yh(e,r,n)}Xt.ft_1=om;function Wh(t,e,r){return t&e^~t&r}Xt.ch32=Wh;function Yh(t,e,r){return t&e^t&r^e&r}Xt.maj32=Yh;function Gh(t,e,r){return t^e^r}Xt.p32=Gh;function am(t){return Zt(t,2)^Zt(t,13)^Zt(t,22)}Xt.s0_256=am;function cm(t){return Zt(t,6)^Zt(t,11)^Zt(t,25)}Xt.s1_256=cm;function fm(t){return Zt(t,7)^Zt(t,18)^t>>>3}Xt.g0_256=fm;function um(t){return Zt(t,17)^Zt(t,19)^t>>>10}Xt.g1_256=um;var En=G,hm=wn,dm=Xt,ea=En.rotl32,ti=En.sum32,lm=En.sum32_5,bm=dm.ft_1,Xh=hm.BlockHash,pm=[1518500249,1859775393,2400959708,3395469782];function Jt(){if(!(this instanceof Jt))return new Jt;Xh.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.W=new Array(80)}En.inherits(Jt,Xh);var gm=Jt;Jt.blockSize=512,Jt.outSize=160,Jt.hmacStrength=80,Jt.padLength=64,Jt.prototype._update=function(e,r){for(var n=this.W,i=0;i<16;i++)n[i]=e[r+i];for(;i<n.length;i++)n[i]=ea(n[i-3]^n[i-8]^n[i-14]^n[i-16],1);var s=this.h[0],o=this.h[1],a=this.h[2],c=this.h[3],f=this.h[4];for(i=0;i<n.length;i++){var h=~~(i/20),l=lm(ea(s,5),bm(h,o,a,c),f,n[i],pm[h]);f=c,c=a,a=ea(o,30),o=s,s=l}this.h[0]=ti(this.h[0],s),this.h[1]=ti(this.h[1],o),this.h[2]=ti(this.h[2],a),this.h[3]=ti(this.h[3],c),this.h[4]=ti(this.h[4],f)},Jt.prototype._digest=function(e){return e==="hex"?En.toHex32(this.h,"big"):En.split32(this.h,"big")};var xn=G,vm=wn,Sn=Xt,ym=qr,Ft=xn.sum32,mm=xn.sum32_4,wm=xn.sum32_5,_m=Sn.ch32,Em=Sn.maj32,xm=Sn.s0_256,Sm=Sn.s1_256,Im=Sn.g0_256,Am=Sn.g1_256,Zh=vm.BlockHash,Dm=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function Qt(){if(!(this instanceof Qt))return new Qt;Zh.call(this),this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.k=Dm,this.W=new Array(64)}xn.inherits(Qt,Zh);var Jh=Qt;Qt.blockSize=512,Qt.outSize=256,Qt.hmacStrength=192,Qt.padLength=64,Qt.prototype._update=function(e,r){for(var n=this.W,i=0;i<16;i++)n[i]=e[r+i];for(;i<n.length;i++)n[i]=mm(Am(n[i-2]),n[i-7],Im(n[i-15]),n[i-16]);var s=this.h[0],o=this.h[1],a=this.h[2],c=this.h[3],f=this.h[4],h=this.h[5],l=this.h[6],y=this.h[7];for(ym(this.k.length===n.length),i=0;i<n.length;i++){var _=wm(y,Sm(f),_m(f,h,l),this.k[i],n[i]),w=Ft(xm(s),Em(s,o,a));y=l,l=h,h=f,f=Ft(c,_),c=a,a=o,o=s,s=Ft(_,w)}this.h[0]=Ft(this.h[0],s),this.h[1]=Ft(this.h[1],o),this.h[2]=Ft(this.h[2],a),this.h[3]=Ft(this.h[3],c),this.h[4]=Ft(this.h[4],f),this.h[5]=Ft(this.h[5],h),this.h[6]=Ft(this.h[6],l),this.h[7]=Ft(this.h[7],y)},Qt.prototype._digest=function(e){return e==="hex"?xn.toHex32(this.h,"big"):xn.split32(this.h,"big")};var ta=G,Qh=Jh;function lr(){if(!(this instanceof lr))return new lr;Qh.call(this),this.h=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]}ta.inherits(lr,Qh);var Om=lr;lr.blockSize=512,lr.outSize=224,lr.hmacStrength=192,lr.padLength=64,lr.prototype._digest=function(e){return e==="hex"?ta.toHex32(this.h.slice(0,7),"big"):ta.split32(this.h.slice(0,7),"big")};var vt=G,Mm=wn,Tm=qr,er=vt.rotr64_hi,tr=vt.rotr64_lo,ed=vt.shr64_hi,td=vt.shr64_lo,Ir=vt.sum64,ra=vt.sum64_hi,na=vt.sum64_lo,Rm=vt.sum64_4_hi,Bm=vt.sum64_4_lo,Nm=vt.sum64_5_hi,Pm=vt.sum64_5_lo,rd=Mm.BlockHash,Cm=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function zt(){if(!(this instanceof zt))return new zt;rd.call(this),this.h=[1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209],this.k=Cm,this.W=new Array(160)}vt.inherits(zt,rd);var nd=zt;zt.blockSize=1024,zt.outSize=512,zt.hmacStrength=192,zt.padLength=128,zt.prototype._prepareBlock=function(e,r){for(var n=this.W,i=0;i<32;i++)n[i]=e[r+i];for(;i<n.length;i+=2){var s=Vm(n[i-4],n[i-3]),o=Wm(n[i-4],n[i-3]),a=n[i-14],c=n[i-13],f=Hm(n[i-30],n[i-29]),h=Km(n[i-30],n[i-29]),l=n[i-32],y=n[i-31];n[i]=Rm(s,o,a,c,f,h,l,y),n[i+1]=Bm(s,o,a,c,f,h,l,y)}},zt.prototype._update=function(e,r){this._prepareBlock(e,r);var n=this.W,i=this.h[0],s=this.h[1],o=this.h[2],a=this.h[3],c=this.h[4],f=this.h[5],h=this.h[6],l=this.h[7],y=this.h[8],_=this.h[9],w=this.h[10],A=this.h[11],D=this.h[12],M=this.h[13],O=this.h[14],T=this.h[15];Tm(this.k.length===n.length);for(var R=0;R<n.length;R+=2){var z=O,L=T,P=jm(y,_),$=qm(y,_),B=$m(y,_,w,A,D),j=Lm(y,_,w,A,D,M),S=this.k[R],u=this.k[R+1],b=n[R],g=n[R+1],p=Nm(z,L,P,$,B,j,S,u,b,g),v=Pm(z,L,P,$,B,j,S,u,b,g);z=Um(i,s),L=km(i,s),P=Fm(i,s,o,a,c),$=zm(i,s,o,a,c,f);var x=ra(z,L,P,$),I=na(z,L,P,$);O=D,T=M,D=w,M=A,w=y,A=_,y=ra(h,l,p,v),_=na(l,l,p,v),h=c,l=f,c=o,f=a,o=i,a=s,i=ra(p,v,x,I),s=na(p,v,x,I)}Ir(this.h,0,i,s),Ir(this.h,2,o,a),Ir(this.h,4,c,f),Ir(this.h,6,h,l),Ir(this.h,8,y,_),Ir(this.h,10,w,A),Ir(this.h,12,D,M),Ir(this.h,14,O,T)},zt.prototype._digest=function(e){return e==="hex"?vt.toHex32(this.h,"big"):vt.split32(this.h,"big")};function $m(t,e,r,n,i){var s=t&r^~t&i;return s<0&&(s+=4294967296),s}function Lm(t,e,r,n,i,s){var o=e&n^~e&s;return o<0&&(o+=4294967296),o}function Fm(t,e,r,n,i){var s=t&r^t&i^r&i;return s<0&&(s+=4294967296),s}function zm(t,e,r,n,i,s){var o=e&n^e&s^n&s;return o<0&&(o+=4294967296),o}function Um(t,e){var r=er(t,e,28),n=er(e,t,2),i=er(e,t,7),s=r^n^i;return s<0&&(s+=4294967296),s}function km(t,e){var r=tr(t,e,28),n=tr(e,t,2),i=tr(e,t,7),s=r^n^i;return s<0&&(s+=4294967296),s}function jm(t,e){var r=er(t,e,14),n=er(t,e,18),i=er(e,t,9),s=r^n^i;return s<0&&(s+=4294967296),s}function qm(t,e){var r=tr(t,e,14),n=tr(t,e,18),i=tr(e,t,9),s=r^n^i;return s<0&&(s+=4294967296),s}function Hm(t,e){var r=er(t,e,1),n=er(t,e,8),i=ed(t,e,7),s=r^n^i;return s<0&&(s+=4294967296),s}function Km(t,e){var r=tr(t,e,1),n=tr(t,e,8),i=td(t,e,7),s=r^n^i;return s<0&&(s+=4294967296),s}function Vm(t,e){var r=er(t,e,19),n=er(e,t,29),i=ed(t,e,6),s=r^n^i;return s<0&&(s+=4294967296),s}function Wm(t,e){var r=tr(t,e,19),n=tr(e,t,29),i=td(t,e,6),s=r^n^i;return s<0&&(s+=4294967296),s}var ia=G,id=nd;function br(){if(!(this instanceof br))return new br;id.call(this),this.h=[3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]}ia.inherits(br,id);var Ym=br;br.blockSize=1024,br.outSize=384,br.hmacStrength=192,br.padLength=128,br.prototype._digest=function(e){return e==="hex"?ia.toHex32(this.h.slice(0,12),"big"):ia.split32(this.h.slice(0,12),"big")},_n.sha1=gm,_n.sha224=Om,_n.sha256=Jh,_n.sha384=Ym,_n.sha512=nd;var sd={},Kr=G,Gm=wn,cs=Kr.rotl32,od=Kr.sum32,ri=Kr.sum32_3,ad=Kr.sum32_4,cd=Gm.BlockHash;function rr(){if(!(this instanceof rr))return new rr;cd.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.endian="little"}Kr.inherits(rr,cd),sd.ripemd160=rr,rr.blockSize=512,rr.outSize=160,rr.hmacStrength=192,rr.padLength=64,rr.prototype._update=function(e,r){for(var n=this.h[0],i=this.h[1],s=this.h[2],o=this.h[3],a=this.h[4],c=n,f=i,h=s,l=o,y=a,_=0;_<80;_++){var w=od(cs(ad(n,fd(_,i,s,o),e[Jm[_]+r],Xm(_)),e6[_]),a);n=a,a=o,o=cs(s,10),s=i,i=w,w=od(cs(ad(c,fd(79-_,f,h,l),e[Qm[_]+r],Zm(_)),t6[_]),y),c=y,y=l,l=cs(h,10),h=f,f=w}w=ri(this.h[1],s,l),this.h[1]=ri(this.h[2],o,y),this.h[2]=ri(this.h[3],a,c),this.h[3]=ri(this.h[4],n,f),this.h[4]=ri(this.h[0],i,h),this.h[0]=w},rr.prototype._digest=function(e){return e==="hex"?Kr.toHex32(this.h,"little"):Kr.split32(this.h,"little")};function fd(t,e,r,n){return t<=15?e^r^n:t<=31?e&r|~e&n:t<=47?(e|~r)^n:t<=63?e&n|r&~n:e^(r|~n)}function Xm(t){return t<=15?0:t<=31?1518500249:t<=47?1859775393:t<=63?2400959708:2840853838}function Zm(t){return t<=15?1352829926:t<=31?1548603684:t<=47?1836072691:t<=63?2053994217:0}var Jm=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],Qm=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],e6=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],t6=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11],r6=G,n6=qr;function In(t,e,r){if(!(this instanceof In))return new In(t,e,r);this.Hash=t,this.blockSize=t.blockSize/8,this.outSize=t.outSize/8,this.inner=null,this.outer=null,this._init(r6.toArray(e,r))}var i6=In;In.prototype._init=function(e){e.length>this.blockSize&&(e=new this.Hash().update(e).digest()),n6(e.length<=this.blockSize);for(var r=e.length;r<this.blockSize;r++)e.push(0);for(r=0;r<e.length;r++)e[r]^=54;for(this.inner=new this.Hash().update(e),r=0;r<e.length;r++)e[r]^=106;this.outer=new this.Hash().update(e)},In.prototype.update=function(e,r){return this.inner.update(e,r),this},In.prototype.digest=function(e){return this.outer.update(this.inner.digest()),this.outer.digest(e)},function(t){var e=t;e.utils=G,e.common=wn,e.sha=_n,e.ripemd=sd,e.hmac=i6,e.sha1=e.sha.sha1,e.sha256=e.sha.sha256,e.sha224=e.sha.sha224,e.sha384=e.sha.sha384,e.sha512=e.sha.sha512,e.ripemd160=e.ripemd.ripemd160}(os);var sa,ud;function s6(){return ud||(ud=1,sa={doubles:{step:4,points:[["e60fce93b59e9ec53011aabc21c23e97b2a31369b87a5ae9c44ee89e2a6dec0a","f7e3507399e595929db99f34f57937101296891e44d23f0be1f32cce69616821"],["8282263212c609d9ea2a6e3e172de238d8c39cabd5ac1ca10646e23fd5f51508","11f8a8098557dfe45e8256e830b60ace62d613ac2f7b17bed31b6eaff6e26caf"],["175e159f728b865a72f99cc6c6fc846de0b93833fd2222ed73fce5b551e5b739","d3506e0d9e3c79eba4ef97a51ff71f5eacb5955add24345c6efa6ffee9fed695"],["363d90d447b00c9c99ceac05b6262ee053441c7e55552ffe526bad8f83ff4640","4e273adfc732221953b445397f3363145b9a89008199ecb62003c7f3bee9de9"],["8b4b5f165df3c2be8c6244b5b745638843e4a781a15bcd1b69f79a55dffdf80c","4aad0a6f68d308b4b3fbd7813ab0da04f9e336546162ee56b3eff0c65fd4fd36"],["723cbaa6e5db996d6bf771c00bd548c7b700dbffa6c0e77bcb6115925232fcda","96e867b5595cc498a921137488824d6e2660a0653779494801dc069d9eb39f5f"],["eebfa4d493bebf98ba5feec812c2d3b50947961237a919839a533eca0e7dd7fa","5d9a8ca3970ef0f269ee7edaf178089d9ae4cdc3a711f712ddfd4fdae1de8999"],["100f44da696e71672791d0a09b7bde459f1215a29b3c03bfefd7835b39a48db0","cdd9e13192a00b772ec8f3300c090666b7ff4a18ff5195ac0fbd5cd62bc65a09"],["e1031be262c7ed1b1dc9227a4a04c017a77f8d4464f3b3852c8acde6e534fd2d","9d7061928940405e6bb6a4176597535af292dd419e1ced79a44f18f29456a00d"],["feea6cae46d55b530ac2839f143bd7ec5cf8b266a41d6af52d5e688d9094696d","e57c6b6c97dce1bab06e4e12bf3ecd5c981c8957cc41442d3155debf18090088"],["da67a91d91049cdcb367be4be6ffca3cfeed657d808583de33fa978bc1ec6cb1","9bacaa35481642bc41f463f7ec9780e5dec7adc508f740a17e9ea8e27a68be1d"],["53904faa0b334cdda6e000935ef22151ec08d0f7bb11069f57545ccc1a37b7c0","5bc087d0bc80106d88c9eccac20d3c1c13999981e14434699dcb096b022771c8"],["8e7bcd0bd35983a7719cca7764ca906779b53a043a9b8bcaeff959f43ad86047","10b7770b2a3da4b3940310420ca9514579e88e2e47fd68b3ea10047e8460372a"],["385eed34c1cdff21e6d0818689b81bde71a7f4f18397e6690a841e1599c43862","283bebc3e8ea23f56701de19e9ebf4576b304eec2086dc8cc0458fe5542e5453"],["6f9d9b803ecf191637c73a4413dfa180fddf84a5947fbc9c606ed86c3fac3a7","7c80c68e603059ba69b8e2a30e45c4d47ea4dd2f5c281002d86890603a842160"],["3322d401243c4e2582a2147c104d6ecbf774d163db0f5e5313b7e0e742d0e6bd","56e70797e9664ef5bfb019bc4ddaf9b72805f63ea2873af624f3a2e96c28b2a0"],["85672c7d2de0b7da2bd1770d89665868741b3f9af7643397721d74d28134ab83","7c481b9b5b43b2eb6374049bfa62c2e5e77f17fcc5298f44c8e3094f790313a6"],["948bf809b1988a46b06c9f1919413b10f9226c60f668832ffd959af60c82a0a","53a562856dcb6646dc6b74c5d1c3418c6d4dff08c97cd2bed4cb7f88d8c8e589"],["6260ce7f461801c34f067ce0f02873a8f1b0e44dfc69752accecd819f38fd8e8","bc2da82b6fa5b571a7f09049776a1ef7ecd292238051c198c1a84e95b2b4ae17"],["e5037de0afc1d8d43d8348414bbf4103043ec8f575bfdc432953cc8d2037fa2d","4571534baa94d3b5f9f98d09fb990bddbd5f5b03ec481f10e0e5dc841d755bda"],["e06372b0f4a207adf5ea905e8f1771b4e7e8dbd1c6a6c5b725866a0ae4fce725","7a908974bce18cfe12a27bb2ad5a488cd7484a7787104870b27034f94eee31dd"],["213c7a715cd5d45358d0bbf9dc0ce02204b10bdde2a3f58540ad6908d0559754","4b6dad0b5ae462507013ad06245ba190bb4850f5f36a7eeddff2c27534b458f2"],["4e7c272a7af4b34e8dbb9352a5419a87e2838c70adc62cddf0cc3a3b08fbd53c","17749c766c9d0b18e16fd09f6def681b530b9614bff7dd33e0b3941817dcaae6"],["fea74e3dbe778b1b10f238ad61686aa5c76e3db2be43057632427e2840fb27b6","6e0568db9b0b13297cf674deccb6af93126b596b973f7b77701d3db7f23cb96f"],["76e64113f677cf0e10a2570d599968d31544e179b760432952c02a4417bdde39","c90ddf8dee4e95cf577066d70681f0d35e2a33d2b56d2032b4b1752d1901ac01"],["c738c56b03b2abe1e8281baa743f8f9a8f7cc643df26cbee3ab150242bcbb891","893fb578951ad2537f718f2eacbfbbbb82314eef7880cfe917e735d9699a84c3"],["d895626548b65b81e264c7637c972877d1d72e5f3a925014372e9f6588f6c14b","febfaa38f2bc7eae728ec60818c340eb03428d632bb067e179363ed75d7d991f"],["b8da94032a957518eb0f6433571e8761ceffc73693e84edd49150a564f676e03","2804dfa44805a1e4d7c99cc9762808b092cc584d95ff3b511488e4e74efdf6e7"],["e80fea14441fb33a7d8adab9475d7fab2019effb5156a792f1a11778e3c0df5d","eed1de7f638e00771e89768ca3ca94472d155e80af322ea9fcb4291b6ac9ec78"],["a301697bdfcd704313ba48e51d567543f2a182031efd6915ddc07bbcc4e16070","7370f91cfb67e4f5081809fa25d40f9b1735dbf7c0a11a130c0d1a041e177ea1"],["90ad85b389d6b936463f9d0512678de208cc330b11307fffab7ac63e3fb04ed4","e507a3620a38261affdcbd9427222b839aefabe1582894d991d4d48cb6ef150"],["8f68b9d2f63b5f339239c1ad981f162ee88c5678723ea3351b7b444c9ec4c0da","662a9f2dba063986de1d90c2b6be215dbbea2cfe95510bfdf23cbf79501fff82"],["e4f3fb0176af85d65ff99ff9198c36091f48e86503681e3e6686fd5053231e11","1e63633ad0ef4f1c1661a6d0ea02b7286cc7e74ec951d1c9822c38576feb73bc"],["8c00fa9b18ebf331eb961537a45a4266c7034f2f0d4e1d0716fb6eae20eae29e","efa47267fea521a1a9dc343a3736c974c2fadafa81e36c54e7d2a4c66702414b"],["e7a26ce69dd4829f3e10cec0a9e98ed3143d084f308b92c0997fddfc60cb3e41","2a758e300fa7984b471b006a1aafbb18d0a6b2c0420e83e20e8a9421cf2cfd51"],["b6459e0ee3662ec8d23540c223bcbdc571cbcb967d79424f3cf29eb3de6b80ef","67c876d06f3e06de1dadf16e5661db3c4b3ae6d48e35b2ff30bf0b61a71ba45"],["d68a80c8280bb840793234aa118f06231d6f1fc67e73c5a5deda0f5b496943e8","db8ba9fff4b586d00c4b1f9177b0e28b5b0e7b8f7845295a294c84266b133120"],["324aed7df65c804252dc0270907a30b09612aeb973449cea4095980fc28d3d5d","648a365774b61f2ff130c0c35aec1f4f19213b0c7e332843967224af96ab7c84"],["4df9c14919cde61f6d51dfdbe5fee5dceec4143ba8d1ca888e8bd373fd054c96","35ec51092d8728050974c23a1d85d4b5d506cdc288490192ebac06cad10d5d"],["9c3919a84a474870faed8a9c1cc66021523489054d7f0308cbfc99c8ac1f98cd","ddb84f0f4a4ddd57584f044bf260e641905326f76c64c8e6be7e5e03d4fc599d"],["6057170b1dd12fdf8de05f281d8e06bb91e1493a8b91d4cc5a21382120a959e5","9a1af0b26a6a4807add9a2daf71df262465152bc3ee24c65e899be932385a2a8"],["a576df8e23a08411421439a4518da31880cef0fba7d4df12b1a6973eecb94266","40a6bf20e76640b2c92b97afe58cd82c432e10a7f514d9f3ee8be11ae1b28ec8"],["7778a78c28dec3e30a05fe9629de8c38bb30d1f5cf9a3a208f763889be58ad71","34626d9ab5a5b22ff7098e12f2ff580087b38411ff24ac563b513fc1fd9f43ac"],["928955ee637a84463729fd30e7afd2ed5f96274e5ad7e5cb09eda9c06d903ac","c25621003d3f42a827b78a13093a95eeac3d26efa8a8d83fc5180e935bcd091f"],["85d0fef3ec6db109399064f3a0e3b2855645b4a907ad354527aae75163d82751","1f03648413a38c0be29d496e582cf5663e8751e96877331582c237a24eb1f962"],["ff2b0dce97eece97c1c9b6041798b85dfdfb6d8882da20308f5404824526087e","493d13fef524ba188af4c4dc54d07936c7b7ed6fb90e2ceb2c951e01f0c29907"],["827fbbe4b1e880ea9ed2b2e6301b212b57f1ee148cd6dd28780e5e2cf856e241","c60f9c923c727b0b71bef2c67d1d12687ff7a63186903166d605b68baec293ec"],["eaa649f21f51bdbae7be4ae34ce6e5217a58fdce7f47f9aa7f3b58fa2120e2b3","be3279ed5bbbb03ac69a80f89879aa5a01a6b965f13f7e59d47a5305ba5ad93d"],["e4a42d43c5cf169d9391df6decf42ee541b6d8f0c9a137401e23632dda34d24f","4d9f92e716d1c73526fc99ccfb8ad34ce886eedfa8d8e4f13a7f7131deba9414"],["1ec80fef360cbdd954160fadab352b6b92b53576a88fea4947173b9d4300bf19","aeefe93756b5340d2f3a4958a7abbf5e0146e77f6295a07b671cdc1cc107cefd"],["146a778c04670c2f91b00af4680dfa8bce3490717d58ba889ddb5928366642be","b318e0ec3354028add669827f9d4b2870aaa971d2f7e5ed1d0b297483d83efd0"],["fa50c0f61d22e5f07e3acebb1aa07b128d0012209a28b9776d76a8793180eef9","6b84c6922397eba9b72cd2872281a68a5e683293a57a213b38cd8d7d3f4f2811"],["da1d61d0ca721a11b1a5bf6b7d88e8421a288ab5d5bba5220e53d32b5f067ec2","8157f55a7c99306c79c0766161c91e2966a73899d279b48a655fba0f1ad836f1"],["a8e282ff0c9706907215ff98e8fd416615311de0446f1e062a73b0610d064e13","7f97355b8db81c09abfb7f3c5b2515888b679a3e50dd6bd6cef7c73111f4cc0c"],["174a53b9c9a285872d39e56e6913cab15d59b1fa512508c022f382de8319497c","ccc9dc37abfc9c1657b4155f2c47f9e6646b3a1d8cb9854383da13ac079afa73"],["959396981943785c3d3e57edf5018cdbe039e730e4918b3d884fdff09475b7ba","2e7e552888c331dd8ba0386a4b9cd6849c653f64c8709385e9b8abf87524f2fd"],["d2a63a50ae401e56d645a1153b109a8fcca0a43d561fba2dbb51340c9d82b151","e82d86fb6443fcb7565aee58b2948220a70f750af484ca52d4142174dcf89405"],["64587e2335471eb890ee7896d7cfdc866bacbdbd3839317b3436f9b45617e073","d99fcdd5bf6902e2ae96dd6447c299a185b90a39133aeab358299e5e9faf6589"],["8481bde0e4e4d885b3a546d3e549de042f0aa6cea250e7fd358d6c86dd45e458","38ee7b8cba5404dd84a25bf39cecb2ca900a79c42b262e556d64b1b59779057e"],["13464a57a78102aa62b6979ae817f4637ffcfed3c4b1ce30bcd6303f6caf666b","69be159004614580ef7e433453ccb0ca48f300a81d0942e13f495a907f6ecc27"],["bc4a9df5b713fe2e9aef430bcc1dc97a0cd9ccede2f28588cada3a0d2d83f366","d3a81ca6e785c06383937adf4b798caa6e8a9fbfa547b16d758d666581f33c1"],["8c28a97bf8298bc0d23d8c749452a32e694b65e30a9472a3954ab30fe5324caa","40a30463a3305193378fedf31f7cc0eb7ae784f0451cb9459e71dc73cbef9482"],["8ea9666139527a8c1dd94ce4f071fd23c8b350c5a4bb33748c4ba111faccae0","620efabbc8ee2782e24e7c0cfb95c5d735b783be9cf0f8e955af34a30e62b945"],["dd3625faef5ba06074669716bbd3788d89bdde815959968092f76cc4eb9a9787","7a188fa3520e30d461da2501045731ca941461982883395937f68d00c644a573"],["f710d79d9eb962297e4f6232b40e8f7feb2bc63814614d692c12de752408221e","ea98e67232d3b3295d3b535532115ccac8612c721851617526ae47a9c77bfc82"]]},naf:{wnd:7,points:[["f9308a019258c31049344f85f89d5229b531c845836f99b08601f113bce036f9","388f7b0f632de8140fe337e62a37f3566500a99934c2231b6cb9fd7584b8e672"],["2f8bde4d1a07209355b4a7250a5c5128e88b84bddc619ab7cba8d569b240efe4","d8ac222636e5e3d6d4dba9dda6c9c426f788271bab0d6840dca87d3aa6ac62d6"],["5cbdf0646e5db4eaa398f365f2ea7a0e3d419b7e0330e39ce92bddedcac4f9bc","6aebca40ba255960a3178d6d861a54dba813d0b813fde7b5a5082628087264da"],["acd484e2f0c7f65309ad178a9f559abde09796974c57e714c35f110dfc27ccbe","cc338921b0a7d9fd64380971763b61e9add888a4375f8e0f05cc262ac64f9c37"],["774ae7f858a9411e5ef4246b70c65aac5649980be5c17891bbec17895da008cb","d984a032eb6b5e190243dd56d7b7b365372db1e2dff9d6a8301d74c9c953c61b"],["f28773c2d975288bc7d1d205c3748651b075fbc6610e58cddeeddf8f19405aa8","ab0902e8d880a89758212eb65cdaf473a1a06da521fa91f29b5cb52db03ed81"],["d7924d4f7d43ea965a465ae3095ff41131e5946f3c85f79e44adbcf8e27e080e","581e2872a86c72a683842ec228cc6defea40af2bd896d3a5c504dc9ff6a26b58"],["defdea4cdb677750a420fee807eacf21eb9898ae79b9768766e4faa04a2d4a34","4211ab0694635168e997b0ead2a93daeced1f4a04a95c0f6cfb199f69e56eb77"],["2b4ea0a797a443d293ef5cff444f4979f06acfebd7e86d277475656138385b6c","85e89bc037945d93b343083b5a1c86131a01f60c50269763b570c854e5c09b7a"],["352bbf4a4cdd12564f93fa332ce333301d9ad40271f8107181340aef25be59d5","321eb4075348f534d59c18259dda3e1f4a1b3b2e71b1039c67bd3d8bcf81998c"],["2fa2104d6b38d11b0230010559879124e42ab8dfeff5ff29dc9cdadd4ecacc3f","2de1068295dd865b64569335bd5dd80181d70ecfc882648423ba76b532b7d67"],["9248279b09b4d68dab21a9b066edda83263c3d84e09572e269ca0cd7f5453714","73016f7bf234aade5d1aa71bdea2b1ff3fc0de2a887912ffe54a32ce97cb3402"],["daed4f2be3a8bf278e70132fb0beb7522f570e144bf615c07e996d443dee8729","a69dce4a7d6c98e8d4a1aca87ef8d7003f83c230f3afa726ab40e52290be1c55"],["c44d12c7065d812e8acf28d7cbb19f9011ecd9e9fdf281b0e6a3b5e87d22e7db","2119a460ce326cdc76c45926c982fdac0e106e861edf61c5a039063f0e0e6482"],["6a245bf6dc698504c89a20cfded60853152b695336c28063b61c65cbd269e6b4","e022cf42c2bd4a708b3f5126f16a24ad8b33ba48d0423b6efd5e6348100d8a82"],["1697ffa6fd9de627c077e3d2fe541084ce13300b0bec1146f95ae57f0d0bd6a5","b9c398f186806f5d27561506e4557433a2cf15009e498ae7adee9d63d01b2396"],["605bdb019981718b986d0f07e834cb0d9deb8360ffb7f61df982345ef27a7479","2972d2de4f8d20681a78d93ec96fe23c26bfae84fb14db43b01e1e9056b8c49"],["62d14dab4150bf497402fdc45a215e10dcb01c354959b10cfe31c7e9d87ff33d","80fc06bd8cc5b01098088a1950eed0db01aa132967ab472235f5642483b25eaf"],["80c60ad0040f27dade5b4b06c408e56b2c50e9f56b9b8b425e555c2f86308b6f","1c38303f1cc5c30f26e66bad7fe72f70a65eed4cbe7024eb1aa01f56430bd57a"],["7a9375ad6167ad54aa74c6348cc54d344cc5dc9487d847049d5eabb0fa03c8fb","d0e3fa9eca8726909559e0d79269046bdc59ea10c70ce2b02d499ec224dc7f7"],["d528ecd9b696b54c907a9ed045447a79bb408ec39b68df504bb51f459bc3ffc9","eecf41253136e5f99966f21881fd656ebc4345405c520dbc063465b521409933"],["49370a4b5f43412ea25f514e8ecdad05266115e4a7ecb1387231808f8b45963","758f3f41afd6ed428b3081b0512fd62a54c3f3afbb5b6764b653052a12949c9a"],["77f230936ee88cbbd73df930d64702ef881d811e0e1498e2f1c13eb1fc345d74","958ef42a7886b6400a08266e9ba1b37896c95330d97077cbbe8eb3c7671c60d6"],["f2dac991cc4ce4b9ea44887e5c7c0bce58c80074ab9d4dbaeb28531b7739f530","e0dedc9b3b2f8dad4da1f32dec2531df9eb5fbeb0598e4fd1a117dba703a3c37"],["463b3d9f662621fb1b4be8fbbe2520125a216cdfc9dae3debcba4850c690d45b","5ed430d78c296c3543114306dd8622d7c622e27c970a1de31cb377b01af7307e"],["f16f804244e46e2a09232d4aff3b59976b98fac14328a2d1a32496b49998f247","cedabd9b82203f7e13d206fcdf4e33d92a6c53c26e5cce26d6579962c4e31df6"],["caf754272dc84563b0352b7a14311af55d245315ace27c65369e15f7151d41d1","cb474660ef35f5f2a41b643fa5e460575f4fa9b7962232a5c32f908318a04476"],["2600ca4b282cb986f85d0f1709979d8b44a09c07cb86d7c124497bc86f082120","4119b88753c15bd6a693b03fcddbb45d5ac6be74ab5f0ef44b0be9475a7e4b40"],["7635ca72d7e8432c338ec53cd12220bc01c48685e24f7dc8c602a7746998e435","91b649609489d613d1d5e590f78e6d74ecfc061d57048bad9e76f302c5b9c61"],["754e3239f325570cdbbf4a87deee8a66b7f2b33479d468fbc1a50743bf56cc18","673fb86e5bda30fb3cd0ed304ea49a023ee33d0197a695d0c5d98093c536683"],["e3e6bd1071a1e96aff57859c82d570f0330800661d1c952f9fe2694691d9b9e8","59c9e0bba394e76f40c0aa58379a3cb6a5a2283993e90c4167002af4920e37f5"],["186b483d056a033826ae73d88f732985c4ccb1f32ba35f4b4cc47fdcf04aa6eb","3b952d32c67cf77e2e17446e204180ab21fb8090895138b4a4a797f86e80888b"],["df9d70a6b9876ce544c98561f4be4f725442e6d2b737d9c91a8321724ce0963f","55eb2dafd84d6ccd5f862b785dc39d4ab157222720ef9da217b8c45cf2ba2417"],["5edd5cc23c51e87a497ca815d5dce0f8ab52554f849ed8995de64c5f34ce7143","efae9c8dbc14130661e8cec030c89ad0c13c66c0d17a2905cdc706ab7399a868"],["290798c2b6476830da12fe02287e9e777aa3fba1c355b17a722d362f84614fba","e38da76dcd440621988d00bcf79af25d5b29c094db2a23146d003afd41943e7a"],["af3c423a95d9f5b3054754efa150ac39cd29552fe360257362dfdecef4053b45","f98a3fd831eb2b749a93b0e6f35cfb40c8cd5aa667a15581bc2feded498fd9c6"],["766dbb24d134e745cccaa28c99bf274906bb66b26dcf98df8d2fed50d884249a","744b1152eacbe5e38dcc887980da38b897584a65fa06cedd2c924f97cbac5996"],["59dbf46f8c94759ba21277c33784f41645f7b44f6c596a58ce92e666191abe3e","c534ad44175fbc300f4ea6ce648309a042ce739a7919798cd85e216c4a307f6e"],["f13ada95103c4537305e691e74e9a4a8dd647e711a95e73cb62dc6018cfd87b8","e13817b44ee14de663bf4bc808341f326949e21a6a75c2570778419bdaf5733d"],["7754b4fa0e8aced06d4167a2c59cca4cda1869c06ebadfb6488550015a88522c","30e93e864e669d82224b967c3020b8fa8d1e4e350b6cbcc537a48b57841163a2"],["948dcadf5990e048aa3874d46abef9d701858f95de8041d2a6828c99e2262519","e491a42537f6e597d5d28a3224b1bc25df9154efbd2ef1d2cbba2cae5347d57e"],["7962414450c76c1689c7b48f8202ec37fb224cf5ac0bfa1570328a8a3d7c77ab","100b610ec4ffb4760d5c1fc133ef6f6b12507a051f04ac5760afa5b29db83437"],["3514087834964b54b15b160644d915485a16977225b8847bb0dd085137ec47ca","ef0afbb2056205448e1652c48e8127fc6039e77c15c2378b7e7d15a0de293311"],["d3cc30ad6b483e4bc79ce2c9dd8bc54993e947eb8df787b442943d3f7b527eaf","8b378a22d827278d89c5e9be8f9508ae3c2ad46290358630afb34db04eede0a4"],["1624d84780732860ce1c78fcbfefe08b2b29823db913f6493975ba0ff4847610","68651cf9b6da903e0914448c6cd9d4ca896878f5282be4c8cc06e2a404078575"],["733ce80da955a8a26902c95633e62a985192474b5af207da6df7b4fd5fc61cd4","f5435a2bd2badf7d485a4d8b8db9fcce3e1ef8e0201e4578c54673bc1dc5ea1d"],["15d9441254945064cf1a1c33bbd3b49f8966c5092171e699ef258dfab81c045c","d56eb30b69463e7234f5137b73b84177434800bacebfc685fc37bbe9efe4070d"],["a1d0fcf2ec9de675b612136e5ce70d271c21417c9d2b8aaaac138599d0717940","edd77f50bcb5a3cab2e90737309667f2641462a54070f3d519212d39c197a629"],["e22fbe15c0af8ccc5780c0735f84dbe9a790badee8245c06c7ca37331cb36980","a855babad5cd60c88b430a69f53a1a7a38289154964799be43d06d77d31da06"],["311091dd9860e8e20ee13473c1155f5f69635e394704eaa74009452246cfa9b3","66db656f87d1f04fffd1f04788c06830871ec5a64feee685bd80f0b1286d8374"],["34c1fd04d301be89b31c0442d3e6ac24883928b45a9340781867d4232ec2dbdf","9414685e97b1b5954bd46f730174136d57f1ceeb487443dc5321857ba73abee"],["f219ea5d6b54701c1c14de5b557eb42a8d13f3abbcd08affcc2a5e6b049b8d63","4cb95957e83d40b0f73af4544cccf6b1f4b08d3c07b27fb8d8c2962a400766d1"],["d7b8740f74a8fbaab1f683db8f45de26543a5490bca627087236912469a0b448","fa77968128d9c92ee1010f337ad4717eff15db5ed3c049b3411e0315eaa4593b"],["32d31c222f8f6f0ef86f7c98d3a3335ead5bcd32abdd94289fe4d3091aa824bf","5f3032f5892156e39ccd3d7915b9e1da2e6dac9e6f26e961118d14b8462e1661"],["7461f371914ab32671045a155d9831ea8793d77cd59592c4340f86cbc18347b5","8ec0ba238b96bec0cbdddcae0aa442542eee1ff50c986ea6b39847b3cc092ff6"],["ee079adb1df1860074356a25aa38206a6d716b2c3e67453d287698bad7b2b2d6","8dc2412aafe3be5c4c5f37e0ecc5f9f6a446989af04c4e25ebaac479ec1c8c1e"],["16ec93e447ec83f0467b18302ee620f7e65de331874c9dc72bfd8616ba9da6b5","5e4631150e62fb40d0e8c2a7ca5804a39d58186a50e497139626778e25b0674d"],["eaa5f980c245f6f038978290afa70b6bd8855897f98b6aa485b96065d537bd99","f65f5d3e292c2e0819a528391c994624d784869d7e6ea67fb18041024edc07dc"],["78c9407544ac132692ee1910a02439958ae04877151342ea96c4b6b35a49f51","f3e0319169eb9b85d5404795539a5e68fa1fbd583c064d2462b675f194a3ddb4"],["494f4be219a1a77016dcd838431aea0001cdc8ae7a6fc688726578d9702857a5","42242a969283a5f339ba7f075e36ba2af925ce30d767ed6e55f4b031880d562c"],["a598a8030da6d86c6bc7f2f5144ea549d28211ea58faa70ebf4c1e665c1fe9b5","204b5d6f84822c307e4b4a7140737aec23fc63b65b35f86a10026dbd2d864e6b"],["c41916365abb2b5d09192f5f2dbeafec208f020f12570a184dbadc3e58595997","4f14351d0087efa49d245b328984989d5caf9450f34bfc0ed16e96b58fa9913"],["841d6063a586fa475a724604da03bc5b92a2e0d2e0a36acfe4c73a5514742881","73867f59c0659e81904f9a1c7543698e62562d6744c169ce7a36de01a8d6154"],["5e95bb399a6971d376026947f89bde2f282b33810928be4ded112ac4d70e20d5","39f23f366809085beebfc71181313775a99c9aed7d8ba38b161384c746012865"],["36e4641a53948fd476c39f8a99fd974e5ec07564b5315d8bf99471bca0ef2f66","d2424b1b1abe4eb8164227b085c9aa9456ea13493fd563e06fd51cf5694c78fc"],["336581ea7bfbbb290c191a2f507a41cf5643842170e914faeab27c2c579f726","ead12168595fe1be99252129b6e56b3391f7ab1410cd1e0ef3dcdcabd2fda224"],["8ab89816dadfd6b6a1f2634fcf00ec8403781025ed6890c4849742706bd43ede","6fdcef09f2f6d0a044e654aef624136f503d459c3e89845858a47a9129cdd24e"],["1e33f1a746c9c5778133344d9299fcaa20b0938e8acff2544bb40284b8c5fb94","60660257dd11b3aa9c8ed618d24edff2306d320f1d03010e33a7d2057f3b3b6"],["85b7c1dcb3cec1b7ee7f30ded79dd20a0ed1f4cc18cbcfcfa410361fd8f08f31","3d98a9cdd026dd43f39048f25a8847f4fcafad1895d7a633c6fed3c35e999511"],["29df9fbd8d9e46509275f4b125d6d45d7fbe9a3b878a7af872a2800661ac5f51","b4c4fe99c775a606e2d8862179139ffda61dc861c019e55cd2876eb2a27d84b"],["a0b1cae06b0a847a3fea6e671aaf8adfdfe58ca2f768105c8082b2e449fce252","ae434102edde0958ec4b19d917a6a28e6b72da1834aff0e650f049503a296cf2"],["4e8ceafb9b3e9a136dc7ff67e840295b499dfb3b2133e4ba113f2e4c0e121e5","cf2174118c8b6d7a4b48f6d534ce5c79422c086a63460502b827ce62a326683c"],["d24a44e047e19b6f5afb81c7ca2f69080a5076689a010919f42725c2b789a33b","6fb8d5591b466f8fc63db50f1c0f1c69013f996887b8244d2cdec417afea8fa3"],["ea01606a7a6c9cdd249fdfcfacb99584001edd28abbab77b5104e98e8e3b35d4","322af4908c7312b0cfbfe369f7a7b3cdb7d4494bc2823700cfd652188a3ea98d"],["af8addbf2b661c8a6c6328655eb96651252007d8c5ea31be4ad196de8ce2131f","6749e67c029b85f52a034eafd096836b2520818680e26ac8f3dfbcdb71749700"],["e3ae1974566ca06cc516d47e0fb165a674a3dabcfca15e722f0e3450f45889","2aeabe7e4531510116217f07bf4d07300de97e4874f81f533420a72eeb0bd6a4"],["591ee355313d99721cf6993ffed1e3e301993ff3ed258802075ea8ced397e246","b0ea558a113c30bea60fc4775460c7901ff0b053d25ca2bdeee98f1a4be5d196"],["11396d55fda54c49f19aa97318d8da61fa8584e47b084945077cf03255b52984","998c74a8cd45ac01289d5833a7beb4744ff536b01b257be4c5767bea93ea57a4"],["3c5d2a1ba39c5a1790000738c9e0c40b8dcdfd5468754b6405540157e017aa7a","b2284279995a34e2f9d4de7396fc18b80f9b8b9fdd270f6661f79ca4c81bd257"],["cc8704b8a60a0defa3a99a7299f2e9c3fbc395afb04ac078425ef8a1793cc030","bdd46039feed17881d1e0862db347f8cf395b74fc4bcdc4e940b74e3ac1f1b13"],["c533e4f7ea8555aacd9777ac5cad29b97dd4defccc53ee7ea204119b2889b197","6f0a256bc5efdf429a2fb6242f1a43a2d9b925bb4a4b3a26bb8e0f45eb596096"],["c14f8f2ccb27d6f109f6d08d03cc96a69ba8c34eec07bbcf566d48e33da6593","c359d6923bb398f7fd4473e16fe1c28475b740dd098075e6c0e8649113dc3a38"],["a6cbc3046bc6a450bac24789fa17115a4c9739ed75f8f21ce441f72e0b90e6ef","21ae7f4680e889bb130619e2c0f95a360ceb573c70603139862afd617fa9b9f"],["347d6d9a02c48927ebfb86c1359b1caf130a3c0267d11ce6344b39f99d43cc38","60ea7f61a353524d1c987f6ecec92f086d565ab687870cb12689ff1e31c74448"],["da6545d2181db8d983f7dcb375ef5866d47c67b1bf31c8cf855ef7437b72656a","49b96715ab6878a79e78f07ce5680c5d6673051b4935bd897fea824b77dc208a"],["c40747cc9d012cb1a13b8148309c6de7ec25d6945d657146b9d5994b8feb1111","5ca560753be2a12fc6de6caf2cb489565db936156b9514e1bb5e83037e0fa2d4"],["4e42c8ec82c99798ccf3a610be870e78338c7f713348bd34c8203ef4037f3502","7571d74ee5e0fb92a7a8b33a07783341a5492144cc54bcc40a94473693606437"],["3775ab7089bc6af823aba2e1af70b236d251cadb0c86743287522a1b3b0dedea","be52d107bcfa09d8bcb9736a828cfa7fac8db17bf7a76a2c42ad961409018cf7"],["cee31cbf7e34ec379d94fb814d3d775ad954595d1314ba8846959e3e82f74e26","8fd64a14c06b589c26b947ae2bcf6bfa0149ef0be14ed4d80f448a01c43b1c6d"],["b4f9eaea09b6917619f6ea6a4eb5464efddb58fd45b1ebefcdc1a01d08b47986","39e5c9925b5a54b07433a4f18c61726f8bb131c012ca542eb24a8ac07200682a"],["d4263dfc3d2df923a0179a48966d30ce84e2515afc3dccc1b77907792ebcc60e","62dfaf07a0f78feb30e30d6295853ce189e127760ad6cf7fae164e122a208d54"],["48457524820fa65a4f8d35eb6930857c0032acc0a4a2de422233eeda897612c4","25a748ab367979d98733c38a1fa1c2e7dc6cc07db2d60a9ae7a76aaa49bd0f77"],["dfeeef1881101f2cb11644f3a2afdfc2045e19919152923f367a1767c11cceda","ecfb7056cf1de042f9420bab396793c0c390bde74b4bbdff16a83ae09a9a7517"],["6d7ef6b17543f8373c573f44e1f389835d89bcbc6062ced36c82df83b8fae859","cd450ec335438986dfefa10c57fea9bcc521a0959b2d80bbf74b190dca712d10"],["e75605d59102a5a2684500d3b991f2e3f3c88b93225547035af25af66e04541f","f5c54754a8f71ee540b9b48728473e314f729ac5308b06938360990e2bfad125"],["eb98660f4c4dfaa06a2be453d5020bc99a0c2e60abe388457dd43fefb1ed620c","6cb9a8876d9cb8520609af3add26cd20a0a7cd8a9411131ce85f44100099223e"],["13e87b027d8514d35939f2e6892b19922154596941888336dc3563e3b8dba942","fef5a3c68059a6dec5d624114bf1e91aac2b9da568d6abeb2570d55646b8adf1"],["ee163026e9fd6fe017c38f06a5be6fc125424b371ce2708e7bf4491691e5764a","1acb250f255dd61c43d94ccc670d0f58f49ae3fa15b96623e5430da0ad6c62b2"],["b268f5ef9ad51e4d78de3a750c2dc89b1e626d43505867999932e5db33af3d80","5f310d4b3c99b9ebb19f77d41c1dee018cf0d34fd4191614003e945a1216e423"],["ff07f3118a9df035e9fad85eb6c7bfe42b02f01ca99ceea3bf7ffdba93c4750d","438136d603e858a3a5c440c38eccbaddc1d2942114e2eddd4740d098ced1f0d8"],["8d8b9855c7c052a34146fd20ffb658bea4b9f69e0d825ebec16e8c3ce2b526a1","cdb559eedc2d79f926baf44fb84ea4d44bcf50fee51d7ceb30e2e7f463036758"],["52db0b5384dfbf05bfa9d472d7ae26dfe4b851ceca91b1eba54263180da32b63","c3b997d050ee5d423ebaf66a6db9f57b3180c902875679de924b69d84a7b375"],["e62f9490d3d51da6395efd24e80919cc7d0f29c3f3fa48c6fff543becbd43352","6d89ad7ba4876b0b22c2ca280c682862f342c8591f1daf5170e07bfd9ccafa7d"],["7f30ea2476b399b4957509c88f77d0191afa2ff5cb7b14fd6d8e7d65aaab1193","ca5ef7d4b231c94c3b15389a5f6311e9daff7bb67b103e9880ef4bff637acaec"],["5098ff1e1d9f14fb46a210fada6c903fef0fb7b4a1dd1d9ac60a0361800b7a00","9731141d81fc8f8084d37c6e7542006b3ee1b40d60dfe5362a5b132fd17ddc0"],["32b78c7de9ee512a72895be6b9cbefa6e2f3c4ccce445c96b9f2c81e2778ad58","ee1849f513df71e32efc3896ee28260c73bb80547ae2275ba497237794c8753c"],["e2cb74fddc8e9fbcd076eef2a7c72b0ce37d50f08269dfc074b581550547a4f7","d3aa2ed71c9dd2247a62df062736eb0baddea9e36122d2be8641abcb005cc4a4"],["8438447566d4d7bedadc299496ab357426009a35f235cb141be0d99cd10ae3a8","c4e1020916980a4da5d01ac5e6ad330734ef0d7906631c4f2390426b2edd791f"],["4162d488b89402039b584c6fc6c308870587d9c46f660b878ab65c82c711d67e","67163e903236289f776f22c25fb8a3afc1732f2b84b4e95dbda47ae5a0852649"],["3fad3fa84caf0f34f0f89bfd2dcf54fc175d767aec3e50684f3ba4a4bf5f683d","cd1bc7cb6cc407bb2f0ca647c718a730cf71872e7d0d2a53fa20efcdfe61826"],["674f2600a3007a00568c1a7ce05d0816c1fb84bf1370798f1c69532faeb1a86b","299d21f9413f33b3edf43b257004580b70db57da0b182259e09eecc69e0d38a5"],["d32f4da54ade74abb81b815ad1fb3b263d82d6c692714bcff87d29bd5ee9f08f","f9429e738b8e53b968e99016c059707782e14f4535359d582fc416910b3eea87"],["30e4e670435385556e593657135845d36fbb6931f72b08cb1ed954f1e3ce3ff6","462f9bce619898638499350113bbc9b10a878d35da70740dc695a559eb88db7b"],["be2062003c51cc3004682904330e4dee7f3dcd10b01e580bf1971b04d4cad297","62188bc49d61e5428573d48a74e1c655b1c61090905682a0d5558ed72dccb9bc"],["93144423ace3451ed29e0fb9ac2af211cb6e84a601df5993c419859fff5df04a","7c10dfb164c3425f5c71a3f9d7992038f1065224f72bb9d1d902a6d13037b47c"],["b015f8044f5fcbdcf21ca26d6c34fb8197829205c7b7d2a7cb66418c157b112c","ab8c1e086d04e813744a655b2df8d5f83b3cdc6faa3088c1d3aea1454e3a1d5f"],["d5e9e1da649d97d89e4868117a465a3a4f8a18de57a140d36b3f2af341a21b52","4cb04437f391ed73111a13cc1d4dd0db1693465c2240480d8955e8592f27447a"],["d3ae41047dd7ca065dbf8ed77b992439983005cd72e16d6f996a5316d36966bb","bd1aeb21ad22ebb22a10f0303417c6d964f8cdd7df0aca614b10dc14d125ac46"],["463e2763d885f958fc66cdd22800f0a487197d0a82e377b49f80af87c897b065","bfefacdb0e5d0fd7df3a311a94de062b26b80c61fbc97508b79992671ef7ca7f"],["7985fdfd127c0567c6f53ec1bb63ec3158e597c40bfe747c83cddfc910641917","603c12daf3d9862ef2b25fe1de289aed24ed291e0ec6708703a5bd567f32ed03"],["74a1ad6b5f76e39db2dd249410eac7f99e74c59cb83d2d0ed5ff1543da7703e9","cc6157ef18c9c63cd6193d83631bbea0093e0968942e8c33d5737fd790e0db08"],["30682a50703375f602d416664ba19b7fc9bab42c72747463a71d0896b22f6da3","553e04f6b018b4fa6c8f39e7f311d3176290d0e0f19ca73f17714d9977a22ff8"],["9e2158f0d7c0d5f26c3791efefa79597654e7a2b2464f52b1ee6c1347769ef57","712fcdd1b9053f09003a3481fa7762e9ffd7c8ef35a38509e2fbf2629008373"],["176e26989a43c9cfeba4029c202538c28172e566e3c4fce7322857f3be327d66","ed8cc9d04b29eb877d270b4878dc43c19aefd31f4eee09ee7b47834c1fa4b1c3"],["75d46efea3771e6e68abb89a13ad747ecf1892393dfc4f1b7004788c50374da8","9852390a99507679fd0b86fd2b39a868d7efc22151346e1a3ca4726586a6bed8"],["809a20c67d64900ffb698c4c825f6d5f2310fb0451c869345b7319f645605721","9e994980d9917e22b76b061927fa04143d096ccc54963e6a5ebfa5f3f8e286c1"],["1b38903a43f7f114ed4500b4eac7083fdefece1cf29c63528d563446f972c180","4036edc931a60ae889353f77fd53de4a2708b26b6f5da72ad3394119daf408f9"]]}}),sa}(function(t){var e=t,r=os,n=Jo,i=xt,s=i.assert;function o(f){f.type==="short"?this.curve=new n.short(f):f.type==="edwards"?this.curve=new n.edwards(f):this.curve=new n.mont(f),this.g=this.curve.g,this.n=this.curve.n,this.hash=f.hash,s(this.g.validate(),"Invalid curve"),s(this.g.mul(this.n).isInfinity(),"Invalid curve, G*N != O")}e.PresetCurve=o;function a(f,h){Object.defineProperty(e,f,{configurable:!0,enumerable:!0,get:function(){var l=new o(h);return Object.defineProperty(e,f,{configurable:!0,enumerable:!0,value:l}),l}})}a("p192",{type:"short",prime:"p192",p:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff",a:"ffffffff ffffffff ffffffff fffffffe ffffffff fffffffc",b:"64210519 e59c80e7 0fa7e9ab 72243049 feb8deec c146b9b1",n:"ffffffff ffffffff ffffffff 99def836 146bc9b1 b4d22831",hash:r.sha256,gRed:!1,g:["188da80e b03090f6 7cbf20eb 43a18800 f4ff0afd 82ff1012","07192b95 ffc8da78 631011ed 6b24cdd5 73f977a1 1e794811"]}),a("p224",{type:"short",prime:"p224",p:"ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001",a:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff fffffffe",b:"b4050a85 0c04b3ab f5413256 5044b0b7 d7bfd8ba 270b3943 2355ffb4",n:"ffffffff ffffffff ffffffff ffff16a2 e0b8f03e 13dd2945 5c5c2a3d",hash:r.sha256,gRed:!1,g:["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3 56c21122 343280d6 115c1d21","bd376388 b5f723fb 4c22dfe6 cd4375a0 5a074764 44d58199 85007e34"]}),a("p256",{type:"short",prime:null,p:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff ffffffff",a:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff fffffffc",b:"5ac635d8 aa3a93e7 b3ebbd55 769886bc 651d06b0 cc53b0f6 3bce3c3e 27d2604b",n:"ffffffff 00000000 ffffffff ffffffff bce6faad a7179e84 f3b9cac2 fc632551",hash:r.sha256,gRed:!1,g:["6b17d1f2 e12c4247 f8bce6e5 63a440f2 77037d81 2deb33a0 f4a13945 d898c296","4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16 2bce3357 6b315ece cbb64068 37bf51f5"]}),a("p384",{type:"short",prime:null,p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 ffffffff",a:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 fffffffc",b:"b3312fa7 e23ee7e4 988e056b e3f82d19 181d9c6e fe814112 0314088f 5013875a c656398d 8a2ed19d 2a85c8ed d3ec2aef",n:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff c7634d81 f4372ddf 581a0db2 48b0a77a ecec196a ccc52973",hash:r.sha384,gRed:!1,g:["aa87ca22 be8b0537 8eb1c71e f320ad74 6e1d3b62 8ba79b98 59f741e0 82542a38 5502f25d bf55296c 3a545e38 72760ab7","3617de4a 96262c6f 5d9e98bf 9292dc29 f8f41dbd 289a147c e9da3113 b5f0b8c0 0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"]}),a("p521",{type:"short",prime:null,p:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff",a:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffc",b:"00000051 953eb961 8e1c9a1f 929a21a0 b68540ee a2da725b 99b315f3 b8b48991 8ef109e1 56193951 ec7e937b 1652c0bd 3bb1bf07 3573df88 3d2c34f1 ef451fd4 6b503f00",n:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffa 51868783 bf2f966b 7fcc0148 f709a5d0 3bb5c9b8 899c47ae bb6fb71e 91386409",hash:r.sha512,gRed:!1,g:["000000c6 858e06b7 0404e9cd 9e3ecb66 2395b442 9c648139 053fb521 f828af60 6b4d3dba a14b5e77 efe75928 fe1dc127 a2ffa8de 3348b3c1 856a429b f97e7e31 c2e5bd66","00000118 39296a78 9a3bc004 5c8a5fb4 2c7d1bd9 98f54449 579b4468 17afbd17 273e662c 97ee7299 5ef42640 c550b901 3fad0761 353c7086 a272c240 88be9476 9fd16650"]}),a("curve25519",{type:"mont",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"76d06",b:"1",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:r.sha256,gRed:!1,g:["9"]}),a("ed25519",{type:"edwards",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"-1",c:"1",d:"52036cee2b6ffe73 8cc740797779e898 00700a4d4141d8ab 75eb4dca135978a3",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:r.sha256,gRed:!1,g:["216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a","6666666666666666666666666666666666666666666666666666666666666658"]});var c;try{c=s6()}catch{c=void 0}a("secp256k1",{type:"short",prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",hash:r.sha256,beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:!1,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",c]})})(ss);var o6=os,Vr=Xo,hd=qr;function Ar(t){if(!(this instanceof Ar))return new Ar(t);this.hash=t.hash,this.predResist=!!t.predResist,this.outLen=this.hash.outSize,this.minEntropy=t.minEntropy||this.hash.hmacStrength,this._reseed=null,this.reseedInterval=null,this.K=null,this.V=null;var e=Vr.toArray(t.entropy,t.entropyEnc||"hex"),r=Vr.toArray(t.nonce,t.nonceEnc||"hex"),n=Vr.toArray(t.pers,t.persEnc||"hex");hd(e.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._init(e,r,n)}var a6=Ar;Ar.prototype._init=function(e,r,n){var i=e.concat(r).concat(n);this.K=new Array(this.outLen/8),this.V=new Array(this.outLen/8);for(var s=0;s<this.V.length;s++)this.K[s]=0,this.V[s]=1;this._update(i),this._reseed=1,this.reseedInterval=281474976710656},Ar.prototype._hmac=function(){return new o6.hmac(this.hash,this.K)},Ar.prototype._update=function(e){var r=this._hmac().update(this.V).update([0]);e&&(r=r.update(e)),this.K=r.digest(),this.V=this._hmac().update(this.V).digest(),e&&(this.K=this._hmac().update(this.V).update([1]).update(e).digest(),this.V=this._hmac().update(this.V).digest())},Ar.prototype.reseed=function(e,r,n,i){typeof r!="string"&&(i=n,n=r,r=null),e=Vr.toArray(e,r),n=Vr.toArray(n,i),hd(e.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._update(e.concat(n||[])),this._reseed=1},Ar.prototype.generate=function(e,r,n,i){if(this._reseed>this.reseedInterval)throw new Error("Reseed is required");typeof r!="string"&&(i=n,n=r,r=null),n&&(n=Vr.toArray(n,i||"hex"),this._update(n));for(var s=[];s.length<e;)this.V=this._hmac().update(this.V).digest(),s=s.concat(this.V);var o=s.slice(0,e);return this._update(n),this._reseed++,Vr.encode(o,r)};var c6=Yt.exports,f6=xt,oa=f6.assert;function ot(t,e){this.ec=t,this.priv=null,this.pub=null,e.priv&&this._importPrivate(e.priv,e.privEnc),e.pub&&this._importPublic(e.pub,e.pubEnc)}var u6=ot;ot.fromPublic=function(e,r,n){return r instanceof ot?r:new ot(e,{pub:r,pubEnc:n})},ot.fromPrivate=function(e,r,n){return r instanceof ot?r:new ot(e,{priv:r,privEnc:n})},ot.prototype.validate=function(){var e=this.getPublic();return e.isInfinity()?{result:!1,reason:"Invalid public key"}:e.validate()?e.mul(this.ec.curve.n).isInfinity()?{result:!0,reason:null}:{result:!1,reason:"Public key * N != O"}:{result:!1,reason:"Public key is not a point"}},ot.prototype.getPublic=function(e,r){return typeof e=="string"&&(r=e,e=null),this.pub||(this.pub=this.ec.g.mul(this.priv)),r?this.pub.encode(r,e):this.pub},ot.prototype.getPrivate=function(e){return e==="hex"?this.priv.toString(16,2):this.priv},ot.prototype._importPrivate=function(e,r){this.priv=new c6(e,r||16),this.priv=this.priv.umod(this.ec.curve.n)},ot.prototype._importPublic=function(e,r){if(e.x||e.y){this.ec.curve.type==="mont"?oa(e.x,"Need x coordinate"):(this.ec.curve.type==="short"||this.ec.curve.type==="edwards")&&oa(e.x&&e.y,"Need both x and y coordinate"),this.pub=this.ec.curve.point(e.x,e.y);return}this.pub=this.ec.curve.decodePoint(e,r)},ot.prototype.derive=function(e){return e.validate()||oa(e.validate(),"public point not validated"),e.mul(this.priv).getX()},ot.prototype.sign=function(e,r,n){return this.ec.sign(e,this,r,n)},ot.prototype.verify=function(e,r,n){return this.ec.verify(e,r,this,void 0,n)},ot.prototype.inspect=function(){return"<Key priv: "+(this.priv&&this.priv.toString(16,2))+" pub: "+(this.pub&&this.pub.inspect())+" >"};var fs=Yt.exports,aa=xt,h6=aa.assert;function us(t,e){if(t instanceof us)return t;this._importDER(t,e)||(h6(t.r&&t.s,"Signature without r or s"),this.r=new fs(t.r,16),this.s=new fs(t.s,16),t.recoveryParam===void 0?this.recoveryParam=null:this.recoveryParam=t.recoveryParam)}var d6=us;function l6(){this.place=0}function ca(t,e){var r=t[e.place++];if(!(r&128))return r;var n=r&15;if(n===0||n>4||t[e.place]===0)return!1;for(var i=0,s=0,o=e.place;s<n;s++,o++)i<<=8,i|=t[o],i>>>=0;return i<=127?!1:(e.place=o,i)}function dd(t){for(var e=0,r=t.length-1;!t[e]&&!(t[e+1]&128)&&e<r;)e++;return e===0?t:t.slice(e)}us.prototype._importDER=function(e,r){e=aa.toArray(e,r);var n=new l6;if(e[n.place++]!==48)return!1;var i=ca(e,n);if(i===!1||i+n.place!==e.length||e[n.place++]!==2)return!1;var s=ca(e,n);if(s===!1||(e[n.place]&128)!==0)return!1;var o=e.slice(n.place,s+n.place);if(n.place+=s,e[n.place++]!==2)return!1;var a=ca(e,n);if(a===!1||e.length!==a+n.place||(e[n.place]&128)!==0)return!1;var c=e.slice(n.place,a+n.place);if(o[0]===0)if(o[1]&128)o=o.slice(1);else return!1;if(c[0]===0)if(c[1]&128)c=c.slice(1);else return!1;return this.r=new fs(o),this.s=new fs(c),this.recoveryParam=null,!0};function fa(t,e){if(e<128){t.push(e);return}var r=1+(Math.log(e)/Math.LN2>>>3);for(t.push(r|128);--r;)t.push(e>>>(r<<3)&255);t.push(e)}us.prototype.toDER=function(e){var r=this.r.toArray(),n=this.s.toArray();for(r[0]&128&&(r=[0].concat(r)),n[0]&128&&(n=[0].concat(n)),r=dd(r),n=dd(n);!n[0]&&!(n[1]&128);)n=n.slice(1);var i=[2];fa(i,r.length),i=i.concat(r),i.push(2),fa(i,n.length);var s=i.concat(n),o=[48];return fa(o,s.length),o=o.concat(s),aa.encode(o,e)};var Ut=Yt.exports,ld=a6,b6=xt,ua=ss,p6=Qi.exports,Wr=b6.assert,ha=u6,hs=d6;function Bt(t){if(!(this instanceof Bt))return new Bt(t);typeof t=="string"&&(Wr(Object.prototype.hasOwnProperty.call(ua,t),"Unknown curve "+t),t=ua[t]),t instanceof ua.PresetCurve&&(t={curve:t}),this.curve=t.curve.curve,this.n=this.curve.n,this.nh=this.n.ushrn(1),this.g=this.curve.g,this.g=t.curve.g,this.g.precompute(t.curve.n.bitLength()+1),this.hash=t.hash||t.curve.hash}var g6=Bt;Bt.prototype.keyPair=function(e){return new ha(this,e)},Bt.prototype.keyFromPrivate=function(e,r){return ha.fromPrivate(this,e,r)},Bt.prototype.keyFromPublic=function(e,r){return ha.fromPublic(this,e,r)},Bt.prototype.genKeyPair=function(e){e||(e={});for(var r=new ld({hash:this.hash,pers:e.pers,persEnc:e.persEnc||"utf8",entropy:e.entropy||p6(this.hash.hmacStrength),entropyEnc:e.entropy&&e.entropyEnc||"utf8",nonce:this.n.toArray()}),n=this.n.byteLength(),i=this.n.sub(new Ut(2));;){var s=new Ut(r.generate(n));if(!(s.cmp(i)>0))return s.iaddn(1),this.keyFromPrivate(s)}},Bt.prototype._truncateToN=function(e,r,n){var i;if(Ut.isBN(e)||typeof e=="number")e=new Ut(e,16),i=e.byteLength();else if(typeof e=="object")i=e.length,e=new Ut(e,16);else{var s=e.toString();i=s.length+1>>>1,e=new Ut(s,16)}typeof n!="number"&&(n=i*8);var o=n-this.n.bitLength();return o>0&&(e=e.ushrn(o)),!r&&e.cmp(this.n)>=0?e.sub(this.n):e},Bt.prototype.sign=function(e,r,n,i){if(typeof n=="object"&&(i=n,n=null),i||(i={}),typeof e!="string"&&typeof e!="number"&&!Ut.isBN(e)){Wr(typeof e=="object"&&e&&typeof e.length=="number","Expected message to be an array-like, a hex string, or a BN instance"),Wr(e.length>>>0===e.length);for(var s=0;s<e.length;s++)Wr((e[s]&255)===e[s])}r=this.keyFromPrivate(r,n),e=this._truncateToN(e,!1,i.msgBitLength),Wr(!e.isNeg(),"Can not sign a negative message");var o=this.n.byteLength(),a=r.getPrivate().toArray("be",o),c=e.toArray("be",o);Wr(new Ut(c).eq(e),"Can not sign message");for(var f=new ld({hash:this.hash,entropy:a,nonce:c,pers:i.pers,persEnc:i.persEnc||"utf8"}),h=this.n.sub(new Ut(1)),l=0;;l++){var y=i.k?i.k(l):new Ut(f.generate(this.n.byteLength()));if(y=this._truncateToN(y,!0),!(y.cmpn(1)<=0||y.cmp(h)>=0)){var _=this.g.mul(y);if(!_.isInfinity()){var w=_.getX(),A=w.umod(this.n);if(A.cmpn(0)!==0){var D=y.invm(this.n).mul(A.mul(r.getPrivate()).iadd(e));if(D=D.umod(this.n),D.cmpn(0)!==0){var M=(_.getY().isOdd()?1:0)|(w.cmp(A)!==0?2:0);return i.canonical&&D.cmp(this.nh)>0&&(D=this.n.sub(D),M^=1),new hs({r:A,s:D,recoveryParam:M})}}}}}},Bt.prototype.verify=function(e,r,n,i,s){s||(s={}),e=this._truncateToN(e,!1,s.msgBitLength),n=this.keyFromPublic(n,i),r=new hs(r,"hex");var o=r.r,a=r.s;if(o.cmpn(1)<0||o.cmp(this.n)>=0||a.cmpn(1)<0||a.cmp(this.n)>=0)return!1;var c=a.invm(this.n),f=c.mul(e).umod(this.n),h=c.mul(o).umod(this.n),l;return this.curve._maxwellTrick?(l=this.g.jmulAdd(f,n.getPublic(),h),l.isInfinity()?!1:l.eqXToP(o)):(l=this.g.mulAdd(f,n.getPublic(),h),l.isInfinity()?!1:l.getX().umod(this.n).cmp(o)===0)},Bt.prototype.recoverPubKey=function(t,e,r,n){Wr((3&r)===r,"The recovery param is more than two bits"),e=new hs(e,n);var i=this.n,s=new Ut(t),o=e.r,a=e.s,c=r&1,f=r>>1;if(o.cmp(this.curve.p.umod(this.curve.n))>=0&&f)throw new Error("Unable to find sencond key candinate");f?o=this.curve.pointFromX(o.add(this.curve.n),c):o=this.curve.pointFromX(o,c);var h=e.r.invm(i),l=i.sub(s).mul(h).umod(i),y=a.mul(h).umod(i);return this.g.mulAdd(l,o,y)},Bt.prototype.getKeyRecoveryParam=function(t,e,r,n){if(e=new hs(e,n),e.recoveryParam!==null)return e.recoveryParam;for(var i=0;i<4;i++){var s;try{s=this.recoverPubKey(t,e,i)}catch{continue}if(s.eq(r))return i}throw new Error("Unable to find valid recovery factor")};var ni=xt,bd=ni.assert,pd=ni.parseBytes,An=ni.cachedProperty;function Ze(t,e){this.eddsa=t,this._secret=pd(e.secret),t.isPoint(e.pub)?this._pub=e.pub:this._pubBytes=pd(e.pub)}Ze.fromPublic=function(e,r){return r instanceof Ze?r:new Ze(e,{pub:r})},Ze.fromSecret=function(e,r){return r instanceof Ze?r:new Ze(e,{secret:r})},Ze.prototype.secret=function(){return this._secret},An(Ze,"pubBytes",function(){return this.eddsa.encodePoint(this.pub())}),An(Ze,"pub",function(){return this._pubBytes?this.eddsa.decodePoint(this._pubBytes):this.eddsa.g.mul(this.priv())}),An(Ze,"privBytes",function(){var e=this.eddsa,r=this.hash(),n=e.encodingLength-1,i=r.slice(0,e.encodingLength);return i[0]&=248,i[n]&=127,i[n]|=64,i}),An(Ze,"priv",function(){return this.eddsa.decodeInt(this.privBytes())}),An(Ze,"hash",function(){return this.eddsa.hash().update(this.secret()).digest()}),An(Ze,"messagePrefix",function(){return this.hash().slice(this.eddsa.encodingLength)}),Ze.prototype.sign=function(e){return bd(this._secret,"KeyPair can only verify"),this.eddsa.sign(e,this)},Ze.prototype.verify=function(e,r){return this.eddsa.verify(e,r,this)},Ze.prototype.getSecret=function(e){return bd(this._secret,"KeyPair is public only"),ni.encode(this.secret(),e)},Ze.prototype.getPublic=function(e){return ni.encode(this.pubBytes(),e)};var v6=Ze,y6=Yt.exports,ds=xt,gd=ds.assert,ls=ds.cachedProperty,m6=ds.parseBytes;function Yr(t,e){this.eddsa=t,typeof e!="object"&&(e=m6(e)),Array.isArray(e)&&(gd(e.length===t.encodingLength*2,"Signature has invalid size"),e={R:e.slice(0,t.encodingLength),S:e.slice(t.encodingLength)}),gd(e.R&&e.S,"Signature without R or S"),t.isPoint(e.R)&&(this._R=e.R),e.S instanceof y6&&(this._S=e.S),this._Rencoded=Array.isArray(e.R)?e.R:e.Rencoded,this._Sencoded=Array.isArray(e.S)?e.S:e.Sencoded}ls(Yr,"S",function(){return this.eddsa.decodeInt(this.Sencoded())}),ls(Yr,"R",function(){return this.eddsa.decodePoint(this.Rencoded())}),ls(Yr,"Rencoded",function(){return this.eddsa.encodePoint(this.R())}),ls(Yr,"Sencoded",function(){return this.eddsa.encodeInt(this.S())}),Yr.prototype.toBytes=function(){return this.Rencoded().concat(this.Sencoded())},Yr.prototype.toHex=function(){return ds.encode(this.toBytes(),"hex").toUpperCase()};var w6=Yr,_6=os,E6=ss,Dn=xt,x6=Dn.assert,vd=Dn.parseBytes,yd=v6,md=w6;function yt(t){if(x6(t==="ed25519","only tested with ed25519 so far"),!(this instanceof yt))return new yt(t);t=E6[t].curve,this.curve=t,this.g=t.g,this.g.precompute(t.n.bitLength()+1),this.pointClass=t.point().constructor,this.encodingLength=Math.ceil(t.n.bitLength()/8),this.hash=_6.sha512}var S6=yt;yt.prototype.sign=function(e,r){e=vd(e);var n=this.keyFromSecret(r),i=this.hashInt(n.messagePrefix(),e),s=this.g.mul(i),o=this.encodePoint(s),a=this.hashInt(o,n.pubBytes(),e).mul(n.priv()),c=i.add(a).umod(this.curve.n);return this.makeSignature({R:s,S:c,Rencoded:o})},yt.prototype.verify=function(e,r,n){if(e=vd(e),r=this.makeSignature(r),r.S().gte(r.eddsa.curve.n)||r.S().isNeg())return!1;var i=this.keyFromPublic(n),s=this.hashInt(r.Rencoded(),i.pubBytes(),e),o=this.g.mul(r.S()),a=r.R().add(i.pub().mul(s));return a.eq(o)},yt.prototype.hashInt=function(){for(var e=this.hash(),r=0;r<arguments.length;r++)e.update(arguments[r]);return Dn.intFromLE(e.digest()).umod(this.curve.n)},yt.prototype.keyFromPublic=function(e){return yd.fromPublic(this,e)},yt.prototype.keyFromSecret=function(e){return yd.fromSecret(this,e)},yt.prototype.makeSignature=function(e){return e instanceof md?e:new md(this,e)},yt.prototype.encodePoint=function(e){var r=e.getY().toArray("le",this.encodingLength);return r[this.encodingLength-1]|=e.getX().isOdd()?128:0,r},yt.prototype.decodePoint=function(e){e=Dn.parseBytes(e);var r=e.length-1,n=e.slice(0,r).concat(e[r]&-129),i=(e[r]&128)!==0,s=Dn.intFromLE(n);return this.curve.pointFromY(s,i)},yt.prototype.encodeInt=function(e){return e.toArray("le",this.encodingLength)},yt.prototype.decodeInt=function(e){return Dn.intFromLE(e)},yt.prototype.isPoint=function(e){return e instanceof this.pointClass},function(t){var e=t;e.version=_8.version,e.utils=xt,e.rand=Qi.exports,e.curve=Jo,e.curves=ss,e.ec=g6,e.eddsa=S6}(Lh);const I6={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe",batchFetchMessages:"waku_batchFetchMessages"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe",batchFetchMessages:"irn_batchFetchMessages"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe",batchFetchMessages:"iridium_batchFetchMessages"}};var A6=Object.defineProperty,wd=Object.getOwnPropertySymbols,D6=Object.prototype.hasOwnProperty,O6=Object.prototype.propertyIsEnumerable,_d=(t,e,r)=>e in t?A6(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,M6=(t,e)=>{for(var r in e||(e={}))D6.call(e,r)&&_d(t,r,e[r]);if(wd)for(var r of wd(e))O6.call(e,r)&&_d(t,r,e[r]);return t};const T6="ReactNative",kt={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},R6="js";function bs(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function Gr(){return!Hi()&&!!So()&&navigator.product===T6}function B6(){return Gr()&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"&&(global==null?void 0:global.Platform.OS)==="android"}function N6(){return Gr()&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"&&(global==null?void 0:global.Platform.OS)==="ios"}function ps(){return!bs()&&!!So()&&!!Hi()}function gs(){return Gr()?kt.reactNative:bs()?kt.node:ps()?kt.browser:kt.unknown}function Ed(){var t;try{return Gr()&&typeof global<"u"&&typeof(global==null?void 0:global.Application)<"u"?(t=global.Application)==null?void 0:t.applicationId:void 0}catch{return}}function P6(t,e){const r=new URLSearchParams(t);for(const n of Object.keys(e).sort())if(e.hasOwnProperty(n)){const i=e[n];i!==void 0&&r.set(n,i)}return r.toString()}function C6(){return Gu()||{name:"",description:"",url:"",icons:[""]}}function $6(){if(gs()===kt.reactNative&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"){const{OS:r,Version:n}=global.Platform;return[r,n].join("-")}const t=Zv();if(t===null)return"unknown";const e=t.os?t.os.replace(" ","").toLowerCase():"unknown";return t.type==="browser"?[e,t.name,t.version].join("-"):[e,t.version].join("-")}function L6(){var t;const e=gs();return e===kt.browser?[e,((t=Yu())==null?void 0:t.host)||"unknown"].join(":"):e}function xd(t,e,r){const n=$6(),i=L6();return[[t,e].join("-"),[R6,r].join("-"),n,i].join("/")}function F6({protocol:t,version:e,relayUrl:r,sdkVersion:n,auth:i,projectId:s,useOnCloseEvent:o,bundleId:a,packageName:c}){const f=r.split("?"),h=xd(t,e,n),l={auth:i,ua:h,projectId:s,useOnCloseEvent:o||void 0,packageName:c||void 0,bundleId:a||void 0},y=P6(f[1]||"",l);return f[0]+"?"+y}function da(t){return Object.fromEntries(t.entries())}function la(t){return new Map(Object.entries(t))}function z6(t=H.FIVE_MINUTES,e){const r=H.toMiliseconds(t||H.FIVE_MINUTES);let n,i,s,o;return{resolve:a=>{s&&n&&(clearTimeout(s),n(a),o=Promise.resolve(a))},reject:a=>{s&&i&&(clearTimeout(s),i(a))},done:()=>new Promise((a,c)=>{if(o)return a(o);s=setTimeout(()=>{const f=new Error(e);o=Promise.reject(f),c(f)},r),n=a,i=c})}}function Dr(t,e,r){return new Promise(async(n,i)=>{const s=setTimeout(()=>i(new Error(r)),e);try{const o=await t;n(o)}catch(o){i(o)}clearTimeout(s)})}function Sd(t,e){if(typeof e=="string"&&e.startsWith(`${t}:`))return e;if(t.toLowerCase()==="topic"){if(typeof e!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${e}`}else if(t.toLowerCase()==="id"){if(typeof e!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${e}`}throw new Error(`Unknown expirer target type: ${t}`)}function U6(t){return Sd("topic",t)}function k6(t){return Sd("id",t)}function j6(t){const[e,r]=t.split(":"),n={id:void 0,topic:void 0};if(e==="topic"&&typeof r=="string")n.topic=r;else if(e==="id"&&Number.isInteger(Number(r)))n.id=Number(r);else throw new Error(`Invalid target, expected id:number or topic:string, got ${e}:${r}`);return n}function ii(t,e){return H.fromMiliseconds((e||Date.now())+H.toMiliseconds(t))}function Id(t){return Date.now()>=H.toMiliseconds(t)}function ba(t,e){return`${t}${e?`:${e}`:""}`}function Ad(){return typeof crypto<"u"&&crypto!=null&&crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/gu,t=>{const e=Math.random()*16|0;return(t==="x"?e:e&3|8).toString(16)})}function Dd(){return typeof process<"u"&&process.env.IS_VITEST==="true"}function Od(t){return Buffer.from(t,"base64").toString("utf-8")}function q6(t){return new Promise(e=>setTimeout(e,t))}function si(t){if(!Number.isSafeInteger(t)||t<0)throw new Error("positive integer expected, got "+t)}function H6(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function vs(t,...e){if(!H6(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function pa(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");si(t.outputLen),si(t.blockLen)}function On(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function Md(t,e){vs(t);const r=e.outputLen;if(t.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}const ys=BigInt(2**32-1),Td=BigInt(32);function K6(t,e=!1){return e?{h:Number(t&ys),l:Number(t>>Td&ys)}:{h:Number(t>>Td&ys)|0,l:Number(t&ys)|0}}function V6(t,e=!1){let r=new Uint32Array(t.length),n=new Uint32Array(t.length);for(let i=0;i<t.length;i++){const{h:s,l:o}=K6(t[i],e);[r[i],n[i]]=[s,o]}return[r,n]}const W6=(t,e,r)=>t<<r|e>>>32-r,Y6=(t,e,r)=>e<<r|t>>>32-r,G6=(t,e,r)=>e<<r-32|t>>>64-r,X6=(t,e,r)=>t<<r-32|e>>>64-r,Mn=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;function Z6(t){return new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4))}function ga(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function nr(t,e){return t<<32-e|t>>>e}const Rd=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function J6(t){return t<<24&4278190080|t<<8&16711680|t>>>8&65280|t>>>24&255}function Bd(t){for(let e=0;e<t.length;e++)t[e]=J6(t[e])}function Q6(t){if(typeof t!="string")throw new Error("utf8ToBytes expected string, got "+typeof t);return new Uint8Array(new TextEncoder().encode(t))}function Tn(t){return typeof t=="string"&&(t=Q6(t)),vs(t),t}class va{clone(){return this._cloneInto()}}function Nd(t){const e=n=>t().update(Tn(n)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e}function oi(t=32){if(Mn&&typeof Mn.getRandomValues=="function")return Mn.getRandomValues(new Uint8Array(t));if(Mn&&typeof Mn.randomBytes=="function")return Mn.randomBytes(t);throw new Error("crypto.getRandomValues must be defined")}const Pd=[],Cd=[],$d=[],e4=BigInt(0),ai=BigInt(1),t4=BigInt(2),r4=BigInt(7),n4=BigInt(256),i4=BigInt(113);for(let t=0,e=ai,r=1,n=0;t<24;t++){[r,n]=[n,(2*r+3*n)%5],Pd.push(2*(5*n+r)),Cd.push((t+1)*(t+2)/2%64);let i=e4;for(let s=0;s<7;s++)e=(e<<ai^(e>>r4)*i4)%n4,e&t4&&(i^=ai<<(ai<<BigInt(s))-ai);$d.push(i)}const[s4,o4]=V6($d,!0),Ld=(t,e,r)=>r>32?G6(t,e,r):W6(t,e,r),Fd=(t,e,r)=>r>32?X6(t,e,r):Y6(t,e,r);function a4(t,e=24){const r=new Uint32Array(10);for(let n=24-e;n<24;n++){for(let o=0;o<10;o++)r[o]=t[o]^t[o+10]^t[o+20]^t[o+30]^t[o+40];for(let o=0;o<10;o+=2){const a=(o+8)%10,c=(o+2)%10,f=r[c],h=r[c+1],l=Ld(f,h,1)^r[a],y=Fd(f,h,1)^r[a+1];for(let _=0;_<50;_+=10)t[o+_]^=l,t[o+_+1]^=y}let i=t[2],s=t[3];for(let o=0;o<24;o++){const a=Cd[o],c=Ld(i,s,a),f=Fd(i,s,a),h=Pd[o];i=t[h],s=t[h+1],t[h]=c,t[h+1]=f}for(let o=0;o<50;o+=10){for(let a=0;a<10;a++)r[a]=t[o+a];for(let a=0;a<10;a++)t[o+a]^=~r[(a+2)%10]&r[(a+4)%10]}t[0]^=s4[n],t[1]^=o4[n]}r.fill(0)}class ya extends va{constructor(e,r,n,i=!1,s=24){if(super(),this.blockLen=e,this.suffix=r,this.outputLen=n,this.enableXOF=i,this.rounds=s,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,si(n),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=Z6(this.state)}keccak(){Rd||Bd(this.state32),a4(this.state32,this.rounds),Rd||Bd(this.state32),this.posOut=0,this.pos=0}update(e){On(this);const{blockLen:r,state:n}=this;e=Tn(e);const i=e.length;for(let s=0;s<i;){const o=Math.min(r-this.pos,i-s);for(let a=0;a<o;a++)n[this.pos++]^=e[s++];this.pos===r&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:r,pos:n,blockLen:i}=this;e[n]^=r,(r&128)!==0&&n===i-1&&this.keccak(),e[i-1]^=128,this.keccak()}writeInto(e){On(this,!1),vs(e),this.finish();const r=this.state,{blockLen:n}=this;for(let i=0,s=e.length;i<s;){this.posOut>=n&&this.keccak();const o=Math.min(n-this.posOut,s-i);e.set(r.subarray(this.posOut,this.posOut+o),i),this.posOut+=o,i+=o}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return si(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(Md(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(e){const{blockLen:r,suffix:n,outputLen:i,rounds:s,enableXOF:o}=this;return e||(e=new ya(r,n,i,o,s)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=s,e.suffix=n,e.outputLen=i,e.enableXOF=o,e.destroyed=this.destroyed,e}}((t,e,r)=>Nd(()=>new ya(e,t,r)))(1,136,256/8);function ma(t){if(!Number.isSafeInteger(t)||t<0)throw new Error("positive integer expected, got "+t)}function zd(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function St(t,...e){if(!zd(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function Ud(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function c4(t,e){St(t);const r=e.outputLen;if(t.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}function kd(t){if(typeof t!="boolean")throw new Error(`boolean expected, not ${t}`)}const Or=t=>new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4)),f4=t=>new DataView(t.buffer,t.byteOffset,t.byteLength);if(!(new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68))throw new Error("Non little-endian hardware is not supported");function u4(t){if(typeof t!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(t))}function wa(t){if(typeof t=="string")t=u4(t);else if(zd(t))t=_a(t);else throw new Error("Uint8Array expected, got "+typeof t);return t}function h4(t,e){if(e==null||typeof e!="object")throw new Error("options must be defined");return Object.assign(t,e)}function d4(t,e){if(t.length!==e.length)return!1;let r=0;for(let n=0;n<t.length;n++)r|=t[n]^e[n];return r===0}const l4=(t,e)=>{function r(n,...i){if(St(n),t.nonceLength!==void 0){const f=i[0];if(!f)throw new Error("nonce / iv required");t.varSizeNonce?St(f):St(f,t.nonceLength)}const s=t.tagLength;s&&i[1]!==void 0&&St(i[1]);const o=e(n,...i),a=(f,h)=>{if(h!==void 0){if(f!==2)throw new Error("cipher output not supported");St(h)}};let c=!1;return{encrypt(f,h){if(c)throw new Error("cannot encrypt() twice with same key + nonce");return c=!0,St(f),a(o.encrypt.length,h),o.encrypt(f,h)},decrypt(f,h){if(St(f),s&&f.length<s)throw new Error("invalid ciphertext length: smaller than tagLength="+s);return a(o.decrypt.length,h),o.decrypt(f,h)}}}return Object.assign(r,t),r};function jd(t,e,r=!0){if(e===void 0)return new Uint8Array(t);if(e.length!==t)throw new Error("invalid output length, expected "+t+", got: "+e.length);if(r&&!b4(e))throw new Error("invalid output, must be aligned");return e}function qd(t,e,r,n){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,r,n);const i=BigInt(32),s=BigInt(4294967295),o=Number(r>>i&s),a=Number(r&s),c=n?4:0,f=n?0:4;t.setUint32(e+c,o,n),t.setUint32(e+f,a,n)}function b4(t){return t.byteOffset%4===0}function _a(t){return Uint8Array.from(t)}function Rn(...t){for(let e=0;e<t.length;e++)t[e].fill(0)}const Hd=t=>Uint8Array.from(t.split("").map(e=>e.charCodeAt(0))),p4=Hd("expand 16-byte k"),g4=Hd("expand 32-byte k"),v4=Or(p4),y4=Or(g4);function Q(t,e){return t<<e|t>>>32-e}function Ea(t){return t.byteOffset%4===0}const ms=64,m4=16,Kd=2**32-1,Vd=new Uint32Array;function w4(t,e,r,n,i,s,o,a){const c=i.length,f=new Uint8Array(ms),h=Or(f),l=Ea(i)&&Ea(s),y=l?Or(i):Vd,_=l?Or(s):Vd;for(let w=0;w<c;o++){if(t(e,r,n,h,o,a),o>=Kd)throw new Error("arx: counter overflow");const A=Math.min(ms,c-w);if(l&&A===ms){const D=w/4;if(w%4!==0)throw new Error("arx: invalid block position");for(let M=0,O;M<m4;M++)O=D+M,_[O]=y[O]^h[M];w+=ms;continue}for(let D=0,M;D<A;D++)M=w+D,s[M]=i[M]^f[D];w+=A}}function _4(t,e){const{allowShortKeys:r,extendNonceFn:n,counterLength:i,counterRight:s,rounds:o}=h4({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},e);if(typeof t!="function")throw new Error("core must be a function");return ma(i),ma(o),kd(s),kd(r),(a,c,f,h,l=0)=>{St(a),St(c),St(f);const y=f.length;if(h===void 0&&(h=new Uint8Array(y)),St(h),ma(l),l<0||l>=Kd)throw new Error("arx: counter overflow");if(h.length<y)throw new Error(`arx: output (${h.length}) is shorter than data (${y})`);const _=[];let w=a.length,A,D;if(w===32)_.push(A=_a(a)),D=y4;else if(w===16&&r)A=new Uint8Array(32),A.set(a),A.set(a,16),D=v4,_.push(A);else throw new Error(`arx: invalid 32-byte key, got length=${w}`);Ea(c)||_.push(c=_a(c));const M=Or(A);if(n){if(c.length!==24)throw new Error("arx: extended nonce must be 24 bytes");n(D,M,Or(c.subarray(0,16)),M),c=c.subarray(16)}const O=16-i;if(O!==c.length)throw new Error(`arx: nonce must be ${O} or 16 bytes`);if(O!==12){const R=new Uint8Array(12);R.set(c,s?0:12-c.length),c=R,_.push(c)}const T=Or(c);return w4(t,D,M,T,f,h,l,o),Rn(..._),h}}const nt=(t,e)=>t[e++]&255|(t[e++]&255)<<8;class E4{constructor(e){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,e=wa(e),St(e,32);const r=nt(e,0),n=nt(e,2),i=nt(e,4),s=nt(e,6),o=nt(e,8),a=nt(e,10),c=nt(e,12),f=nt(e,14);this.r[0]=r&8191,this.r[1]=(r>>>13|n<<3)&8191,this.r[2]=(n>>>10|i<<6)&7939,this.r[3]=(i>>>7|s<<9)&8191,this.r[4]=(s>>>4|o<<12)&255,this.r[5]=o>>>1&8190,this.r[6]=(o>>>14|a<<2)&8191,this.r[7]=(a>>>11|c<<5)&8065,this.r[8]=(c>>>8|f<<8)&8191,this.r[9]=f>>>5&127;for(let h=0;h<8;h++)this.pad[h]=nt(e,16+2*h)}process(e,r,n=!1){const i=n?0:2048,{h:s,r:o}=this,a=o[0],c=o[1],f=o[2],h=o[3],l=o[4],y=o[5],_=o[6],w=o[7],A=o[8],D=o[9],M=nt(e,r+0),O=nt(e,r+2),T=nt(e,r+4),R=nt(e,r+6),z=nt(e,r+8),L=nt(e,r+10),P=nt(e,r+12),$=nt(e,r+14);let B=s[0]+(M&8191),j=s[1]+((M>>>13|O<<3)&8191),S=s[2]+((O>>>10|T<<6)&8191),u=s[3]+((T>>>7|R<<9)&8191),b=s[4]+((R>>>4|z<<12)&8191),g=s[5]+(z>>>1&8191),p=s[6]+((z>>>14|L<<2)&8191),v=s[7]+((L>>>11|P<<5)&8191),x=s[8]+((P>>>8|$<<8)&8191),I=s[9]+($>>>5|i),m=0,d=m+B*a+j*(5*D)+S*(5*A)+u*(5*w)+b*(5*_);m=d>>>13,d&=8191,d+=g*(5*y)+p*(5*l)+v*(5*h)+x*(5*f)+I*(5*c),m+=d>>>13,d&=8191;let E=m+B*c+j*a+S*(5*D)+u*(5*A)+b*(5*w);m=E>>>13,E&=8191,E+=g*(5*_)+p*(5*y)+v*(5*l)+x*(5*h)+I*(5*f),m+=E>>>13,E&=8191;let N=m+B*f+j*c+S*a+u*(5*D)+b*(5*A);m=N>>>13,N&=8191,N+=g*(5*w)+p*(5*_)+v*(5*y)+x*(5*l)+I*(5*h),m+=N>>>13,N&=8191;let C=m+B*h+j*f+S*c+u*a+b*(5*D);m=C>>>13,C&=8191,C+=g*(5*A)+p*(5*w)+v*(5*_)+x*(5*y)+I*(5*l),m+=C>>>13,C&=8191;let F=m+B*l+j*h+S*f+u*c+b*a;m=F>>>13,F&=8191,F+=g*(5*D)+p*(5*A)+v*(5*w)+x*(5*_)+I*(5*y),m+=F>>>13,F&=8191;let k=m+B*y+j*l+S*h+u*f+b*c;m=k>>>13,k&=8191,k+=g*a+p*(5*D)+v*(5*A)+x*(5*w)+I*(5*_),m+=k>>>13,k&=8191;let q=m+B*_+j*y+S*l+u*h+b*f;m=q>>>13,q&=8191,q+=g*c+p*a+v*(5*D)+x*(5*A)+I*(5*w),m+=q>>>13,q&=8191;let V=m+B*w+j*_+S*y+u*l+b*h;m=V>>>13,V&=8191,V+=g*f+p*c+v*a+x*(5*D)+I*(5*A),m+=V>>>13,V&=8191;let Z=m+B*A+j*w+S*_+u*y+b*l;m=Z>>>13,Z&=8191,Z+=g*h+p*f+v*c+x*a+I*(5*D),m+=Z>>>13,Z&=8191;let K=m+B*D+j*A+S*w+u*_+b*y;m=K>>>13,K&=8191,K+=g*l+p*h+v*f+x*c+I*a,m+=K>>>13,K&=8191,m=(m<<2)+m|0,m=m+d|0,d=m&8191,m=m>>>13,E+=m,s[0]=d,s[1]=E,s[2]=N,s[3]=C,s[4]=F,s[5]=k,s[6]=q,s[7]=V,s[8]=Z,s[9]=K}finalize(){const{h:e,pad:r}=this,n=new Uint16Array(10);let i=e[1]>>>13;e[1]&=8191;for(let a=2;a<10;a++)e[a]+=i,i=e[a]>>>13,e[a]&=8191;e[0]+=i*5,i=e[0]>>>13,e[0]&=8191,e[1]+=i,i=e[1]>>>13,e[1]&=8191,e[2]+=i,n[0]=e[0]+5,i=n[0]>>>13,n[0]&=8191;for(let a=1;a<10;a++)n[a]=e[a]+i,i=n[a]>>>13,n[a]&=8191;n[9]-=8192;let s=(i^1)-1;for(let a=0;a<10;a++)n[a]&=s;s=~s;for(let a=0;a<10;a++)e[a]=e[a]&s|n[a];e[0]=(e[0]|e[1]<<13)&65535,e[1]=(e[1]>>>3|e[2]<<10)&65535,e[2]=(e[2]>>>6|e[3]<<7)&65535,e[3]=(e[3]>>>9|e[4]<<4)&65535,e[4]=(e[4]>>>12|e[5]<<1|e[6]<<14)&65535,e[5]=(e[6]>>>2|e[7]<<11)&65535,e[6]=(e[7]>>>5|e[8]<<8)&65535,e[7]=(e[8]>>>8|e[9]<<5)&65535;let o=e[0]+r[0];e[0]=o&65535;for(let a=1;a<8;a++)o=(e[a]+r[a]|0)+(o>>>16)|0,e[a]=o&65535;Rn(n)}update(e){Ud(this);const{buffer:r,blockLen:n}=this;e=wa(e);const i=e.length;for(let s=0;s<i;){const o=Math.min(n-this.pos,i-s);if(o===n){for(;n<=i-s;s+=n)this.process(e,s);continue}r.set(e.subarray(s,s+o),this.pos),this.pos+=o,s+=o,this.pos===n&&(this.process(r,0,!1),this.pos=0)}return this}destroy(){Rn(this.h,this.r,this.buffer,this.pad)}digestInto(e){Ud(this),c4(e,this),this.finished=!0;const{buffer:r,h:n}=this;let{pos:i}=this;if(i){for(r[i++]=1;i<16;i++)r[i]=0;this.process(r,0,!0)}this.finalize();let s=0;for(let o=0;o<8;o++)e[s++]=n[o]>>>0,e[s++]=n[o]>>>8;return e}digest(){const{buffer:e,outputLen:r}=this;this.digestInto(e);const n=e.slice(0,r);return this.destroy(),n}}function x4(t){const e=(n,i)=>t(i).update(wa(n)).digest(),r=t(new Uint8Array(32));return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=n=>t(n),e}const S4=x4(t=>new E4(t));function I4(t,e,r,n,i,s=20){let o=t[0],a=t[1],c=t[2],f=t[3],h=e[0],l=e[1],y=e[2],_=e[3],w=e[4],A=e[5],D=e[6],M=e[7],O=i,T=r[0],R=r[1],z=r[2],L=o,P=a,$=c,B=f,j=h,S=l,u=y,b=_,g=w,p=A,v=D,x=M,I=O,m=T,d=R,E=z;for(let C=0;C<s;C+=2)L=L+j|0,I=Q(I^L,16),g=g+I|0,j=Q(j^g,12),L=L+j|0,I=Q(I^L,8),g=g+I|0,j=Q(j^g,7),P=P+S|0,m=Q(m^P,16),p=p+m|0,S=Q(S^p,12),P=P+S|0,m=Q(m^P,8),p=p+m|0,S=Q(S^p,7),$=$+u|0,d=Q(d^$,16),v=v+d|0,u=Q(u^v,12),$=$+u|0,d=Q(d^$,8),v=v+d|0,u=Q(u^v,7),B=B+b|0,E=Q(E^B,16),x=x+E|0,b=Q(b^x,12),B=B+b|0,E=Q(E^B,8),x=x+E|0,b=Q(b^x,7),L=L+S|0,E=Q(E^L,16),v=v+E|0,S=Q(S^v,12),L=L+S|0,E=Q(E^L,8),v=v+E|0,S=Q(S^v,7),P=P+u|0,I=Q(I^P,16),x=x+I|0,u=Q(u^x,12),P=P+u|0,I=Q(I^P,8),x=x+I|0,u=Q(u^x,7),$=$+b|0,m=Q(m^$,16),g=g+m|0,b=Q(b^g,12),$=$+b|0,m=Q(m^$,8),g=g+m|0,b=Q(b^g,7),B=B+j|0,d=Q(d^B,16),p=p+d|0,j=Q(j^p,12),B=B+j|0,d=Q(d^B,8),p=p+d|0,j=Q(j^p,7);let N=0;n[N++]=o+L|0,n[N++]=a+P|0,n[N++]=c+$|0,n[N++]=f+B|0,n[N++]=h+j|0,n[N++]=l+S|0,n[N++]=y+u|0,n[N++]=_+b|0,n[N++]=w+g|0,n[N++]=A+p|0,n[N++]=D+v|0,n[N++]=M+x|0,n[N++]=O+I|0,n[N++]=T+m|0,n[N++]=R+d|0,n[N++]=z+E|0}const A4=_4(I4,{counterRight:!1,counterLength:4,allowShortKeys:!1}),D4=new Uint8Array(16),Wd=(t,e)=>{t.update(e);const r=e.length%16;r&&t.update(D4.subarray(r))},O4=new Uint8Array(32);function Yd(t,e,r,n,i){const s=t(e,r,O4),o=S4.create(s);i&&Wd(o,i),Wd(o,n);const a=new Uint8Array(16),c=f4(a);qd(c,0,BigInt(i?i.length:0),!0),qd(c,8,BigInt(n.length),!0),o.update(a);const f=o.digest();return Rn(s,a),f}const M4=t=>(e,r,n)=>({encrypt(i,s){const o=i.length;s=jd(o+16,s,!1),s.set(i);const a=s.subarray(0,-16);t(e,r,a,a,1);const c=Yd(t,e,r,a,n);return s.set(c,o),Rn(c),s},decrypt(i,s){s=jd(i.length-16,s,!1);const o=i.subarray(0,-16),a=i.subarray(-16),c=Yd(t,e,r,o,n);if(!d4(a,c))throw new Error("invalid tag");return s.set(i.subarray(0,-16)),t(e,r,s,s,1),Rn(c),s}}),Gd=l4({blockSize:64,nonceLength:12,tagLength:16},M4(A4));class Xd extends va{constructor(e,r){super(),this.finished=!1,this.destroyed=!1,pa(e);const n=Tn(r);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const i=this.blockLen,s=new Uint8Array(i);s.set(n.length>i?e.create().update(n).digest():n);for(let o=0;o<s.length;o++)s[o]^=54;this.iHash.update(s),this.oHash=e.create();for(let o=0;o<s.length;o++)s[o]^=106;this.oHash.update(s),s.fill(0)}update(e){return On(this),this.iHash.update(e),this}digestInto(e){On(this),vs(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:r,iHash:n,finished:i,destroyed:s,blockLen:o,outputLen:a}=this;return e=e,e.finished=i,e.destroyed=s,e.blockLen=o,e.outputLen=a,e.oHash=r._cloneInto(e.oHash),e.iHash=n._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const xa=(t,e,r)=>new Xd(t,e).update(r).digest();xa.create=(t,e)=>new Xd(t,e);function T4(t,e,r){return pa(t),r===void 0&&(r=new Uint8Array(t.outputLen)),xa(t,Tn(r),Tn(e))}const Sa=new Uint8Array([0]),Zd=new Uint8Array;function R4(t,e,r,n=32){if(pa(t),si(n),n>255*t.outputLen)throw new Error("Length should be <= 255*HashLen");const i=Math.ceil(n/t.outputLen);r===void 0&&(r=Zd);const s=new Uint8Array(i*t.outputLen),o=xa.create(t,e),a=o._cloneInto(),c=new Uint8Array(o.outputLen);for(let f=0;f<i;f++)Sa[0]=f+1,a.update(f===0?Zd:c).update(r).update(Sa).digestInto(c),s.set(c,t.outputLen*f),o._cloneInto(a);return o.destroy(),a.destroy(),c.fill(0),Sa.fill(0),s.slice(0,n)}const B4=(t,e,r,n,i)=>R4(t,T4(t,e,r),n,i);function N4(t,e,r,n){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,r,n);const i=BigInt(32),s=BigInt(4294967295),o=Number(r>>i&s),a=Number(r&s),c=n?4:0,f=n?0:4;t.setUint32(e+c,o,n),t.setUint32(e+f,a,n)}function P4(t,e,r){return t&e^~t&r}function C4(t,e,r){return t&e^t&r^e&r}class $4 extends va{constructor(e,r,n,i){super(),this.blockLen=e,this.outputLen=r,this.padOffset=n,this.isLE=i,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=ga(this.buffer)}update(e){On(this);const{view:r,buffer:n,blockLen:i}=this;e=Tn(e);const s=e.length;for(let o=0;o<s;){const a=Math.min(i-this.pos,s-o);if(a===i){const c=ga(e);for(;i<=s-o;o+=i)this.process(c,o);continue}n.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===i&&(this.process(r,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){On(this),Md(e,this),this.finished=!0;const{buffer:r,view:n,blockLen:i,isLE:s}=this;let{pos:o}=this;r[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>i-o&&(this.process(n,0),o=0);for(let l=o;l<i;l++)r[l]=0;N4(n,i-8,BigInt(this.length*8),s),this.process(n,0);const a=ga(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const f=c/4,h=this.get();if(f>h.length)throw new Error("_sha2: outputLen bigger than state");for(let l=0;l<f;l++)a.setUint32(4*l,h[l],s)}digest(){const{buffer:e,outputLen:r}=this;this.digestInto(e);const n=e.slice(0,r);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:r,buffer:n,length:i,finished:s,destroyed:o,pos:a}=this;return e.length=i,e.pos=a,e.finished=s,e.destroyed=o,i%r&&e.buffer.set(n),e}}const L4=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Mr=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Tr=new Uint32Array(64);class F4 extends $4{constructor(){super(64,32,8,!1),this.A=Mr[0]|0,this.B=Mr[1]|0,this.C=Mr[2]|0,this.D=Mr[3]|0,this.E=Mr[4]|0,this.F=Mr[5]|0,this.G=Mr[6]|0,this.H=Mr[7]|0}get(){const{A:e,B:r,C:n,D:i,E:s,F:o,G:a,H:c}=this;return[e,r,n,i,s,o,a,c]}set(e,r,n,i,s,o,a,c){this.A=e|0,this.B=r|0,this.C=n|0,this.D=i|0,this.E=s|0,this.F=o|0,this.G=a|0,this.H=c|0}process(e,r){for(let l=0;l<16;l++,r+=4)Tr[l]=e.getUint32(r,!1);for(let l=16;l<64;l++){const y=Tr[l-15],_=Tr[l-2],w=nr(y,7)^nr(y,18)^y>>>3,A=nr(_,17)^nr(_,19)^_>>>10;Tr[l]=A+Tr[l-7]+w+Tr[l-16]|0}let{A:n,B:i,C:s,D:o,E:a,F:c,G:f,H:h}=this;for(let l=0;l<64;l++){const y=nr(a,6)^nr(a,11)^nr(a,25),_=h+y+P4(a,c,f)+L4[l]+Tr[l]|0,w=(nr(n,2)^nr(n,13)^nr(n,22))+C4(n,i,s)|0;h=f,f=c,c=a,a=o+_|0,o=s,s=i,i=n,n=_+w|0}n=n+this.A|0,i=i+this.B|0,s=s+this.C|0,o=o+this.D|0,a=a+this.E|0,c=c+this.F|0,f=f+this.G|0,h=h+this.H|0,this.set(n,i,s,o,a,c,f,h)}roundClean(){Tr.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}const ws=Nd(()=>new F4);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Jd=BigInt(0);function Ia(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function Qd(t){if(!Ia(t))throw new Error("Uint8Array expected")}const z4=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function U4(t){Qd(t);let e="";for(let r=0;r<t.length;r++)e+=z4[t[r]];return e}function k4(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return t===""?Jd:BigInt("0x"+t)}const pr={_0:48,_9:57,A:65,F:70,a:97,f:102};function el(t){if(t>=pr._0&&t<=pr._9)return t-pr._0;if(t>=pr.A&&t<=pr.F)return t-(pr.A-10);if(t>=pr.a&&t<=pr.f)return t-(pr.a-10)}function tl(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);const e=t.length,r=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);const n=new Uint8Array(r);for(let i=0,s=0;i<r;i++,s+=2){const o=el(t.charCodeAt(s)),a=el(t.charCodeAt(s+1));if(o===void 0||a===void 0){const c=t[s]+t[s+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+s)}n[i]=o*16+a}return n}function rl(t){return Qd(t),k4(U4(Uint8Array.from(t).reverse()))}function j4(t,e){return tl(t.toString(16).padStart(e*2,"0"))}function q4(t,e){return j4(t,e).reverse()}function nl(t,e,r){let n;if(typeof e=="string")try{n=tl(e)}catch(s){throw new Error(t+" must be hex string or Uint8Array, cause: "+s)}else if(Ia(e))n=Uint8Array.from(e);else throw new Error(t+" must be hex string or Uint8Array");const i=n.length;if(typeof r=="number"&&i!==r)throw new Error(t+" of length "+r+" expected, got "+i);return n}const Aa=t=>typeof t=="bigint"&&Jd<=t;function H4(t,e,r){return Aa(t)&&Aa(e)&&Aa(r)&&e<=t&&t<r}function il(t,e,r,n){if(!H4(e,r,n))throw new Error("expected valid "+t+": "+r+" <= n < "+n+", got "+e)}const K4={bigint:t=>typeof t=="bigint",function:t=>typeof t=="function",boolean:t=>typeof t=="boolean",string:t=>typeof t=="string",stringOrUint8Array:t=>typeof t=="string"||Ia(t),isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>typeof t=="function"&&Number.isSafeInteger(t.outputLen)};function V4(t,e,r={}){const n=(i,s,o)=>{const a=K4[s];if(typeof a!="function")throw new Error("invalid validator function");const c=t[i];if(!(o&&c===void 0)&&!a(c,t))throw new Error("param "+String(i)+" is invalid. Expected "+s+", got "+c)};for(const[i,s]of Object.entries(e))n(i,s,!1);for(const[i,s]of Object.entries(r))n(i,s,!0);return t}const Bn=BigInt(0),_s=BigInt(1);function sl(t,e){const r=t%e;return r>=Bn?r:e+r}function W4(t,e,r){if(e<Bn)throw new Error("invalid exponent, negatives unsupported");if(r<=Bn)throw new Error("invalid modulus");if(r===_s)return Bn;let n=_s;for(;e>Bn;)e&_s&&(n=n*t%r),t=t*t%r,e>>=_s;return n}function jt(t,e,r){let n=t;for(;e-- >Bn;)n*=n,n%=r;return n}BigInt(0),BigInt(1),BigInt(0),BigInt(1),BigInt(2),BigInt(8);const Nn=BigInt(0),Da=BigInt(1);function Y4(t){return V4(t,{a:"bigint"},{montgomeryBits:"isSafeInteger",nByteLength:"isSafeInteger",adjustScalarBytes:"function",domain:"function",powPminus2:"function",Gu:"bigint"}),Object.freeze(M6({},t))}function G4(t){const e=Y4(t),{P:r}=e,n=O=>sl(O,r),i=e.montgomeryBits,s=Math.ceil(i/8),o=e.nByteLength,a=e.adjustScalarBytes||(O=>O),c=e.powPminus2||(O=>W4(O,r-BigInt(2),r));function f(O,T,R){const z=n(O*(T-R));return T=n(T-z),R=n(R+z),[T,R]}const h=(e.a-BigInt(2))/BigInt(4);function l(O,T){il("u",O,Nn,r),il("scalar",T,Nn,r);const R=T,z=O;let L=Da,P=Nn,$=O,B=Da,j=Nn,S;for(let b=BigInt(i-1);b>=Nn;b--){const g=R>>b&Da;j^=g,S=f(j,L,$),L=S[0],$=S[1],S=f(j,P,B),P=S[0],B=S[1],j=g;const p=L+P,v=n(p*p),x=L-P,I=n(x*x),m=v-I,d=$+B,E=$-B,N=n(E*p),C=n(d*x),F=N+C,k=N-C;$=n(F*F),B=n(z*n(k*k)),L=n(v*I),P=n(m*(v+n(h*m)))}S=f(j,L,$),L=S[0],$=S[1],S=f(j,P,B),P=S[0],B=S[1];const u=c(P);return n(L*u)}function y(O){return q4(n(O),s)}function _(O){const T=nl("u coordinate",O,s);return o===32&&(T[31]&=127),rl(T)}function w(O){const T=nl("scalar",O),R=T.length;if(R!==s&&R!==o){let z=""+s+" or "+o;throw new Error("invalid scalar, expected "+z+" bytes, got "+R)}return rl(a(T))}function A(O,T){const R=_(T),z=w(O),L=l(R,z);if(L===Nn)throw new Error("invalid private or public key received");return y(L)}const D=y(e.Gu);function M(O){return A(O,D)}return{scalarMult:A,scalarMultBase:M,getSharedSecret:(O,T)=>A(O,T),getPublicKey:O=>M(O),utils:{randomPrivateKey:()=>e.randomBytes(e.nByteLength)},GuBytes:D}}const Oa=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949");BigInt(0);const X4=BigInt(1),ol=BigInt(2),Z4=BigInt(3),J4=BigInt(5);BigInt(8);function Q4(t){const e=BigInt(10),r=BigInt(20),n=BigInt(40),i=BigInt(80),s=Oa,o=t*t%s*t%s,a=jt(o,ol,s)*o%s,c=jt(a,X4,s)*t%s,f=jt(c,J4,s)*c%s,h=jt(f,e,s)*f%s,l=jt(h,r,s)*h%s,y=jt(l,n,s)*l%s,_=jt(y,i,s)*y%s,w=jt(_,i,s)*y%s,A=jt(w,e,s)*f%s;return{pow_p_5_8:jt(A,ol,s)*t%s,b2:o}}function e5(t){return t[0]&=248,t[31]&=127,t[31]|=64,t}const Ma=G4({P:Oa,a:BigInt(486662),montgomeryBits:255,nByteLength:32,Gu:BigInt(9),powPminus2:t=>{const e=Oa,{pow_p_5_8:r,b2:n}=Q4(t);return sl(jt(r,Z4,e)*n,e)},adjustScalarBytes:e5,randomBytes:oi}),al="base10",at="base16",Es="base64pad",ci="utf8",cl=0,Pn=1,xs=2,t5=0,fl=1,fi=12,Ta=32;function r5(){const t=Ma.utils.randomPrivateKey(),e=Ma.getPublicKey(t);return{privateKey:ht(t,at),publicKey:ht(e,at)}}function Ra(){const t=oi(Ta);return ht(t,at)}function n5(t,e){const r=Ma.getSharedSecret(Et(t,at),Et(e,at)),n=B4(ws,r,void 0,void 0,Ta);return ht(n,at)}function i5(t){const e=ws(Et(t,at));return ht(e,at)}function Ss(t){const e=ws(Et(t,ci));return ht(e,at)}function ul(t){return Et(`${t}`,al)}function Xr(t){return Number(ht(t,al))}function s5(t){const e=ul(typeof t.type<"u"?t.type:cl);if(Xr(e)===Pn&&typeof t.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const r=typeof t.senderPublicKey<"u"?Et(t.senderPublicKey,at):void 0,n=typeof t.iv<"u"?Et(t.iv,at):oi(fi),i=Et(t.symKey,at),s=Gd(i,n).encrypt(Et(t.message,ci));return hl({type:e,sealed:s,iv:n,senderPublicKey:r,encoding:t.encoding})}function o5(t){const e=Et(t.symKey,at),{sealed:r,iv:n}=ui(t),i=Gd(e,n).decrypt(r);if(i===null)throw new Error("Failed to decrypt");return ht(i,ci)}function a5(t,e){const r=ul(xs),n=oi(fi),i=Et(t,ci);return hl({type:r,sealed:i,iv:n,encoding:e})}function c5(t,e){const{sealed:r}=ui({encoded:t,encoding:e});return ht(r,ci)}function hl(t){const{encoding:e=Es}=t;if(Xr(t.type)===xs)return ht(Go([t.type,t.sealed]),e);if(Xr(t.type)===Pn){if(typeof t.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return ht(Go([t.type,t.senderPublicKey,t.iv,t.sealed]),e)}return ht(Go([t.type,t.iv,t.sealed]),e)}function ui(t){const{encoded:e,encoding:r=Es}=t,n=Et(e,r),i=n.slice(t5,fl),s=fl;if(Xr(i)===Pn){const f=s+Ta,h=f+fi,l=n.slice(s,f),y=n.slice(f,h),_=n.slice(h);return{type:i,sealed:_,iv:y,senderPublicKey:l}}if(Xr(i)===xs){const f=n.slice(s),h=oi(fi);return{type:i,sealed:f,iv:h}}const o=s+fi,a=n.slice(s,o),c=n.slice(o);return{type:i,sealed:c,iv:a}}function f5(t,e){const r=ui({encoded:t,encoding:e?.encoding});return dl({type:Xr(r.type),senderPublicKey:typeof r.senderPublicKey<"u"?ht(r.senderPublicKey,at):void 0,receiverPublicKey:e?.receiverPublicKey})}function dl(t){const e=t?.type||cl;if(e===Pn){if(typeof t?.senderPublicKey>"u")throw new Error("missing sender public key");if(typeof t?.receiverPublicKey>"u")throw new Error("missing receiver public key")}return{type:e,senderPublicKey:t?.senderPublicKey,receiverPublicKey:t?.receiverPublicKey}}function ll(t){return t.type===Pn&&typeof t.senderPublicKey=="string"&&typeof t.receiverPublicKey=="string"}function bl(t){return t.type===xs}function u5(t){return new Lh.ec("p256").keyFromPublic({x:Buffer.from(t.x,"base64").toString("hex"),y:Buffer.from(t.y,"base64").toString("hex")},"hex")}function h5(t){let e=t.replace(/-/g,"+").replace(/_/g,"/");const r=e.length%4;return r>0&&(e+="=".repeat(4-r)),e}function d5(t){return Buffer.from(h5(t),"base64")}function l5(t,e){const[r,n,i]=t.split("."),s=d5(i);if(s.length!==64)throw new Error("Invalid signature length");const o=s.slice(0,32).toString("hex"),a=s.slice(32,64).toString("hex"),c=`${r}.${n}`,f=ws(c),h=u5(e),l=ht(f,at);if(!h.verify(l,{r:o,s:a}))throw new Error("Invalid signature");return wo(t).payload}const b5="irn";function Is(t){return t?.relay||{protocol:b5}}function hi(t){const e=I6[t];if(typeof e>"u")throw new Error(`Relay Protocol not supported: ${t}`);return e}function p5(t,e="-"){const r={},n="relay"+e;return Object.keys(t).forEach(i=>{if(i.startsWith(n)){const s=i.replace(n,""),o=t[i];r[s]=o}}),r}function pl(t){if(!t.includes("wc:")){const f=Od(t);f!=null&&f.includes("wc:")&&(t=f)}t=t.includes("wc://")?t.replace("wc://",""):t,t=t.includes("wc:")?t.replace("wc:",""):t;const e=t.indexOf(":"),r=t.indexOf("?")!==-1?t.indexOf("?"):void 0,n=t.substring(0,e),i=t.substring(e+1,r).split("@"),s=typeof r<"u"?t.substring(r):"",o=new URLSearchParams(s),a={};o.forEach((f,h)=>{a[h]=f});const c=typeof a.methods=="string"?a.methods.split(","):void 0;return{protocol:n,topic:g5(i[0]),version:parseInt(i[1],10),symKey:a.symKey,relay:p5(a),methods:c,expiryTimestamp:a.expiryTimestamp?parseInt(a.expiryTimestamp,10):void 0}}function g5(t){return t.startsWith("//")?t.substring(2):t}function v5(t,e="-"){const r="relay",n={};return Object.keys(t).forEach(i=>{const s=i,o=r+e+s;t[s]&&(n[o]=t[s])}),n}function gl(t){const e=new URLSearchParams,r=v5(t.relay);Object.keys(r).sort().forEach(i=>{e.set(i,r[i])}),e.set("symKey",t.symKey),t.expiryTimestamp&&e.set("expiryTimestamp",t.expiryTimestamp.toString()),t.methods&&e.set("methods",t.methods.join(","));const n=e.toString();return`${t.protocol}:${t.topic}@${t.version}?${n}`}const y5={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},m5={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function te(t,e){const{message:r,code:n}=m5[t];return{message:e?`${r} ${e}`:r,code:n}}function di(t,e){const{message:r,code:n}=y5[t];return{message:e?`${r} ${e}`:r,code:n}}function As(t){return typeof t>"u"}function vl(t,e){return e&&As(t)?!0:typeof t=="string"&&!!t.trim().length}function w5(t){function e(r){try{return typeof new URL(r)<"u"}catch{return!1}}try{if(vl(t,!1)){if(e(t))return!0;const r=Od(t);return e(r)}}catch{}return!1}function _5(t){var e;return(e=t?.proposer)==null?void 0:e.publicKey}function E5(t){return t?.topic}function Ba(t){return typeof t<"u"&&typeof t!==null}function yl(){const t=gs();return new Promise(e=>{switch(t){case kt.browser:e(x5());break;case kt.reactNative:e(S5());break;case kt.node:e(I5());break;default:e(!0)}})}function x5(){return ps()&&navigator?.onLine}async function S5(){if(Gr()&&typeof global<"u"&&global!=null&&global.NetInfo){const t=await(global==null?void 0:global.NetInfo.fetch());return t?.isConnected}return!0}function I5(){return!0}function A5(t){switch(gs()){case kt.browser:D5(t);break;case kt.reactNative:O5(t);break}}function D5(t){!Gr()&&ps()&&(window.addEventListener("online",()=>t(!0)),window.addEventListener("offline",()=>t(!1)))}function O5(t){Gr()&&typeof global<"u"&&global!=null&&global.NetInfo&&global?.NetInfo.addEventListener(e=>t(e?.isConnected))}var M5=Object.defineProperty,T5=(t,e,r)=>e in t?M5(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,ir=(t,e,r)=>T5(t,typeof e!="symbol"?e+"":e,r);class ml{constructor(e,r){this.core=e,this.logger=r,ir(this,"keychain",new Map),ir(this,"name",tf),ir(this,"version",rf),ir(this,"initialized",!1),ir(this,"storagePrefix",Ct),ir(this,"init",async()=>{if(!this.initialized){const n=await this.getKeyChain();typeof n<"u"&&(this.keychain=n),this.initialized=!0}}),ir(this,"has",n=>(this.isInitialized(),this.keychain.has(n))),ir(this,"set",async(n,i)=>{this.isInitialized(),this.keychain.set(n,i),await this.persist()}),ir(this,"get",n=>{this.isInitialized();const i=this.keychain.get(n);if(typeof i>"u"){const{message:s}=te("NO_MATCHING_KEY",`${this.name}: ${n}`);throw new Error(s)}return i}),ir(this,"del",async n=>{this.isInitialized(),this.keychain.delete(n),await this.persist()}),this.core=e,this.logger=lt(r,this.name)}get context(){return wt(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(e){await this.core.storage.setItem(this.storageKey,da(e))}async getKeyChain(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?la(e):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:e}=te("NOT_INITIALIZED",this.name);throw new Error(e)}}}var R5=Object.defineProperty,B5=(t,e,r)=>e in t?R5(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,it=(t,e,r)=>B5(t,typeof e!="symbol"?e+"":e,r);class wl{constructor(e,r,n){this.core=e,this.logger=r,it(this,"name",Qc),it(this,"keychain"),it(this,"randomSessionIdentifier",Ra()),it(this,"initialized",!1),it(this,"init",async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)}),it(this,"hasKeys",i=>(this.isInitialized(),this.keychain.has(i))),it(this,"getClientId",async()=>{this.isInitialized();const i=await this.getClientSeed(),s=Iu(i);return Su(s.publicKey)}),it(this,"generateKeyPair",()=>{this.isInitialized();const i=r5();return this.setPrivateKey(i.publicKey,i.privateKey)}),it(this,"signJWT",async i=>{this.isInitialized();const s=await this.getClientSeed(),o=Iu(s),a=this.randomSessionIdentifier;return await x2(a,i,ef,o)}),it(this,"generateSharedKey",(i,s,o)=>{this.isInitialized();const a=this.getPrivateKey(i),c=n5(a,s);return this.setSymKey(c,o)}),it(this,"setSymKey",async(i,s)=>{this.isInitialized();const o=s||i5(i);return await this.keychain.set(o,i),o}),it(this,"deleteKeyPair",async i=>{this.isInitialized(),await this.keychain.del(i)}),it(this,"deleteSymKey",async i=>{this.isInitialized(),await this.keychain.del(i)}),it(this,"encode",async(i,s,o)=>{this.isInitialized();const a=dl(o),c=Cr(s);if(bl(a))return a5(c,o?.encoding);if(ll(a)){const y=a.senderPublicKey,_=a.receiverPublicKey;i=await this.generateSharedKey(y,_)}const f=this.getSymKey(i),{type:h,senderPublicKey:l}=a;return s5({type:h,symKey:f,message:c,senderPublicKey:l,encoding:o?.encoding})}),it(this,"decode",async(i,s,o)=>{this.isInitialized();const a=f5(s,o);if(bl(a)){const c=c5(s,o?.encoding);return en(c)}if(ll(a)){const c=a.receiverPublicKey,f=a.senderPublicKey;i=await this.generateSharedKey(c,f)}try{const c=this.getSymKey(i),f=o5({symKey:c,encoded:s,encoding:o?.encoding});return en(f)}catch(c){this.logger.error(`Failed to decode message from topic: '${i}', clientId: '${await this.getClientId()}'`),this.logger.error(c)}}),it(this,"getPayloadType",(i,s=Es)=>{const o=ui({encoded:i,encoding:s});return Xr(o.type)}),it(this,"getPayloadSenderPublicKey",(i,s=Es)=>{const o=ui({encoded:i,encoding:s});return o.senderPublicKey?ht(o.senderPublicKey,at):void 0}),this.core=e,this.logger=lt(r,this.name),this.keychain=n||new ml(this.core,this.logger)}get context(){return wt(this.logger)}async setPrivateKey(e,r){return await this.keychain.set(e,r),e}getPrivateKey(e){return this.keychain.get(e)}async getClientSeed(){let e="";try{e=this.keychain.get(Gs)}catch{e=Ra(),await this.keychain.set(Gs,e)}return Et(e,"base16")}getSymKey(e){return this.keychain.get(e)}isInitialized(){if(!this.initialized){const{message:e}=te("NOT_INITIALIZED",this.name);throw new Error(e)}}}var N5=Object.defineProperty,P5=Object.defineProperties,C5=Object.getOwnPropertyDescriptors,_l=Object.getOwnPropertySymbols,$5=Object.prototype.hasOwnProperty,L5=Object.prototype.propertyIsEnumerable,Na=(t,e,r)=>e in t?N5(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,F5=(t,e)=>{for(var r in e||(e={}))$5.call(e,r)&&Na(t,r,e[r]);if(_l)for(var r of _l(e))L5.call(e,r)&&Na(t,r,e[r]);return t},z5=(t,e)=>P5(t,C5(e)),It=(t,e,r)=>Na(t,typeof e!="symbol"?e+"":e,r);class El extends bb{constructor(e,r){super(e,r),this.logger=e,this.core=r,It(this,"messages",new Map),It(this,"messagesWithoutClientAck",new Map),It(this,"name",nf),It(this,"version",sf),It(this,"initialized",!1),It(this,"storagePrefix",Ct),It(this,"init",async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const n=await this.getRelayerMessages();typeof n<"u"&&(this.messages=n);const i=await this.getRelayerMessagesWithoutClientAck();typeof i<"u"&&(this.messagesWithoutClientAck=i),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(n){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(n)}finally{this.initialized=!0}}}),It(this,"set",async(n,i,s)=>{this.isInitialized();const o=Ss(i);let a=this.messages.get(n);if(typeof a>"u"&&(a={}),typeof a[o]<"u")return o;if(a[o]=i,this.messages.set(n,a),s===Hn.inbound){const c=this.messagesWithoutClientAck.get(n)||{};this.messagesWithoutClientAck.set(n,z5(F5({},c),{[o]:i}))}return await this.persist(),o}),It(this,"get",n=>{this.isInitialized();let i=this.messages.get(n);return typeof i>"u"&&(i={}),i}),It(this,"getWithoutAck",n=>{this.isInitialized();const i={};for(const s of n){const o=this.messagesWithoutClientAck.get(s)||{};i[s]=Object.values(o)}return i}),It(this,"has",(n,i)=>{this.isInitialized();const s=this.get(n),o=Ss(i);return typeof s[o]<"u"}),It(this,"ack",async(n,i)=>{this.isInitialized();const s=this.messagesWithoutClientAck.get(n);if(typeof s>"u")return;const o=Ss(i);delete s[o],Object.keys(s).length===0?this.messagesWithoutClientAck.delete(n):this.messagesWithoutClientAck.set(n,s),await this.persist()}),It(this,"del",async n=>{this.isInitialized(),this.messages.delete(n),this.messagesWithoutClientAck.delete(n),await this.persist()}),this.logger=lt(e,this.name),this.core=r}get context(){return wt(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get storageKeyWithoutClientAck(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name+"_withoutClientAck"}async setRelayerMessages(e){await this.core.storage.setItem(this.storageKey,da(e))}async setRelayerMessagesWithoutClientAck(e){await this.core.storage.setItem(this.storageKeyWithoutClientAck,da(e))}async getRelayerMessages(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?la(e):void 0}async getRelayerMessagesWithoutClientAck(){const e=await this.core.storage.getItem(this.storageKeyWithoutClientAck);return typeof e<"u"?la(e):void 0}async persist(){await this.setRelayerMessages(this.messages),await this.setRelayerMessagesWithoutClientAck(this.messagesWithoutClientAck)}isInitialized(){if(!this.initialized){const{message:e}=te("NOT_INITIALIZED",this.name);throw new Error(e)}}}const U5="PARSE_ERROR",k5="INVALID_REQUEST",j5="METHOD_NOT_FOUND",q5="INVALID_PARAMS",xl="INTERNAL_ERROR",Pa="SERVER_ERROR",H5=[-32700,-32600,-32601,-32602,-32603],li={[U5]:{code:-32700,message:"Parse error"},[k5]:{code:-32600,message:"Invalid Request"},[j5]:{code:-32601,message:"Method not found"},[q5]:{code:-32602,message:"Invalid params"},[xl]:{code:-32603,message:"Internal error"},[Pa]:{code:-32e3,message:"Server error"}},Sl=Pa;function K5(t){return H5.includes(t)}function Il(t){return Object.keys(li).includes(t)?li[t]:li[Sl]}function V5(t){const e=Object.values(li).find(r=>r.code===t);return e||li[Sl]}function W5(t,e,r){return t.message.includes("getaddrinfo ENOTFOUND")||t.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${r} RPC url at ${e}`):t}var Al={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var Ca=function(t,e){return Ca=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},Ca(t,e)};function Y5(t,e){Ca(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var $a=function(){return $a=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},$a.apply(this,arguments)};function G5(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}function X5(t,e,r,n){var i=arguments.length,s=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,r):n,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,r,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,r,s):o(e,r))||s);return i>3&&s&&Object.defineProperty(e,r,s),s}function Z5(t,e){return function(r,n){e(r,n,t)}}function J5(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function Q5(t,e,r,n){function i(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function a(h){try{f(n.next(h))}catch(l){o(l)}}function c(h){try{f(n.throw(h))}catch(l){o(l)}}function f(h){h.done?s(h.value):i(h.value).then(a,c)}f((n=n.apply(t,e||[])).next())})}function ew(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(f){return function(h){return c([f,h])}}function c(f){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(s=f[0]&2?i.return:f[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,f[1])).done)return s;switch(i=0,s&&(f=[f[0]&2,s.value]),f[0]){case 0:case 1:s=f;break;case 4:return r.label++,{value:f[1],done:!1};case 5:r.label++,i=f[1],f=[0];continue;case 7:f=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(f[0]===6||f[0]===2)){r=0;continue}if(f[0]===3&&(!s||f[1]>s[0]&&f[1]<s[3])){r.label=f[1];break}if(f[0]===6&&r.label<s[1]){r.label=s[1],s=f;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(f);break}s[2]&&r.ops.pop(),r.trys.pop();continue}f=e.call(t,r)}catch(h){f=[6,h],i=0}finally{n=s=0}if(f[0]&5)throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}}function tw(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}function rw(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function La(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Dl(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),i,s=[],o;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(a){o={error:a}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return s}function nw(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(Dl(arguments[e]));return t}function iw(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var n=Array(t),i=0,e=0;e<r;e++)for(var s=arguments[e],o=0,a=s.length;o<a;o++,i++)n[i]=s[o];return n}function bi(t){return this instanceof bi?(this.v=t,this):new bi(t)}function sw(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(t,e||[]),i,s=[];return i={},o("next"),o("throw"),o("return"),i[Symbol.asyncIterator]=function(){return this},i;function o(y){n[y]&&(i[y]=function(_){return new Promise(function(w,A){s.push([y,_,w,A])>1||a(y,_)})})}function a(y,_){try{c(n[y](_))}catch(w){l(s[0][3],w)}}function c(y){y.value instanceof bi?Promise.resolve(y.value.v).then(f,h):l(s[0][2],y)}function f(y){a("next",y)}function h(y){a("throw",y)}function l(y,_){y(_),s.shift(),s.length&&a(s[0][0],s[0][1])}}function ow(t){var e,r;return e={},n("next"),n("throw",function(i){throw i}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(i,s){e[i]=t[i]?function(o){return(r=!r)?{value:bi(t[i](o)),done:i==="return"}:s?s(o):o}:s}}function aw(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof La=="function"?La(t):t[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(s){r[s]=t[s]&&function(o){return new Promise(function(a,c){o=t[s](o),i(a,c,o.done,o.value)})}}function i(s,o,a,c){Promise.resolve(c).then(function(f){s({value:f,done:a})},o)}}function cw(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function fw(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function uw(t){return t&&t.__esModule?t:{default:t}}function hw(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function dw(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}var lw=Object.freeze({__proto__:null,__extends:Y5,get __assign(){return $a},__rest:G5,__decorate:X5,__param:Z5,__metadata:J5,__awaiter:Q5,__generator:ew,__createBinding:tw,__exportStar:rw,__values:La,__read:Dl,__spread:nw,__spreadArrays:iw,__await:bi,__asyncGenerator:sw,__asyncDelegator:ow,__asyncValues:aw,__makeTemplateObject:cw,__importStar:fw,__importDefault:uw,__classPrivateFieldGet:hw,__classPrivateFieldSet:dw}),bw=Bs(lw),gr={},Ol;function pw(){if(Ol)return gr;Ol=1,Object.defineProperty(gr,"__esModule",{value:!0}),gr.isBrowserCryptoAvailable=gr.getSubtleCrypto=gr.getBrowerCrypto=void 0;function t(){return Pt?.crypto||Pt?.msCrypto||{}}gr.getBrowerCrypto=t;function e(){const n=t();return n.subtle||n.webkitSubtle}gr.getSubtleCrypto=e;function r(){return!!t()&&!!e()}return gr.isBrowserCryptoAvailable=r,gr}var vr={},Ml;function gw(){if(Ml)return vr;Ml=1,Object.defineProperty(vr,"__esModule",{value:!0}),vr.isBrowser=vr.isNode=vr.isReactNative=void 0;function t(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}vr.isReactNative=t;function e(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}vr.isNode=e;function r(){return!t()&&!e()}return vr.isBrowser=r,vr}(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=bw;e.__exportStar(pw(),t),e.__exportStar(gw(),t)})(Al);function Tl(t=3){const e=Date.now()*Math.pow(10,t),r=Math.floor(Math.random()*Math.pow(10,t));return e+r}function Fa(t=6){return BigInt(Tl(t))}function za(t,e,r){return{id:r||Tl(),jsonrpc:"2.0",method:t,params:e}}function Rl(t,e){return{id:t,jsonrpc:"2.0",result:e}}function Bl(t,e,r){return{id:t,jsonrpc:"2.0",error:vw(e,r)}}function vw(t,e){return typeof t>"u"?Il(xl):(typeof t=="string"&&(t=Object.assign(Object.assign({},Il(Pa)),{message:t})),typeof e<"u"&&(t.data=e),K5(t.code)&&(t=V5(t.code)),t)}class yw{}class mw extends yw{constructor(){super()}}class ww extends mw{constructor(e){super()}}const _w="^wss?:";function Ew(t){const e=t.match(new RegExp(/^\w+:/,"gi"));if(!(!e||!e.length))return e[0]}function xw(t,e){const r=Ew(t);return typeof r>"u"?!1:new RegExp(e).test(r)}function Nl(t){return xw(t,_w)}function Sw(t){return new RegExp("wss?://localhost(:d{2,5})?").test(t)}function Pl(t){return typeof t=="object"&&"id"in t&&"jsonrpc"in t&&t.jsonrpc==="2.0"}function Cl(t){return Pl(t)&&"method"in t}function Ua(t){return Pl(t)&&($l(t)||Ds(t))}function $l(t){return"result"in t}function Ds(t){return"error"in t}class Iw extends ww{constructor(e){super(e),this.events=new At.exports.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(e),this.connection.connected&&this.registerEventListeners()}async connect(e=this.connection){await this.open(e)}async disconnect(){await this.close()}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async request(e,r){return this.requestStrict(za(e.method,e.params||[],e.id||Fa().toString()),r)}async requestStrict(e,r){return new Promise(async(n,i)=>{if(!this.connection.connected)try{await this.open()}catch(s){i(s)}this.events.on(`${e.id}`,s=>{Ds(s)?i(s.error):n(s.result)});try{await this.connection.send(e,r)}catch(s){i(s)}})}setConnection(e=this.connection){return e}onPayload(e){this.events.emit("payload",e),Ua(e)?this.events.emit(`${e.id}`,e):this.events.emit("message",{type:e.method,data:e.params})}onClose(e){e&&e.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${e.code} ${e.reason?`(${e.reason})`:""}`)),this.events.emit("disconnect")}async open(e=this.connection){this.connection===e&&this.connection.connected||(this.connection.connected&&this.close(),typeof e=="string"&&(await this.connection.open(e),e=this.connection),this.connection=this.setConnection(e),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",e=>this.onPayload(e)),this.connection.on("close",e=>this.onClose(e)),this.connection.on("error",e=>this.events.emit("error",e)),this.connection.on("register_error",e=>this.onClose()),this.hasRegisteredEventListeners=!0)}}const Aw=()=>typeof WebSocket<"u"?WebSocket:typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:require("ws"),Dw=()=>typeof WebSocket<"u"||typeof global<"u"&&typeof global.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u",Ll=t=>t.split("?")[0],Fl=10,Ow=Aw();class Mw{constructor(e){if(this.url=e,this.events=new At.exports.EventEmitter,this.registering=!1,!Nl(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);this.url=e}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async open(e=this.url){await this.register(e)}async close(){return new Promise((e,r)=>{if(typeof this.socket>"u"){r(new Error("Connection already closed"));return}this.socket.onclose=n=>{this.onClose(n),e()},this.socket.close()})}async send(e){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(Cr(e))}catch(r){this.onError(e.id,r)}}register(e=this.url){if(!Nl(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((n,i)=>{this.events.once("register_error",s=>{this.resetMaxListeners(),i(s)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return i(new Error("WebSocket connection is missing or invalid"));n(this.socket)})})}return this.url=e,this.registering=!0,new Promise((r,n)=>{const i=Al.isReactNative()?void 0:{rejectUnauthorized:!Sw(e)},s=new Ow(e,[],i);Dw()?s.onerror=o=>{const a=o;n(this.emitError(a.error))}:s.on("error",o=>{n(this.emitError(o))}),s.onopen=()=>{this.onOpen(s),r(s)}})}onOpen(e){e.onmessage=r=>this.onPayload(r),e.onclose=r=>this.onClose(r),this.socket=e,this.registering=!1,this.events.emit("open")}onClose(e){this.socket=void 0,this.registering=!1,this.events.emit("close",e)}onPayload(e){if(typeof e.data>"u")return;const r=typeof e.data=="string"?en(e.data):e.data;this.events.emit("payload",r)}onError(e,r){const n=this.parseError(r),i=n.message||n.toString(),s=Bl(e,i);this.events.emit("payload",s)}parseError(e,r=this.url){return W5(e,Ll(r),"WS")}resetMaxListeners(){this.events.getMaxListeners()>Fl&&this.events.setMaxListeners(Fl)}emitError(e){const r=this.parseError(new Error(e?.message||`WebSocket connection failed for host: ${Ll(this.url)}`));return this.events.emit("register_error",r),r}}var Tw=Object.defineProperty,Rw=Object.defineProperties,Bw=Object.getOwnPropertyDescriptors,zl=Object.getOwnPropertySymbols,Nw=Object.prototype.hasOwnProperty,Pw=Object.prototype.propertyIsEnumerable,ka=(t,e,r)=>e in t?Tw(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Os=(t,e)=>{for(var r in e||(e={}))Nw.call(e,r)&&ka(t,r,e[r]);if(zl)for(var r of zl(e))Pw.call(e,r)&&ka(t,r,e[r]);return t},ja=(t,e)=>Rw(t,Bw(e)),qt=(t,e,r)=>ka(t,typeof e!="symbol"?e+"":e,r);class Cw extends pb{constructor(e,r){super(e,r),this.relayer=e,this.logger=r,qt(this,"events",new At.exports.EventEmitter),qt(this,"name",of),qt(this,"queue",new Map),qt(this,"publishTimeout",H.toMiliseconds(H.ONE_MINUTE)),qt(this,"initialPublishTimeout",H.toMiliseconds(H.ONE_SECOND*15)),qt(this,"needsTransportRestart",!1),qt(this,"publish",async(n,i,s)=>{var o;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:n,message:i,opts:s}});const a=s?.ttl||Xs,c=Is(s),f=s?.prompt||!1,h=s?.tag||0,l=s?.id||Fa().toString(),y={topic:n,message:i,opts:{ttl:a,relay:c,prompt:f,tag:h,id:l,attestation:s?.attestation,tvf:s?.tvf}},_=`Failed to publish payload, please try again. id:${l} tag:${h}`;try{const w=new Promise(async A=>{const D=({id:O})=>{y.opts.id===O&&(this.removeRequestFromQueue(O),this.relayer.events.removeListener(Qe.publish,D),A(y))};this.relayer.events.on(Qe.publish,D);const M=Dr(new Promise((O,T)=>{this.rpcPublish({topic:n,message:i,ttl:a,prompt:f,tag:h,id:l,attestation:s?.attestation,tvf:s?.tvf}).then(O).catch(R=>{this.logger.warn(R,R?.message),T(R)})}),this.initialPublishTimeout,`Failed initial publish, retrying.... id:${l} tag:${h}`);try{await M,this.events.removeListener(Qe.publish,D)}catch(O){this.queue.set(l,ja(Os({},y),{attempt:1})),this.logger.warn(O,O?.message)}});this.logger.trace({type:"method",method:"publish",params:{id:l,topic:n,message:i,opts:s}}),await Dr(w,this.publishTimeout,_)}catch(w){if(this.logger.debug("Failed to Publish Payload"),this.logger.error(w),(o=s?.internal)!=null&&o.throwOnFailedPublish)throw w}finally{this.queue.delete(l)}}),qt(this,"on",(n,i)=>{this.events.on(n,i)}),qt(this,"once",(n,i)=>{this.events.once(n,i)}),qt(this,"off",(n,i)=>{this.events.off(n,i)}),qt(this,"removeListener",(n,i)=>{this.events.removeListener(n,i)}),this.relayer=e,this.logger=lt(r,this.name),this.registerEventListeners()}get context(){return wt(this.logger)}async rpcPublish(e){var r,n,i,s;const{topic:o,message:a,ttl:c=Xs,prompt:f,tag:h,id:l,attestation:y,tvf:_}=e,w={method:hi(Is().protocol).publish,params:Os({topic:o,message:a,ttl:c,prompt:f,tag:h,attestation:y},_),id:l};As((r=w.params)==null?void 0:r.prompt)&&((n=w.params)==null||delete n.prompt),As((i=w.params)==null?void 0:i.tag)&&((s=w.params)==null||delete s.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:w});const A=await this.relayer.request(w);return this.relayer.events.emit(Qe.publish,e),this.logger.debug("Successfully Published Payload"),A}removeRequestFromQueue(e){this.queue.delete(e)}checkQueue(){this.queue.forEach(async(e,r)=>{const n=e.attempt+1;this.queue.set(r,ja(Os({},e),{attempt:n}));const{topic:i,message:s,opts:o,attestation:a}=e;this.logger.warn({},`Publisher: queue->publishing: ${e.opts.id}, tag: ${e.opts.tag}, attempt: ${n}`),await this.rpcPublish(ja(Os({},e),{topic:i,message:s,ttl:o.ttl,prompt:o.prompt,tag:o.tag,id:o.id,attestation:a,tvf:o.tvf})),this.logger.warn({},`Publisher: queue->published: ${e.opts.id}`)})}registerEventListeners(){this.relayer.core.heartbeat.on(Qr.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(Qe.connection_stalled);return}this.checkQueue()}),this.relayer.on(Qe.message_ack,e=>{this.removeRequestFromQueue(e.id.toString())})}}var $w=Object.defineProperty,Lw=(t,e,r)=>e in t?$w(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Cn=(t,e,r)=>Lw(t,typeof e!="symbol"?e+"":e,r);class Fw{constructor(){Cn(this,"map",new Map),Cn(this,"set",(e,r)=>{const n=this.get(e);this.exists(e,r)||this.map.set(e,[...n,r])}),Cn(this,"get",e=>this.map.get(e)||[]),Cn(this,"exists",(e,r)=>this.get(e).includes(r)),Cn(this,"delete",(e,r)=>{if(typeof r>"u"){this.map.delete(e);return}if(!this.map.has(e))return;const n=this.get(e);if(!this.exists(e,r))return;const i=n.filter(s=>s!==r);if(!i.length){this.map.delete(e);return}this.map.set(e,i)}),Cn(this,"clear",()=>{this.map.clear()})}get topics(){return Array.from(this.map.keys())}}var zw=Object.defineProperty,Uw=Object.defineProperties,kw=Object.getOwnPropertyDescriptors,Ul=Object.getOwnPropertySymbols,jw=Object.prototype.hasOwnProperty,qw=Object.prototype.propertyIsEnumerable,qa=(t,e,r)=>e in t?zw(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,pi=(t,e)=>{for(var r in e||(e={}))jw.call(e,r)&&qa(t,r,e[r]);if(Ul)for(var r of Ul(e))qw.call(e,r)&&qa(t,r,e[r]);return t},Ha=(t,e)=>Uw(t,kw(e)),ie=(t,e,r)=>qa(t,typeof e!="symbol"?e+"":e,r);class kl extends yb{constructor(e,r){super(e,r),this.relayer=e,this.logger=r,ie(this,"subscriptions",new Map),ie(this,"topicMap",new Fw),ie(this,"events",new At.exports.EventEmitter),ie(this,"name",bf),ie(this,"version",pf),ie(this,"pending",new Map),ie(this,"cached",[]),ie(this,"initialized",!1),ie(this,"storagePrefix",Ct),ie(this,"subscribeTimeout",H.toMiliseconds(H.ONE_MINUTE)),ie(this,"initialSubscribeTimeout",H.toMiliseconds(H.ONE_SECOND*15)),ie(this,"clientId"),ie(this,"batchSubscribeTopicsLimit",500),ie(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),await this.restore()),this.initialized=!0}),ie(this,"subscribe",async(n,i)=>{this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:i}});try{const s=Is(i),o={topic:n,relay:s,transportType:i?.transportType};this.pending.set(n,o);const a=await this.rpcSubscribe(n,s,i);return typeof a=="string"&&(this.onSubscribe(a,o),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:i}})),a}catch(s){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(s),s}}),ie(this,"unsubscribe",async(n,i)=>{this.isInitialized(),typeof i?.id<"u"?await this.unsubscribeById(n,i.id,i):await this.unsubscribeByTopic(n,i)}),ie(this,"isSubscribed",n=>new Promise(i=>{i(this.topicMap.topics.includes(n))})),ie(this,"isKnownTopic",n=>new Promise(i=>{i(this.topicMap.topics.includes(n)||this.pending.has(n)||this.cached.some(s=>s.topic===n))})),ie(this,"on",(n,i)=>{this.events.on(n,i)}),ie(this,"once",(n,i)=>{this.events.once(n,i)}),ie(this,"off",(n,i)=>{this.events.off(n,i)}),ie(this,"removeListener",(n,i)=>{this.events.removeListener(n,i)}),ie(this,"start",async()=>{await this.onConnect()}),ie(this,"stop",async()=>{await this.onDisconnect()}),ie(this,"restart",async()=>{await this.restore(),await this.onRestart()}),ie(this,"checkPending",async()=>{if(this.pending.size===0&&(!this.initialized||!this.relayer.connected))return;const n=[];this.pending.forEach(i=>{n.push(i)}),await this.batchSubscribe(n)}),ie(this,"registerEventListeners",()=>{this.relayer.core.heartbeat.on(Qr.pulse,async()=>{await this.checkPending()}),this.events.on(bt.created,async n=>{const i=bt.created;this.logger.info(`Emitting ${i}`),this.logger.debug({type:"event",event:i,data:n}),await this.persist()}),this.events.on(bt.deleted,async n=>{const i=bt.deleted;this.logger.info(`Emitting ${i}`),this.logger.debug({type:"event",event:i,data:n}),await this.persist()})}),this.relayer=e,this.logger=lt(r,this.name),this.clientId=""}get context(){return wt(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}get hasAnyTopics(){return this.topicMap.topics.length>0||this.pending.size>0||this.cached.length>0||this.subscriptions.size>0}hasSubscription(e,r){let n=!1;try{n=this.getSubscription(e).topic===r}catch{}return n}reset(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(e,r){const n=this.topicMap.get(e);await Promise.all(n.map(async i=>await this.unsubscribeById(e,i,r)))}async unsubscribeById(e,r,n){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:r,opts:n}});try{const i=Is(n);await this.restartToComplete({topic:e,id:r,relay:i}),await this.rpcUnsubscribe(e,r,i);const s=di("USER_DISCONNECTED",`${this.name}, ${e}`);await this.onUnsubscribe(e,r,s),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:r,opts:n}})}catch(i){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(i),i}}async rpcSubscribe(e,r,n){var i;(!n||n?.transportType===$r.relay)&&await this.restartToComplete({topic:e,id:e,relay:r});const s={method:hi(r.protocol).subscribe,params:{topic:e}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});const o=(i=n?.internal)==null?void 0:i.throwOnFailedPublish;try{const a=await this.getSubscriptionId(e);if(n?.transportType===$r.link_mode)return setTimeout(()=>{(this.relayer.connected||this.relayer.connecting)&&this.relayer.request(s).catch(h=>this.logger.warn(h))},H.toMiliseconds(H.ONE_SECOND)),a;const c=new Promise(async h=>{const l=y=>{y.topic===e&&(this.events.removeListener(bt.created,l),h(y.id))};this.events.on(bt.created,l);try{const y=await Dr(new Promise((_,w)=>{this.relayer.request(s).catch(A=>{this.logger.warn(A,A?.message),w(A)}).then(_)}),this.initialSubscribeTimeout,`Subscribing to ${e} failed, please try again`);this.events.removeListener(bt.created,l),h(y)}catch{}}),f=await Dr(c,this.subscribeTimeout,`Subscribing to ${e} failed, please try again`);if(!f&&o)throw new Error(`Subscribing to ${e} failed, please try again`);return f?a:null}catch(a){if(this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(Qe.connection_stalled),o)throw a}return null}async rpcBatchSubscribe(e){if(!e.length)return;const r=e[0].relay,n={method:hi(r.protocol).batchSubscribe,params:{topics:e.map(i=>i.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});try{await await Dr(new Promise(i=>{this.relayer.request(n).catch(s=>this.logger.warn(s)).then(i)}),this.subscribeTimeout,"rpcBatchSubscribe failed, please try again")}catch{this.relayer.events.emit(Qe.connection_stalled)}}async rpcBatchFetchMessages(e){if(!e.length)return;const r=e[0].relay,n={method:hi(r.protocol).batchFetchMessages,params:{topics:e.map(s=>s.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});let i;try{i=await await Dr(new Promise((s,o)=>{this.relayer.request(n).catch(a=>{this.logger.warn(a),o(a)}).then(s)}),this.subscribeTimeout,"rpcBatchFetchMessages failed, please try again")}catch{this.relayer.events.emit(Qe.connection_stalled)}return i}rpcUnsubscribe(e,r,n){const i={method:hi(n.protocol).unsubscribe,params:{topic:e,id:r}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:i}),this.relayer.request(i)}onSubscribe(e,r){this.setSubscription(e,Ha(pi({},r),{id:e})),this.pending.delete(r.topic)}onBatchSubscribe(e){e.length&&e.forEach(r=>{this.setSubscription(r.id,pi({},r)),this.pending.delete(r.topic)})}async onUnsubscribe(e,r,n){this.events.removeAllListeners(r),this.hasSubscription(r,e)&&this.deleteSubscription(r,n),await this.relayer.messages.del(e)}async setRelayerSubscriptions(e){await this.relayer.core.storage.setItem(this.storageKey,e)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(e,r){this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:r}),this.addSubscription(e,r)}addSubscription(e,r){this.subscriptions.set(e,pi({},r)),this.topicMap.set(r.topic,e),this.events.emit(bt.created,r)}getSubscription(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});const r=this.subscriptions.get(e);if(!r){const{message:n}=te("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(n)}return r}deleteSubscription(e,r){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:r});const n=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(n.topic,e),this.events.emit(bt.deleted,Ha(pi({},n),{reason:r}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(bt.sync)}async onRestart(){if(this.cached.length){const e=[...this.cached],r=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let n=0;n<r;n++){const i=e.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(i)}}this.events.emit(bt.resubscribed)}async restore(){try{const e=await this.getRelayerSubscriptions();if(typeof e>"u"||!e.length)return;if(this.subscriptions.size){const{message:r}=te("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(e){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(e)}}async batchSubscribe(e){e.length&&(await this.rpcBatchSubscribe(e),this.onBatchSubscribe(await Promise.all(e.map(async r=>Ha(pi({},r),{id:await this.getSubscriptionId(r.topic)})))))}async batchFetchMessages(e){if(!e.length)return;this.logger.trace(`Fetching batch messages for ${e.length} subscriptions`);const r=await this.rpcBatchFetchMessages(e);r&&r.messages&&(await q6(H.toMiliseconds(H.ONE_SECOND)),await this.relayer.handleBatchMessageEvents(r.messages))}async onConnect(){await this.restart(),this.reset()}onDisconnect(){this.onDisable()}isInitialized(){if(!this.initialized){const{message:e}=te("NOT_INITIALIZED",this.name);throw new Error(e)}}async restartToComplete(e){!this.relayer.connected&&!this.relayer.connecting&&(this.cached.push(e),await this.relayer.transportOpen())}async getClientId(){return this.clientId||(this.clientId=await this.relayer.core.crypto.getClientId()),this.clientId}async getSubscriptionId(e){return Ss(e+await this.getClientId())}}var Hw=Object.defineProperty,jl=Object.getOwnPropertySymbols,Kw=Object.prototype.hasOwnProperty,Vw=Object.prototype.propertyIsEnumerable,Ka=(t,e,r)=>e in t?Hw(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,ql=(t,e)=>{for(var r in e||(e={}))Kw.call(e,r)&&Ka(t,r,e[r]);if(jl)for(var r of jl(e))Vw.call(e,r)&&Ka(t,r,e[r]);return t},ee=(t,e,r)=>Ka(t,typeof e!="symbol"?e+"":e,r);class Hl extends gb{constructor(e){super(e),ee(this,"protocol","wc"),ee(this,"version",2),ee(this,"core"),ee(this,"logger"),ee(this,"events",new At.exports.EventEmitter),ee(this,"provider"),ee(this,"messages"),ee(this,"subscriber"),ee(this,"publisher"),ee(this,"name",ff),ee(this,"transportExplicitlyClosed",!1),ee(this,"initialized",!1),ee(this,"connectionAttemptInProgress",!1),ee(this,"relayUrl"),ee(this,"projectId"),ee(this,"packageName"),ee(this,"bundleId"),ee(this,"hasExperiencedNetworkDisruption",!1),ee(this,"pingTimeout"),ee(this,"heartBeatTimeout",H.toMiliseconds(H.THIRTY_SECONDS+H.FIVE_SECONDS)),ee(this,"reconnectTimeout"),ee(this,"connectPromise"),ee(this,"reconnectInProgress",!1),ee(this,"requestsInFlight",[]),ee(this,"connectTimeout",H.toMiliseconds(H.ONE_SECOND*15)),ee(this,"request",async r=>{var n,i;this.logger.debug("Publishing Request Payload");const s=r.id||Fa().toString();await this.toEstablishConnection();try{this.logger.trace({id:s,method:r.method,topic:(n=r.params)==null?void 0:n.topic},"relayer.request - publishing...");const o=`${s}:${((i=r.params)==null?void 0:i.tag)||""}`;this.requestsInFlight.push(o);const a=await this.provider.request(r);return this.requestsInFlight=this.requestsInFlight.filter(c=>c!==o),a}catch(o){throw this.logger.debug(`Failed to Publish Request: ${s}`),o}}),ee(this,"resetPingTimeout",()=>{bs()&&(clearTimeout(this.pingTimeout),this.pingTimeout=setTimeout(()=>{var r,n,i,s;try{this.logger.debug({},"pingTimeout: Connection stalled, terminating..."),(s=(i=(n=(r=this.provider)==null?void 0:r.connection)==null?void 0:n.socket)==null?void 0:i.terminate)==null||s.call(i)}catch(o){this.logger.warn(o,o?.message)}},this.heartBeatTimeout))}),ee(this,"onPayloadHandler",r=>{this.onProviderPayload(r),this.resetPingTimeout()}),ee(this,"onConnectHandler",()=>{this.logger.warn({},"Relayer connected \u{1F6DC}"),this.startPingTimeout(),this.events.emit(Qe.connect)}),ee(this,"onDisconnectHandler",()=>{this.logger.warn({},"Relayer disconnected \u{1F6D1}"),this.requestsInFlight=[],this.onProviderDisconnect()}),ee(this,"onProviderErrorHandler",r=>{this.logger.fatal(`Fatal socket error: ${r.message}`),this.events.emit(Qe.error,r),this.logger.fatal("Fatal socket error received, closing transport"),this.transportClose()}),ee(this,"registerProviderListeners",()=>{this.provider.on(_t.payload,this.onPayloadHandler),this.provider.on(_t.connect,this.onConnectHandler),this.provider.on(_t.disconnect,this.onDisconnectHandler),this.provider.on(_t.error,this.onProviderErrorHandler)}),this.core=e.core,this.logger=typeof e.logger<"u"&&typeof e.logger!="string"?lt(e.logger,this.name):yr(Gc({level:e.logger||cf})),this.messages=new El(this.logger,e.core),this.subscriber=new kl(this,this.logger),this.publisher=new Cw(this,this.logger),this.relayUrl=e?.relayUrl||Zs,this.projectId=e.projectId,B6()?this.packageName=Ed():N6()&&(this.bundleId=Ed()),this.provider={}}async init(){if(this.logger.trace("Initialized"),this.registerEventListeners(),await Promise.all([this.messages.init(),this.subscriber.init()]),this.initialized=!0,this.subscriber.hasAnyTopics)try{await this.transportOpen()}catch(e){this.logger.warn(e,e?.message)}}get context(){return wt(this.logger)}get connected(){var e,r,n;return((n=(r=(e=this.provider)==null?void 0:e.connection)==null?void 0:r.socket)==null?void 0:n.readyState)===1||!1}get connecting(){var e,r,n;return((n=(r=(e=this.provider)==null?void 0:e.connection)==null?void 0:r.socket)==null?void 0:n.readyState)===0||this.connectPromise!==void 0||!1}async publish(e,r,n){this.isInitialized(),await this.publisher.publish(e,r,n),await this.recordMessageEvent({topic:e,message:r,publishedAt:Date.now(),transportType:$r.relay},Hn.outbound)}async subscribe(e,r){var n,i,s;this.isInitialized(),(!(r!=null&&r.transportType)||r?.transportType==="relay")&&await this.toEstablishConnection();const o=typeof((n=r?.internal)==null?void 0:n.throwOnFailedPublish)>"u"?!0:(i=r?.internal)==null?void 0:i.throwOnFailedPublish;let a=((s=this.subscriber.topicMap.get(e))==null?void 0:s[0])||"",c;const f=h=>{h.topic===e&&(this.subscriber.off(bt.created,f),c())};return await Promise.all([new Promise(h=>{c=h,this.subscriber.on(bt.created,f)}),new Promise(async(h,l)=>{a=await this.subscriber.subscribe(e,ql({internal:{throwOnFailedPublish:o}},r)).catch(y=>{o&&l(y)})||a,h()})]),a}async unsubscribe(e,r){this.isInitialized(),await this.subscriber.unsubscribe(e,r)}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async transportDisconnect(){this.provider.disconnect&&(this.hasExperiencedNetworkDisruption||this.connected)?await Dr(this.provider.disconnect(),2e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.onProviderDisconnect()}async transportClose(){this.transportExplicitlyClosed=!0,await this.transportDisconnect()}async transportOpen(e){if(!this.subscriber.hasAnyTopics){this.logger.warn("Starting WS connection skipped because the client has no topics to work with.");return}if(this.connectPromise?(this.logger.debug({},"Waiting for existing connection attempt to resolve..."),await this.connectPromise,this.logger.debug({},"Existing connection attempt resolved")):(this.connectPromise=new Promise(async(r,n)=>{await this.connect(e).then(r).catch(n).finally(()=>{this.connectPromise=void 0})}),await this.connectPromise),!this.connected)throw new Error(`Couldn't establish socket connection to the relay server: ${this.relayUrl}`)}async restartTransport(e){this.logger.debug({},"Restarting transport..."),!this.connectionAttemptInProgress&&(this.relayUrl=e||this.relayUrl,await this.confirmOnlineStateOrThrow(),await this.transportClose(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await yl())throw new Error("No internet connection detected. Please restart your network and try again.")}async handleBatchMessageEvents(e){if(e?.length===0){this.logger.trace("Batch message events is empty. Ignoring...");return}const r=e.sort((n,i)=>n.publishedAt-i.publishedAt);this.logger.debug(`Batch of ${r.length} message events sorted`);for(const n of r)try{await this.onMessageEvent(n)}catch(i){this.logger.warn(i,"Error while processing batch message event: "+i?.message)}this.logger.trace(`Batch of ${r.length} message events processed`)}async onLinkMessageEvent(e,r){const{topic:n}=e;if(!r.sessionExists){const i=ii(H.FIVE_MINUTES),s={topic:n,expiry:i,relay:{protocol:"irn"},active:!1};await this.core.pairing.pairings.set(n,s)}this.events.emit(Qe.message,e),await this.recordMessageEvent(e,Hn.inbound)}async connect(e){await this.confirmOnlineStateOrThrow(),e&&e!==this.relayUrl&&(this.relayUrl=e,await this.transportDisconnect()),this.connectionAttemptInProgress=!0,this.transportExplicitlyClosed=!1;let r=1;for(;r<6;){try{if(this.transportExplicitlyClosed)break;this.logger.debug({},`Connecting to ${this.relayUrl}, attempt: ${r}...`),await this.createProvider(),await new Promise(async(n,i)=>{const s=()=>{i(new Error("Connection interrupted while trying to subscribe"))};this.provider.once(_t.disconnect,s),await Dr(new Promise((o,a)=>{this.provider.connect().then(o).catch(a)}),this.connectTimeout,`Socket stalled when trying to connect to ${this.relayUrl}`).catch(o=>{i(o)}).finally(()=>{this.provider.off(_t.disconnect,s),clearTimeout(this.reconnectTimeout)}),await new Promise(async(o,a)=>{const c=()=>{a(new Error("Connection interrupted while trying to subscribe"))};this.provider.once(_t.disconnect,c),await this.subscriber.start().then(o).catch(a).finally(()=>{this.provider.off(_t.disconnect,c)})}),this.hasExperiencedNetworkDisruption=!1,n()})}catch(n){await this.subscriber.stop();const i=n;this.logger.warn({},i.message),this.hasExperiencedNetworkDisruption=!0}finally{this.connectionAttemptInProgress=!1}if(this.connected){this.logger.debug({},`Connected to ${this.relayUrl} successfully on attempt: ${r}`);break}await new Promise(n=>setTimeout(n,H.toMiliseconds(r*1))),r++}}startPingTimeout(){var e,r,n,i,s;if(bs())try{(r=(e=this.provider)==null?void 0:e.connection)!=null&&r.socket&&((s=(i=(n=this.provider)==null?void 0:n.connection)==null?void 0:i.socket)==null||s.on("ping",()=>{this.resetPingTimeout()})),this.resetPingTimeout()}catch(o){this.logger.warn(o,o?.message)}}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();const e=await this.core.crypto.signJWT(this.relayUrl);this.provider=new Iw(new Mw(F6({sdkVersion:Ni,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:e,useOnCloseEvent:!0,bundleId:this.bundleId,packageName:this.packageName}))),this.registerProviderListeners()}async recordMessageEvent(e,r){const{topic:n,message:i}=e;await this.messages.set(n,i,r)}async shouldIgnoreMessageEvent(e){const{topic:r,message:n}=e;if(!n||n.length===0)return this.logger.warn(`Ignoring invalid/empty message: ${n}`),!0;if(!await this.subscriber.isKnownTopic(r))return this.logger.warn(`Ignoring message for unknown topic ${r}`),!0;const i=this.messages.has(r,n);return i&&this.logger.warn(`Ignoring duplicate message: ${n}`),i}async onProviderPayload(e){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:e}),Cl(e)){if(!e.method.endsWith(uf))return;const r=e.params,{topic:n,message:i,publishedAt:s,attestation:o}=r.data,a={topic:n,message:i,publishedAt:s,transportType:$r.relay,attestation:o};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(ql({type:"event",event:r.id},a)),this.events.emit(r.id,a),await this.acknowledgePayload(e),await this.onMessageEvent(a)}else Ua(e)&&this.events.emit(Qe.message_ack,e)}async onMessageEvent(e){await this.shouldIgnoreMessageEvent(e)||(await this.recordMessageEvent(e,Hn.inbound),this.events.emit(Qe.message,e))}async acknowledgePayload(e){const r=Rl(e.id,!0);await this.provider.connection.send(r)}unregisterProviderListeners(){this.provider.off(_t.payload,this.onPayloadHandler),this.provider.off(_t.connect,this.onConnectHandler),this.provider.off(_t.disconnect,this.onDisconnectHandler),this.provider.off(_t.error,this.onProviderErrorHandler),clearTimeout(this.pingTimeout)}async registerEventListeners(){let e=await yl();A5(async r=>{e!==r&&(e=r,r?await this.transportOpen().catch(n=>this.logger.error(n,n?.message)):(this.hasExperiencedNetworkDisruption=!0,await this.transportDisconnect(),this.transportExplicitlyClosed=!1))})}async onProviderDisconnect(){clearTimeout(this.pingTimeout),this.events.emit(Qe.disconnect),this.connectionAttemptInProgress=!1,!this.reconnectInProgress&&(this.reconnectInProgress=!0,await this.subscriber.stop(),this.subscriber.hasAnyTopics&&(this.transportExplicitlyClosed||(this.reconnectTimeout=setTimeout(async()=>{await this.transportOpen().catch(e=>this.logger.error(e,e?.message)),this.reconnectTimeout=void 0,this.reconnectInProgress=!1},H.toMiliseconds(hf)))))}isInitialized(){if(!this.initialized){const{message:e}=te("NOT_INITIALIZED",this.name);throw new Error(e)}}async toEstablishConnection(){await this.confirmOnlineStateOrThrow(),!this.connected&&await this.connect()}}function Ww(){}function Kl(t){if(!t||typeof t!="object")return!1;const e=Object.getPrototypeOf(t);return e===null||e===Object.prototype||Object.getPrototypeOf(e)===null?Object.prototype.toString.call(t)==="[object Object]":!1}function Vl(t){return Object.getOwnPropertySymbols(t).filter(e=>Object.prototype.propertyIsEnumerable.call(t,e))}function Wl(t){return t==null?t===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(t)}const Yw="[object RegExp]",Gw="[object String]",Xw="[object Number]",Zw="[object Boolean]",Yl="[object Arguments]",Jw="[object Symbol]",Qw="[object Date]",e9="[object Map]",t9="[object Set]",r9="[object Array]",n9="[object Function]",i9="[object ArrayBuffer]",Va="[object Object]",s9="[object Error]",o9="[object DataView]",a9="[object Uint8Array]",c9="[object Uint8ClampedArray]",f9="[object Uint16Array]",u9="[object Uint32Array]",h9="[object BigUint64Array]",d9="[object Int8Array]",l9="[object Int16Array]",b9="[object Int32Array]",p9="[object BigInt64Array]",g9="[object Float32Array]",v9="[object Float64Array]";function y9(t,e){return t===e||Number.isNaN(t)&&Number.isNaN(e)}function m9(t,e,r){return gi(t,e,void 0,void 0,void 0,void 0,r)}function gi(t,e,r,n,i,s,o){const a=o(t,e,r,n,i,s);if(a!==void 0)return a;if(typeof t==typeof e)switch(typeof t){case"bigint":case"string":case"boolean":case"symbol":case"undefined":return t===e;case"number":return t===e||Object.is(t,e);case"function":return t===e;case"object":return vi(t,e,s,o)}return vi(t,e,s,o)}function vi(t,e,r,n){if(Object.is(t,e))return!0;let i=Wl(t),s=Wl(e);if(i===Yl&&(i=Va),s===Yl&&(s=Va),i!==s)return!1;switch(i){case Gw:return t.toString()===e.toString();case Xw:{const c=t.valueOf(),f=e.valueOf();return y9(c,f)}case Zw:case Qw:case Jw:return Object.is(t.valueOf(),e.valueOf());case Yw:return t.source===e.source&&t.flags===e.flags;case n9:return t===e}r=r??new Map;const o=r.get(t),a=r.get(e);if(o!=null&&a!=null)return o===e;r.set(t,e),r.set(e,t);try{switch(i){case e9:{if(t.size!==e.size)return!1;for(const[c,f]of t.entries())if(!e.has(c)||!gi(f,e.get(c),c,t,e,r,n))return!1;return!0}case t9:{if(t.size!==e.size)return!1;const c=Array.from(t.values()),f=Array.from(e.values());for(let h=0;h<c.length;h++){const l=c[h],y=f.findIndex(_=>gi(l,_,void 0,t,e,r,n));if(y===-1)return!1;f.splice(y,1)}return!0}case r9:case a9:case c9:case f9:case u9:case h9:case d9:case l9:case b9:case p9:case g9:case v9:{if(typeof Buffer<"u"&&Buffer.isBuffer(t)!==Buffer.isBuffer(e)||t.length!==e.length)return!1;for(let c=0;c<t.length;c++)if(!gi(t[c],e[c],c,t,e,r,n))return!1;return!0}case i9:return t.byteLength!==e.byteLength?!1:vi(new Uint8Array(t),new Uint8Array(e),r,n);case o9:return t.byteLength!==e.byteLength||t.byteOffset!==e.byteOffset?!1:vi(new Uint8Array(t),new Uint8Array(e),r,n);case s9:return t.name===e.name&&t.message===e.message;case Va:{if(!(vi(t.constructor,e.constructor,r,n)||Kl(t)&&Kl(e)))return!1;const f=[...Object.keys(t),...Vl(t)],h=[...Object.keys(e),...Vl(e)];if(f.length!==h.length)return!1;for(let l=0;l<f.length;l++){const y=f[l],_=t[y];if(!Object.hasOwn(e,y))return!1;const w=e[y];if(!gi(_,w,y,t,e,r,n))return!1}return!0}default:return!1}}finally{r.delete(t),r.delete(e)}}function w9(t,e){return m9(t,e,Ww)}var _9=Object.defineProperty,Gl=Object.getOwnPropertySymbols,E9=Object.prototype.hasOwnProperty,x9=Object.prototype.propertyIsEnumerable,Wa=(t,e,r)=>e in t?_9(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Xl=(t,e)=>{for(var r in e||(e={}))E9.call(e,r)&&Wa(t,r,e[r]);if(Gl)for(var r of Gl(e))x9.call(e,r)&&Wa(t,r,e[r]);return t},mt=(t,e,r)=>Wa(t,typeof e!="symbol"?e+"":e,r);class Zl extends vb{constructor(e,r,n,i=Ct,s=void 0){super(e,r,n,i),this.core=e,this.logger=r,this.name=n,mt(this,"map",new Map),mt(this,"version",df),mt(this,"cached",[]),mt(this,"initialized",!1),mt(this,"getKey"),mt(this,"storagePrefix",Ct),mt(this,"recentlyDeleted",[]),mt(this,"recentlyDeletedLimit",200),mt(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(o=>{this.getKey&&o!==null&&!As(o)?this.map.set(this.getKey(o),o):_5(o)?this.map.set(o.id,o):E5(o)&&this.map.set(o.topic,o)}),this.cached=[],this.initialized=!0)}),mt(this,"set",async(o,a)=>{this.isInitialized(),this.map.has(o)?await this.update(o,a):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:o,value:a}),this.map.set(o,a),await this.persist())}),mt(this,"get",o=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:o}),this.getData(o))),mt(this,"getAll",o=>(this.isInitialized(),o?this.values.filter(a=>Object.keys(o).every(c=>w9(a[c],o[c]))):this.values)),mt(this,"update",async(o,a)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:o,update:a});const c=Xl(Xl({},this.getData(o)),a);this.map.set(o,c),await this.persist()}),mt(this,"delete",async(o,a)=>{this.isInitialized(),this.map.has(o)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:o,reason:a}),this.map.delete(o),this.addToRecentlyDeleted(o),await this.persist())}),this.logger=lt(r,this.name),this.storagePrefix=i,this.getKey=s}get context(){return wt(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}addToRecentlyDeleted(e){this.recentlyDeleted.push(e),this.recentlyDeleted.length>=this.recentlyDeletedLimit&&this.recentlyDeleted.splice(0,this.recentlyDeletedLimit/2)}async setDataStore(e){await this.core.storage.setItem(this.storageKey,e)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(e){const r=this.map.get(e);if(!r){if(this.recentlyDeleted.includes(e)){const{message:i}=te("MISSING_OR_INVALID",`Record was recently deleted - ${this.name}: ${e}`);throw this.logger.error(i),new Error(i)}const{message:n}=te("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(n),new Error(n)}return r}async persist(){await this.setDataStore(this.values)}async restore(){try{const e=await this.getDataStore();if(typeof e>"u"||!e.length)return;if(this.map.size){const{message:r}=te("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(e){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(e)}}isInitialized(){if(!this.initialized){const{message:e}=te("NOT_INITIALIZED",this.name);throw new Error(e)}}}var S9=Object.defineProperty,I9=(t,e,r)=>e in t?S9(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,X=(t,e,r)=>I9(t,typeof e!="symbol"?e+"":e,r);class Jl{constructor(e,r){this.core=e,this.logger=r,X(this,"name",gf),X(this,"version",vf),X(this,"events",new At.exports),X(this,"pairings"),X(this,"initialized",!1),X(this,"storagePrefix",Ct),X(this,"ignoredPayloadTypes",[Pn]),X(this,"registeredMethods",[]),X(this,"init",async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))}),X(this,"register",({methods:n})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...n])]}),X(this,"create",async n=>{this.isInitialized();const i=Ra(),s=await this.core.crypto.setSymKey(i),o=ii(H.FIVE_MINUTES),a={protocol:af},c={topic:s,expiry:o,relay:a,active:!1,methods:n?.methods},f=gl({protocol:this.core.protocol,version:this.core.version,topic:s,symKey:i,relay:a,expiryTimestamp:o,methods:n?.methods});return this.events.emit(sn.create,c),this.core.expirer.set(s,o),await this.pairings.set(s,c),await this.core.relayer.subscribe(s,{transportType:n?.transportType}),{topic:s,uri:f}}),X(this,"pair",async n=>{this.isInitialized();const i=this.core.eventClient.createEvent({properties:{topic:n?.uri,trace:[Kt.pairing_started]}});this.isValidPair(n,i);const{topic:s,symKey:o,relay:a,expiryTimestamp:c,methods:f}=pl(n.uri);i.props.properties.topic=s,i.addTrace(Kt.pairing_uri_validation_success),i.addTrace(Kt.pairing_uri_not_expired);let h;if(this.pairings.keys.includes(s)){if(h=this.pairings.get(s),i.addTrace(Kt.existing_pairing),h.active)throw i.setError(sr.active_pairing_already_exists),new Error(`Pairing already exists: ${s}. Please try again with a new connection URI.`);i.addTrace(Kt.pairing_not_expired)}const l=c||ii(H.FIVE_MINUTES),y={topic:s,relay:a,expiry:l,active:!1,methods:f};this.core.expirer.set(s,l),await this.pairings.set(s,y),i.addTrace(Kt.store_new_pairing),n.activatePairing&&await this.activate({topic:s}),this.events.emit(sn.create,y),i.addTrace(Kt.emit_inactive_pairing),this.core.crypto.keychain.has(s)||await this.core.crypto.setSymKey(o,s),i.addTrace(Kt.subscribing_pairing_topic);try{await this.core.relayer.confirmOnlineStateOrThrow()}catch{i.setError(sr.no_internet_connection)}try{await this.core.relayer.subscribe(s,{relay:a})}catch(_){throw i.setError(sr.subscribe_pairing_topic_failure),_}return i.addTrace(Kt.subscribe_pairing_topic_success),y}),X(this,"activate",async({topic:n})=>{this.isInitialized();const i=ii(H.FIVE_MINUTES);this.core.expirer.set(n,i),await this.pairings.update(n,{active:!0,expiry:i})}),X(this,"ping",async n=>{this.isInitialized(),await this.isValidPing(n),this.logger.warn("ping() is deprecated and will be removed in the next major release.");const{topic:i}=n;if(this.pairings.keys.includes(i)){const s=await this.sendRequest(i,"wc_pairingPing",{}),{done:o,resolve:a,reject:c}=z6();this.events.once(ba("pairing_ping",s),({error:f})=>{f?c(f):a()}),await o()}}),X(this,"updateExpiry",async({topic:n,expiry:i})=>{this.isInitialized(),await this.pairings.update(n,{expiry:i})}),X(this,"updateMetadata",async({topic:n,metadata:i})=>{this.isInitialized(),await this.pairings.update(n,{peerMetadata:i})}),X(this,"getPairings",()=>(this.isInitialized(),this.pairings.values)),X(this,"disconnect",async n=>{this.isInitialized(),await this.isValidDisconnect(n);const{topic:i}=n;this.pairings.keys.includes(i)&&(await this.sendRequest(i,"wc_pairingDelete",di("USER_DISCONNECTED")),await this.deletePairing(i))}),X(this,"formatUriFromPairing",n=>{this.isInitialized();const{topic:i,relay:s,expiry:o,methods:a}=n,c=this.core.crypto.keychain.get(i);return gl({protocol:this.core.protocol,version:this.core.version,topic:i,symKey:c,relay:s,expiryTimestamp:o,methods:a})}),X(this,"sendRequest",async(n,i,s)=>{const o=za(i,s),a=await this.core.crypto.encode(n,o),c=nn[i].req;return this.core.history.set(n,o),this.core.relayer.publish(n,a,c),o.id}),X(this,"sendResult",async(n,i,s)=>{const o=Rl(n,s),a=await this.core.crypto.encode(i,o),c=(await this.core.history.get(i,n)).request.method,f=nn[c].res;await this.core.relayer.publish(i,a,f),await this.core.history.resolve(o)}),X(this,"sendError",async(n,i,s)=>{const o=Bl(n,s),a=await this.core.crypto.encode(i,o),c=(await this.core.history.get(i,n)).request.method,f=nn[c]?nn[c].res:nn.unregistered_method.res;await this.core.relayer.publish(i,a,f),await this.core.history.resolve(o)}),X(this,"deletePairing",async(n,i)=>{await this.core.relayer.unsubscribe(n),await Promise.all([this.pairings.delete(n,di("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(n),i?Promise.resolve():this.core.expirer.del(n)])}),X(this,"cleanup",async()=>{const n=this.pairings.getAll().filter(i=>Id(i.expiry));await Promise.all(n.map(i=>this.deletePairing(i.topic)))}),X(this,"onRelayEventRequest",async n=>{const{topic:i,payload:s}=n;switch(s.method){case"wc_pairingPing":return await this.onPairingPingRequest(i,s);case"wc_pairingDelete":return await this.onPairingDeleteRequest(i,s);default:return await this.onUnknownRpcMethodRequest(i,s)}}),X(this,"onRelayEventResponse",async n=>{const{topic:i,payload:s}=n,o=(await this.core.history.get(i,s.id)).request.method;switch(o){case"wc_pairingPing":return this.onPairingPingResponse(i,s);default:return this.onUnknownRpcMethodResponse(o)}}),X(this,"onPairingPingRequest",async(n,i)=>{const{id:s}=i;try{this.isValidPing({topic:n}),await this.sendResult(s,n,!0),this.events.emit(sn.ping,{id:s,topic:n})}catch(o){await this.sendError(s,n,o),this.logger.error(o)}}),X(this,"onPairingPingResponse",(n,i)=>{const{id:s}=i;setTimeout(()=>{$l(i)?this.events.emit(ba("pairing_ping",s),{}):Ds(i)&&this.events.emit(ba("pairing_ping",s),{error:i.error})},500)}),X(this,"onPairingDeleteRequest",async(n,i)=>{const{id:s}=i;try{this.isValidDisconnect({topic:n}),await this.deletePairing(n),this.events.emit(sn.delete,{id:s,topic:n})}catch(o){await this.sendError(s,n,o),this.logger.error(o)}}),X(this,"onUnknownRpcMethodRequest",async(n,i)=>{const{id:s,method:o}=i;try{if(this.registeredMethods.includes(o))return;const a=di("WC_METHOD_UNSUPPORTED",o);await this.sendError(s,n,a),this.logger.error(a)}catch(a){await this.sendError(s,n,a),this.logger.error(a)}}),X(this,"onUnknownRpcMethodResponse",n=>{this.registeredMethods.includes(n)||this.logger.error(di("WC_METHOD_UNSUPPORTED",n))}),X(this,"isValidPair",(n,i)=>{var s;if(!Ba(n)){const{message:a}=te("MISSING_OR_INVALID",`pair() params: ${n}`);throw i.setError(sr.malformed_pairing_uri),new Error(a)}if(!w5(n.uri)){const{message:a}=te("MISSING_OR_INVALID",`pair() uri: ${n.uri}`);throw i.setError(sr.malformed_pairing_uri),new Error(a)}const o=pl(n?.uri);if(!((s=o?.relay)!=null&&s.protocol)){const{message:a}=te("MISSING_OR_INVALID","pair() uri#relay-protocol");throw i.setError(sr.malformed_pairing_uri),new Error(a)}if(!(o!=null&&o.symKey)){const{message:a}=te("MISSING_OR_INVALID","pair() uri#symKey");throw i.setError(sr.malformed_pairing_uri),new Error(a)}if(o!=null&&o.expiryTimestamp&&H.toMiliseconds(o?.expiryTimestamp)<Date.now()){i.setError(sr.pairing_expired);const{message:a}=te("EXPIRED","pair() URI has expired. Please try again with a new connection URI.");throw new Error(a)}}),X(this,"isValidPing",async n=>{if(!Ba(n)){const{message:s}=te("MISSING_OR_INVALID",`ping() params: ${n}`);throw new Error(s)}const{topic:i}=n;await this.isValidPairingTopic(i)}),X(this,"isValidDisconnect",async n=>{if(!Ba(n)){const{message:s}=te("MISSING_OR_INVALID",`disconnect() params: ${n}`);throw new Error(s)}const{topic:i}=n;await this.isValidPairingTopic(i)}),X(this,"isValidPairingTopic",async n=>{if(!vl(n,!1)){const{message:i}=te("MISSING_OR_INVALID",`pairing topic should be a string: ${n}`);throw new Error(i)}if(!this.pairings.keys.includes(n)){const{message:i}=te("NO_MATCHING_KEY",`pairing topic doesn't exist: ${n}`);throw new Error(i)}if(Id(this.pairings.get(n).expiry)){await this.deletePairing(n);const{message:i}=te("EXPIRED",`pairing topic: ${n}`);throw new Error(i)}}),this.core=e,this.logger=lt(r,this.name),this.pairings=new Zl(this.core,this.logger,this.name,this.storagePrefix)}get context(){return wt(this.logger)}isInitialized(){if(!this.initialized){const{message:e}=te("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.core.relayer.on(Qe.message,async e=>{const{topic:r,message:n,transportType:i}=e;if(this.pairings.keys.includes(r)&&i!==$r.link_mode&&!this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(n)))try{const s=await this.core.crypto.decode(r,n);Cl(s)?(this.core.history.set(r,s),await this.onRelayEventRequest({topic:r,payload:s})):Ua(s)&&(await this.core.history.resolve(s),await this.onRelayEventResponse({topic:r,payload:s}),this.core.history.delete(r,s.id)),await this.core.relayer.messages.ack(r,n)}catch(s){this.logger.error(s)}})}registerExpirerEvents(){this.core.expirer.on(Ot.expired,async e=>{const{topic:r}=j6(e.target);r&&this.pairings.keys.includes(r)&&(await this.deletePairing(r,!0),this.events.emit(sn.expire,{topic:r}))})}}var A9=Object.defineProperty,D9=(t,e,r)=>e in t?A9(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,st=(t,e,r)=>D9(t,typeof e!="symbol"?e+"":e,r);class Ql extends lb{constructor(e,r){super(e,r),this.core=e,this.logger=r,st(this,"records",new Map),st(this,"events",new At.exports.EventEmitter),st(this,"name",yf),st(this,"version",mf),st(this,"cached",[]),st(this,"initialized",!1),st(this,"storagePrefix",Ct),st(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.records.set(n.id,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)}),st(this,"set",(n,i,s)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:n,request:i,chainId:s}),this.records.has(i.id))return;const o={id:i.id,topic:n,request:{method:i.method,params:i.params||null},chainId:s,expiry:ii(H.THIRTY_DAYS)};this.records.set(o.id,o),this.persist(),this.events.emit(Dt.created,o)}),st(this,"resolve",async n=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:n}),!this.records.has(n.id))return;const i=await this.getRecord(n.id);typeof i.response>"u"&&(i.response=Ds(n)?{error:n.error}:{result:n.result},this.records.set(i.id,i),this.persist(),this.events.emit(Dt.updated,i))}),st(this,"get",async(n,i)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:n,id:i}),await this.getRecord(i))),st(this,"delete",(n,i)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:i}),this.values.forEach(s=>{if(s.topic===n){if(typeof i<"u"&&s.id!==i)return;this.records.delete(s.id),this.events.emit(Dt.deleted,s)}}),this.persist()}),st(this,"exists",async(n,i)=>(this.isInitialized(),this.records.has(i)?(await this.getRecord(i)).topic===n:!1)),st(this,"on",(n,i)=>{this.events.on(n,i)}),st(this,"once",(n,i)=>{this.events.once(n,i)}),st(this,"off",(n,i)=>{this.events.off(n,i)}),st(this,"removeListener",(n,i)=>{this.events.removeListener(n,i)}),this.logger=lt(r,this.name)}get context(){return wt(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const e=[];return this.values.forEach(r=>{if(typeof r.response<"u")return;const n={topic:r.topic,request:za(r.request.method,r.request.params,r.id),chainId:r.chainId};return e.push(n)}),e}async setJsonRpcRecords(e){await this.core.storage.setItem(this.storageKey,e)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(e){this.isInitialized();const r=this.records.get(e);if(!r){const{message:n}=te("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(n)}return r}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(Dt.sync)}async restore(){try{const e=await this.getJsonRpcRecords();if(typeof e>"u"||!e.length)return;if(this.records.size){const{message:r}=te("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}}registerEventListeners(){this.events.on(Dt.created,e=>{const r=Dt.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e})}),this.events.on(Dt.updated,e=>{const r=Dt.updated;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e})}),this.events.on(Dt.deleted,e=>{const r=Dt.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e})}),this.core.heartbeat.on(Qr.pulse,()=>{this.cleanup()})}cleanup(){try{this.isInitialized();let e=!1;this.records.forEach(r=>{H.toMiliseconds(r.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${r.id}`),this.records.delete(r.id),this.events.emit(Dt.deleted,r,!1),e=!0)}),e&&this.persist()}catch(e){this.logger.warn(e)}}isInitialized(){if(!this.initialized){const{message:e}=te("NOT_INITIALIZED",this.name);throw new Error(e)}}}var O9=Object.defineProperty,M9=(t,e,r)=>e in t?O9(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,ct=(t,e,r)=>M9(t,typeof e!="symbol"?e+"":e,r);class e0 extends mb{constructor(e,r){super(e,r),this.core=e,this.logger=r,ct(this,"expirations",new Map),ct(this,"events",new At.exports.EventEmitter),ct(this,"name",wf),ct(this,"version",_f),ct(this,"cached",[]),ct(this,"initialized",!1),ct(this,"storagePrefix",Ct),ct(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.expirations.set(n.target,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)}),ct(this,"has",n=>{try{const i=this.formatTarget(n);return typeof this.getExpiration(i)<"u"}catch{return!1}}),ct(this,"set",(n,i)=>{this.isInitialized();const s=this.formatTarget(n),o={target:s,expiry:i};this.expirations.set(s,o),this.checkExpiry(s,o),this.events.emit(Ot.created,{target:s,expiration:o})}),ct(this,"get",n=>{this.isInitialized();const i=this.formatTarget(n);return this.getExpiration(i)}),ct(this,"del",n=>{if(this.isInitialized(),this.has(n)){const i=this.formatTarget(n),s=this.getExpiration(i);this.expirations.delete(i),this.events.emit(Ot.deleted,{target:i,expiration:s})}}),ct(this,"on",(n,i)=>{this.events.on(n,i)}),ct(this,"once",(n,i)=>{this.events.once(n,i)}),ct(this,"off",(n,i)=>{this.events.off(n,i)}),ct(this,"removeListener",(n,i)=>{this.events.removeListener(n,i)}),this.logger=lt(r,this.name)}get context(){return wt(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(e){if(typeof e=="string")return U6(e);if(typeof e=="number")return k6(e);const{message:r}=te("UNKNOWN_TYPE",`Target type: ${typeof e}`);throw new Error(r)}async setExpirations(e){await this.core.storage.setItem(this.storageKey,e)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(Ot.sync)}async restore(){try{const e=await this.getExpirations();if(typeof e>"u"||!e.length)return;if(this.expirations.size){const{message:r}=te("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(e){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(e)}}getExpiration(e){const r=this.expirations.get(e);if(!r){const{message:n}=te("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.warn(n),new Error(n)}return r}checkExpiry(e,r){const{expiry:n}=r;H.toMiliseconds(n)-Date.now()<=0&&this.expire(e,r)}expire(e,r){this.expirations.delete(e),this.events.emit(Ot.expired,{target:e,expiration:r})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((e,r)=>this.checkExpiry(r,e))}registerEventListeners(){this.core.heartbeat.on(Qr.pulse,()=>this.checkExpirations()),this.events.on(Ot.created,e=>{const r=Ot.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()}),this.events.on(Ot.expired,e=>{const r=Ot.expired;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()}),this.events.on(Ot.deleted,e=>{const r=Ot.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=te("NOT_INITIALIZED",this.name);throw new Error(e)}}}var T9=Object.defineProperty,R9=(t,e,r)=>e in t?T9(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Ee=(t,e,r)=>R9(t,typeof e!="symbol"?e+"":e,r);class t0 extends wb{constructor(e,r,n){super(e,r,n),this.core=e,this.logger=r,this.store=n,Ee(this,"name",Ef),Ee(this,"abortController"),Ee(this,"isDevEnv"),Ee(this,"verifyUrlV3",Sf),Ee(this,"storagePrefix",Ct),Ee(this,"version",Ys),Ee(this,"publicKey"),Ee(this,"fetchPromise"),Ee(this,"init",async()=>{var i;this.isDevEnv||(this.publicKey=await this.store.getItem(this.storeKey),this.publicKey&&H.toMiliseconds((i=this.publicKey)==null?void 0:i.expiresAt)<Date.now()&&(this.logger.debug("verify v2 public key expired"),await this.removePublicKey()))}),Ee(this,"register",async i=>{if(!ps()||this.isDevEnv)return;const s=window.location.origin,{id:o,decryptedId:a}=i,c=`${this.verifyUrlV3}/attestation?projectId=${this.core.projectId}&origin=${s}&id=${o}&decryptedId=${a}`;try{const f=Hi(),h=this.startAbortTimer(H.ONE_SECOND*5),l=await new Promise((y,_)=>{const w=()=>{window.removeEventListener("message",D),f.body.removeChild(A),_("attestation aborted")};this.abortController.signal.addEventListener("abort",w);const A=f.createElement("iframe");A.src=c,A.style.display="none",A.addEventListener("error",w,{signal:this.abortController.signal});const D=M=>{if(M.data&&typeof M.data=="string")try{const O=JSON.parse(M.data);if(O.type==="verify_attestation"){if(wo(O.attestation).payload.id!==o)return;clearInterval(h),f.body.removeChild(A),this.abortController.signal.removeEventListener("abort",w),window.removeEventListener("message",D),y(O.attestation===null?"":O.attestation)}}catch(O){this.logger.warn(O)}};f.body.appendChild(A),window.addEventListener("message",D,{signal:this.abortController.signal})});return this.logger.debug("jwt attestation",l),l}catch(f){this.logger.warn(f)}return""}),Ee(this,"resolve",async i=>{if(this.isDevEnv)return"";const{attestationId:s,hash:o,encryptedId:a}=i;if(s===""){this.logger.debug("resolve: attestationId is empty, skipping");return}if(s){if(wo(s).payload.id!==a)return;const f=await this.isValidJwtAttestation(s);if(f){if(!f.isVerified){this.logger.warn("resolve: jwt attestation: origin url not verified");return}return f}}if(!o)return;const c=this.getVerifyUrl(i?.verifyUrl);return this.fetchAttestation(o,c)}),Ee(this,"fetchAttestation",async(i,s)=>{this.logger.debug(`resolving attestation: ${i} from url: ${s}`);const o=this.startAbortTimer(H.ONE_SECOND*5),a=await fetch(`${s}/attestation/${i}?v2Supported=true`,{signal:this.abortController.signal});return clearTimeout(o),a.status===200?await a.json():void 0}),Ee(this,"getVerifyUrl",i=>{let s=i||Kn;return If.includes(s)||(this.logger.info(`verify url: ${s}, not included in trusted list, assigning default: ${Kn}`),s=Kn),s}),Ee(this,"fetchPublicKey",async()=>{try{this.logger.debug(`fetching public key from: ${this.verifyUrlV3}`);const i=this.startAbortTimer(H.FIVE_SECONDS),s=await fetch(`${this.verifyUrlV3}/public-key`,{signal:this.abortController.signal});return clearTimeout(i),await s.json()}catch(i){this.logger.warn(i)}}),Ee(this,"persistPublicKey",async i=>{this.logger.debug("persisting public key to local storage",i),await this.store.setItem(this.storeKey,i),this.publicKey=i}),Ee(this,"removePublicKey",async()=>{this.logger.debug("removing verify v2 public key from storage"),await this.store.removeItem(this.storeKey),this.publicKey=void 0}),Ee(this,"isValidJwtAttestation",async i=>{const s=await this.getPublicKey();try{if(s)return this.validateAttestation(i,s)}catch(a){this.logger.error(a),this.logger.warn("error validating attestation")}const o=await this.fetchAndPersistPublicKey();try{if(o)return this.validateAttestation(i,o)}catch(a){this.logger.error(a),this.logger.warn("error validating attestation")}}),Ee(this,"getPublicKey",async()=>this.publicKey?this.publicKey:await this.fetchAndPersistPublicKey()),Ee(this,"fetchAndPersistPublicKey",async()=>{if(this.fetchPromise)return await this.fetchPromise,this.publicKey;this.fetchPromise=new Promise(async s=>{const o=await this.fetchPublicKey();o&&(await this.persistPublicKey(o),s(o))});const i=await this.fetchPromise;return this.fetchPromise=void 0,i}),Ee(this,"validateAttestation",(i,s)=>{const o=l5(i,s.publicKey),a={hasExpired:H.toMiliseconds(o.exp)<Date.now(),payload:o};if(a.hasExpired)throw this.logger.warn("resolve: jwt attestation expired"),new Error("JWT attestation expired");return{origin:a.payload.origin,isScam:a.payload.isScam,isVerified:a.payload.isVerified}}),this.logger=lt(r,this.name),this.abortController=new AbortController,this.isDevEnv=Dd(),this.init()}get storeKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//verify:public:key"}get context(){return wt(this.logger)}startAbortTimer(e){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),H.toMiliseconds(e))}}var B9=Object.defineProperty,N9=(t,e,r)=>e in t?B9(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,r0=(t,e,r)=>N9(t,typeof e!="symbol"?e+"":e,r);class n0 extends _b{constructor(e,r){super(e,r),this.projectId=e,this.logger=r,r0(this,"context",Af),r0(this,"registerDeviceToken",async n=>{const{clientId:i,token:s,notificationType:o,enableEncrypted:a=!1}=n,c=`${Df}/${this.projectId}/clients`;await fetch(c,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:i,type:o,token:s,always_raw:a})})}),this.logger=lt(r,this.context)}}var P9=Object.defineProperty,i0=Object.getOwnPropertySymbols,C9=Object.prototype.hasOwnProperty,$9=Object.prototype.propertyIsEnumerable,Ya=(t,e,r)=>e in t?P9(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,yi=(t,e)=>{for(var r in e||(e={}))C9.call(e,r)&&Ya(t,r,e[r]);if(i0)for(var r of i0(e))$9.call(e,r)&&Ya(t,r,e[r]);return t},Je=(t,e,r)=>Ya(t,typeof e!="symbol"?e+"":e,r);class s0 extends Eb{constructor(e,r,n=!0){super(e,r,n),this.core=e,this.logger=r,Je(this,"context",Mf),Je(this,"storagePrefix",Ct),Je(this,"storageVersion",Of),Je(this,"events",new Map),Je(this,"shouldPersist",!1),Je(this,"init",async()=>{if(!Dd())try{const i={eventId:Ad(),timestamp:Date.now(),domain:this.getAppDomain(),props:{event:"INIT",type:"",properties:{client_id:await this.core.crypto.getClientId(),user_agent:xd(this.core.relayer.protocol,this.core.relayer.version,Ni)}}};await this.sendEvent([i])}catch(i){this.logger.warn(i)}}),Je(this,"createEvent",i=>{const{event:s="ERROR",type:o="",properties:{topic:a,trace:c}}=i,f=Ad(),h=this.core.projectId||"",l=Date.now(),y=yi({eventId:f,timestamp:l,props:{event:s,type:o,properties:{topic:a,trace:c}},bundleId:h,domain:this.getAppDomain()},this.setMethods(f));return this.telemetryEnabled&&(this.events.set(f,y),this.shouldPersist=!0),y}),Je(this,"getEvent",i=>{const{eventId:s,topic:o}=i;if(s)return this.events.get(s);const a=Array.from(this.events.values()).find(c=>c.props.properties.topic===o);if(a)return yi(yi({},a),this.setMethods(a.eventId))}),Je(this,"deleteEvent",i=>{const{eventId:s}=i;this.events.delete(s),this.shouldPersist=!0}),Je(this,"setEventListeners",()=>{this.core.heartbeat.on(Qr.pulse,async()=>{this.shouldPersist&&await this.persist(),this.events.forEach(i=>{H.fromMiliseconds(Date.now())-H.fromMiliseconds(i.timestamp)>Tf&&(this.events.delete(i.eventId),this.shouldPersist=!0)})})}),Je(this,"setMethods",i=>({addTrace:s=>this.addTrace(i,s),setError:s=>this.setError(i,s)})),Je(this,"addTrace",(i,s)=>{const o=this.events.get(i);o&&(o.props.properties.trace.push(s),this.events.set(i,o),this.shouldPersist=!0)}),Je(this,"setError",(i,s)=>{const o=this.events.get(i);o&&(o.props.type=s,o.timestamp=Date.now(),this.events.set(i,o),this.shouldPersist=!0)}),Je(this,"persist",async()=>{await this.core.storage.setItem(this.storageKey,Array.from(this.events.values())),this.shouldPersist=!1}),Je(this,"restore",async()=>{try{const i=await this.core.storage.getItem(this.storageKey)||[];if(!i.length)return;i.forEach(s=>{this.events.set(s.eventId,yi(yi({},s),this.setMethods(s.eventId)))})}catch(i){this.logger.warn(i)}}),Je(this,"submit",async()=>{if(!this.telemetryEnabled||this.events.size===0)return;const i=[];for(const[s,o]of this.events)o.props.type&&i.push(o);if(i.length!==0)try{if((await this.sendEvent(i)).ok)for(const s of i)this.events.delete(s.eventId),this.shouldPersist=!0}catch(s){this.logger.warn(s)}}),Je(this,"sendEvent",async i=>{const s=this.getAppDomain()?"":"&sp=desktop";return await fetch(`${Rf}?projectId=${this.core.projectId}&st=events_sdk&sv=js-${Ni}${s}`,{method:"POST",body:JSON.stringify(i)})}),Je(this,"getAppDomain",()=>C6().url),this.logger=lt(r,this.context),this.telemetryEnabled=n,n?this.restore().then(async()=>{await this.submit(),this.setEventListeners()}):this.persist()}get storageKey(){return this.storagePrefix+this.storageVersion+this.core.customStoragePrefix+"//"+this.context}}var L9=Object.defineProperty,o0=Object.getOwnPropertySymbols,F9=Object.prototype.hasOwnProperty,z9=Object.prototype.propertyIsEnumerable,Ga=(t,e,r)=>e in t?L9(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,a0=(t,e)=>{for(var r in e||(e={}))F9.call(e,r)&&Ga(t,r,e[r]);if(o0)for(var r of o0(e))z9.call(e,r)&&Ga(t,r,e[r]);return t},ae=(t,e,r)=>Ga(t,typeof e!="symbol"?e+"":e,r);class Ms extends fb{constructor(e){var r;super(e),ae(this,"protocol",Ws),ae(this,"version",Ys),ae(this,"name",qn),ae(this,"relayUrl"),ae(this,"projectId"),ae(this,"customStoragePrefix"),ae(this,"events",new At.exports.EventEmitter),ae(this,"logger"),ae(this,"heartbeat"),ae(this,"relayer"),ae(this,"crypto"),ae(this,"storage"),ae(this,"history"),ae(this,"expirer"),ae(this,"pairing"),ae(this,"verify"),ae(this,"echoClient"),ae(this,"linkModeSupportedApps"),ae(this,"eventClient"),ae(this,"initialized",!1),ae(this,"logChunkController"),ae(this,"on",(o,a)=>this.events.on(o,a)),ae(this,"once",(o,a)=>this.events.once(o,a)),ae(this,"off",(o,a)=>this.events.off(o,a)),ae(this,"removeListener",(o,a)=>this.events.removeListener(o,a)),ae(this,"dispatchEnvelope",({topic:o,message:a,sessionExists:c})=>{if(!o||!a)return;const f={topic:o,message:a,publishedAt:Date.now(),transportType:$r.link_mode};this.relayer.onLinkMessageEvent(f,{sessionExists:c})}),this.projectId=e?.projectId,this.relayUrl=e?.relayUrl||Zs,this.customStoragePrefix=e!=null&&e.customStoragePrefix?`:${e.customStoragePrefix}`:"";const n=Gc({level:typeof e?.logger=="string"&&e.logger?e.logger:Zc.logger,name:qn}),{logger:i,chunkLoggerController:s}=ob({opts:n,maxSizeInBytes:e?.maxLogBlobSizeInBytes,loggerOverride:e?.logger});this.logChunkController=s,(r=this.logChunkController)!=null&&r.downloadLogsBlobInBrowser&&(window.downloadLogsBlobInBrowser=async()=>{var o,a;(o=this.logChunkController)!=null&&o.downloadLogsBlobInBrowser&&((a=this.logChunkController)==null||a.downloadLogsBlobInBrowser({clientId:await this.crypto.getClientId()}))}),this.logger=lt(i,this.name),this.heartbeat=new Us,this.crypto=new wl(this,this.logger,e?.keychain),this.history=new Ql(this,this.logger),this.expirer=new e0(this,this.logger),this.storage=e!=null&&e.storage?e.storage:new B1(a0(a0({},Jc),e?.storageOptions)),this.relayer=new Hl({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new Jl(this,this.logger),this.verify=new t0(this,this.logger,this.storage),this.echoClient=new n0(this.projectId||"",this.logger),this.linkModeSupportedApps=[],this.eventClient=new s0(this,this.logger,e?.telemetryEnabled)}static async init(e){const r=new Ms(e);await r.initialize();const n=await r.crypto.getClientId();return await r.storage.setItem(lf,n),r}get context(){return wt(this.logger)}async start(){this.initialized||await this.initialize()}async getLogsBlob(){var e;return(e=this.logChunkController)==null?void 0:e.logsToBlob({clientId:await this.crypto.getClientId()})}async addLinkModeSupportedApp(e){this.linkModeSupportedApps.includes(e)||(this.linkModeSupportedApps.push(e),await this.storage.setItem(Js,this.linkModeSupportedApps))}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.linkModeSupportedApps=await this.storage.getItem(Js)||[],this.initialized=!0,this.logger.info("Core Initialization Success")}catch(e){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,e),this.logger.error(e.message),e}}}const U9=Ms;U.CORE_CONTEXT=qn,U.CORE_DEFAULT=Zc,U.CORE_PROTOCOL=Ws,U.CORE_STORAGE_OPTIONS=Jc,U.CORE_STORAGE_PREFIX=Ct,U.CORE_VERSION=Ys,U.CRYPTO_CLIENT_SEED=Gs,U.CRYPTO_CONTEXT=Qc,U.CRYPTO_JWT_TTL=ef,U.Core=U9,U.Crypto=wl,U.ECHO_CONTEXT=Af,U.ECHO_URL=Df,U.EVENTS_CLIENT_API_URL=Rf,U.EVENTS_STORAGE_CLEANUP_INTERVAL=Tf,U.EVENTS_STORAGE_CONTEXT=Mf,U.EVENTS_STORAGE_VERSION=Of,U.EVENT_CLIENT_AUTHENTICATE_ERRORS=Pb,U.EVENT_CLIENT_AUTHENTICATE_TRACES=Nb,U.EVENT_CLIENT_CONTEXT=Tb,U.EVENT_CLIENT_PAIRING_ERRORS=sr,U.EVENT_CLIENT_PAIRING_TRACES=Kt,U.EVENT_CLIENT_SESSION_ERRORS=Bb,U.EVENT_CLIENT_SESSION_TRACES=Rb,U.EXPIRER_CONTEXT=wf,U.EXPIRER_DEFAULT_TTL=Ob,U.EXPIRER_EVENTS=Ot,U.EXPIRER_STORAGE_VERSION=_f,U.EchoClient=n0,U.EventClient=s0,U.Expirer=e0,U.HISTORY_CONTEXT=yf,U.HISTORY_EVENTS=Dt,U.HISTORY_STORAGE_VERSION=mf,U.JsonRpcHistory=Ql,U.KEYCHAIN_CONTEXT=tf,U.KEYCHAIN_STORAGE_VERSION=rf,U.KeyChain=ml,U.MESSAGES_CONTEXT=nf,U.MESSAGES_STORAGE_VERSION=sf,U.MESSAGE_DIRECTION=Hn,U.MessageTracker=El,U.PAIRING_CONTEXT=gf,U.PAIRING_DEFAULT_TTL=Db,U.PAIRING_EVENTS=sn,U.PAIRING_RPC_OPTS=nn,U.PAIRING_STORAGE_VERSION=vf,U.PENDING_SUB_RESOLUTION_TIMEOUT=Ab,U.PUBLISHER_CONTEXT=of,U.PUBLISHER_DEFAULT_TTL=Xs,U.Pairing=Jl,U.RELAYER_CONTEXT=ff,U.RELAYER_DEFAULT_LOGGER=cf,U.RELAYER_DEFAULT_PROTOCOL=af,U.RELAYER_DEFAULT_RELAY_URL=Zs,U.RELAYER_EVENTS=Qe,U.RELAYER_PROVIDER_EVENTS=_t,U.RELAYER_RECONNECT_TIMEOUT=hf,U.RELAYER_SDK_VERSION=Ni,U.RELAYER_STORAGE_OPTIONS=xb,U.RELAYER_SUBSCRIBER_SUFFIX=uf,U.RELAYER_TRANSPORT_CUTOFF=Sb,U.Relayer=Hl,U.STORE_STORAGE_VERSION=df,U.SUBSCRIBER_CONTEXT=bf,U.SUBSCRIBER_DEFAULT_TTL=Ib,U.SUBSCRIBER_EVENTS=bt,U.SUBSCRIBER_STORAGE_VERSION=pf,U.Store=Zl,U.Subscriber=kl,U.TRANSPORT_TYPES=$r,U.TRUSTED_VERIFY_URLS=If,U.VERIFY_CONTEXT=Ef,U.VERIFY_SERVER=Kn,U.VERIFY_SERVER_V3=Sf,U.Verify=t0,U.WALLETCONNECT_CLIENT_ID=lf,U.WALLETCONNECT_LINK_MODE_APPS=Js,U.default=Ms,Object.defineProperty(U,"__esModule",{value:!0})});
//# sourceMappingURL=index.umd.js.map
