"use strict";function e(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(exports,"__esModule",{value:!0});var t=e(require("react-dom")),r=require("react"),n=e(r),a=e(require("react-modal")),s=require("events"),i=require("rxjs"),l=e(require("qrcode.react")),o=require("@ngraveio/bc-ur");const A=({size:e=200,data:t="",ecl:r="L"})=>n.createElement(l,{value:t,size:e,level:r});var c,u,m;(c=exports.ReadStatus||(exports.ReadStatus={})).canceled="canceled",c.success="success",(u=exports.PlayStatus||(exports.PlayStatus={})).canceled="canceled",u.success="success",(m=exports.SupportedResult||(exports.SupportedResult={})).UR_BYTES="bytes",m.UR_CRYPTO_HDKEY="crypto-hdkey",m.UR_CRYPTO_ACCOUNT="crypto-account",m.UR_ETH_SIGN_REQUEST="eth-sign-request",m.UR_ETH_SIGNATURE="eth-signature",m.UR_CRYPTO_MULTI_ACCOUNTS="crypto-multi-accounts",m.UR_SOL_SIGN_REQUEST="sol-sign-request",m.UR_SOL_SIGNATURE="sol-signature",m.UR_APTOS_SIGN_REQUEST="aptos-sign-request",m.UR_APTOS_SIGNATURE="aptos-signature",m.UR_ARWEAVE_SIGN_REQUEST="arweave-sign-request",m.UR_ARWEAVE_SIGNATURE="arweave-signature",m.UR_ARWEAVE_CRYPTO_ACCOUNT="arweave-crypto-account",m.UR_COSMOS_SIGN_REQUEST="cosmos-sign-request",m.UR_COSMOS_SIGNATURE="cosmos-signature";const d={minWidth:"16rem",height:"3rem",background:"#784FFE",borderColor:"grey",borderRadius:"8px",borderWidth:1,color:"white",outline:"none",margin:2},y=e=>{const{onClick:t,children:r}=e;return n.createElement("button",{onClick:t,style:d},r)},E=e=>n.createElement("div",{style:{width:"100%",marginTop:"1rem",display:"flex",flexDirection:"row-reverse",alignItems:"center",justifyContent:"center"}},e.children),g=new o.UR(Buffer.from("NO DATA","utf-8"));class p extends Error{constructor(e){super(e),Object.setPrototypeOf(this,p.prototype)}}const S=()=>n.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",style:{margin:"auto",display:"block",shapeRendering:"auto",animationPlayState:"running",animationDelay:"0s"},width:"200px",height:"200px",viewBox:"0 0 100 100",preserveAspectRatio:"xMidYMid"},n.createElement("circle",{cx:"50",cy:"50",fill:"none",stroke:"#9b9b9b",strokeWidth:"7",r:"35",strokeDasharray:"164.93361431346415 56.97787143782138",style:{animationPlayState:"running",animationDelay:"0s"}},n.createElement("animateTransform",{attributeName:"transform",type:"rotate",repeatCount:"indefinite",dur:"1s",values:"0 50 50;360 50 50",keyTimes:"0;1",style:{animationPlayState:"running",animationDelay:"0s"}}))),f=n.lazy(()=>new Promise((function(e){e(function(e){if(e&&e.__esModule)return e;var t={};return e&&Object.keys(e).forEach((function(r){var n=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(t,r,n.get?n:{enumerable:!0,get:function(){return e[r]}})})),t.default=e,t}(require("react-qr-reader")))})));let R="";const h=e=>n.createElement("div",{style:{paddingLeft:"1rem"}},n.createElement("div",{style:{display:"flex",alignItems:"center",padding:0}},n.createElement("img",{style:{display:"inline-block"},src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAoCAYAAACfKfiZAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAKAAAAACc9ikyAAAD+ElEQVRYCb1WbWiNURw/Z9caY5SyrKzVhuUtZcYoJdZ8kMywGClG+WK+eJsPmogNKfZBxBbmAyPyEgvtA8UUX9inbVeb8AGTd8t2j9/vdp91ntPzPPd57h3/+t1z/uf/ev7nnP9zhUiMsmH2BOgF9ifmIjmrVpgrDWuScxfMeqUW2EqiB2sjgrlJTDsNZmHACqyP2xJzGcyq2iU4E7kTzFVw7fEw+Qbou9bn94K7FCIlgNFh6I7y0E8oAQ9/NlEBuAig71ifv4VspM1iiJnHHsGZyPohjmdzxzeu79acsyFJm8UQMnzbfONmUIvnsRTG4g3DWAM8B24DM4GkaR88WMGcxkYtQr2h+wl8niYPPJ0Aix+AU2Cu8UlmASRe0gHA1L1JYaLUBEPToc7v1hx7XdISTc/3tAiaXs+uE3K2ZdJaQE/MnLdDzvvhm3ij2wDTkc4vj3lLx/gmji7tqmL6voYNcRze17zwv4CemNuc/xt8NSoqsau5OfoD2TSAxDb+EXDTNdeX0igeHYSCaajzfGoWZWDidU90O84XWIZuYw4EvwDT0OK527GG8VUPfcuO4wPAsVvqt/MolIYDbsSmxLPUiS+gEpgBOH1Z+7HOC90MMBFXYnn0jM35S8hDrtZJCFgBluZEHB/bIWenc6XVV1Qo/MCxCoM2ucUi0lwubX4YfBng1TKvQ1426MWY1NSolAs94jJKVoYaOh2DbqGw3ddQqutqkGcooEG5rmHM+8DvMNZs7KVuUaiUWOUjOO0k9HIjSpzOq1RRv0xgus2jnTkONhxbKsZ4A7gFlMbWRChddMLtZ4v3O0YiojZvq8rkEbwCrOai278Dkw98BxYBLYD+anaB58sREzerosiAaMExjCbvl0KpooAV6HIx2IN1Bk8FTgF6cLDiCLCTk86z8mlKSCzBbr6S90NSooumiXYm8MjBgG+3KbZehXGygw6XmAQrEU0C77TETxII3ofA6zrrZR+PIAvoBrhTEnvAPIBJZAIdQLzS8r8BkxGTNqq5AxLHocQY8iYxOIKuwCu4Sxkr8B7g5bLoIiYMTjoExAtOvTqASYiORtmmJCohxRfyBv3GeqkVnDJWgLQQaAV45iw3k5oKsAMySb9UDcVaKuduUYWiX1xDObPJI/AHDBXhBsnvwiBZCXChAuA/nWdkQLxg0bJGOf8/tDtG9fxNKqNfisX4ZKamC/Gw/Zzs9e9GiL1Q5n0ICn6A5gQJ5KY7C4Ig33s90WibdXOsr3ud7wsoshcwiaAUPfegRm76syHgBylINaIX0c1hout8FecB/i/Uy23OedvZP/4Z5cDzSeAnYAZnK54P/BcahygHAD5dNh12tilAIPoLD0OnpwCV000AAAAASUVORK5CYII=",alt:""}),n.createElement("div",{style:{fontSize:"1.25rem",fontWeight:"bold",marginLeft:"1rem"}},"Sync Keystone")),n.createElement("ul",{style:{marginTop:"2rem",listStyleType:"none",padding:0,fontSize:"1rem"}},n.createElement("li",{style:{marginBottom:"0.75rem"}},"1. Turn on your Keystone hardware device"),n.createElement("li",{style:{marginBottom:"0.75rem"}},`2. Select your "${e.walletMode}" as your Watch-only wallet(Companion App)`),n.createElement("li",{style:{marginBottom:"0.75rem"}}," ",'3. Press the "Scan Keystone" button and scan the QR Code displayed on your Keystone hardware wallet'),n.createElement("li",{style:{marginBottom:"0.75rem"}}," ","4. Select account and check your watch-only wallet")),n.createElement("div",{style:{marginBottom:"1rem"}},n.createElement("a",{style:{marginTop:"1.25rem",color:"#784FFE",textDecoration:"none"},href:e.link,target:"_blank",rel:"noreferrer"},"Click here to view detailed tutorial")),n.createElement(y,{onClick:e.onButtonClick},"Sync Keystone")),v={overlay:{zIndex:999},content:{top:"50%",left:"50%",right:"auto",bottom:"auto",borderRadius:"10px",width:"37rem",marginRight:"-50%",transform:"translate(-50%, -50%)",postion:"relative"}};var x=()=>{const[e,{read:t,play:l,cameraReady:c}]=(()=>{const e=r.useMemo(()=>new s.EventEmitter,[]),[t,l]=r.useState(!1),[c,u]=r.useState(""),[m,d]=r.useState(""),[x,w]=r.useState(null),[U,{play:C}]=(()=>{const[e,t]=r.useState(g),[a,l]=r.useState(!1),[c,u]=r.useState(100),[m,d]=r.useState(400),[p,S]=r.useState(!1),[f,R]=r.useState(null),[h,v]=r.useState(null),x=r.useMemo(()=>new o.UREncoder(e,m),[e]),[w,U]=r.useState(x.nextPart()),C=r.useMemo(()=>new s.EventEmitter,[]);return r.useEffect(()=>{x.cbor.toString("hex")!==g.cbor.toString("hex")&&l(!0)},[x]),r.useEffect(()=>{const e=i.interval(c).subscribe(()=>{U(x.nextPart())});return()=>{e.unsubscribe()}},[c,x]),[a?n.createElement("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"}},f&&n.createElement("p",{style:{fontSize:"1.25rem",fontWeight:"bold"}},f),n.createElement(A,{size:288,data:w}),h&&n.createElement("p",{style:{fontSize:"1rem",textAlign:"center"}},h),n.createElement(E,null,n.createElement(y,{onClick:()=>{C.emit("finish",!0)}},p?"Scan Keystone":"Finish"))):n.createElement("div",null),{play:(e,r)=>new Promise(n=>{t(e),r&&(r.refreshSpeed&&u(r.refreshSpeed),r.hasNext&&S(r.hasNext),r.title&&R(r.title),r.description&&v(r.description),r.maxFragmentLength&&d(r.maxFragmentLength)),C.once("finish",()=>{t(g),l(!1),u(100),n(exports.PlayStatus.success)})})}]})(),[b,{read:T,cameraReady:B}]=(()=>{const[e,t]=r.useState(!1),[a,i]=r.useState([]),[l,A]=r.useState(new o.URDecoder),[c,u]=r.useState(""),m=r.useMemo(()=>new s.EventEmitter,[]),[d,g]=r.useState(null),[h,v]=r.useState(0),[x,w]=r.useState(null),U=()=>{A(new o.URDecoder),u("")};return[n.createElement("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"}},d&&n.createElement("p",{style:{fontSize:"1.25rem",fontWeight:"bold"}},d),x&&n.createElement("p",{style:{fontSize:"1rem",textAlign:"center"}},x),n.createElement(r.Suspense,{fallback:n.createElement("div",null)},n.createElement("div",{style:{position:"relative",width:"100%"}},e?null:n.createElement("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)"}},n.createElement(S,null)),n.createElement(f,{onScan:e=>{e&&(t(!0),((e,t)=>{try{if(l.isComplete()){const e=l.resultUR();let t=!1;if(a.forEach(r=>{if(r===e.type)return t=!0,void m.emit("read",{result:e,status:"success"})}),!t)throw new p(`received ur type ${e.type}, but expected [${a.join(",")}]`)}else l.receivePart(e),v(l.getProgress())}catch(e){u(e instanceof p?t:e.message)}})(e,R))},delay:100,style:{width:"100%"},onError:e=>{u(e.message)}}))),n.createElement("p",null,(100*h).toFixed(0)," %"),c&&n.createElement("p",{style:{color:"red",fontSize:"1rem"}},c),n.createElement(E,null,n.createElement(y,{onClick:()=>{m.emit("read",{status:"canceled"})}},"Close"),c&&n.createElement(y,{onClick:()=>{U()}},"Retry"))),{read:(e,t)=>new Promise(r=>{i(e),t&&(t.title&&g(t.title),t.description&&w(t.description),R=t.URTypeErrorMessage?t.URTypeErrorMessage:""),m.once("read",e=>{U(),r(e)})}),cameraReady:e}]})(),D=()=>{w(null),d(""),u(""),l(!1)};var P;return[n.createElement(a,{isOpen:t,style:v},n.createElement("div",{onClick:()=>{e.emit("close"),D()}},n.createElement("img",{style:{position:"absolute",top:"1rem",right:"1rem"},src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAADKADAAQAAAABAAAADAAAAAATDPpdAAAAmklEQVQoFZWRwQ3DIAwAa4brJPBP80hnaD/lD5N0iYxEfRVBxBGRwsvgO2PZklJaReTrvX/eTk7O+VVKuTtgDRYVPyOeHAysAFV40jCGEB69aHN/YSRZGK4JVuKu5/DrToDoqnI9tOh4vXJ2Qlc96kSY2lTfWs0m9DCT0r3MSkUrXR9r3eBCNbuDrY/td23z7Vg3wQhGIgcD+wPGY2fPvHuWagAAAABJRU5ErkJggg=="})),n.createElement("div",{style:{width:"35rem",padding:18,flex:1,flexDirection:"column",alignItems:"center",justifyContent:"center",color:"#002237"}},"initial"===(P=x)?n.createElement(h,{walletMode:c,link:m,onButtonClick:()=>{w("read")}}):"read"===P?b:"play"===P?U:null)),{play:(t,r)=>new Promise(n=>{e.once("close",()=>{n(exports.PlayStatus.canceled)}),l(!0),w("play"),C(t,r).then(()=>{D(),n(exports.PlayStatus.success)})}),read:async(t,r)=>new Promise(n=>{e.once("close",()=>{D(),n({status:exports.ReadStatus.canceled})}),r.renderInitial?(u(r.renderInitial.walletMode),d(r.renderInitial.link),w("initial"),l(!0),T(t,r).then(e=>{D(),n(e)})):(w("read"),l(!0),T(t,r).then(e=>{D(),n(e)}))}),cameraReady:B}]})();return T(t,l,c),e};let w,U,C,b=!1;const T=(e,t,r)=>{b=!0,w=e,U=t,C=r};exports.default={bootstrap:()=>{const e=document.getElementsByTagName("body").item(0),r=document.createElement("div");r.id="kv_sdk_container",e.appendChild(r),a.setAppElement("#kv_sdk_container"),t.render(n.createElement(x),r)},getSdk:()=>{if(b)return{read:w,play:U,cameraReady:C};throw new Error("SDK is not initialized")}};
//# sourceMappingURL=sdk.cjs.production.min.js.map
