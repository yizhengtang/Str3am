(function(ie,Nt){typeof exports=="object"&&typeof module<"u"?Nt(exports):typeof define=="function"&&define.amd?define(["exports"],Nt):(ie=typeof globalThis<"u"?globalThis:ie||self,Nt(ie["@walletconnect/sign-client"]={}))})(this,function(ie){"use strict";var Nt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ja(t){var e=t.default;if(typeof e=="function"){var r=function(){return e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(t).forEach(function(i){var n=Object.getOwnPropertyDescriptor(t,i);Object.defineProperty(r,i,n.get?n:{enumerable:!0,get:function(){return t[i]}})}),r}var zt={exports:{}},bn=typeof Reflect=="object"?Reflect:null,Sf=bn&&typeof bn.apply=="function"?bn.apply:function(e,r,i){return Function.prototype.apply.call(e,r,i)},go;bn&&typeof bn.ownKeys=="function"?go=bn.ownKeys:Object.getOwnPropertySymbols?go=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:go=function(e){return Object.getOwnPropertyNames(e)};function G1(t){console&&console.warn&&console.warn(t)}var If=Number.isNaN||function(e){return e!==e};function le(){le.init.call(this)}zt.exports=le,zt.exports.once=Z1,le.EventEmitter=le,le.prototype._events=void 0,le.prototype._eventsCount=0,le.prototype._maxListeners=void 0;var Af=10;function yo(t){if(typeof t!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}Object.defineProperty(le,"defaultMaxListeners",{enumerable:!0,get:function(){return Af},set:function(t){if(typeof t!="number"||t<0||If(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");Af=t}}),le.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},le.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||If(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function Df(t){return t._maxListeners===void 0?le.defaultMaxListeners:t._maxListeners}le.prototype.getMaxListeners=function(){return Df(this)},le.prototype.emit=function(e){for(var r=[],i=1;i<arguments.length;i++)r.push(arguments[i]);var n=e==="error",s=this._events;if(s!==void 0)n=n&&s.error===void 0;else if(!n)return!1;if(n){var o;if(r.length>0&&(o=r[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var c=s[e];if(c===void 0)return!1;if(typeof c=="function")Sf(c,this,r);else for(var u=c.length,h=Tf(c,u),i=0;i<u;++i)Sf(h[i],this,r);return!0};function Of(t,e,r,i){var n,s,o;if(yo(r),s=t._events,s===void 0?(s=t._events=Object.create(null),t._eventsCount=0):(s.newListener!==void 0&&(t.emit("newListener",e,r.listener?r.listener:r),s=t._events),o=s[e]),o===void 0)o=s[e]=r,++t._eventsCount;else if(typeof o=="function"?o=s[e]=i?[r,o]:[o,r]:i?o.unshift(r):o.push(r),n=Df(t),n>0&&o.length>n&&!o.warned){o.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=t,a.type=e,a.count=o.length,G1(a)}return t}le.prototype.addListener=function(e,r){return Of(this,e,r,!1)},le.prototype.on=le.prototype.addListener,le.prototype.prependListener=function(e,r){return Of(this,e,r,!0)};function W1(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Mf(t,e,r){var i={fired:!1,wrapFn:void 0,target:t,type:e,listener:r},n=W1.bind(i);return n.listener=r,i.wrapFn=n,n}le.prototype.once=function(e,r){return yo(r),this.on(e,Mf(this,e,r)),this},le.prototype.prependOnceListener=function(e,r){return yo(r),this.prependListener(e,Mf(this,e,r)),this},le.prototype.removeListener=function(e,r){var i,n,s,o,a;if(yo(r),n=this._events,n===void 0)return this;if(i=n[e],i===void 0)return this;if(i===r||i.listener===r)--this._eventsCount===0?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,i.listener||r));else if(typeof i!="function"){for(s=-1,o=i.length-1;o>=0;o--)if(i[o]===r||i[o].listener===r){a=i[o].listener,s=o;break}if(s<0)return this;s===0?i.shift():Y1(i,s),i.length===1&&(n[e]=i[0]),n.removeListener!==void 0&&this.emit("removeListener",e,a||r)}return this},le.prototype.off=le.prototype.removeListener,le.prototype.removeAllListeners=function(e){var r,i,n;if(i=this._events,i===void 0)return this;if(i.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):i[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete i[e]),this;if(arguments.length===0){var s=Object.keys(i),o;for(n=0;n<s.length;++n)o=s[n],o!=="removeListener"&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(r=i[e],typeof r=="function")this.removeListener(e,r);else if(r!==void 0)for(n=r.length-1;n>=0;n--)this.removeListener(e,r[n]);return this};function $f(t,e,r){var i=t._events;if(i===void 0)return[];var n=i[e];return n===void 0?[]:typeof n=="function"?r?[n.listener||n]:[n]:r?X1(n):Tf(n,n.length)}le.prototype.listeners=function(e){return $f(this,e,!0)},le.prototype.rawListeners=function(e){return $f(this,e,!1)},le.listenerCount=function(t,e){return typeof t.listenerCount=="function"?t.listenerCount(e):Pf.call(t,e)},le.prototype.listenerCount=Pf;function Pf(t){var e=this._events;if(e!==void 0){var r=e[t];if(typeof r=="function")return 1;if(r!==void 0)return r.length}return 0}le.prototype.eventNames=function(){return this._eventsCount>0?go(this._events):[]};function Tf(t,e){for(var r=new Array(e),i=0;i<e;++i)r[i]=t[i];return r}function Y1(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function X1(t){for(var e=new Array(t.length),r=0;r<e.length;++r)e[r]=t[r].listener||t[r];return e}function Z1(t,e){return new Promise(function(r,i){function n(o){t.removeListener(e,s),i(o)}function s(){typeof t.removeListener=="function"&&t.removeListener("error",n),r([].slice.call(arguments))}Rf(t,e,s,{once:!0}),e!=="error"&&J1(t,n,{once:!0})})}function J1(t,e,r){typeof t.on=="function"&&Rf(t,"error",e,r)}function Rf(t,e,r,i){if(typeof t.on=="function")i.once?t.once(e,r):t.on(e,r);else if(typeof t.addEventListener=="function")t.addEventListener(e,function n(s){i.once&&t.removeEventListener(e,n),r(s)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t)}var V={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var Ka=function(t,e){return Ka=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)i.hasOwnProperty(n)&&(r[n]=i[n])},Ka(t,e)};function Q1(t,e){Ka(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var Va=function(){return Va=Object.assign||function(e){for(var r,i=1,n=arguments.length;i<n;i++){r=arguments[i];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Va.apply(this,arguments)};function eb(t,e){var r={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(r[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(t);n<i.length;n++)e.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(t,i[n])&&(r[i[n]]=t[i[n]]);return r}function tb(t,e,r,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,r):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,r,i);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(n<3?o(s):n>3?o(e,r,s):o(e,r))||s);return n>3&&s&&Object.defineProperty(e,r,s),s}function rb(t,e){return function(r,i){e(r,i,t)}}function ib(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function nb(t,e,r,i){function n(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function a(h){try{u(i.next(h))}catch(l){o(l)}}function c(h){try{u(i.throw(h))}catch(l){o(l)}}function u(h){h.done?s(h.value):n(h.value).then(a,c)}u((i=i.apply(t,e||[])).next())})}function sb(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},i,n,s,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(u){return function(h){return c([u,h])}}function c(u){if(i)throw new TypeError("Generator is already executing.");for(;r;)try{if(i=1,n&&(s=u[0]&2?n.return:u[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,u[1])).done)return s;switch(n=0,s&&(u=[u[0]&2,s.value]),u[0]){case 0:case 1:s=u;break;case 4:return r.label++,{value:u[1],done:!1};case 5:r.label++,n=u[1],u=[0];continue;case 7:u=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(u[0]===6||u[0]===2)){r=0;continue}if(u[0]===3&&(!s||u[1]>s[0]&&u[1]<s[3])){r.label=u[1];break}if(u[0]===6&&r.label<s[1]){r.label=s[1],s=u;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(u);break}s[2]&&r.ops.pop(),r.trys.pop();continue}u=e.call(t,r)}catch(h){u=[6,h],n=0}finally{i=s=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}function ob(t,e,r,i){i===void 0&&(i=r),t[i]=e[r]}function ab(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function Ha(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],i=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Nf(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var i=r.call(t),n,s=[],o;try{for(;(e===void 0||e-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(a){o={error:a}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return s}function cb(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(Nf(arguments[e]));return t}function ub(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var i=Array(t),n=0,e=0;e<r;e++)for(var s=arguments[e],o=0,a=s.length;o<a;o++,n++)i[n]=s[o];return i}function ns(t){return this instanceof ns?(this.v=t,this):new ns(t)}function fb(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=r.apply(t,e||[]),n,s=[];return n={},o("next"),o("throw"),o("return"),n[Symbol.asyncIterator]=function(){return this},n;function o(b){i[b]&&(n[b]=function(w){return new Promise(function(g,x){s.push([b,w,g,x])>1||a(b,w)})})}function a(b,w){try{c(i[b](w))}catch(g){l(s[0][3],g)}}function c(b){b.value instanceof ns?Promise.resolve(b.value.v).then(u,h):l(s[0][2],b)}function u(b){a("next",b)}function h(b){a("throw",b)}function l(b,w){b(w),s.shift(),s.length&&a(s[0][0],s[0][1])}}function hb(t){var e,r;return e={},i("next"),i("throw",function(n){throw n}),i("return"),e[Symbol.iterator]=function(){return this},e;function i(n,s){e[n]=t[n]?function(o){return(r=!r)?{value:ns(t[n](o)),done:n==="return"}:s?s(o):o}:s}}function db(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof Ha=="function"?Ha(t):t[Symbol.iterator](),r={},i("next"),i("throw"),i("return"),r[Symbol.asyncIterator]=function(){return this},r);function i(s){r[s]=t[s]&&function(o){return new Promise(function(a,c){o=t[s](o),n(a,c,o.done,o.value)})}}function n(s,o,a,c){Promise.resolve(c).then(function(u){s({value:u,done:a})},o)}}function lb(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function pb(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function bb(t){return t&&t.__esModule?t:{default:t}}function gb(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function yb(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}var vb=Object.freeze({__proto__:null,__extends:Q1,get __assign(){return Va},__rest:eb,__decorate:tb,__param:rb,__metadata:ib,__awaiter:nb,__generator:sb,__createBinding:ob,__exportStar:ab,__values:Ha,__read:Nf,__spread:cb,__spreadArrays:ub,__await:ns,__asyncGenerator:fb,__asyncDelegator:hb,__asyncValues:db,__makeTemplateObject:lb,__importStar:pb,__importDefault:bb,__classPrivateFieldGet:gb,__classPrivateFieldSet:yb}),vo=ja(vb),Ga={},ss={},Cf;function mb(){if(Cf)return ss;Cf=1,Object.defineProperty(ss,"__esModule",{value:!0}),ss.delay=void 0;function t(e){return new Promise(r=>{setTimeout(()=>{r(!0)},e)})}return ss.delay=t,ss}var Ni={},Wa={},Ci={},Bf;function wb(){return Bf||(Bf=1,Object.defineProperty(Ci,"__esModule",{value:!0}),Ci.ONE_THOUSAND=Ci.ONE_HUNDRED=void 0,Ci.ONE_HUNDRED=100,Ci.ONE_THOUSAND=1e3),Ci}var Ya={},Ff;function _b(){return Ff||(Ff=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.ONE_YEAR=t.FOUR_WEEKS=t.THREE_WEEKS=t.TWO_WEEKS=t.ONE_WEEK=t.THIRTY_DAYS=t.SEVEN_DAYS=t.FIVE_DAYS=t.THREE_DAYS=t.ONE_DAY=t.TWENTY_FOUR_HOURS=t.TWELVE_HOURS=t.SIX_HOURS=t.THREE_HOURS=t.ONE_HOUR=t.SIXTY_MINUTES=t.THIRTY_MINUTES=t.TEN_MINUTES=t.FIVE_MINUTES=t.ONE_MINUTE=t.SIXTY_SECONDS=t.THIRTY_SECONDS=t.TEN_SECONDS=t.FIVE_SECONDS=t.ONE_SECOND=void 0,t.ONE_SECOND=1,t.FIVE_SECONDS=5,t.TEN_SECONDS=10,t.THIRTY_SECONDS=30,t.SIXTY_SECONDS=60,t.ONE_MINUTE=t.SIXTY_SECONDS,t.FIVE_MINUTES=t.ONE_MINUTE*5,t.TEN_MINUTES=t.ONE_MINUTE*10,t.THIRTY_MINUTES=t.ONE_MINUTE*30,t.SIXTY_MINUTES=t.ONE_MINUTE*60,t.ONE_HOUR=t.SIXTY_MINUTES,t.THREE_HOURS=t.ONE_HOUR*3,t.SIX_HOURS=t.ONE_HOUR*6,t.TWELVE_HOURS=t.ONE_HOUR*12,t.TWENTY_FOUR_HOURS=t.ONE_HOUR*24,t.ONE_DAY=t.TWENTY_FOUR_HOURS,t.THREE_DAYS=t.ONE_DAY*3,t.FIVE_DAYS=t.ONE_DAY*5,t.SEVEN_DAYS=t.ONE_DAY*7,t.THIRTY_DAYS=t.ONE_DAY*30,t.ONE_WEEK=t.SEVEN_DAYS,t.TWO_WEEKS=t.ONE_WEEK*2,t.THREE_WEEKS=t.ONE_WEEK*3,t.FOUR_WEEKS=t.ONE_WEEK*4,t.ONE_YEAR=t.ONE_DAY*365}(Ya)),Ya}var Lf;function qf(){return Lf||(Lf=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=vo;e.__exportStar(wb(),t),e.__exportStar(_b(),t)}(Wa)),Wa}var zf;function Eb(){if(zf)return Ni;zf=1,Object.defineProperty(Ni,"__esModule",{value:!0}),Ni.fromMiliseconds=Ni.toMiliseconds=void 0;const t=qf();function e(i){return i*t.ONE_THOUSAND}Ni.toMiliseconds=e;function r(i){return Math.floor(i/t.ONE_THOUSAND)}return Ni.fromMiliseconds=r,Ni}var Uf;function xb(){return Uf||(Uf=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=vo;e.__exportStar(mb(),t),e.__exportStar(Eb(),t)}(Ga)),Ga}var gn={},kf;function Sb(){if(kf)return gn;kf=1,Object.defineProperty(gn,"__esModule",{value:!0}),gn.Watch=void 0;class t{constructor(){this.timestamps=new Map}start(r){if(this.timestamps.has(r))throw new Error(`Watch already started for label: ${r}`);this.timestamps.set(r,{started:Date.now()})}stop(r){const i=this.get(r);if(typeof i.elapsed<"u")throw new Error(`Watch already stopped for label: ${r}`);const n=Date.now()-i.started;this.timestamps.set(r,{started:i.started,elapsed:n})}get(r){const i=this.timestamps.get(r);if(typeof i>"u")throw new Error(`No timestamp found for label: ${r}`);return i}elapsed(r){const i=this.get(r);return i.elapsed||Date.now()-i.started}}return gn.Watch=t,gn.default=t,gn}var Xa={},os={},jf;function Ib(){if(jf)return os;jf=1,Object.defineProperty(os,"__esModule",{value:!0}),os.IWatch=void 0;class t{}return os.IWatch=t,os}var Kf;function Ab(){return Kf||(Kf=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),vo.__exportStar(Ib(),t)}(Xa)),Xa}(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=vo;e.__exportStar(xb(),t),e.__exportStar(Sb(),t),e.__exportStar(Ab(),t),e.__exportStar(qf(),t)})(V);class Bi{}class Db extends Bi{constructor(e){super()}}const Vf=V.FIVE_SECONDS,yn={pulse:"heartbeat_pulse"};class Za extends Db{constructor(e){super(e),this.events=new zt.exports.EventEmitter,this.interval=Vf,this.interval=e?.interval||Vf}static async init(e){const r=new Za(e);return await r.init(),r}async init(){await this.initialize()}stop(){clearInterval(this.intervalRef)}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async initialize(){this.intervalRef=setInterval(()=>this.pulse(),V.toMiliseconds(this.interval))}pulse(){this.events.emit(yn.pulse)}}const Ob=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,Mb=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,$b=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function Pb(t,e){if(t==="__proto__"||t==="constructor"&&e&&typeof e=="object"&&"prototype"in e){Tb(t);return}return e}function Tb(t){console.warn(`[destr] Dropping "${t}" key to prevent prototype pollution.`)}function mo(t,e={}){if(typeof t!="string")return t;const r=t.trim();if(t[0]==='"'&&t.endsWith('"')&&!t.includes("\\"))return r.slice(1,-1);if(r.length<=9){const i=r.toLowerCase();if(i==="true")return!0;if(i==="false")return!1;if(i==="undefined")return;if(i==="null")return null;if(i==="nan")return Number.NaN;if(i==="infinity")return Number.POSITIVE_INFINITY;if(i==="-infinity")return Number.NEGATIVE_INFINITY}if(!$b.test(t)){if(e.strict)throw new SyntaxError("[destr] Invalid JSON");return t}try{if(Ob.test(t)||Mb.test(t)){if(e.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(t,Pb)}return JSON.parse(t)}catch(i){if(e.strict)throw i;return t}}function Rb(t){return!t||typeof t.then!="function"?Promise.resolve(t):t}function ht(t,...e){try{return Rb(t(...e))}catch(r){return Promise.reject(r)}}function Nb(t){const e=typeof t;return t===null||e!=="object"&&e!=="function"}function Cb(t){const e=Object.getPrototypeOf(t);return!e||e.isPrototypeOf(Object)}function wo(t){if(Nb(t))return String(t);if(Cb(t)||Array.isArray(t))return JSON.stringify(t);if(typeof t.toJSON=="function")return wo(t.toJSON());throw new Error("[unstorage] Cannot stringify value!")}const Ja="base64:";function Bb(t){return typeof t=="string"?t:Ja+qb(t)}function Fb(t){return typeof t!="string"||!t.startsWith(Ja)?t:Lb(t.slice(Ja.length))}function Lb(t){return globalThis.Buffer?Buffer.from(t,"base64"):Uint8Array.from(globalThis.atob(t),e=>e.codePointAt(0))}function qb(t){return globalThis.Buffer?Buffer.from(t).toString("base64"):globalThis.btoa(String.fromCodePoint(...t))}function Ut(t){return t&&t.split("?")[0]?.replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,"")||""}function zb(...t){return Ut(t.join(":"))}function _o(t){return t=Ut(t),t?t+":":""}function cA(t){return t}const Ub="memory",kb=()=>{const t=new Map;return{name:Ub,getInstance:()=>t,hasItem(e){return t.has(e)},getItem(e){return t.get(e)??null},getItemRaw(e){return t.get(e)??null},setItem(e,r){t.set(e,r)},setItemRaw(e,r){t.set(e,r)},removeItem(e){t.delete(e)},getKeys(){return[...t.keys()]},clear(){t.clear()},dispose(){t.clear()}}};function jb(t={}){const e={mounts:{"":t.driver||kb()},mountpoints:[""],watching:!1,watchListeners:[],unwatch:{}},r=u=>{for(const h of e.mountpoints)if(u.startsWith(h))return{base:h,relativeKey:u.slice(h.length),driver:e.mounts[h]};return{base:"",relativeKey:u,driver:e.mounts[""]}},i=(u,h)=>e.mountpoints.filter(l=>l.startsWith(u)||h&&u.startsWith(l)).map(l=>({relativeBase:u.length>l.length?u.slice(l.length):void 0,mountpoint:l,driver:e.mounts[l]})),n=(u,h)=>{if(e.watching){h=Ut(h);for(const l of e.watchListeners)l(u,h)}},s=async()=>{if(!e.watching){e.watching=!0;for(const u in e.mounts)e.unwatch[u]=await Hf(e.mounts[u],n,u)}},o=async()=>{if(e.watching){for(const u in e.unwatch)await e.unwatch[u]();e.unwatch={},e.watching=!1}},a=(u,h,l)=>{const b=new Map,w=g=>{let x=b.get(g.base);return x||(x={driver:g.driver,base:g.base,items:[]},b.set(g.base,x)),x};for(const g of u){const x=typeof g=="string",A=Ut(x?g:g.key),D=x?void 0:g.value,$=x||!g.options?h:{...h,...g.options},P=r(A);w(P).items.push({key:A,value:D,relativeKey:P.relativeKey,options:$})}return Promise.all([...b.values()].map(g=>l(g))).then(g=>g.flat())},c={hasItem(u,h={}){u=Ut(u);const{relativeKey:l,driver:b}=r(u);return ht(b.hasItem,l,h)},getItem(u,h={}){u=Ut(u);const{relativeKey:l,driver:b}=r(u);return ht(b.getItem,l,h).then(w=>mo(w))},getItems(u,h={}){return a(u,h,l=>l.driver.getItems?ht(l.driver.getItems,l.items.map(b=>({key:b.relativeKey,options:b.options})),h).then(b=>b.map(w=>({key:zb(l.base,w.key),value:mo(w.value)}))):Promise.all(l.items.map(b=>ht(l.driver.getItem,b.relativeKey,b.options).then(w=>({key:b.key,value:mo(w)})))))},getItemRaw(u,h={}){u=Ut(u);const{relativeKey:l,driver:b}=r(u);return b.getItemRaw?ht(b.getItemRaw,l,h):ht(b.getItem,l,h).then(w=>Fb(w))},async setItem(u,h,l={}){if(h===void 0)return c.removeItem(u);u=Ut(u);const{relativeKey:b,driver:w}=r(u);w.setItem&&(await ht(w.setItem,b,wo(h),l),w.watch||n("update",u))},async setItems(u,h){await a(u,h,async l=>{if(l.driver.setItems)return ht(l.driver.setItems,l.items.map(b=>({key:b.relativeKey,value:wo(b.value),options:b.options})),h);l.driver.setItem&&await Promise.all(l.items.map(b=>ht(l.driver.setItem,b.relativeKey,wo(b.value),b.options)))})},async setItemRaw(u,h,l={}){if(h===void 0)return c.removeItem(u,l);u=Ut(u);const{relativeKey:b,driver:w}=r(u);if(w.setItemRaw)await ht(w.setItemRaw,b,h,l);else if(w.setItem)await ht(w.setItem,b,Bb(h),l);else return;w.watch||n("update",u)},async removeItem(u,h={}){typeof h=="boolean"&&(h={removeMeta:h}),u=Ut(u);const{relativeKey:l,driver:b}=r(u);b.removeItem&&(await ht(b.removeItem,l,h),(h.removeMeta||h.removeMata)&&await ht(b.removeItem,l+"$",h),b.watch||n("remove",u))},async getMeta(u,h={}){typeof h=="boolean"&&(h={nativeOnly:h}),u=Ut(u);const{relativeKey:l,driver:b}=r(u),w=Object.create(null);if(b.getMeta&&Object.assign(w,await ht(b.getMeta,l,h)),!h.nativeOnly){const g=await ht(b.getItem,l+"$",h).then(x=>mo(x));g&&typeof g=="object"&&(typeof g.atime=="string"&&(g.atime=new Date(g.atime)),typeof g.mtime=="string"&&(g.mtime=new Date(g.mtime)),Object.assign(w,g))}return w},setMeta(u,h,l={}){return this.setItem(u+"$",h,l)},removeMeta(u,h={}){return this.removeItem(u+"$",h)},async getKeys(u,h={}){u=_o(u);const l=i(u,!0);let b=[];const w=[];for(const g of l){const x=await ht(g.driver.getKeys,g.relativeBase,h);for(const A of x){const D=g.mountpoint+Ut(A);b.some($=>D.startsWith($))||w.push(D)}b=[g.mountpoint,...b.filter(A=>!A.startsWith(g.mountpoint))]}return u?w.filter(g=>g.startsWith(u)&&g[g.length-1]!=="$"):w.filter(g=>g[g.length-1]!=="$")},async clear(u,h={}){u=_o(u),await Promise.all(i(u,!1).map(async l=>{if(l.driver.clear)return ht(l.driver.clear,l.relativeBase,h);if(l.driver.removeItem){const b=await l.driver.getKeys(l.relativeBase||"",h);return Promise.all(b.map(w=>l.driver.removeItem(w,h)))}}))},async dispose(){await Promise.all(Object.values(e.mounts).map(u=>Gf(u)))},async watch(u){return await s(),e.watchListeners.push(u),async()=>{e.watchListeners=e.watchListeners.filter(h=>h!==u),e.watchListeners.length===0&&await o()}},async unwatch(){e.watchListeners=[],await o()},mount(u,h){if(u=_o(u),u&&e.mounts[u])throw new Error(`already mounted at ${u}`);return u&&(e.mountpoints.push(u),e.mountpoints.sort((l,b)=>b.length-l.length)),e.mounts[u]=h,e.watching&&Promise.resolve(Hf(h,n,u)).then(l=>{e.unwatch[u]=l}).catch(console.error),c},async unmount(u,h=!0){u=_o(u),!(!u||!e.mounts[u])&&(e.watching&&u in e.unwatch&&(e.unwatch[u]?.(),delete e.unwatch[u]),h&&await Gf(e.mounts[u]),e.mountpoints=e.mountpoints.filter(l=>l!==u),delete e.mounts[u])},getMount(u=""){u=Ut(u)+":";const h=r(u);return{driver:h.driver,base:h.base}},getMounts(u="",h={}){return u=Ut(u),i(u,h.parents).map(b=>({driver:b.driver,base:b.mountpoint}))},keys:(u,h={})=>c.getKeys(u,h),get:(u,h={})=>c.getItem(u,h),set:(u,h,l={})=>c.setItem(u,h,l),has:(u,h={})=>c.hasItem(u,h),del:(u,h={})=>c.removeItem(u,h),remove:(u,h={})=>c.removeItem(u,h)};return c}function Hf(t,e,r){return t.watch?t.watch((i,n)=>e(i,r+n)):()=>{}}async function Gf(t){typeof t.dispose=="function"&&await ht(t.dispose)}function Fi(t){return new Promise((e,r)=>{t.oncomplete=t.onsuccess=()=>e(t.result),t.onabort=t.onerror=()=>r(t.error)})}function Wf(t,e){const r=indexedDB.open(t);r.onupgradeneeded=()=>r.result.createObjectStore(e);const i=Fi(r);return(n,s)=>i.then(o=>s(o.transaction(e,n).objectStore(e)))}let Qa;function as(){return Qa||(Qa=Wf("keyval-store","keyval")),Qa}function Yf(t,e=as()){return e("readonly",r=>Fi(r.get(t)))}function Kb(t,e,r=as()){return r("readwrite",i=>(i.put(e,t),Fi(i.transaction)))}function Vb(t,e=as()){return e("readwrite",r=>(r.delete(t),Fi(r.transaction)))}function Hb(t=as()){return t("readwrite",e=>(e.clear(),Fi(e.transaction)))}function Gb(t,e){return t.openCursor().onsuccess=function(){this.result&&(e(this.result),this.result.continue())},Fi(t.transaction)}function Wb(t=as()){return t("readonly",e=>{if(e.getAllKeys)return Fi(e.getAllKeys());const r=[];return Gb(e,i=>r.push(i.key)).then(()=>r)})}const Yb=t=>JSON.stringify(t,(e,r)=>typeof r=="bigint"?r.toString()+"n":r),Xb=t=>{const e=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,r=t.replace(e,'$1"$2n"$3');return JSON.parse(r,(i,n)=>typeof n=="string"&&n.match(/^\d+n$/)?BigInt(n.substring(0,n.length-1)):n)};function vn(t){if(typeof t!="string")throw new Error(`Cannot safe json parse value of type ${typeof t}`);try{return Xb(t)}catch{return t}}function Li(t){return typeof t=="string"?t:Yb(t)||""}const Zb="idb-keyval";var Jb=(t={})=>{const e=t.base&&t.base.length>0?`${t.base}:`:"",r=n=>e+n;let i;return t.dbName&&t.storeName&&(i=Wf(t.dbName,t.storeName)),{name:Zb,options:t,async hasItem(n){return!(typeof await Yf(r(n),i)>"u")},async getItem(n){return await Yf(r(n),i)??null},setItem(n,s){return Kb(r(n),s,i)},removeItem(n){return Vb(r(n),i)},getKeys(){return Wb(i)},clear(){return Hb(i)}}};const Qb="WALLET_CONNECT_V2_INDEXED_DB",eg="keyvaluestorage";class tg{constructor(){this.indexedDb=jb({driver:Jb({dbName:Qb,storeName:eg})})}async getKeys(){return this.indexedDb.getKeys()}async getEntries(){return(await this.indexedDb.getItems(await this.indexedDb.getKeys())).map(e=>[e.key,e.value])}async getItem(e){const r=await this.indexedDb.getItem(e);if(r!==null)return r}async setItem(e,r){await this.indexedDb.setItem(e,Li(r))}async removeItem(e){await this.indexedDb.removeItem(e)}}var ec=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Eo={exports:{}};(function(){let t;function e(){}t=e,t.prototype.getItem=function(r){return this.hasOwnProperty(r)?String(this[r]):null},t.prototype.setItem=function(r,i){this[r]=String(i)},t.prototype.removeItem=function(r){delete this[r]},t.prototype.clear=function(){const r=this;Object.keys(r).forEach(function(i){r[i]=void 0,delete r[i]})},t.prototype.key=function(r){return r=r||0,Object.keys(this)[r]},t.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof ec<"u"&&ec.localStorage?Eo.exports=ec.localStorage:typeof window<"u"&&window.localStorage?Eo.exports=window.localStorage:Eo.exports=new e})();function rg(t){var e;return[t[0],vn((e=t[1])!=null?e:"")]}class ig{constructor(){this.localStorage=Eo.exports}async getKeys(){return Object.keys(this.localStorage)}async getEntries(){return Object.entries(this.localStorage).map(rg)}async getItem(e){const r=this.localStorage.getItem(e);if(r!==null)return vn(r)}async setItem(e,r){this.localStorage.setItem(e,Li(r))}async removeItem(e){this.localStorage.removeItem(e)}}const ng="wc_storage_version",Xf=1,sg=async(t,e,r)=>{const i=ng,n=await e.getItem(i);if(n&&n>=Xf){r(e);return}const s=await t.getKeys();if(!s.length){r(e);return}const o=[];for(;s.length;){const a=s.shift();if(!a)continue;const c=a.toLowerCase();if(c.includes("wc@")||c.includes("walletconnect")||c.includes("wc_")||c.includes("wallet_connect")){const u=await t.getItem(a);await e.setItem(a,u),o.push(a)}}await e.setItem(i,Xf),r(e),og(t,o)},og=async(t,e)=>{e.length&&e.forEach(async r=>{await t.removeItem(r)})};class ag{constructor(){this.initialized=!1,this.setInitialized=r=>{this.storage=r,this.initialized=!0};const e=new ig;this.storage=e;try{const r=new tg;sg(e,r,this.setInitialized)}catch{this.initialized=!0}}async getKeys(){return await this.initialize(),this.storage.getKeys()}async getEntries(){return await this.initialize(),this.storage.getEntries()}async getItem(e){return await this.initialize(),this.storage.getItem(e)}async setItem(e,r){return await this.initialize(),this.storage.setItem(e,r)}async removeItem(e){return await this.initialize(),this.storage.removeItem(e)}async initialize(){this.initialized||await new Promise(e=>{const r=setInterval(()=>{this.initialized&&(clearInterval(r),e())},20)})}}function cg(t){try{return JSON.stringify(t)}catch{return'"[Circular]"'}}var ug=fg;function fg(t,e,r){var i=r&&r.stringify||cg,n=1;if(typeof t=="object"&&t!==null){var s=e.length+n;if(s===1)return t;var o=new Array(s);o[0]=i(t);for(var a=1;a<s;a++)o[a]=i(e[a]);return o.join(" ")}if(typeof t!="string")return t;var c=e.length;if(c===0)return t;for(var u="",h=1-n,l=-1,b=t&&t.length||0,w=0;w<b;){if(t.charCodeAt(w)===37&&w+1<b){switch(l=l>-1?l:0,t.charCodeAt(w+1)){case 100:case 102:if(h>=c||e[h]==null)break;l<w&&(u+=t.slice(l,w)),u+=Number(e[h]),l=w+2,w++;break;case 105:if(h>=c||e[h]==null)break;l<w&&(u+=t.slice(l,w)),u+=Math.floor(Number(e[h])),l=w+2,w++;break;case 79:case 111:case 106:if(h>=c||e[h]===void 0)break;l<w&&(u+=t.slice(l,w));var g=typeof e[h];if(g==="string"){u+="'"+e[h]+"'",l=w+2,w++;break}if(g==="function"){u+=e[h].name||"<anonymous>",l=w+2,w++;break}u+=i(e[h]),l=w+2,w++;break;case 115:if(h>=c)break;l<w&&(u+=t.slice(l,w)),u+=String(e[h]),l=w+2,w++;break;case 37:l<w&&(u+=t.slice(l,w)),u+="%",l=w+2,w++,h--;break}++h}++w}return l===-1?t:(l<b&&(u+=t.slice(l)),u)}const Zf=ug;var Gr=Ir;const cs=wg().console||{},hg={mapHttpRequest:So,mapHttpResponse:So,wrapRequestSerializer:rc,wrapResponseSerializer:rc,wrapErrorSerializer:rc,req:So,res:So,err:gg};function dg(t,e){return Array.isArray(t)?t.filter(function(i){return i!=="!stdSerializers.err"}):t===!0?Object.keys(e):!1}function Ir(t){t=t||{},t.browser=t.browser||{};const e=t.browser.transmit;if(e&&typeof e.send!="function")throw Error("pino: transmit option must have a send function");const r=t.browser.write||cs;t.browser.write&&(t.browser.asObject=!0);const i=t.serializers||{},n=dg(t.browser.serialize,i);let s=t.browser.serialize;Array.isArray(t.browser.serialize)&&t.browser.serialize.indexOf("!stdSerializers.err")>-1&&(s=!1);const o=["error","fatal","warn","info","debug","trace"];typeof r=="function"&&(r.error=r.fatal=r.warn=r.info=r.debug=r.trace=r),t.enabled===!1&&(t.level="silent");const a=t.level||"info",c=Object.create(r);c.log||(c.log=us),Object.defineProperty(c,"levelVal",{get:h}),Object.defineProperty(c,"level",{get:l,set:b});const u={transmit:e,serialize:n,asObject:t.browser.asObject,levels:o,timestamp:yg(t)};c.levels=Ir.levels,c.level=a,c.setMaxListeners=c.getMaxListeners=c.emit=c.addListener=c.on=c.prependListener=c.once=c.prependOnceListener=c.removeListener=c.removeAllListeners=c.listeners=c.listenerCount=c.eventNames=c.write=c.flush=us,c.serializers=i,c._serialize=n,c._stdErrSerialize=s,c.child=w,e&&(c._logEvent=tc());function h(){return this.level==="silent"?1/0:this.levels.values[this.level]}function l(){return this._level}function b(g){if(g!=="silent"&&!this.levels.values[g])throw Error("unknown level "+g);this._level=g,mn(u,c,"error","log"),mn(u,c,"fatal","error"),mn(u,c,"warn","error"),mn(u,c,"info","log"),mn(u,c,"debug","log"),mn(u,c,"trace","log")}function w(g,x){if(!g)throw new Error("missing bindings for child Pino");x=x||{},n&&g.serializers&&(x.serializers=g.serializers);const A=x.serializers;if(n&&A){var D=Object.assign({},i,A),$=t.browser.serialize===!0?Object.keys(D):n;delete g.serializers,xo([g],$,D,this._stdErrSerialize)}function P(T){this._childLevel=(T._childLevel|0)+1,this.error=wn(T,g,"error"),this.fatal=wn(T,g,"fatal"),this.warn=wn(T,g,"warn"),this.info=wn(T,g,"info"),this.debug=wn(T,g,"debug"),this.trace=wn(T,g,"trace"),D&&(this.serializers=D,this._serialize=$),e&&(this._logEvent=tc([].concat(T._logEvent.bindings,g)))}return P.prototype=this,new P(this)}return c}Ir.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},Ir.stdSerializers=hg,Ir.stdTimeFunctions=Object.assign({},{nullTime:Jf,epochTime:Qf,unixTime:vg,isoTime:mg});function mn(t,e,r,i){const n=Object.getPrototypeOf(e);e[r]=e.levelVal>e.levels.values[r]?us:n[r]?n[r]:cs[r]||cs[i]||us,lg(t,e,r)}function lg(t,e,r){!t.transmit&&e[r]===us||(e[r]=function(i){return function(){const s=t.timestamp(),o=new Array(arguments.length),a=Object.getPrototypeOf&&Object.getPrototypeOf(this)===cs?cs:this;for(var c=0;c<o.length;c++)o[c]=arguments[c];if(t.serialize&&!t.asObject&&xo(o,this._serialize,this.serializers,this._stdErrSerialize),t.asObject?i.call(a,pg(this,r,o,s)):i.apply(a,o),t.transmit){const u=t.transmit.level||e.level,h=Ir.levels.values[u],l=Ir.levels.values[r];if(l<h)return;bg(this,{ts:s,methodLevel:r,methodValue:l,transmitLevel:u,transmitValue:Ir.levels.values[t.transmit.level||e.level],send:t.transmit.send,val:e.levelVal},o)}}}(e[r]))}function pg(t,e,r,i){t._serialize&&xo(r,t._serialize,t.serializers,t._stdErrSerialize);const n=r.slice();let s=n[0];const o={};i&&(o.time=i),o.level=Ir.levels.values[e];let a=(t._childLevel|0)+1;if(a<1&&(a=1),s!==null&&typeof s=="object"){for(;a--&&typeof n[0]=="object";)Object.assign(o,n.shift());s=n.length?Zf(n.shift(),n):void 0}else typeof s=="string"&&(s=Zf(n.shift(),n));return s!==void 0&&(o.msg=s),o}function xo(t,e,r,i){for(const n in t)if(i&&t[n]instanceof Error)t[n]=Ir.stdSerializers.err(t[n]);else if(typeof t[n]=="object"&&!Array.isArray(t[n]))for(const s in t[n])e&&e.indexOf(s)>-1&&s in r&&(t[n][s]=r[s](t[n][s]))}function wn(t,e,r){return function(){const i=new Array(1+arguments.length);i[0]=e;for(var n=1;n<i.length;n++)i[n]=arguments[n-1];return t[r].apply(this,i)}}function bg(t,e,r){const i=e.send,n=e.ts,s=e.methodLevel,o=e.methodValue,a=e.val,c=t._logEvent.bindings;xo(r,t._serialize||Object.keys(t.serializers),t.serializers,t._stdErrSerialize===void 0?!0:t._stdErrSerialize),t._logEvent.ts=n,t._logEvent.messages=r.filter(function(u){return c.indexOf(u)===-1}),t._logEvent.level.label=s,t._logEvent.level.value=o,i(s,t._logEvent,a),t._logEvent=tc(c)}function tc(t){return{ts:0,messages:[],bindings:t||[],level:{label:"",value:0}}}function gg(t){const e={type:t.constructor.name,msg:t.message,stack:t.stack};for(const r in t)e[r]===void 0&&(e[r]=t[r]);return e}function yg(t){return typeof t.timestamp=="function"?t.timestamp:t.timestamp===!1?Jf:Qf}function So(){return{}}function rc(t){return t}function us(){}function Jf(){return!1}function Qf(){return Date.now()}function vg(){return Math.round(Date.now()/1e3)}function mg(){return new Date(Date.now()).toISOString()}function wg(){function t(e){return typeof e<"u"&&e}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return t(self)||t(window)||t(this)||{}}}const _g={level:"info"},fs="custom_context",ic=1e3*1024;class Eg{constructor(e){this.nodeValue=e,this.sizeInBytes=new TextEncoder().encode(this.nodeValue).length,this.next=null}get value(){return this.nodeValue}get size(){return this.sizeInBytes}}class eh{constructor(e){this.head=null,this.tail=null,this.lengthInNodes=0,this.maxSizeInBytes=e,this.sizeInBytes=0}append(e){const r=new Eg(e);if(r.size>this.maxSizeInBytes)throw new Error(`[LinkedList] Value too big to insert into list: ${e} with size ${r.size}`);for(;this.size+r.size>this.maxSizeInBytes;)this.shift();this.head?(this.tail&&(this.tail.next=r),this.tail=r):(this.head=r,this.tail=r),this.lengthInNodes++,this.sizeInBytes+=r.size}shift(){if(!this.head)return;const e=this.head;this.head=this.head.next,this.head||(this.tail=null),this.lengthInNodes--,this.sizeInBytes-=e.size}toArray(){const e=[];let r=this.head;for(;r!==null;)e.push(r.value),r=r.next;return e}get length(){return this.lengthInNodes}get size(){return this.sizeInBytes}toOrderedArray(){return Array.from(this)}[Symbol.iterator](){let e=this.head;return{next:()=>{if(!e)return{done:!0,value:null};const r=e.value;return e=e.next,{done:!1,value:r}}}}}class th{constructor(e,r=ic){this.level=e??"error",this.levelValue=Gr.levels.values[this.level],this.MAX_LOG_SIZE_IN_BYTES=r,this.logs=new eh(this.MAX_LOG_SIZE_IN_BYTES)}forwardToConsole(e,r){r===Gr.levels.values.error?console.error(e):r===Gr.levels.values.warn?console.warn(e):r===Gr.levels.values.debug?console.debug(e):r===Gr.levels.values.trace?console.trace(e):console.log(e)}appendToLogs(e){this.logs.append(Li({timestamp:new Date().toISOString(),log:e}));const r=typeof e=="string"?JSON.parse(e).level:e.level;r>=this.levelValue&&this.forwardToConsole(e,r)}getLogs(){return this.logs}clearLogs(){this.logs=new eh(this.MAX_LOG_SIZE_IN_BYTES)}getLogArray(){return Array.from(this.logs)}logsToBlob(e){const r=this.getLogArray();return r.push(Li({extraMetadata:e})),new Blob(r,{type:"application/json"})}}class xg{constructor(e,r=ic){this.baseChunkLogger=new th(e,r)}write(e){this.baseChunkLogger.appendToLogs(e)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(e){return this.baseChunkLogger.logsToBlob(e)}downloadLogsBlobInBrowser(e){const r=URL.createObjectURL(this.logsToBlob(e)),i=document.createElement("a");i.href=r,i.download=`walletconnect-logs-${new Date().toISOString()}.txt`,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(r)}}class Sg{constructor(e,r=ic){this.baseChunkLogger=new th(e,r)}write(e){this.baseChunkLogger.appendToLogs(e)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(e){return this.baseChunkLogger.logsToBlob(e)}}var Ig=Object.defineProperty,Ag=Object.defineProperties,Dg=Object.getOwnPropertyDescriptors,rh=Object.getOwnPropertySymbols,Og=Object.prototype.hasOwnProperty,Mg=Object.prototype.propertyIsEnumerable,ih=(t,e,r)=>e in t?Ig(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Io=(t,e)=>{for(var r in e||(e={}))Og.call(e,r)&&ih(t,r,e[r]);if(rh)for(var r of rh(e))Mg.call(e,r)&&ih(t,r,e[r]);return t},Ao=(t,e)=>Ag(t,Dg(e));function nc(t){return Ao(Io({},t),{level:t?.level||_g.level})}function $g(t,e=fs){return t[e]||""}function Pg(t,e,r=fs){return t[r]=e,t}function kt(t,e=fs){let r="";return typeof t.bindings>"u"?r=$g(t,e):r=t.bindings().context||"",r}function Tg(t,e,r=fs){const i=kt(t,r);return i.trim()?`${i}/${e}`:e}function Ct(t,e,r=fs){const i=Tg(t,e,r),n=t.child({context:i});return Pg(n,i,r)}function Rg(t){var e,r;const i=new xg((e=t.opts)==null?void 0:e.level,t.maxSizeInBytes);return{logger:Gr(Ao(Io({},t.opts),{level:"trace",browser:Ao(Io({},(r=t.opts)==null?void 0:r.browser),{write:n=>i.write(n)})})),chunkLoggerController:i}}function Ng(t){var e;const r=new Sg((e=t.opts)==null?void 0:e.level,t.maxSizeInBytes);return{logger:Gr(Ao(Io({},t.opts),{level:"trace"})),chunkLoggerController:r}}function Cg(t){return typeof t.loggerOverride<"u"&&typeof t.loggerOverride!="string"?{logger:t.loggerOverride,chunkLoggerController:null}:typeof window<"u"?Rg(t):Ng(t)}var Bg=Object.defineProperty,Fg=(t,e,r)=>e in t?Bg(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,nh=(t,e,r)=>Fg(t,typeof e!="symbol"?e+"":e,r);class Lg extends Bi{constructor(e){super(),this.opts=e,nh(this,"protocol","wc"),nh(this,"version",2)}}var qg=Object.defineProperty,zg=(t,e,r)=>e in t?qg(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Ug=(t,e,r)=>zg(t,typeof e!="symbol"?e+"":e,r);class kg extends Bi{constructor(e,r){super(),this.core=e,this.logger=r,Ug(this,"records",new Map)}}class jg{constructor(e,r){this.logger=e,this.core=r}}class Kg extends Bi{constructor(e,r){super(),this.relayer=e,this.logger=r}}class Vg extends Bi{constructor(e){super()}}class Hg{constructor(e,r,i,n){this.core=e,this.logger=r,this.name=i}}class Gg extends Bi{constructor(e,r){super(),this.relayer=e,this.logger=r}}class Wg extends Bi{constructor(e,r){super(),this.core=e,this.logger=r}}class Yg{constructor(e,r,i){this.core=e,this.logger=r,this.store=i}}class Xg{constructor(e,r){this.projectId=e,this.logger=r}}class Zg{constructor(e,r,i){this.core=e,this.logger=r,this.telemetryEnabled=i}}var Jg=Object.defineProperty,Qg=(t,e,r)=>e in t?Jg(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,sh=(t,e,r)=>Qg(t,typeof e!="symbol"?e+"":e,r);class ey{constructor(e){this.opts=e,sh(this,"protocol","wc"),sh(this,"version",2)}}class ty{constructor(e){this.client=e}}function ry(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function oh(t,...e){if(!ry(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function ah(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function iy(t,e){oh(t);const r=e.outputLen;if(t.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}const _n=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const sc=t=>new DataView(t.buffer,t.byteOffset,t.byteLength);function ny(t){if(typeof t!="string")throw new Error("utf8ToBytes expected string, got "+typeof t);return new Uint8Array(new TextEncoder().encode(t))}function ch(t){return typeof t=="string"&&(t=ny(t)),oh(t),t}class sy{clone(){return this._cloneInto()}}function oy(t){const e=i=>t().update(ch(i)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e}function uh(t=32){if(_n&&typeof _n.getRandomValues=="function")return _n.getRandomValues(new Uint8Array(t));if(_n&&typeof _n.randomBytes=="function")return _n.randomBytes(t);throw new Error("crypto.getRandomValues must be defined")}function ay(t,e,r,i){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,r,i);const n=BigInt(32),s=BigInt(4294967295),o=Number(r>>n&s),a=Number(r&s),c=i?4:0,u=i?0:4;t.setUint32(e+c,o,i),t.setUint32(e+u,a,i)}class cy extends sy{constructor(e,r,i,n){super(),this.blockLen=e,this.outputLen=r,this.padOffset=i,this.isLE=n,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=sc(this.buffer)}update(e){ah(this);const{view:r,buffer:i,blockLen:n}=this;e=ch(e);const s=e.length;for(let o=0;o<s;){const a=Math.min(n-this.pos,s-o);if(a===n){const c=sc(e);for(;n<=s-o;o+=n)this.process(c,o);continue}i.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===n&&(this.process(r,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){ah(this),iy(e,this),this.finished=!0;const{buffer:r,view:i,blockLen:n,isLE:s}=this;let{pos:o}=this;r[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>n-o&&(this.process(i,0),o=0);for(let l=o;l<n;l++)r[l]=0;ay(i,n-8,BigInt(this.length*8),s),this.process(i,0);const a=sc(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const u=c/4,h=this.get();if(u>h.length)throw new Error("_sha2: outputLen bigger than state");for(let l=0;l<u;l++)a.setUint32(4*l,h[l],s)}digest(){const{buffer:e,outputLen:r}=this;this.digestInto(e);const i=e.slice(0,r);return this.destroy(),i}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:r,buffer:i,length:n,finished:s,destroyed:o,pos:a}=this;return e.length=n,e.pos=a,e.finished=s,e.destroyed=o,n%r&&e.buffer.set(i),e}}const Do=BigInt(2**32-1),oc=BigInt(32);function fh(t,e=!1){return e?{h:Number(t&Do),l:Number(t>>oc&Do)}:{h:Number(t>>oc&Do)|0,l:Number(t&Do)|0}}function uy(t,e=!1){let r=new Uint32Array(t.length),i=new Uint32Array(t.length);for(let n=0;n<t.length;n++){const{h:s,l:o}=fh(t[n],e);[r[n],i[n]]=[s,o]}return[r,i]}const fy=(t,e)=>BigInt(t>>>0)<<oc|BigInt(e>>>0),hy=(t,e,r)=>t>>>r,dy=(t,e,r)=>t<<32-r|e>>>r,ly=(t,e,r)=>t>>>r|e<<32-r,py=(t,e,r)=>t<<32-r|e>>>r,by=(t,e,r)=>t<<64-r|e>>>r-32,gy=(t,e,r)=>t>>>r-32|e<<64-r,yy=(t,e)=>e,vy=(t,e)=>t,my=(t,e,r)=>t<<r|e>>>32-r,wy=(t,e,r)=>e<<r|t>>>32-r,_y=(t,e,r)=>e<<r-32|t>>>64-r,Ey=(t,e,r)=>t<<r-32|e>>>64-r;function xy(t,e,r,i){const n=(e>>>0)+(i>>>0);return{h:t+r+(n/2**32|0)|0,l:n|0}}const Sy=(t,e,r)=>(t>>>0)+(e>>>0)+(r>>>0),Iy=(t,e,r,i)=>e+r+i+(t/2**32|0)|0,Ay=(t,e,r,i)=>(t>>>0)+(e>>>0)+(r>>>0)+(i>>>0),Dy=(t,e,r,i,n)=>e+r+i+n+(t/2**32|0)|0,Oy=(t,e,r,i,n)=>(t>>>0)+(e>>>0)+(r>>>0)+(i>>>0)+(n>>>0),My=(t,e,r,i,n,s)=>e+r+i+n+s+(t/2**32|0)|0,te={fromBig:fh,split:uy,toBig:fy,shrSH:hy,shrSL:dy,rotrSH:ly,rotrSL:py,rotrBH:by,rotrBL:gy,rotr32H:yy,rotr32L:vy,rotlSH:my,rotlSL:wy,rotlBH:_y,rotlBL:Ey,add:xy,add3L:Sy,add3H:Iy,add4L:Ay,add4H:Dy,add5H:My,add5L:Oy},[$y,Py]=te.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(t=>BigInt(t))),fi=new Uint32Array(80),hi=new Uint32Array(80);class Ty extends cy{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:e,Al:r,Bh:i,Bl:n,Ch:s,Cl:o,Dh:a,Dl:c,Eh:u,El:h,Fh:l,Fl:b,Gh:w,Gl:g,Hh:x,Hl:A}=this;return[e,r,i,n,s,o,a,c,u,h,l,b,w,g,x,A]}set(e,r,i,n,s,o,a,c,u,h,l,b,w,g,x,A){this.Ah=e|0,this.Al=r|0,this.Bh=i|0,this.Bl=n|0,this.Ch=s|0,this.Cl=o|0,this.Dh=a|0,this.Dl=c|0,this.Eh=u|0,this.El=h|0,this.Fh=l|0,this.Fl=b|0,this.Gh=w|0,this.Gl=g|0,this.Hh=x|0,this.Hl=A|0}process(e,r){for(let P=0;P<16;P++,r+=4)fi[P]=e.getUint32(r),hi[P]=e.getUint32(r+=4);for(let P=16;P<80;P++){const T=fi[P-15]|0,N=hi[P-15]|0,L=te.rotrSH(T,N,1)^te.rotrSH(T,N,8)^te.shrSH(T,N,7),F=te.rotrSL(T,N,1)^te.rotrSL(T,N,8)^te.shrSL(T,N,7),B=fi[P-2]|0,C=hi[P-2]|0,G=te.rotrSH(B,C,19)^te.rotrBH(B,C,61)^te.shrSH(B,C,6),I=te.rotrSL(B,C,19)^te.rotrBL(B,C,61)^te.shrSL(B,C,6),f=te.add4L(F,I,hi[P-7],hi[P-16]),p=te.add4H(f,L,G,fi[P-7],fi[P-16]);fi[P]=p|0,hi[P]=f|0}let{Ah:i,Al:n,Bh:s,Bl:o,Ch:a,Cl:c,Dh:u,Dl:h,Eh:l,El:b,Fh:w,Fl:g,Gh:x,Gl:A,Hh:D,Hl:$}=this;for(let P=0;P<80;P++){const T=te.rotrSH(l,b,14)^te.rotrSH(l,b,18)^te.rotrBH(l,b,41),N=te.rotrSL(l,b,14)^te.rotrSL(l,b,18)^te.rotrBL(l,b,41),L=l&w^~l&x,F=b&g^~b&A,B=te.add5L($,N,F,Py[P],hi[P]),C=te.add5H(B,D,T,L,$y[P],fi[P]),G=B|0,I=te.rotrSH(i,n,28)^te.rotrBH(i,n,34)^te.rotrBH(i,n,39),f=te.rotrSL(i,n,28)^te.rotrBL(i,n,34)^te.rotrBL(i,n,39),p=i&s^i&a^s&a,v=n&o^n&c^o&c;D=x|0,$=A|0,x=w|0,A=g|0,w=l|0,g=b|0,{h:l,l:b}=te.add(u|0,h|0,C|0,G|0),u=a|0,h=c|0,a=s|0,c=o|0,s=i|0,o=n|0;const y=te.add3L(G,f,v);i=te.add3H(y,C,I,p),n=y|0}({h:i,l:n}=te.add(this.Ah|0,this.Al|0,i|0,n|0)),{h:s,l:o}=te.add(this.Bh|0,this.Bl|0,s|0,o|0),{h:a,l:c}=te.add(this.Ch|0,this.Cl|0,a|0,c|0),{h:u,l:h}=te.add(this.Dh|0,this.Dl|0,u|0,h|0),{h:l,l:b}=te.add(this.Eh|0,this.El|0,l|0,b|0),{h:w,l:g}=te.add(this.Fh|0,this.Fl|0,w|0,g|0),{h:x,l:A}=te.add(this.Gh|0,this.Gl|0,x|0,A|0),{h:D,l:$}=te.add(this.Hh|0,this.Hl|0,D|0,$|0),this.set(i,n,s,o,a,c,u,h,l,b,w,g,x,A,D,$)}roundClean(){fi.fill(0),hi.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const Ry=oy(()=>new Ty);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const ac=BigInt(0),hh=BigInt(1),Ny=BigInt(2);function cc(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function uc(t){if(!cc(t))throw new Error("Uint8Array expected")}function fc(t,e){if(typeof e!="boolean")throw new Error(t+" boolean expected, got "+e)}const Cy=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function hc(t){uc(t);let e="";for(let r=0;r<t.length;r++)e+=Cy[t[r]];return e}function dh(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return t===""?ac:BigInt("0x"+t)}const Wr={_0:48,_9:57,A:65,F:70,a:97,f:102};function lh(t){if(t>=Wr._0&&t<=Wr._9)return t-Wr._0;if(t>=Wr.A&&t<=Wr.F)return t-(Wr.A-10);if(t>=Wr.a&&t<=Wr.f)return t-(Wr.a-10)}function ph(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);const e=t.length,r=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);const i=new Uint8Array(r);for(let n=0,s=0;n<r;n++,s+=2){const o=lh(t.charCodeAt(s)),a=lh(t.charCodeAt(s+1));if(o===void 0||a===void 0){const c=t[s]+t[s+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+s)}i[n]=o*16+a}return i}function By(t){return dh(hc(t))}function Oo(t){return uc(t),dh(hc(Uint8Array.from(t).reverse()))}function bh(t,e){return ph(t.toString(16).padStart(e*2,"0"))}function dc(t,e){return bh(t,e).reverse()}function Yr(t,e,r){let i;if(typeof e=="string")try{i=ph(e)}catch(s){throw new Error(t+" must be hex string or Uint8Array, cause: "+s)}else if(cc(e))i=Uint8Array.from(e);else throw new Error(t+" must be hex string or Uint8Array");const n=i.length;if(typeof r=="number"&&n!==r)throw new Error(t+" of length "+r+" expected, got "+n);return i}function gh(...t){let e=0;for(let i=0;i<t.length;i++){const n=t[i];uc(n),e+=n.length}const r=new Uint8Array(e);for(let i=0,n=0;i<t.length;i++){const s=t[i];r.set(s,n),n+=s.length}return r}const lc=t=>typeof t=="bigint"&&ac<=t;function Fy(t,e,r){return lc(t)&&lc(e)&&lc(r)&&e<=t&&t<r}function hs(t,e,r,i){if(!Fy(e,r,i))throw new Error("expected valid "+t+": "+r+" <= n < "+i+", got "+e)}function Ly(t){let e;for(e=0;t>ac;t>>=hh,e+=1);return e}const qy=t=>(Ny<<BigInt(t-1))-hh,zy={bigint:t=>typeof t=="bigint",function:t=>typeof t=="function",boolean:t=>typeof t=="boolean",string:t=>typeof t=="string",stringOrUint8Array:t=>typeof t=="string"||cc(t),isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>typeof t=="function"&&Number.isSafeInteger(t.outputLen)};function pc(t,e,r={}){const i=(n,s,o)=>{const a=zy[s];if(typeof a!="function")throw new Error("invalid validator function");const c=t[n];if(!(o&&c===void 0)&&!a(c,t))throw new Error("param "+String(n)+" is invalid. Expected "+s+", got "+c)};for(const[n,s]of Object.entries(e))i(n,s,!1);for(const[n,s]of Object.entries(r))i(n,s,!0);return t}function yh(t){const e=new WeakMap;return(r,...i)=>{const n=e.get(r);if(n!==void 0)return n;const s=t(r,...i);return e.set(r,s),s}}const dt=BigInt(0),it=BigInt(1),qi=BigInt(2),Uy=BigInt(3),bc=BigInt(4),vh=BigInt(5),mh=BigInt(8);function at(t,e){const r=t%e;return r>=dt?r:e+r}function ky(t,e,r){if(e<dt)throw new Error("invalid exponent, negatives unsupported");if(r<=dt)throw new Error("invalid modulus");if(r===it)return dt;let i=it;for(;e>dt;)e&it&&(i=i*t%r),t=t*t%r,e>>=it;return i}function Ar(t,e,r){let i=t;for(;e-- >dt;)i*=i,i%=r;return i}function wh(t,e){if(t===dt)throw new Error("invert: expected non-zero number");if(e<=dt)throw new Error("invert: expected positive modulus, got "+e);let r=at(t,e),i=e,n=dt,s=it;for(;r!==dt;){const o=i/r,a=i%r,c=n-s*o;i=r,r=a,n=s,s=c}if(i!==it)throw new Error("invert: does not exist");return at(n,e)}function jy(t){const e=(t-it)/qi;let r,i,n;for(r=t-it,i=0;r%qi===dt;r/=qi,i++);for(n=qi;n<t&&ky(n,e,t)!==t-it;n++)if(n>1e3)throw new Error("Cannot find square root: likely non-prime P");if(i===1){const o=(t+it)/bc;return function(a,c){const u=a.pow(c,o);if(!a.eql(a.sqr(u),c))throw new Error("Cannot find square root");return u}}const s=(r+it)/qi;return function(o,a){if(o.pow(a,e)===o.neg(o.ONE))throw new Error("Cannot find square root");let c=i,u=o.pow(o.mul(o.ONE,n),r),h=o.pow(a,s),l=o.pow(a,r);for(;!o.eql(l,o.ONE);){if(o.eql(l,o.ZERO))return o.ZERO;let b=1;for(let g=o.sqr(l);b<c&&!o.eql(g,o.ONE);b++)g=o.sqr(g);const w=o.pow(u,it<<BigInt(c-b-1));u=o.sqr(w),h=o.mul(h,w),l=o.mul(l,u),c=b}return h}}function Ky(t){if(t%bc===Uy){const e=(t+it)/bc;return function(r,i){const n=r.pow(i,e);if(!r.eql(r.sqr(n),i))throw new Error("Cannot find square root");return n}}if(t%mh===vh){const e=(t-vh)/mh;return function(r,i){const n=r.mul(i,qi),s=r.pow(n,e),o=r.mul(i,s),a=r.mul(r.mul(o,qi),s),c=r.mul(o,r.sub(a,r.ONE));if(!r.eql(r.sqr(c),i))throw new Error("Cannot find square root");return c}}return jy(t)}const Vy=(t,e)=>(at(t,e)&it)===it,Hy=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function Gy(t){const e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},r=Hy.reduce((i,n)=>(i[n]="function",i),e);return pc(t,r)}function Wy(t,e,r){if(r<dt)throw new Error("invalid exponent, negatives unsupported");if(r===dt)return t.ONE;if(r===it)return e;let i=t.ONE,n=e;for(;r>dt;)r&it&&(i=t.mul(i,n)),n=t.sqr(n),r>>=it;return i}function Yy(t,e){const r=new Array(e.length),i=e.reduce((s,o,a)=>t.is0(o)?s:(r[a]=s,t.mul(s,o)),t.ONE),n=t.inv(i);return e.reduceRight((s,o,a)=>t.is0(o)?s:(r[a]=t.mul(s,r[a]),t.mul(s,o)),n),r}function _h(t,e){const r=e!==void 0?e:t.toString(2).length,i=Math.ceil(r/8);return{nBitLength:r,nByteLength:i}}function Eh(t,e,r=!1,i={}){if(t<=dt)throw new Error("invalid field: expected ORDER > 0, got "+t);const{nBitLength:n,nByteLength:s}=_h(t,e);if(s>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let o;const a=Object.freeze({ORDER:t,isLE:r,BITS:n,BYTES:s,MASK:qy(n),ZERO:dt,ONE:it,create:c=>at(c,t),isValid:c=>{if(typeof c!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof c);return dt<=c&&c<t},is0:c=>c===dt,isOdd:c=>(c&it)===it,neg:c=>at(-c,t),eql:(c,u)=>c===u,sqr:c=>at(c*c,t),add:(c,u)=>at(c+u,t),sub:(c,u)=>at(c-u,t),mul:(c,u)=>at(c*u,t),pow:(c,u)=>Wy(a,c,u),div:(c,u)=>at(c*wh(u,t),t),sqrN:c=>c*c,addN:(c,u)=>c+u,subN:(c,u)=>c-u,mulN:(c,u)=>c*u,inv:c=>wh(c,t),sqrt:i.sqrt||(c=>(o||(o=Ky(t)),o(a,c))),invertBatch:c=>Yy(a,c),cmov:(c,u,h)=>h?u:c,toBytes:c=>r?dc(c,s):bh(c,s),fromBytes:c=>{if(c.length!==s)throw new Error("Field.fromBytes: expected "+s+" bytes, got "+c.length);return r?Oo(c):By(c)}});return Object.freeze(a)}const xh=BigInt(0),Mo=BigInt(1);function gc(t,e){const r=e.negate();return t?r:e}function Sh(t,e){if(!Number.isSafeInteger(t)||t<=0||t>e)throw new Error("invalid window size, expected [1.."+e+"], got W="+t)}function yc(t,e){Sh(t,e);const r=Math.ceil(e/t)+1,i=2**(t-1);return{windows:r,windowSize:i}}function Xy(t,e){if(!Array.isArray(t))throw new Error("array expected");t.forEach((r,i)=>{if(!(r instanceof e))throw new Error("invalid point at index "+i)})}function Zy(t,e){if(!Array.isArray(t))throw new Error("array of scalars expected");t.forEach((r,i)=>{if(!e.isValid(r))throw new Error("invalid scalar at index "+i)})}const vc=new WeakMap,Ih=new WeakMap;function mc(t){return Ih.get(t)||1}function Jy(t,e){return{constTimeNegate:gc,hasPrecomputes(r){return mc(r)!==1},unsafeLadder(r,i,n=t.ZERO){let s=r;for(;i>xh;)i&Mo&&(n=n.add(s)),s=s.double(),i>>=Mo;return n},precomputeWindow(r,i){const{windows:n,windowSize:s}=yc(i,e),o=[];let a=r,c=a;for(let u=0;u<n;u++){c=a,o.push(c);for(let h=1;h<s;h++)c=c.add(a),o.push(c);a=c.double()}return o},wNAF(r,i,n){const{windows:s,windowSize:o}=yc(r,e);let a=t.ZERO,c=t.BASE;const u=BigInt(2**r-1),h=2**r,l=BigInt(r);for(let b=0;b<s;b++){const w=b*o;let g=Number(n&u);n>>=l,g>o&&(g-=h,n+=Mo);const x=w,A=w+Math.abs(g)-1,D=b%2!==0,$=g<0;g===0?c=c.add(gc(D,i[x])):a=a.add(gc($,i[A]))}return{p:a,f:c}},wNAFUnsafe(r,i,n,s=t.ZERO){const{windows:o,windowSize:a}=yc(r,e),c=BigInt(2**r-1),u=2**r,h=BigInt(r);for(let l=0;l<o;l++){const b=l*a;if(n===xh)break;let w=Number(n&c);if(n>>=h,w>a&&(w-=u,n+=Mo),w===0)continue;let g=i[b+Math.abs(w)-1];w<0&&(g=g.negate()),s=s.add(g)}return s},getPrecomputes(r,i,n){let s=vc.get(i);return s||(s=this.precomputeWindow(i,r),r!==1&&vc.set(i,n(s))),s},wNAFCached(r,i,n){const s=mc(r);return this.wNAF(s,this.getPrecomputes(s,r,n),i)},wNAFCachedUnsafe(r,i,n,s){const o=mc(r);return o===1?this.unsafeLadder(r,i,s):this.wNAFUnsafe(o,this.getPrecomputes(o,r,n),i,s)},setWindowSize(r,i){Sh(i,e),Ih.set(r,i),vc.delete(r)}}}function Qy(t,e,r,i){if(Xy(r,t),Zy(i,e),r.length!==i.length)throw new Error("arrays of points and scalars must have equal length");const n=t.ZERO,s=Ly(BigInt(r.length)),o=s>12?s-3:s>4?s-2:s?2:1,a=(1<<o)-1,c=new Array(a+1).fill(n),u=Math.floor((e.BITS-1)/o)*o;let h=n;for(let l=u;l>=0;l-=o){c.fill(n);for(let w=0;w<i.length;w++){const g=i[w],x=Number(g>>BigInt(l)&BigInt(a));c[x]=c[x].add(r[w])}let b=n;for(let w=c.length-1,g=n;w>0;w--)g=g.add(c[w]),b=b.add(g);if(h=h.add(b),l!==0)for(let w=0;w<o;w++)h=h.double()}return h}function e2(t){return Gy(t.Fp),pc(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({..._h(t.n,t.nBitLength),...t,p:t.Fp.ORDER})}const lr=BigInt(0),jt=BigInt(1),$o=BigInt(2),t2=BigInt(8),r2={zip215:!0};function i2(t){const e=e2(t);return pc(t,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...e})}function n2(t){const e=i2(t),{Fp:r,n:i,prehash:n,hash:s,randomBytes:o,nByteLength:a,h:c}=e,u=$o<<BigInt(a*8)-jt,h=r.create,l=Eh(e.n,e.nBitLength),b=e.uvRatio||((y,m)=>{try{return{isValid:!0,value:r.sqrt(y*r.inv(m))}}catch{return{isValid:!1,value:lr}}}),w=e.adjustScalarBytes||(y=>y),g=e.domain||((y,m,S)=>{if(fc("phflag",S),m.length||S)throw new Error("Contexts/pre-hash are not supported");return y});function x(y,m){hs("coordinate "+y,m,lr,u)}function A(y){if(!(y instanceof P))throw new Error("ExtendedPoint expected")}const D=yh((y,m)=>{const{ex:S,ey:O,ez:_}=y,d=y.is0();m==null&&(m=d?t2:r.inv(_));const E=h(S*m),q=h(O*m),z=h(_*m);if(d)return{x:lr,y:jt};if(z!==jt)throw new Error("invZ was invalid");return{x:E,y:q}}),$=yh(y=>{const{a:m,d:S}=e;if(y.is0())throw new Error("bad point: ZERO");const{ex:O,ey:_,ez:d,et:E}=y,q=h(O*O),z=h(_*_),U=h(d*d),k=h(U*U),W=h(q*m),Z=h(U*h(W+z)),J=h(k+h(S*h(q*z)));if(Z!==J)throw new Error("bad point: equation left != right (1)");const X=h(O*_),Q=h(d*E);if(X!==Q)throw new Error("bad point: equation left != right (2)");return!0});class P{constructor(m,S,O,_){this.ex=m,this.ey=S,this.ez=O,this.et=_,x("x",m),x("y",S),x("z",O),x("t",_),Object.freeze(this)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(m){if(m instanceof P)throw new Error("extended point not allowed");const{x:S,y:O}=m||{};return x("x",S),x("y",O),new P(S,O,jt,h(S*O))}static normalizeZ(m){const S=r.invertBatch(m.map(O=>O.ez));return m.map((O,_)=>O.toAffine(S[_])).map(P.fromAffine)}static msm(m,S){return Qy(P,l,m,S)}_setWindowSize(m){L.setWindowSize(this,m)}assertValidity(){$(this)}equals(m){A(m);const{ex:S,ey:O,ez:_}=this,{ex:d,ey:E,ez:q}=m,z=h(S*q),U=h(d*_),k=h(O*q),W=h(E*_);return z===U&&k===W}is0(){return this.equals(P.ZERO)}negate(){return new P(h(-this.ex),this.ey,this.ez,h(-this.et))}double(){const{a:m}=e,{ex:S,ey:O,ez:_}=this,d=h(S*S),E=h(O*O),q=h($o*h(_*_)),z=h(m*d),U=S+O,k=h(h(U*U)-d-E),W=z+E,Z=W-q,J=z-E,X=h(k*Z),Q=h(W*J),Le=h(k*J),re=h(Z*W);return new P(X,Q,re,Le)}add(m){A(m);const{a:S,d:O}=e,{ex:_,ey:d,ez:E,et:q}=this,{ex:z,ey:U,ez:k,et:W}=m;if(S===BigInt(-1)){const Ae=h((d-_)*(U+z)),cn=h((d+_)*(U-z)),Ee=h(cn-Ae);if(Ee===lr)return this.double();const De=h(E*$o*W),un=h(q*$o*k),Oe=un+De,Me=cn+Ae,fn=un-De,ye=h(Oe*Ee),xe=h(Me*fn),hn=h(Oe*fn),ce=h(Ee*Me);return new P(ye,xe,ce,hn)}const Z=h(_*z),J=h(d*U),X=h(q*O*W),Q=h(E*k),Le=h((_+d)*(z+U)-Z-J),re=Q-X,ae=Q+X,ft=h(J-S*Z),de=h(Le*re),Pe=h(ae*ft),ts=h(Le*ft),Te=h(re*ae);return new P(de,Pe,Te,ts)}subtract(m){return this.add(m.negate())}wNAF(m){return L.wNAFCached(this,m,P.normalizeZ)}multiply(m){const S=m;hs("scalar",S,jt,i);const{p:O,f:_}=this.wNAF(S);return P.normalizeZ([O,_])[0]}multiplyUnsafe(m,S=P.ZERO){const O=m;return hs("scalar",O,lr,i),O===lr?N:this.is0()||O===jt?this:L.wNAFCachedUnsafe(this,O,P.normalizeZ,S)}isSmallOrder(){return this.multiplyUnsafe(c).is0()}isTorsionFree(){return L.unsafeLadder(this,i).is0()}toAffine(m){return D(this,m)}clearCofactor(){const{h:m}=e;return m===jt?this:this.multiplyUnsafe(m)}static fromHex(m,S=!1){const{d:O,a:_}=e,d=r.BYTES;m=Yr("pointHex",m,d),fc("zip215",S);const E=m.slice(),q=m[d-1];E[d-1]=q&-129;const z=Oo(E),U=S?u:r.ORDER;hs("pointHex.y",z,lr,U);const k=h(z*z),W=h(k-jt),Z=h(O*k-_);let{isValid:J,value:X}=b(W,Z);if(!J)throw new Error("Point.fromHex: invalid y coordinate");const Q=(X&jt)===jt,Le=(q&128)!==0;if(!S&&X===lr&&Le)throw new Error("Point.fromHex: x=0 and x_0=1");return Le!==Q&&(X=h(-X)),P.fromAffine({x:X,y:z})}static fromPrivateKey(m){return C(m).point}toRawBytes(){const{x:m,y:S}=this.toAffine(),O=dc(S,r.BYTES);return O[O.length-1]|=m&jt?128:0,O}toHex(){return hc(this.toRawBytes())}}P.BASE=new P(e.Gx,e.Gy,jt,h(e.Gx*e.Gy)),P.ZERO=new P(lr,jt,jt,lr);const{BASE:T,ZERO:N}=P,L=Jy(P,a*8);function F(y){return at(y,i)}function B(y){return F(Oo(y))}function C(y){const m=r.BYTES;y=Yr("private key",y,m);const S=Yr("hashed private key",s(y),2*m),O=w(S.slice(0,m)),_=S.slice(m,2*m),d=B(O),E=T.multiply(d),q=E.toRawBytes();return{head:O,prefix:_,scalar:d,point:E,pointBytes:q}}function G(y){return C(y).pointBytes}function I(y=new Uint8Array,...m){const S=gh(...m);return B(s(g(S,Yr("context",y),!!n)))}function f(y,m,S={}){y=Yr("message",y),n&&(y=n(y));const{prefix:O,scalar:_,pointBytes:d}=C(m),E=I(S.context,O,y),q=T.multiply(E).toRawBytes(),z=I(S.context,q,d,y),U=F(E+z*_);hs("signature.s",U,lr,i);const k=gh(q,dc(U,r.BYTES));return Yr("result",k,r.BYTES*2)}const p=r2;function v(y,m,S,O=p){const{context:_,zip215:d}=O,E=r.BYTES;y=Yr("signature",y,2*E),m=Yr("message",m),S=Yr("publicKey",S,E),d!==void 0&&fc("zip215",d),n&&(m=n(m));const q=Oo(y.slice(E,2*E));let z,U,k;try{z=P.fromHex(S,d),U=P.fromHex(y.slice(0,E),d),k=T.multiplyUnsafe(q)}catch{return!1}if(!d&&z.isSmallOrder())return!1;const W=I(_,U.toRawBytes(),z.toRawBytes(),m);return U.add(z.multiplyUnsafe(W)).subtract(k).clearCofactor().equals(P.ZERO)}return T._setWindowSize(8),{CURVE:e,getPublicKey:G,sign:f,verify:v,ExtendedPoint:P,utils:{getExtendedPublicKey:C,randomPrivateKey:()=>o(r.BYTES),precompute(y=8,m=P.BASE){return m._setWindowSize(y),m.multiply(BigInt(3)),m}}}}BigInt(0),BigInt(1);const wc=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),Ah=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");BigInt(0);const s2=BigInt(1),Dh=BigInt(2);BigInt(3);const o2=BigInt(5),a2=BigInt(8);function c2(t){const e=BigInt(10),r=BigInt(20),i=BigInt(40),n=BigInt(80),s=wc,o=t*t%s*t%s,a=Ar(o,Dh,s)*o%s,c=Ar(a,s2,s)*t%s,u=Ar(c,o2,s)*c%s,h=Ar(u,e,s)*u%s,l=Ar(h,r,s)*h%s,b=Ar(l,i,s)*l%s,w=Ar(b,n,s)*b%s,g=Ar(w,n,s)*b%s,x=Ar(g,e,s)*u%s;return{pow_p_5_8:Ar(x,Dh,s)*t%s,b2:o}}function u2(t){return t[0]&=248,t[31]&=127,t[31]|=64,t}function f2(t,e){const r=wc,i=at(e*e*e,r),n=at(i*i*e,r),s=c2(t*n).pow_p_5_8;let o=at(t*i*s,r);const a=at(e*o*o,r),c=o,u=at(o*Ah,r),h=a===t,l=a===at(-t,r),b=a===at(-t*Ah,r);return h&&(o=c),(l||b)&&(o=u),Vy(o,r)&&(o=at(-o,r)),{isValid:h||l,value:o}}const h2=Eh(wc,void 0,!0),d2={a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:h2,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:a2,Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:Ry,randomBytes:uh,adjustScalarBytes:u2,uvRatio:f2},Oh=n2(d2),l2="EdDSA",p2="JWT",Po=".",To="base64url",Mh="utf8",$h="utf8",b2=":",g2="did",y2="key",Ph="base58btc",v2="z",m2="K36",w2=32;function _c(t){return globalThis.Buffer!=null?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}function Th(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?_c(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}function Rh(t,e){e||(e=t.reduce((n,s)=>n+s.length,0));const r=Th(e);let i=0;for(const n of t)r.set(n,i),i+=n.length;return _c(r)}function _2(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),i=0;i<r.length;i++)r[i]=255;for(var n=0;n<t.length;n++){var s=t.charAt(n),o=s.charCodeAt(0);if(r[o]!==255)throw new TypeError(s+" is ambiguous");r[o]=n}var a=t.length,c=t.charAt(0),u=Math.log(a)/Math.log(256),h=Math.log(256)/Math.log(a);function l(g){if(g instanceof Uint8Array||(ArrayBuffer.isView(g)?g=new Uint8Array(g.buffer,g.byteOffset,g.byteLength):Array.isArray(g)&&(g=Uint8Array.from(g))),!(g instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(g.length===0)return"";for(var x=0,A=0,D=0,$=g.length;D!==$&&g[D]===0;)D++,x++;for(var P=($-D)*h+1>>>0,T=new Uint8Array(P);D!==$;){for(var N=g[D],L=0,F=P-1;(N!==0||L<A)&&F!==-1;F--,L++)N+=256*T[F]>>>0,T[F]=N%a>>>0,N=N/a>>>0;if(N!==0)throw new Error("Non-zero carry");A=L,D++}for(var B=P-A;B!==P&&T[B]===0;)B++;for(var C=c.repeat(x);B<P;++B)C+=t.charAt(T[B]);return C}function b(g){if(typeof g!="string")throw new TypeError("Expected String");if(g.length===0)return new Uint8Array;var x=0;if(g[x]!==" "){for(var A=0,D=0;g[x]===c;)A++,x++;for(var $=(g.length-x)*u+1>>>0,P=new Uint8Array($);g[x];){var T=r[g.charCodeAt(x)];if(T===255)return;for(var N=0,L=$-1;(T!==0||N<D)&&L!==-1;L--,N++)T+=a*P[L]>>>0,P[L]=T%256>>>0,T=T/256>>>0;if(T!==0)throw new Error("Non-zero carry");D=N,x++}if(g[x]!==" "){for(var F=$-D;F!==$&&P[F]===0;)F++;for(var B=new Uint8Array(A+($-F)),C=A;F!==$;)B[C++]=P[F++];return B}}}function w(g){var x=b(g);if(x)return x;throw new Error(`Non-${e} character`)}return{encode:l,decodeUnsafe:b,decode:w}}var E2=_2,x2=E2;const Nh=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},S2=t=>new TextEncoder().encode(t),I2=t=>new TextDecoder().decode(t);class A2{constructor(e,r,i){this.name=e,this.prefix=r,this.baseEncode=i}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class D2{constructor(e,r,i){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=i}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return Ch(this,e)}}class O2{constructor(e){this.decoders=e}or(e){return Ch(this,e)}decode(e){const r=e[0],i=this.decoders[r];if(i)return i.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Ch=(t,e)=>new O2({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});class M2{constructor(e,r,i,n){this.name=e,this.prefix=r,this.baseEncode=i,this.baseDecode=n,this.encoder=new A2(e,r,i),this.decoder=new D2(e,r,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const Ro=({name:t,prefix:e,encode:r,decode:i})=>new M2(t,e,r,i),ds=({prefix:t,name:e,alphabet:r})=>{const{encode:i,decode:n}=x2(r,e);return Ro({prefix:t,name:e,encode:i,decode:s=>Nh(n(s))})},$2=(t,e,r,i)=>{const n={};for(let h=0;h<e.length;++h)n[e[h]]=h;let s=t.length;for(;t[s-1]==="=";)--s;const o=new Uint8Array(s*r/8|0);let a=0,c=0,u=0;for(let h=0;h<s;++h){const l=n[t[h]];if(l===void 0)throw new SyntaxError(`Non-${i} character`);c=c<<r|l,a+=r,a>=8&&(a-=8,o[u++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},P2=(t,e,r)=>{const i=e[e.length-1]==="=",n=(1<<r)-1;let s="",o=0,a=0;for(let c=0;c<t.length;++c)for(a=a<<8|t[c],o+=8;o>r;)o-=r,s+=e[n&a>>o];if(o&&(s+=e[n&a<<r-o]),i)for(;s.length*r&7;)s+="=";return s},_t=({name:t,prefix:e,bitsPerChar:r,alphabet:i})=>Ro({prefix:e,name:t,encode(n){return P2(n,i,r)},decode(n){return $2(n,i,r,t)}}),T2=Ro({prefix:"\0",name:"identity",encode:t=>I2(t),decode:t=>S2(t)});var R2=Object.freeze({__proto__:null,identity:T2});const N2=_t({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var C2=Object.freeze({__proto__:null,base2:N2});const B2=_t({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var F2=Object.freeze({__proto__:null,base8:B2});const L2=ds({prefix:"9",name:"base10",alphabet:"0123456789"});var q2=Object.freeze({__proto__:null,base10:L2});const z2=_t({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),U2=_t({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var k2=Object.freeze({__proto__:null,base16:z2,base16upper:U2});const j2=_t({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),K2=_t({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),V2=_t({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),H2=_t({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),G2=_t({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),W2=_t({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Y2=_t({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),X2=_t({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Z2=_t({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var J2=Object.freeze({__proto__:null,base32:j2,base32upper:K2,base32pad:V2,base32padupper:H2,base32hex:G2,base32hexupper:W2,base32hexpad:Y2,base32hexpadupper:X2,base32z:Z2});const Q2=ds({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),ev=ds({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var tv=Object.freeze({__proto__:null,base36:Q2,base36upper:ev});const rv=ds({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),iv=ds({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var nv=Object.freeze({__proto__:null,base58btc:rv,base58flickr:iv});const sv=_t({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),ov=_t({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),av=_t({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),cv=_t({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var uv=Object.freeze({__proto__:null,base64:sv,base64pad:ov,base64url:av,base64urlpad:cv});const Bh=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),fv=Bh.reduce((t,e,r)=>(t[r]=e,t),[]),hv=Bh.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function dv(t){return t.reduce((e,r)=>(e+=fv[r],e),"")}function lv(t){const e=[];for(const r of t){const i=hv[r.codePointAt(0)];if(i===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(i)}return new Uint8Array(e)}const pv=Ro({prefix:"\u{1F680}",name:"base256emoji",encode:dv,decode:lv});var bv=Object.freeze({__proto__:null,base256emoji:pv}),gv=Lh,Fh=128,yv=127,vv=~yv,mv=Math.pow(2,31);function Lh(t,e,r){e=e||[],r=r||0;for(var i=r;t>=mv;)e[r++]=t&255|Fh,t/=128;for(;t&vv;)e[r++]=t&255|Fh,t>>>=7;return e[r]=t|0,Lh.bytes=r-i+1,e}var wv=Ec,_v=128,qh=127;function Ec(t,i){var r=0,i=i||0,n=0,s=i,o,a=t.length;do{if(s>=a)throw Ec.bytes=0,new RangeError("Could not decode varint");o=t[s++],r+=n<28?(o&qh)<<n:(o&qh)*Math.pow(2,n),n+=7}while(o>=_v);return Ec.bytes=s-i,r}var Ev=Math.pow(2,7),xv=Math.pow(2,14),Sv=Math.pow(2,21),Iv=Math.pow(2,28),Av=Math.pow(2,35),Dv=Math.pow(2,42),Ov=Math.pow(2,49),Mv=Math.pow(2,56),$v=Math.pow(2,63),Pv=function(t){return t<Ev?1:t<xv?2:t<Sv?3:t<Iv?4:t<Av?5:t<Dv?6:t<Ov?7:t<Mv?8:t<$v?9:10},Tv={encode:gv,decode:wv,encodingLength:Pv},zh=Tv;const Uh=(t,e,r=0)=>(zh.encode(t,e,r),e),kh=t=>zh.encodingLength(t),xc=(t,e)=>{const r=e.byteLength,i=kh(t),n=i+kh(r),s=new Uint8Array(n+r);return Uh(t,s,0),Uh(r,s,i),s.set(e,n),new Rv(t,r,e,s)};class Rv{constructor(e,r,i,n){this.code=e,this.size=r,this.digest=i,this.bytes=n}}const jh=({name:t,code:e,encode:r})=>new Nv(t,e,r);class Nv{constructor(e,r,i){this.name=e,this.code=r,this.encode=i}digest(e){if(e instanceof Uint8Array){const r=this.encode(e);return r instanceof Uint8Array?xc(this.code,r):r.then(i=>xc(this.code,i))}else throw Error("Unknown type, must be binary type")}}const Kh=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),Cv=jh({name:"sha2-256",code:18,encode:Kh("SHA-256")}),Bv=jh({name:"sha2-512",code:19,encode:Kh("SHA-512")});var Fv=Object.freeze({__proto__:null,sha256:Cv,sha512:Bv});const Vh=0,Lv="identity",Hh=Nh;var qv=Object.freeze({__proto__:null,identity:{code:Vh,name:Lv,encode:Hh,digest:t=>xc(Vh,Hh(t))}});new TextEncoder,new TextDecoder;const Gh={...R2,...C2,...F2,...q2,...k2,...J2,...tv,...nv,...uv,...bv};({...Fv,...qv});function Wh(t,e,r,i){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:i}}}const Yh=Wh("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),Sc=Wh("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);const e=Th(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),Xh={utf8:Yh,"utf-8":Yh,hex:Gh.base16,latin1:Sc,ascii:Sc,binary:Sc,...Gh};function No(t,e="utf8"){const r=Xh[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8"):r.encoder.encode(t).substring(1)}function En(t,e="utf8"){const r=Xh[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?_c(globalThis.Buffer.from(t,"utf-8")):r.decoder.decode(`${r.prefix}${t}`)}function Zh(t){return vn(No(En(t,To),Mh))}function Co(t){return No(En(Li(t),Mh),To)}function Jh(t){const e=En(m2,Ph),r=v2+No(Rh([e,t]),Ph);return[g2,y2,r].join(b2)}function zv(t){return No(t,To)}function Uv(t){return En(t,To)}function kv(t){return En([Co(t.header),Co(t.payload)].join(Po),$h)}function jv(t){return[Co(t.header),Co(t.payload),zv(t.signature)].join(Po)}function Ic(t){const e=t.split(Po),r=Zh(e[0]),i=Zh(e[1]),n=Uv(e[2]),s=En(e.slice(0,2).join(Po),$h);return{header:r,payload:i,signature:n,data:s}}function Qh(t=uh(w2)){const e=Oh.getPublicKey(t);return{secretKey:Rh([t,e]),publicKey:e}}async function Kv(t,e,r,i,n=V.fromMiliseconds(Date.now())){const s={alg:l2,typ:p2},o=Jh(i.publicKey),a=n+r,c={iss:o,sub:t,aud:e,iat:n,exp:a},u=kv({header:s,payload:c}),h=Oh.sign(u,i.secretKey.slice(0,32));return jv({header:s,payload:c,signature:h})}var ed=function(t,e,r){if(r||arguments.length===2)for(var i=0,n=e.length,s;i<n;i++)(s||!(i in e))&&(s||(s=Array.prototype.slice.call(e,0,i)),s[i]=e[i]);return t.concat(s||Array.prototype.slice.call(e))},Vv=function(){function t(e,r,i){this.name=e,this.version=r,this.os=i,this.type="browser"}return t}(),Hv=function(){function t(e){this.version=e,this.type="node",this.name="node",this.os=process.platform}return t}(),Gv=function(){function t(e,r,i,n){this.name=e,this.version=r,this.os=i,this.bot=n,this.type="bot-device"}return t}(),Wv=function(){function t(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return t}(),Yv=function(){function t(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return t}(),Xv=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,Zv=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,td=3,Jv=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",Xv]],rd=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function Qv(t){return t?id(t):typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new Yv:typeof navigator<"u"?id(navigator.userAgent):rm()}function em(t){return t!==""&&Jv.reduce(function(e,r){var i=r[0],n=r[1];if(e)return e;var s=n.exec(t);return!!s&&[i,s]},!1)}function id(t){var e=em(t);if(!e)return null;var r=e[0],i=e[1];if(r==="searchbot")return new Wv;var n=i[1]&&i[1].split(".").join("_").split("_").slice(0,3);n?n.length<td&&(n=ed(ed([],n,!0),im(td-n.length),!0)):n=[];var s=n.join("."),o=tm(t),a=Zv.exec(t);return a&&a[1]?new Gv(r,s,o,a[1]):new Vv(r,s,o)}function tm(t){for(var e=0,r=rd.length;e<r;e++){var i=rd[e],n=i[0],s=i[1],o=s.exec(t);if(o)return n}return null}function rm(){var t=typeof process<"u"&&process.version;return t?new Hv(process.version.slice(1)):null}function im(t){for(var e=[],r=0;r<t;r++)e.push("0");return e}var ve={};Object.defineProperty(ve,"__esModule",{value:!0}),ve.getLocalStorage=ve.getLocalStorageOrThrow=ve.getCrypto=ve.getCryptoOrThrow=nd=ve.getLocation=ve.getLocationOrThrow=Ac=ve.getNavigator=ve.getNavigatorOrThrow=ls=ve.getDocument=ve.getDocumentOrThrow=ve.getFromWindowOrThrow=ve.getFromWindow=void 0;function zi(t){let e;return typeof window<"u"&&typeof window[t]<"u"&&(e=window[t]),e}ve.getFromWindow=zi;function xn(t){const e=zi(t);if(!e)throw new Error(`${t} is not defined in Window`);return e}ve.getFromWindowOrThrow=xn;function nm(){return xn("document")}ve.getDocumentOrThrow=nm;function sm(){return zi("document")}var ls=ve.getDocument=sm;function om(){return xn("navigator")}ve.getNavigatorOrThrow=om;function am(){return zi("navigator")}var Ac=ve.getNavigator=am;function cm(){return xn("location")}ve.getLocationOrThrow=cm;function um(){return zi("location")}var nd=ve.getLocation=um;function fm(){return xn("crypto")}ve.getCryptoOrThrow=fm;function hm(){return zi("crypto")}ve.getCrypto=hm;function dm(){return xn("localStorage")}ve.getLocalStorageOrThrow=dm;function lm(){return zi("localStorage")}ve.getLocalStorage=lm;var Dc={};Object.defineProperty(Dc,"__esModule",{value:!0});var sd=Dc.getWindowMetadata=void 0;const od=ve;function pm(){let t,e;try{t=od.getDocumentOrThrow(),e=od.getLocationOrThrow()}catch{return null}function r(){const l=t.getElementsByTagName("link"),b=[];for(let w=0;w<l.length;w++){const g=l[w],x=g.getAttribute("rel");if(x&&x.toLowerCase().indexOf("icon")>-1){const A=g.getAttribute("href");if(A)if(A.toLowerCase().indexOf("https:")===-1&&A.toLowerCase().indexOf("http:")===-1&&A.indexOf("//")!==0){let D=e.protocol+"//"+e.host;if(A.indexOf("/")===0)D+=A;else{const $=e.pathname.split("/");$.pop();const P=$.join("/");D+=P+"/"+A}b.push(D)}else if(A.indexOf("//")===0){const D=e.protocol+A;b.push(D)}else b.push(A)}}return b}function i(...l){const b=t.getElementsByTagName("meta");for(let w=0;w<b.length;w++){const g=b[w],x=["itemprop","property","name"].map(A=>g.getAttribute(A)).filter(A=>A?l.includes(A):!1);if(x.length&&x){const A=g.getAttribute("content");if(A)return A}}return""}function n(){let l=i("name","og:site_name","og:title","twitter:title");return l||(l=t.title),l}function s(){return i("description","og:description","twitter:description","keywords")}const o=n(),a=s(),c=e.origin,u=r();return{description:a,url:c,icons:u,name:o}}sd=Dc.getWindowMetadata=pm;function ps(t,{strict:e=!0}={}){return!t||typeof t!="string"?!1:e?/^0x[0-9a-fA-F]*$/.test(t):t.startsWith("0x")}function ad(t){return ps(t,{strict:!1})?Math.ceil((t.length-2)/2):t.length}const cd="2.23.2";let Oc={getDocsUrl:({docsBaseUrl:t,docsPath:e="",docsSlug:r})=>e?`${t??"https://viem.sh"}${e}${r?`#${r}`:""}`:void 0,version:`viem@${cd}`};class Ui extends Error{constructor(e,r={}){const i=r.cause instanceof Ui?r.cause.details:r.cause?.message?r.cause.message:r.details,n=r.cause instanceof Ui&&r.cause.docsPath||r.docsPath,s=Oc.getDocsUrl?.({...r,docsPath:n}),o=[e||"An error occurred.","",...r.metaMessages?[...r.metaMessages,""]:[],...s?[`Docs: ${s}`]:[],...i?[`Details: ${i}`]:[],...Oc.version?[`Version: ${Oc.version}`]:[]].join(`
`);super(o,r.cause?{cause:r.cause}:void 0),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metaMessages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"version",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"BaseError"}),this.details=i,this.docsPath=n,this.metaMessages=r.metaMessages,this.name=r.name??this.name,this.shortMessage=e,this.version=cd}walk(e){return ud(this,e)}}function ud(t,e){return e?.(t)?t:t&&typeof t=="object"&&"cause"in t&&t.cause!==void 0?ud(t.cause,e):e?null:t}class fd extends Ui{constructor({size:e,targetSize:r,type:i}){super(`${i.charAt(0).toUpperCase()}${i.slice(1).toLowerCase()} size (${e}) exceeds padding size (${r}).`,{name:"SizeExceedsPaddingSizeError"})}}function Sn(t,{dir:e,size:r=32}={}){return typeof t=="string"?bm(t,{dir:e,size:r}):gm(t,{dir:e,size:r})}function bm(t,{dir:e,size:r=32}={}){if(r===null)return t;const i=t.replace("0x","");if(i.length>r*2)throw new fd({size:Math.ceil(i.length/2),targetSize:r,type:"hex"});return`0x${i[e==="right"?"padEnd":"padStart"](r*2,"0")}`}function gm(t,{dir:e,size:r=32}={}){if(r===null)return t;if(t.length>r)throw new fd({size:t.length,targetSize:r,type:"bytes"});const i=new Uint8Array(r);for(let n=0;n<r;n++){const s=e==="right";i[s?n:r-n-1]=t[s?n:t.length-n-1]}return i}class ym extends Ui{constructor({max:e,min:r,signed:i,size:n,value:s}){super(`Number "${s}" is not in safe ${n?`${n*8}-bit ${i?"signed":"unsigned"} `:""}integer range ${e?`(${r} to ${e})`:`(above ${r})`}`,{name:"IntegerOutOfRangeError"})}}class vm extends Ui{constructor({givenSize:e,maxSize:r}){super(`Size cannot exceed ${r} bytes. Given size: ${e} bytes.`,{name:"SizeOverflowError"})}}function In(t,{size:e}){if(ad(t)>e)throw new vm({givenSize:ad(t),maxSize:e})}function Mc(t,e={}){const{signed:r}=e;e.size&&In(t,{size:e.size});const i=BigInt(t);if(!r)return i;const n=(t.length-2)/2,s=(1n<<BigInt(n)*8n-1n)-1n;return i<=s?i:i-BigInt(`0x${"f".padStart(n*2,"f")}`)-1n}function mm(t,e={}){return Number(Mc(t,e))}const wm=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function $c(t,e={}){return typeof t=="number"||typeof t=="bigint"?dd(t,e):typeof t=="string"?xm(t,e):typeof t=="boolean"?_m(t,e):hd(t,e)}function _m(t,e={}){const r=`0x${Number(t)}`;return typeof e.size=="number"?(In(r,{size:e.size}),Sn(r,{size:e.size})):r}function hd(t,e={}){let r="";for(let n=0;n<t.length;n++)r+=wm[t[n]];const i=`0x${r}`;return typeof e.size=="number"?(In(i,{size:e.size}),Sn(i,{dir:"right",size:e.size})):i}function dd(t,e={}){const{signed:r,size:i}=e,n=BigInt(t);let s;i?r?s=(1n<<BigInt(i)*8n-1n)-1n:s=2n**(BigInt(i)*8n)-1n:typeof t=="number"&&(s=BigInt(Number.MAX_SAFE_INTEGER));const o=typeof s=="bigint"&&r?-s-1n:0;if(s&&n>s||n<o){const c=typeof t=="bigint"?"n":"";throw new ym({max:s?`${s}${c}`:void 0,min:`${o}${c}`,signed:r,size:i,value:`${t}${c}`})}const a=`0x${(r&&n<0?(1n<<BigInt(i*8))+BigInt(n):n).toString(16)}`;return i?Sn(a,{size:i}):a}const Em=new TextEncoder;function xm(t,e={}){const r=Em.encode(t);return hd(r,e)}const Sm=new TextEncoder;function Im(t,e={}){return typeof t=="number"||typeof t=="bigint"?Dm(t,e):typeof t=="boolean"?Am(t,e):ps(t)?pd(t,e):bd(t,e)}function Am(t,e={}){const r=new Uint8Array(1);return r[0]=Number(t),typeof e.size=="number"?(In(r,{size:e.size}),Sn(r,{size:e.size})):r}const Xr={zero:48,nine:57,A:65,F:70,a:97,f:102};function ld(t){if(t>=Xr.zero&&t<=Xr.nine)return t-Xr.zero;if(t>=Xr.A&&t<=Xr.F)return t-(Xr.A-10);if(t>=Xr.a&&t<=Xr.f)return t-(Xr.a-10)}function pd(t,e={}){let r=t;e.size&&(In(r,{size:e.size}),r=Sn(r,{dir:"right",size:e.size}));let i=r.slice(2);i.length%2&&(i=`0${i}`);const n=i.length/2,s=new Uint8Array(n);for(let o=0,a=0;o<n;o++){const c=ld(i.charCodeAt(a++)),u=ld(i.charCodeAt(a++));if(c===void 0||u===void 0)throw new Ui(`Invalid byte sequence ("${i[a-2]}${i[a-1]}" in "${i}").`);s[o]=c*16+u}return s}function Dm(t,e){const r=dd(t,e);return pd(r)}function bd(t,e={}){const r=Sm.encode(t);return typeof e.size=="number"?(In(r,{size:e.size}),Sn(r,{dir:"right",size:e.size})):r}function Bo(t){if(!Number.isSafeInteger(t)||t<0)throw new Error("positive integer expected, got "+t)}function Om(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function bs(t,...e){if(!Om(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function Mm(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");Bo(t.outputLen),Bo(t.blockLen)}function An(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function gd(t,e){bs(t);const r=e.outputLen;if(t.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}const Fo=BigInt(2**32-1),yd=BigInt(32);function $m(t,e=!1){return e?{h:Number(t&Fo),l:Number(t>>yd&Fo)}:{h:Number(t>>yd&Fo)|0,l:Number(t&Fo)|0}}function Pm(t,e=!1){let r=new Uint32Array(t.length),i=new Uint32Array(t.length);for(let n=0;n<t.length;n++){const{h:s,l:o}=$m(t[n],e);[r[n],i[n]]=[s,o]}return[r,i]}const Tm=(t,e,r)=>t<<r|e>>>32-r,Rm=(t,e,r)=>e<<r|t>>>32-r,Nm=(t,e,r)=>e<<r-32|t>>>64-r,Cm=(t,e,r)=>t<<r-32|e>>>64-r,Dn=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;function Bm(t){return new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4))}function Pc(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function Dr(t,e){return t<<32-e|t>>>e}const vd=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function Fm(t){return t<<24&4278190080|t<<8&16711680|t>>>8&65280|t>>>24&255}function md(t){for(let e=0;e<t.length;e++)t[e]=Fm(t[e])}function Lm(t){if(typeof t!="string")throw new Error("utf8ToBytes expected string, got "+typeof t);return new Uint8Array(new TextEncoder().encode(t))}function Lo(t){return typeof t=="string"&&(t=Lm(t)),bs(t),t}function qm(...t){let e=0;for(let i=0;i<t.length;i++){const n=t[i];bs(n),e+=n.length}const r=new Uint8Array(e);for(let i=0,n=0;i<t.length;i++){const s=t[i];r.set(s,n),n+=s.length}return r}class Tc{clone(){return this._cloneInto()}}function wd(t){const e=i=>t().update(Lo(i)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e}function _d(t=32){if(Dn&&typeof Dn.getRandomValues=="function")return Dn.getRandomValues(new Uint8Array(t));if(Dn&&typeof Dn.randomBytes=="function")return Dn.randomBytes(t);throw new Error("crypto.getRandomValues must be defined")}const Ed=[],xd=[],Sd=[],zm=BigInt(0),gs=BigInt(1),Um=BigInt(2),km=BigInt(7),jm=BigInt(256),Km=BigInt(113);for(let t=0,e=gs,r=1,i=0;t<24;t++){[r,i]=[i,(2*r+3*i)%5],Ed.push(2*(5*i+r)),xd.push((t+1)*(t+2)/2%64);let n=zm;for(let s=0;s<7;s++)e=(e<<gs^(e>>km)*Km)%jm,e&Um&&(n^=gs<<(gs<<BigInt(s))-gs);Sd.push(n)}const[Vm,Hm]=Pm(Sd,!0),Id=(t,e,r)=>r>32?Nm(t,e,r):Tm(t,e,r),Ad=(t,e,r)=>r>32?Cm(t,e,r):Rm(t,e,r);function Gm(t,e=24){const r=new Uint32Array(10);for(let i=24-e;i<24;i++){for(let o=0;o<10;o++)r[o]=t[o]^t[o+10]^t[o+20]^t[o+30]^t[o+40];for(let o=0;o<10;o+=2){const a=(o+8)%10,c=(o+2)%10,u=r[c],h=r[c+1],l=Id(u,h,1)^r[a],b=Ad(u,h,1)^r[a+1];for(let w=0;w<50;w+=10)t[o+w]^=l,t[o+w+1]^=b}let n=t[2],s=t[3];for(let o=0;o<24;o++){const a=xd[o],c=Id(n,s,a),u=Ad(n,s,a),h=Ed[o];n=t[h],s=t[h+1],t[h]=c,t[h+1]=u}for(let o=0;o<50;o+=10){for(let a=0;a<10;a++)r[a]=t[o+a];for(let a=0;a<10;a++)t[o+a]^=~r[(a+2)%10]&r[(a+4)%10]}t[0]^=Vm[i],t[1]^=Hm[i]}r.fill(0)}class Rc extends Tc{constructor(e,r,i,n=!1,s=24){if(super(),this.blockLen=e,this.suffix=r,this.outputLen=i,this.enableXOF=n,this.rounds=s,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,Bo(i),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=Bm(this.state)}keccak(){vd||md(this.state32),Gm(this.state32,this.rounds),vd||md(this.state32),this.posOut=0,this.pos=0}update(e){An(this);const{blockLen:r,state:i}=this;e=Lo(e);const n=e.length;for(let s=0;s<n;){const o=Math.min(r-this.pos,n-s);for(let a=0;a<o;a++)i[this.pos++]^=e[s++];this.pos===r&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:r,pos:i,blockLen:n}=this;e[i]^=r,(r&128)!==0&&i===n-1&&this.keccak(),e[n-1]^=128,this.keccak()}writeInto(e){An(this,!1),bs(e),this.finish();const r=this.state,{blockLen:i}=this;for(let n=0,s=e.length;n<s;){this.posOut>=i&&this.keccak();const o=Math.min(i-this.posOut,s-n);e.set(r.subarray(this.posOut,this.posOut+o),n),this.posOut+=o,n+=o}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return Bo(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(gd(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(e){const{blockLen:r,suffix:i,outputLen:n,rounds:s,enableXOF:o}=this;return e||(e=new Rc(r,i,n,o,s)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=s,e.suffix=i,e.outputLen=n,e.enableXOF=o,e.destroyed=this.destroyed,e}}const Dd=((t,e,r)=>wd(()=>new Rc(e,t,r)))(1,136,256/8);function Od(t,e){const r=e||"hex",i=Dd(ps(t,{strict:!1})?Im(t):t);return r==="bytes"?i:$c(i)}class Md extends Map{constructor(e){super(),Object.defineProperty(this,"maxSize",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxSize=e}get(e){const r=super.get(e);return super.has(e)&&r!==void 0&&(this.delete(e),super.set(e,r)),r}set(e,r){if(super.set(e,r),this.maxSize&&this.size>this.maxSize){const i=this.keys().next().value;i&&this.delete(i)}return this}}const Nc=new Md(8192);function Wm(t,e){if(Nc.has(`${t}.${e}`))return Nc.get(`${t}.${e}`);const r=e?`${e}${t.toLowerCase()}`:t.substring(2).toLowerCase(),i=Od(bd(r),"bytes"),n=(e?r.substring(`${e}0x`.length):r).split("");for(let o=0;o<40;o+=2)i[o>>1]>>4>=8&&n[o]&&(n[o]=n[o].toUpperCase()),(i[o>>1]&15)>=8&&n[o+1]&&(n[o+1]=n[o+1].toUpperCase());const s=`0x${n.join("")}`;return Nc.set(`${t}.${e}`,s),s}function Ym(t){const e=Od(`0x${t.substring(4)}`).substring(26);return Wm(`0x${e}`)}async function Xm({hash:t,signature:e}){const r=ps(t)?t:$c(t),{secp256k1:i}=await Promise.resolve().then(function(){return $w});return`0x${(()=>{if(typeof e=="object"&&"r"in e&&"s"in e){const{r:u,s:h,v:l,yParity:b}=e,w=Number(b??l),g=$d(w);return new i.Signature(Mc(u),Mc(h)).addRecoveryBit(g)}const o=ps(e)?e:$c(e),a=mm(`0x${o.slice(130)}`),c=$d(a);return i.Signature.fromCompact(o.substring(2,130)).addRecoveryBit(c)})().recoverPublicKey(r.substring(2)).toHex(!1)}`}function $d(t){if(t===0||t===1)return t;if(t===27)return 0;if(t===28)return 1;throw new Error("Invalid yParityOrV value")}async function Zm({hash:t,signature:e}){return Ym(await Xm({hash:t,signature:e}))}function Jm(t,e,r,i){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,r,i);const n=BigInt(32),s=BigInt(4294967295),o=Number(r>>n&s),a=Number(r&s),c=i?4:0,u=i?0:4;t.setUint32(e+c,o,i),t.setUint32(e+u,a,i)}function Qm(t,e,r){return t&e^~t&r}function e3(t,e,r){return t&e^t&r^e&r}class t3 extends Tc{constructor(e,r,i,n){super(),this.blockLen=e,this.outputLen=r,this.padOffset=i,this.isLE=n,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=Pc(this.buffer)}update(e){An(this);const{view:r,buffer:i,blockLen:n}=this;e=Lo(e);const s=e.length;for(let o=0;o<s;){const a=Math.min(n-this.pos,s-o);if(a===n){const c=Pc(e);for(;n<=s-o;o+=n)this.process(c,o);continue}i.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===n&&(this.process(r,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){An(this),gd(e,this),this.finished=!0;const{buffer:r,view:i,blockLen:n,isLE:s}=this;let{pos:o}=this;r[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>n-o&&(this.process(i,0),o=0);for(let l=o;l<n;l++)r[l]=0;Jm(i,n-8,BigInt(this.length*8),s),this.process(i,0);const a=Pc(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const u=c/4,h=this.get();if(u>h.length)throw new Error("_sha2: outputLen bigger than state");for(let l=0;l<u;l++)a.setUint32(4*l,h[l],s)}digest(){const{buffer:e,outputLen:r}=this;this.digestInto(e);const i=e.slice(0,r);return this.destroy(),i}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:r,buffer:i,length:n,finished:s,destroyed:o,pos:a}=this;return e.length=n,e.pos=a,e.finished=s,e.destroyed=o,n%r&&e.buffer.set(i),e}}const r3=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),di=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),li=new Uint32Array(64);class i3 extends t3{constructor(){super(64,32,8,!1),this.A=di[0]|0,this.B=di[1]|0,this.C=di[2]|0,this.D=di[3]|0,this.E=di[4]|0,this.F=di[5]|0,this.G=di[6]|0,this.H=di[7]|0}get(){const{A:e,B:r,C:i,D:n,E:s,F:o,G:a,H:c}=this;return[e,r,i,n,s,o,a,c]}set(e,r,i,n,s,o,a,c){this.A=e|0,this.B=r|0,this.C=i|0,this.D=n|0,this.E=s|0,this.F=o|0,this.G=a|0,this.H=c|0}process(e,r){for(let l=0;l<16;l++,r+=4)li[l]=e.getUint32(r,!1);for(let l=16;l<64;l++){const b=li[l-15],w=li[l-2],g=Dr(b,7)^Dr(b,18)^b>>>3,x=Dr(w,17)^Dr(w,19)^w>>>10;li[l]=x+li[l-7]+g+li[l-16]|0}let{A:i,B:n,C:s,D:o,E:a,F:c,G:u,H:h}=this;for(let l=0;l<64;l++){const b=Dr(a,6)^Dr(a,11)^Dr(a,25),w=h+b+Qm(a,c,u)+r3[l]+li[l]|0,x=(Dr(i,2)^Dr(i,13)^Dr(i,22))+e3(i,n,s)|0;h=u,u=c,c=a,a=o+w|0,o=s,s=n,n=i,i=w+x|0}i=i+this.A|0,n=n+this.B|0,s=s+this.C|0,o=o+this.D|0,a=a+this.E|0,c=c+this.F|0,u=u+this.G|0,h=h+this.H|0,this.set(i,n,s,o,a,c,u,h)}roundClean(){li.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}const qo=wd(()=>new i3);new Md(128);const n3=new Uint8Array([7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8]),Pd=new Uint8Array(new Array(16).fill(0).map((t,e)=>e)),s3=Pd.map(t=>(9*t+5)%16);let o3=[Pd],a3=[s3];for(let t=0;t<4;t++)for(let e of[o3,a3])e.push(e[t].map(r=>n3[r]));/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const zo=BigInt(0),Uo=BigInt(1),c3=BigInt(2);function ki(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function Or(t){if(!ki(t))throw new Error("Uint8Array expected")}function On(t,e){if(typeof e!="boolean")throw new Error(t+" boolean expected, got "+e)}const u3=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function Mn(t){Or(t);let e="";for(let r=0;r<t.length;r++)e+=u3[t[r]];return e}function $n(t){const e=t.toString(16);return e.length&1?"0"+e:e}function Cc(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return t===""?zo:BigInt("0x"+t)}const Zr={_0:48,_9:57,A:65,F:70,a:97,f:102};function Td(t){if(t>=Zr._0&&t<=Zr._9)return t-Zr._0;if(t>=Zr.A&&t<=Zr.F)return t-(Zr.A-10);if(t>=Zr.a&&t<=Zr.f)return t-(Zr.a-10)}function Pn(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);const e=t.length,r=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);const i=new Uint8Array(r);for(let n=0,s=0;n<r;n++,s+=2){const o=Td(t.charCodeAt(s)),a=Td(t.charCodeAt(s+1));if(o===void 0||a===void 0){const c=t[s]+t[s+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+s)}i[n]=o*16+a}return i}function Mr(t){return Cc(Mn(t))}function Bc(t){return Or(t),Cc(Mn(Uint8Array.from(t).reverse()))}function pi(t,e){return Pn(t.toString(16).padStart(e*2,"0"))}function Fc(t,e){return pi(t,e).reverse()}function f3(t){return Pn($n(t))}function Mt(t,e,r){let i;if(typeof e=="string")try{i=Pn(e)}catch(s){throw new Error(t+" must be hex string or Uint8Array, cause: "+s)}else if(ki(e))i=Uint8Array.from(e);else throw new Error(t+" must be hex string or Uint8Array");const n=i.length;if(typeof r=="number"&&n!==r)throw new Error(t+" of length "+r+" expected, got "+n);return i}function Yt(...t){let e=0;for(let i=0;i<t.length;i++){const n=t[i];Or(n),e+=n.length}const r=new Uint8Array(e);for(let i=0,n=0;i<t.length;i++){const s=t[i];r.set(s,n),n+=s.length}return r}function h3(t,e){if(t.length!==e.length)return!1;let r=0;for(let i=0;i<t.length;i++)r|=t[i]^e[i];return r===0}function ko(t){if(typeof t!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(t))}const Lc=t=>typeof t=="bigint"&&zo<=t;function Tn(t,e,r){return Lc(t)&&Lc(e)&&Lc(r)&&e<=t&&t<r}function bi(t,e,r,i){if(!Tn(e,r,i))throw new Error("expected valid "+t+": "+r+" <= n < "+i+", got "+e)}function Rd(t){let e;for(e=0;t>zo;t>>=Uo,e+=1);return e}function d3(t,e){return t>>BigInt(e)&Uo}function l3(t,e,r){return t|(r?Uo:zo)<<BigInt(e)}const qc=t=>(c3<<BigInt(t-1))-Uo,zc=t=>new Uint8Array(t),Nd=t=>Uint8Array.from(t);function Cd(t,e,r){if(typeof t!="number"||t<2)throw new Error("hashLen must be a number");if(typeof e!="number"||e<2)throw new Error("qByteLen must be a number");if(typeof r!="function")throw new Error("hmacFn must be a function");let i=zc(t),n=zc(t),s=0;const o=()=>{i.fill(1),n.fill(0),s=0},a=(...l)=>r(n,i,...l),c=(l=zc())=>{n=a(Nd([0]),l),i=a(),l.length!==0&&(n=a(Nd([1]),l),i=a())},u=()=>{if(s++>=1e3)throw new Error("drbg: tried 1000 values");let l=0;const b=[];for(;l<e;){i=a();const w=i.slice();b.push(w),l+=i.length}return Yt(...b)};return(l,b)=>{o(),c(l);let w;for(;!(w=b(u()));)c();return o(),w}}const p3={bigint:t=>typeof t=="bigint",function:t=>typeof t=="function",boolean:t=>typeof t=="boolean",string:t=>typeof t=="string",stringOrUint8Array:t=>typeof t=="string"||ki(t),isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>typeof t=="function"&&Number.isSafeInteger(t.outputLen)};function Rn(t,e,r={}){const i=(n,s,o)=>{const a=p3[s];if(typeof a!="function")throw new Error("invalid validator function");const c=t[n];if(!(o&&c===void 0)&&!a(c,t))throw new Error("param "+String(n)+" is invalid. Expected "+s+", got "+c)};for(const[n,s]of Object.entries(e))i(n,s,!1);for(const[n,s]of Object.entries(r))i(n,s,!0);return t}const b3=()=>{throw new Error("not implemented")};function Uc(t){const e=new WeakMap;return(r,...i)=>{const n=e.get(r);if(n!==void 0)return n;const s=t(r,...i);return e.set(r,s),s}}var g3=Object.freeze({__proto__:null,isBytes:ki,abytes:Or,abool:On,bytesToHex:Mn,numberToHexUnpadded:$n,hexToNumber:Cc,hexToBytes:Pn,bytesToNumberBE:Mr,bytesToNumberLE:Bc,numberToBytesBE:pi,numberToBytesLE:Fc,numberToVarBytesBE:f3,ensureBytes:Mt,concatBytes:Yt,equalBytes:h3,utf8ToBytes:ko,inRange:Tn,aInRange:bi,bitLen:Rd,bitGet:d3,bitSet:l3,bitMask:qc,createHmacDrbg:Cd,validateObject:Rn,notImplemented:b3,memoized:Uc});const y3="0.1.1";function v3(){return y3}class Bt extends Error{constructor(e,r={}){const i=(()=>{if(r.cause instanceof Bt){if(r.cause.details)return r.cause.details;if(r.cause.shortMessage)return r.cause.shortMessage}return r.cause?.message?r.cause.message:r.details})(),n=r.cause instanceof Bt&&r.cause.docsPath||r.docsPath,o=`https://oxlib.sh${n??""}`,a=[e||"An error occurred.",...r.metaMessages?["",...r.metaMessages]:[],...i||n?["",i?`Details: ${i}`:void 0,n?`See: ${o}`:void 0]:[]].filter(c=>typeof c=="string").join(`
`);super(a,r.cause?{cause:r.cause}:void 0),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"cause",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"BaseError"}),Object.defineProperty(this,"version",{enumerable:!0,configurable:!0,writable:!0,value:`ox@${v3()}`}),this.cause=r.cause,this.details=i,this.docs=o,this.docsPath=n,this.shortMessage=e}walk(e){return Bd(this,e)}}function Bd(t,e){return e?.(t)?t:t&&typeof t=="object"&&"cause"in t&&t.cause?Bd(t.cause,e):e?null:t}function m3(t,e){if(qd(t)>e)throw new D3({givenSize:qd(t),maxSize:e})}const Jr={zero:48,nine:57,A:65,F:70,a:97,f:102};function Fd(t){if(t>=Jr.zero&&t<=Jr.nine)return t-Jr.zero;if(t>=Jr.A&&t<=Jr.F)return t-(Jr.A-10);if(t>=Jr.a&&t<=Jr.f)return t-(Jr.a-10)}function w3(t,e={}){const{dir:r,size:i=32}=e;if(i===0)return t;if(t.length>i)throw new O3({size:t.length,targetSize:i,type:"Bytes"});const n=new Uint8Array(i);for(let s=0;s<i;s++){const o=r==="right";n[o?s:i-s-1]=t[o?s:t.length-s-1]}return n}function kc(t,e){if(Kc(t)>e)throw new C3({givenSize:Kc(t),maxSize:e})}function Ld(t,e={}){const{dir:r,size:i=32}=e;if(i===0)return t;const n=t.replace("0x","");if(n.length>i*2)throw new B3({size:Math.ceil(n.length/2),targetSize:i,type:"Hex"});return`0x${n[r==="right"?"padEnd":"padStart"](i*2,"0")}`}const _3=new TextEncoder;function E3(t){return t instanceof Uint8Array?t:typeof t=="string"?S3(t):x3(t)}function x3(t){return t instanceof Uint8Array?t:new Uint8Array(t)}function S3(t,e={}){const{size:r}=e;let i=t;r&&(kc(t,r),i=jc(t,r));let n=i.slice(2);n.length%2&&(n=`0${n}`);const s=n.length/2,o=new Uint8Array(s);for(let a=0,c=0;a<s;a++){const u=Fd(n.charCodeAt(c++)),h=Fd(n.charCodeAt(c++));if(u===void 0||h===void 0)throw new Bt(`Invalid byte sequence ("${n[c-2]}${n[c-1]}" in "${n}").`);o[a]=u*16+h}return o}function I3(t,e={}){const{size:r}=e,i=_3.encode(t);return typeof r=="number"?(m3(i,r),A3(i,r)):i}function A3(t,e){return w3(t,{dir:"right",size:e})}function qd(t){return t.length}class D3 extends Bt{constructor({givenSize:e,maxSize:r}){super(`Size cannot exceed \`${r}\` bytes. Given size: \`${e}\` bytes.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Bytes.SizeOverflowError"})}}class O3 extends Bt{constructor({size:e,targetSize:r,type:i}){super(`${i.charAt(0).toUpperCase()}${i.slice(1).toLowerCase()} size (\`${e}\`) exceeds padding size (\`${r}\`).`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Bytes.SizeExceedsPaddingSizeError"})}}const M3=new TextEncoder,$3=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function zd(...t){return`0x${t.reduce((e,r)=>e+r.replace("0x",""),"")}`}function P3(t,e={}){const r=`0x${Number(t)}`;return typeof e.size=="number"?(kc(r,e.size),jo(r,e.size)):r}function Ud(t,e={}){let r="";for(let n=0;n<t.length;n++)r+=$3[t[n]];const i=`0x${r}`;return typeof e.size=="number"?(kc(i,e.size),jc(i,e.size)):i}function T3(t,e={}){const{signed:r,size:i}=e,n=BigInt(t);let s;i?r?s=(1n<<BigInt(i)*8n-1n)-1n:s=2n**(BigInt(i)*8n)-1n:typeof t=="number"&&(s=BigInt(Number.MAX_SAFE_INTEGER));const o=typeof s=="bigint"&&r?-s-1n:0;if(s&&n>s||n<o){const u=typeof t=="bigint"?"n":"";throw new N3({max:s?`${s}${u}`:void 0,min:`${o}${u}`,signed:r,size:i,value:`${t}${u}`})}const c=`0x${(r&&n<0?(1n<<BigInt(i*8))+BigInt(n):n).toString(16)}`;return i?jo(c,i):c}function R3(t,e={}){return Ud(M3.encode(t),e)}function jo(t,e){return Ld(t,{dir:"left",size:e})}function jc(t,e){return Ld(t,{dir:"right",size:e})}function Kc(t){return Math.ceil((t.length-2)/2)}class N3 extends Bt{constructor({max:e,min:r,signed:i,size:n,value:s}){super(`Number \`${s}\` is not in safe${n?` ${n*8}-bit`:""}${i?" signed":" unsigned"} integer range ${e?`(\`${r}\` to \`${e}\`)`:`(above \`${r}\`)`}`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.IntegerOutOfRangeError"})}}class C3 extends Bt{constructor({givenSize:e,maxSize:r}){super(`Size cannot exceed \`${r}\` bytes. Given size: \`${e}\` bytes.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.SizeOverflowError"})}}class B3 extends Bt{constructor({size:e,targetSize:r,type:i}){super(`${i.charAt(0).toUpperCase()}${i.slice(1).toLowerCase()} size (\`${e}\`) exceeds padding size (\`${r}\`).`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.SizeExceedsPaddingSizeError"})}}function F3(t,e={}){const{as:r=typeof t=="string"?"Hex":"Bytes"}=e,i=Dd(E3(t));return r==="Bytes"?i:Ud(i)}class L3 extends Map{constructor(e){super(),Object.defineProperty(this,"maxSize",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxSize=e}get(e){const r=super.get(e);return super.has(e)&&r!==void 0&&(this.delete(e),super.set(e,r)),r}set(e,r){if(super.set(e,r),this.maxSize&&this.size>this.maxSize){const i=this.keys().next().value;i&&this.delete(i)}return this}}const Vc={checksum:new L3(8192)}.checksum,q3=/^0x[a-fA-F0-9]{40}$/;function kd(t,e={}){const{strict:r=!0}=e;if(!q3.test(t))throw new jd({address:t,cause:new U3});if(r){if(t.toLowerCase()===t)return;if(z3(t)!==t)throw new jd({address:t,cause:new k3})}}function z3(t){if(Vc.has(t))return Vc.get(t);kd(t,{strict:!1});const e=t.substring(2).toLowerCase(),r=F3(I3(e),{as:"Bytes"}),i=e.split("");for(let s=0;s<40;s+=2)r[s>>1]>>4>=8&&i[s]&&(i[s]=i[s].toUpperCase()),(r[s>>1]&15)>=8&&i[s+1]&&(i[s+1]=i[s+1].toUpperCase());const n=`0x${i.join("")}`;return Vc.set(t,n),n}class jd extends Bt{constructor({address:e,cause:r}){super(`Address "${e}" is invalid.`,{cause:r}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Address.InvalidAddressError"})}}class U3 extends Bt{constructor(){super("Address is not a 20 byte (40 hexadecimal character) value."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Address.InvalidInputError"})}}class k3 extends Bt{constructor(){super("Address does not match its checksum counterpart."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Address.InvalidChecksumError"})}}const j3=/^(.*)\[([0-9]*)\]$/,K3=/^bytes([1-9]|1[0-9]|2[0-9]|3[0-2])?$/,V3=/^(u?int)(8|16|24|32|40|48|56|64|72|80|88|96|104|112|120|128|136|144|152|160|168|176|184|192|200|208|216|224|232|240|248|256)?$/;function Hc(t,e){if(t.length!==e.length)throw new G3({expectedLength:t.length,givenLength:e.length});const r=[];for(let i=0;i<t.length;i++){const n=t[i],s=e[i];r.push(Hc.encode(n,s))}return zd(...r)}(function(t){function e(r,i,n=!1){if(r==="address"){const c=i;return kd(c),jo(c.toLowerCase(),n?32:0)}if(r==="string")return R3(i);if(r==="bytes")return i;if(r==="bool")return jo(P3(i),n?32:1);const s=r.match(V3);if(s){const[c,u,h="256"]=s,l=Number.parseInt(h)/8;return T3(i,{size:n?32:l,signed:u==="int"})}const o=r.match(K3);if(o){const[c,u]=o;if(Number.parseInt(u)!==(i.length-2)/2)throw new H3({expectedSize:Number.parseInt(u),value:i});return jc(i,n?32:0)}const a=r.match(j3);if(a&&Array.isArray(i)){const[c,u]=a,h=[];for(let l=0;l<i.length;l++)h.push(e(u,i[l],!0));return h.length===0?"0x":zd(...h)}throw new W3(r)}t.encode=e})(Hc||(Hc={}));class H3 extends Bt{constructor({expectedSize:e,value:r}){super(`Size of bytes "${r}" (bytes${Kc(r)}) does not match expected size (bytes${e}).`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"AbiParameters.BytesSizeMismatchError"})}}class G3 extends Bt{constructor({expectedLength:e,givenLength:r}){super(["ABI encoding parameters/values length mismatch.",`Expected length (parameters): ${e}`,`Given length (values): ${r}`].join(`
`)),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"AbiParameters.LengthMismatchError"})}}class W3 extends Bt{constructor(e){super(`Type \`${e}\` is not a valid ABI Type.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"AbiParameters.InvalidTypeError"})}}class Kd extends Tc{constructor(e,r){super(),this.finished=!1,this.destroyed=!1,Mm(e);const i=Lo(r);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const n=this.blockLen,s=new Uint8Array(n);s.set(i.length>n?e.create().update(i).digest():i);for(let o=0;o<s.length;o++)s[o]^=54;this.iHash.update(s),this.oHash=e.create();for(let o=0;o<s.length;o++)s[o]^=106;this.oHash.update(s),s.fill(0)}update(e){return An(this),this.iHash.update(e),this}digestInto(e){An(this),bs(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:r,iHash:i,finished:n,destroyed:s,blockLen:o,outputLen:a}=this;return e=e,e.finished=n,e.destroyed=s,e.blockLen=o,e.outputLen=a,e.oHash=r._cloneInto(e.oHash),e.iHash=i._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const Vd=(t,e,r)=>new Kd(t,e).update(r).digest();Vd.create=(t,e)=>new Kd(t,e);const lt=BigInt(0),nt=BigInt(1),ji=BigInt(2),Y3=BigInt(3),Gc=BigInt(4),Hd=BigInt(5),Gd=BigInt(8);function pt(t,e){const r=t%e;return r>=lt?r:e+r}function X3(t,e,r){if(e<lt)throw new Error("invalid exponent, negatives unsupported");if(r<=lt)throw new Error("invalid modulus");if(r===nt)return lt;let i=nt;for(;e>lt;)e&nt&&(i=i*t%r),t=t*t%r,e>>=nt;return i}function rr(t,e,r){let i=t;for(;e-- >lt;)i*=i,i%=r;return i}function Wc(t,e){if(t===lt)throw new Error("invert: expected non-zero number");if(e<=lt)throw new Error("invert: expected positive modulus, got "+e);let r=pt(t,e),i=e,n=lt,s=nt;for(;r!==lt;){const a=i/r,c=i%r,u=n-s*a;i=r,r=c,n=s,s=u}if(i!==nt)throw new Error("invert: does not exist");return pt(n,e)}function Z3(t){const e=(t-nt)/ji;let r,i,n;for(r=t-nt,i=0;r%ji===lt;r/=ji,i++);for(n=ji;n<t&&X3(n,e,t)!==t-nt;n++)if(n>1e3)throw new Error("Cannot find square root: likely non-prime P");if(i===1){const o=(t+nt)/Gc;return function(c,u){const h=c.pow(u,o);if(!c.eql(c.sqr(h),u))throw new Error("Cannot find square root");return h}}const s=(r+nt)/ji;return function(a,c){if(a.pow(c,e)===a.neg(a.ONE))throw new Error("Cannot find square root");let u=i,h=a.pow(a.mul(a.ONE,n),r),l=a.pow(c,s),b=a.pow(c,r);for(;!a.eql(b,a.ONE);){if(a.eql(b,a.ZERO))return a.ZERO;let w=1;for(let x=a.sqr(b);w<u&&!a.eql(x,a.ONE);w++)x=a.sqr(x);const g=a.pow(h,nt<<BigInt(u-w-1));h=a.sqr(g),l=a.mul(l,g),b=a.mul(b,h),u=w}return l}}function J3(t){if(t%Gc===Y3){const e=(t+nt)/Gc;return function(i,n){const s=i.pow(n,e);if(!i.eql(i.sqr(s),n))throw new Error("Cannot find square root");return s}}if(t%Gd===Hd){const e=(t-Hd)/Gd;return function(i,n){const s=i.mul(n,ji),o=i.pow(s,e),a=i.mul(n,o),c=i.mul(i.mul(a,ji),o),u=i.mul(a,i.sub(c,i.ONE));if(!i.eql(i.sqr(u),n))throw new Error("Cannot find square root");return u}}return Z3(t)}const Q3=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function Wd(t){const e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},r=Q3.reduce((i,n)=>(i[n]="function",i),e);return Rn(t,r)}function ew(t,e,r){if(r<lt)throw new Error("invalid exponent, negatives unsupported");if(r===lt)return t.ONE;if(r===nt)return e;let i=t.ONE,n=e;for(;r>lt;)r&nt&&(i=t.mul(i,n)),n=t.sqr(n),r>>=nt;return i}function tw(t,e){const r=new Array(e.length),i=e.reduce((s,o,a)=>t.is0(o)?s:(r[a]=s,t.mul(s,o)),t.ONE),n=t.inv(i);return e.reduceRight((s,o,a)=>t.is0(o)?s:(r[a]=t.mul(s,r[a]),t.mul(s,o)),n),r}function Yd(t,e){const r=e!==void 0?e:t.toString(2).length,i=Math.ceil(r/8);return{nBitLength:r,nByteLength:i}}function Xd(t,e,r=!1,i={}){if(t<=lt)throw new Error("invalid field: expected ORDER > 0, got "+t);const{nBitLength:n,nByteLength:s}=Yd(t,e);if(s>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let o;const a=Object.freeze({ORDER:t,isLE:r,BITS:n,BYTES:s,MASK:qc(n),ZERO:lt,ONE:nt,create:c=>pt(c,t),isValid:c=>{if(typeof c!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof c);return lt<=c&&c<t},is0:c=>c===lt,isOdd:c=>(c&nt)===nt,neg:c=>pt(-c,t),eql:(c,u)=>c===u,sqr:c=>pt(c*c,t),add:(c,u)=>pt(c+u,t),sub:(c,u)=>pt(c-u,t),mul:(c,u)=>pt(c*u,t),pow:(c,u)=>ew(a,c,u),div:(c,u)=>pt(c*Wc(u,t),t),sqrN:c=>c*c,addN:(c,u)=>c+u,subN:(c,u)=>c-u,mulN:(c,u)=>c*u,inv:c=>Wc(c,t),sqrt:i.sqrt||(c=>(o||(o=J3(t)),o(a,c))),invertBatch:c=>tw(a,c),cmov:(c,u,h)=>h?u:c,toBytes:c=>r?Fc(c,s):pi(c,s),fromBytes:c=>{if(c.length!==s)throw new Error("Field.fromBytes: expected "+s+" bytes, got "+c.length);return r?Bc(c):Mr(c)}});return Object.freeze(a)}function Zd(t){if(typeof t!="bigint")throw new Error("field order must be bigint");const e=t.toString(2).length;return Math.ceil(e/8)}function Jd(t){const e=Zd(t);return e+Math.ceil(e/2)}function rw(t,e,r=!1){const i=t.length,n=Zd(e),s=Jd(e);if(i<16||i<s||i>1024)throw new Error("expected "+s+"-1024 bytes of input, got "+i);const o=r?Bc(t):Mr(t),a=pt(o,e-nt)+nt;return r?Fc(a,n):pi(a,n)}const Qd=BigInt(0),Ko=BigInt(1);function Yc(t,e){const r=e.negate();return t?r:e}function el(t,e){if(!Number.isSafeInteger(t)||t<=0||t>e)throw new Error("invalid window size, expected [1.."+e+"], got W="+t)}function Xc(t,e){el(t,e);const r=Math.ceil(e/t)+1,i=2**(t-1);return{windows:r,windowSize:i}}function iw(t,e){if(!Array.isArray(t))throw new Error("array expected");t.forEach((r,i)=>{if(!(r instanceof e))throw new Error("invalid point at index "+i)})}function nw(t,e){if(!Array.isArray(t))throw new Error("array of scalars expected");t.forEach((r,i)=>{if(!e.isValid(r))throw new Error("invalid scalar at index "+i)})}const Zc=new WeakMap,tl=new WeakMap;function Jc(t){return tl.get(t)||1}function sw(t,e){return{constTimeNegate:Yc,hasPrecomputes(r){return Jc(r)!==1},unsafeLadder(r,i,n=t.ZERO){let s=r;for(;i>Qd;)i&Ko&&(n=n.add(s)),s=s.double(),i>>=Ko;return n},precomputeWindow(r,i){const{windows:n,windowSize:s}=Xc(i,e),o=[];let a=r,c=a;for(let u=0;u<n;u++){c=a,o.push(c);for(let h=1;h<s;h++)c=c.add(a),o.push(c);a=c.double()}return o},wNAF(r,i,n){const{windows:s,windowSize:o}=Xc(r,e);let a=t.ZERO,c=t.BASE;const u=BigInt(2**r-1),h=2**r,l=BigInt(r);for(let b=0;b<s;b++){const w=b*o;let g=Number(n&u);n>>=l,g>o&&(g-=h,n+=Ko);const x=w,A=w+Math.abs(g)-1,D=b%2!==0,$=g<0;g===0?c=c.add(Yc(D,i[x])):a=a.add(Yc($,i[A]))}return{p:a,f:c}},wNAFUnsafe(r,i,n,s=t.ZERO){const{windows:o,windowSize:a}=Xc(r,e),c=BigInt(2**r-1),u=2**r,h=BigInt(r);for(let l=0;l<o;l++){const b=l*a;if(n===Qd)break;let w=Number(n&c);if(n>>=h,w>a&&(w-=u,n+=Ko),w===0)continue;let g=i[b+Math.abs(w)-1];w<0&&(g=g.negate()),s=s.add(g)}return s},getPrecomputes(r,i,n){let s=Zc.get(i);return s||(s=this.precomputeWindow(i,r),r!==1&&Zc.set(i,n(s))),s},wNAFCached(r,i,n){const s=Jc(r);return this.wNAF(s,this.getPrecomputes(s,r,n),i)},wNAFCachedUnsafe(r,i,n,s){const o=Jc(r);return o===1?this.unsafeLadder(r,i,s):this.wNAFUnsafe(o,this.getPrecomputes(o,r,n),i,s)},setWindowSize(r,i){el(i,e),tl.set(r,i),Zc.delete(r)}}}function ow(t,e,r,i){if(iw(r,t),nw(i,e),r.length!==i.length)throw new Error("arrays of points and scalars must have equal length");const n=t.ZERO,s=Rd(BigInt(r.length)),o=s>12?s-3:s>4?s-2:s?2:1,a=(1<<o)-1,c=new Array(a+1).fill(n),u=Math.floor((e.BITS-1)/o)*o;let h=n;for(let l=u;l>=0;l-=o){c.fill(n);for(let w=0;w<i.length;w++){const g=i[w],x=Number(g>>BigInt(l)&BigInt(a));c[x]=c[x].add(r[w])}let b=n;for(let w=c.length-1,g=n;w>0;w--)g=g.add(c[w]),b=b.add(g);if(h=h.add(b),l!==0)for(let w=0;w<o;w++)h=h.double()}return h}function rl(t){return Wd(t.Fp),Rn(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...Yd(t.n,t.nBitLength),...t,p:t.Fp.ORDER})}function il(t){t.lowS!==void 0&&On("lowS",t.lowS),t.prehash!==void 0&&On("prehash",t.prehash)}function aw(t){const e=rl(t);Rn(e,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:r,Fp:i,a:n}=e;if(r){if(!i.eql(n,i.ZERO))throw new Error("invalid endomorphism, can only be defined for Koblitz curves that have a=0");if(typeof r!="object"||typeof r.beta!="bigint"||typeof r.splitScalar!="function")throw new Error("invalid endomorphism, expected beta: bigint and splitScalar: function")}return Object.freeze({...e})}const{bytesToNumberBE:cw,hexToBytes:uw}=g3;class fw extends Error{constructor(e=""){super(e)}}const Qr={Err:fw,_tlv:{encode:(t,e)=>{const{Err:r}=Qr;if(t<0||t>256)throw new r("tlv.encode: wrong tag");if(e.length&1)throw new r("tlv.encode: unpadded data");const i=e.length/2,n=$n(i);if(n.length/2&128)throw new r("tlv.encode: long form length too big");const s=i>127?$n(n.length/2|128):"";return $n(t)+s+n+e},decode(t,e){const{Err:r}=Qr;let i=0;if(t<0||t>256)throw new r("tlv.encode: wrong tag");if(e.length<2||e[i++]!==t)throw new r("tlv.decode: wrong tlv");const n=e[i++],s=!!(n&128);let o=0;if(!s)o=n;else{const c=n&127;if(!c)throw new r("tlv.decode(long): indefinite length not supported");if(c>4)throw new r("tlv.decode(long): byte length is too big");const u=e.subarray(i,i+c);if(u.length!==c)throw new r("tlv.decode: length bytes not complete");if(u[0]===0)throw new r("tlv.decode(long): zero leftmost byte");for(const h of u)o=o<<8|h;if(i+=c,o<128)throw new r("tlv.decode(long): not minimal encoding")}const a=e.subarray(i,i+o);if(a.length!==o)throw new r("tlv.decode: wrong value length");return{v:a,l:e.subarray(i+o)}}},_int:{encode(t){const{Err:e}=Qr;if(t<pr)throw new e("integer: negative integers are not allowed");let r=$n(t);if(Number.parseInt(r[0],16)&8&&(r="00"+r),r.length&1)throw new e("unexpected DER parsing assertion: unpadded hex");return r},decode(t){const{Err:e}=Qr;if(t[0]&128)throw new e("invalid signature integer: negative");if(t[0]===0&&!(t[1]&128))throw new e("invalid signature integer: unnecessary leading zero");return cw(t)}},toSig(t){const{Err:e,_int:r,_tlv:i}=Qr,n=typeof t=="string"?uw(t):t;Or(n);const{v:s,l:o}=i.decode(48,n);if(o.length)throw new e("invalid signature: left bytes after parsing");const{v:a,l:c}=i.decode(2,s),{v:u,l:h}=i.decode(2,c);if(h.length)throw new e("invalid signature: left bytes after parsing");return{r:r.decode(a),s:r.decode(u)}},hexFromSig(t){const{_tlv:e,_int:r}=Qr,i=e.encode(2,r.encode(t.r)),n=e.encode(2,r.encode(t.s)),s=i+n;return e.encode(48,s)}},pr=BigInt(0),pe=BigInt(1),gi=BigInt(2),Vo=BigInt(3),nl=BigInt(4);function hw(t){const e=aw(t),{Fp:r}=e,i=Xd(e.n,e.nBitLength),n=e.toBytes||((x,A,D)=>{const $=A.toAffine();return Yt(Uint8Array.from([4]),r.toBytes($.x),r.toBytes($.y))}),s=e.fromBytes||(x=>{const A=x.subarray(1),D=r.fromBytes(A.subarray(0,r.BYTES)),$=r.fromBytes(A.subarray(r.BYTES,2*r.BYTES));return{x:D,y:$}});function o(x){const{a:A,b:D}=e,$=r.sqr(x),P=r.mul($,x);return r.add(r.add(P,r.mul(x,A)),D)}if(!r.eql(r.sqr(e.Gy),o(e.Gx)))throw new Error("bad generator point: equation left != right");function a(x){return Tn(x,pe,e.n)}function c(x){const{allowedPrivateKeyLengths:A,nByteLength:D,wrapPrivateKey:$,n:P}=e;if(A&&typeof x!="bigint"){if(ki(x)&&(x=Mn(x)),typeof x!="string"||!A.includes(x.length))throw new Error("invalid private key");x=x.padStart(D*2,"0")}let T;try{T=typeof x=="bigint"?x:Mr(Mt("private key",x,D))}catch{throw new Error("invalid private key, expected hex or "+D+" bytes, got "+typeof x)}return $&&(T=pt(T,P)),bi("private key",T,pe,P),T}function u(x){if(!(x instanceof b))throw new Error("ProjectivePoint expected")}const h=Uc((x,A)=>{const{px:D,py:$,pz:P}=x;if(r.eql(P,r.ONE))return{x:D,y:$};const T=x.is0();A==null&&(A=T?r.ONE:r.inv(P));const N=r.mul(D,A),L=r.mul($,A),F=r.mul(P,A);if(T)return{x:r.ZERO,y:r.ZERO};if(!r.eql(F,r.ONE))throw new Error("invZ was invalid");return{x:N,y:L}}),l=Uc(x=>{if(x.is0()){if(e.allowInfinityPoint&&!r.is0(x.py))return;throw new Error("bad point: ZERO")}const{x:A,y:D}=x.toAffine();if(!r.isValid(A)||!r.isValid(D))throw new Error("bad point: x or y not FE");const $=r.sqr(D),P=o(A);if(!r.eql($,P))throw new Error("bad point: equation left != right");if(!x.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});class b{constructor(A,D,$){if(this.px=A,this.py=D,this.pz=$,A==null||!r.isValid(A))throw new Error("x required");if(D==null||!r.isValid(D))throw new Error("y required");if($==null||!r.isValid($))throw new Error("z required");Object.freeze(this)}static fromAffine(A){const{x:D,y:$}=A||{};if(!A||!r.isValid(D)||!r.isValid($))throw new Error("invalid affine point");if(A instanceof b)throw new Error("projective point not allowed");const P=T=>r.eql(T,r.ZERO);return P(D)&&P($)?b.ZERO:new b(D,$,r.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(A){const D=r.invertBatch(A.map($=>$.pz));return A.map(($,P)=>$.toAffine(D[P])).map(b.fromAffine)}static fromHex(A){const D=b.fromAffine(s(Mt("pointHex",A)));return D.assertValidity(),D}static fromPrivateKey(A){return b.BASE.multiply(c(A))}static msm(A,D){return ow(b,i,A,D)}_setWindowSize(A){g.setWindowSize(this,A)}assertValidity(){l(this)}hasEvenY(){const{y:A}=this.toAffine();if(r.isOdd)return!r.isOdd(A);throw new Error("Field doesn't support isOdd")}equals(A){u(A);const{px:D,py:$,pz:P}=this,{px:T,py:N,pz:L}=A,F=r.eql(r.mul(D,L),r.mul(T,P)),B=r.eql(r.mul($,L),r.mul(N,P));return F&&B}negate(){return new b(this.px,r.neg(this.py),this.pz)}double(){const{a:A,b:D}=e,$=r.mul(D,Vo),{px:P,py:T,pz:N}=this;let L=r.ZERO,F=r.ZERO,B=r.ZERO,C=r.mul(P,P),G=r.mul(T,T),I=r.mul(N,N),f=r.mul(P,T);return f=r.add(f,f),B=r.mul(P,N),B=r.add(B,B),L=r.mul(A,B),F=r.mul($,I),F=r.add(L,F),L=r.sub(G,F),F=r.add(G,F),F=r.mul(L,F),L=r.mul(f,L),B=r.mul($,B),I=r.mul(A,I),f=r.sub(C,I),f=r.mul(A,f),f=r.add(f,B),B=r.add(C,C),C=r.add(B,C),C=r.add(C,I),C=r.mul(C,f),F=r.add(F,C),I=r.mul(T,N),I=r.add(I,I),C=r.mul(I,f),L=r.sub(L,C),B=r.mul(I,G),B=r.add(B,B),B=r.add(B,B),new b(L,F,B)}add(A){u(A);const{px:D,py:$,pz:P}=this,{px:T,py:N,pz:L}=A;let F=r.ZERO,B=r.ZERO,C=r.ZERO;const G=e.a,I=r.mul(e.b,Vo);let f=r.mul(D,T),p=r.mul($,N),v=r.mul(P,L),y=r.add(D,$),m=r.add(T,N);y=r.mul(y,m),m=r.add(f,p),y=r.sub(y,m),m=r.add(D,P);let S=r.add(T,L);return m=r.mul(m,S),S=r.add(f,v),m=r.sub(m,S),S=r.add($,P),F=r.add(N,L),S=r.mul(S,F),F=r.add(p,v),S=r.sub(S,F),C=r.mul(G,m),F=r.mul(I,v),C=r.add(F,C),F=r.sub(p,C),C=r.add(p,C),B=r.mul(F,C),p=r.add(f,f),p=r.add(p,f),v=r.mul(G,v),m=r.mul(I,m),p=r.add(p,v),v=r.sub(f,v),v=r.mul(G,v),m=r.add(m,v),f=r.mul(p,m),B=r.add(B,f),f=r.mul(S,m),F=r.mul(y,F),F=r.sub(F,f),f=r.mul(y,p),C=r.mul(S,C),C=r.add(C,f),new b(F,B,C)}subtract(A){return this.add(A.negate())}is0(){return this.equals(b.ZERO)}wNAF(A){return g.wNAFCached(this,A,b.normalizeZ)}multiplyUnsafe(A){const{endo:D,n:$}=e;bi("scalar",A,pr,$);const P=b.ZERO;if(A===pr)return P;if(this.is0()||A===pe)return this;if(!D||g.hasPrecomputes(this))return g.wNAFCachedUnsafe(this,A,b.normalizeZ);let{k1neg:T,k1:N,k2neg:L,k2:F}=D.splitScalar(A),B=P,C=P,G=this;for(;N>pr||F>pr;)N&pe&&(B=B.add(G)),F&pe&&(C=C.add(G)),G=G.double(),N>>=pe,F>>=pe;return T&&(B=B.negate()),L&&(C=C.negate()),C=new b(r.mul(C.px,D.beta),C.py,C.pz),B.add(C)}multiply(A){const{endo:D,n:$}=e;bi("scalar",A,pe,$);let P,T;if(D){const{k1neg:N,k1:L,k2neg:F,k2:B}=D.splitScalar(A);let{p:C,f:G}=this.wNAF(L),{p:I,f}=this.wNAF(B);C=g.constTimeNegate(N,C),I=g.constTimeNegate(F,I),I=new b(r.mul(I.px,D.beta),I.py,I.pz),P=C.add(I),T=G.add(f)}else{const{p:N,f:L}=this.wNAF(A);P=N,T=L}return b.normalizeZ([P,T])[0]}multiplyAndAddUnsafe(A,D,$){const P=b.BASE,T=(L,F)=>F===pr||F===pe||!L.equals(P)?L.multiplyUnsafe(F):L.multiply(F),N=T(this,D).add(T(A,$));return N.is0()?void 0:N}toAffine(A){return h(this,A)}isTorsionFree(){const{h:A,isTorsionFree:D}=e;if(A===pe)return!0;if(D)return D(b,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:A,clearCofactor:D}=e;return A===pe?this:D?D(b,this):this.multiplyUnsafe(e.h)}toRawBytes(A=!0){return On("isCompressed",A),this.assertValidity(),n(b,this,A)}toHex(A=!0){return On("isCompressed",A),Mn(this.toRawBytes(A))}}b.BASE=new b(e.Gx,e.Gy,r.ONE),b.ZERO=new b(r.ZERO,r.ONE,r.ZERO);const w=e.nBitLength,g=sw(b,e.endo?Math.ceil(w/2):w);return{CURVE:e,ProjectivePoint:b,normPrivateKeyToScalar:c,weierstrassEquation:o,isWithinCurveOrder:a}}function dw(t){const e=rl(t);return Rn(e,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...e})}function lw(t){const e=dw(t),{Fp:r,n:i}=e,n=r.BYTES+1,s=2*r.BYTES+1;function o(v){return pt(v,i)}function a(v){return Wc(v,i)}const{ProjectivePoint:c,normPrivateKeyToScalar:u,weierstrassEquation:h,isWithinCurveOrder:l}=hw({...e,toBytes(v,y,m){const S=y.toAffine(),O=r.toBytes(S.x),_=Yt;return On("isCompressed",m),m?_(Uint8Array.from([y.hasEvenY()?2:3]),O):_(Uint8Array.from([4]),O,r.toBytes(S.y))},fromBytes(v){const y=v.length,m=v[0],S=v.subarray(1);if(y===n&&(m===2||m===3)){const O=Mr(S);if(!Tn(O,pe,r.ORDER))throw new Error("Point is not on curve");const _=h(O);let d;try{d=r.sqrt(_)}catch(z){const U=z instanceof Error?": "+z.message:"";throw new Error("Point is not on curve"+U)}const E=(d&pe)===pe;return(m&1)===1!==E&&(d=r.neg(d)),{x:O,y:d}}else if(y===s&&m===4){const O=r.fromBytes(S.subarray(0,r.BYTES)),_=r.fromBytes(S.subarray(r.BYTES,2*r.BYTES));return{x:O,y:_}}else{const O=n,_=s;throw new Error("invalid Point, expected length of "+O+", or uncompressed "+_+", got "+y)}}}),b=v=>Mn(pi(v,e.nByteLength));function w(v){const y=i>>pe;return v>y}function g(v){return w(v)?o(-v):v}const x=(v,y,m)=>Mr(v.slice(y,m));class A{constructor(y,m,S){this.r=y,this.s=m,this.recovery=S,this.assertValidity()}static fromCompact(y){const m=e.nByteLength;return y=Mt("compactSignature",y,m*2),new A(x(y,0,m),x(y,m,2*m))}static fromDER(y){const{r:m,s:S}=Qr.toSig(Mt("DER",y));return new A(m,S)}assertValidity(){bi("r",this.r,pe,i),bi("s",this.s,pe,i)}addRecoveryBit(y){return new A(this.r,this.s,y)}recoverPublicKey(y){const{r:m,s:S,recovery:O}=this,_=L(Mt("msgHash",y));if(O==null||![0,1,2,3].includes(O))throw new Error("recovery id invalid");const d=O===2||O===3?m+e.n:m;if(d>=r.ORDER)throw new Error("recovery id 2 or 3 invalid");const E=(O&1)===0?"02":"03",q=c.fromHex(E+b(d)),z=a(d),U=o(-_*z),k=o(S*z),W=c.BASE.multiplyAndAddUnsafe(q,U,k);if(!W)throw new Error("point at infinify");return W.assertValidity(),W}hasHighS(){return w(this.s)}normalizeS(){return this.hasHighS()?new A(this.r,o(-this.s),this.recovery):this}toDERRawBytes(){return Pn(this.toDERHex())}toDERHex(){return Qr.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return Pn(this.toCompactHex())}toCompactHex(){return b(this.r)+b(this.s)}}const D={isValidPrivateKey(v){try{return u(v),!0}catch{return!1}},normPrivateKeyToScalar:u,randomPrivateKey:()=>{const v=Jd(e.n);return rw(e.randomBytes(v),e.n)},precompute(v=8,y=c.BASE){return y._setWindowSize(v),y.multiply(BigInt(3)),y}};function $(v,y=!0){return c.fromPrivateKey(v).toRawBytes(y)}function P(v){const y=ki(v),m=typeof v=="string",S=(y||m)&&v.length;return y?S===n||S===s:m?S===2*n||S===2*s:v instanceof c}function T(v,y,m=!0){if(P(v))throw new Error("first arg must be private key");if(!P(y))throw new Error("second arg must be public key");return c.fromHex(y).multiply(u(v)).toRawBytes(m)}const N=e.bits2int||function(v){if(v.length>8192)throw new Error("input is too large");const y=Mr(v),m=v.length*8-e.nBitLength;return m>0?y>>BigInt(m):y},L=e.bits2int_modN||function(v){return o(N(v))},F=qc(e.nBitLength);function B(v){return bi("num < 2^"+e.nBitLength,v,pr,F),pi(v,e.nByteLength)}function C(v,y,m=G){if(["recovered","canonical"].some(J=>J in m))throw new Error("sign() legacy options not supported");const{hash:S,randomBytes:O}=e;let{lowS:_,prehash:d,extraEntropy:E}=m;_==null&&(_=!0),v=Mt("msgHash",v),il(m),d&&(v=Mt("prehashed msgHash",S(v)));const q=L(v),z=u(y),U=[B(z),B(q)];if(E!=null&&E!==!1){const J=E===!0?O(r.BYTES):E;U.push(Mt("extraEntropy",J))}const k=Yt(...U),W=q;function Z(J){const X=N(J);if(!l(X))return;const Q=a(X),Le=c.BASE.multiply(X).toAffine(),re=o(Le.x);if(re===pr)return;const ae=o(Q*o(W+re*z));if(ae===pr)return;let ft=(Le.x===re?0:2)|Number(Le.y&pe),de=ae;return _&&w(ae)&&(de=g(ae),ft^=1),new A(re,de,ft)}return{seed:k,k2sig:Z}}const G={lowS:e.lowS,prehash:!1},I={lowS:e.lowS,prehash:!1};function f(v,y,m=G){const{seed:S,k2sig:O}=C(v,y,m),_=e;return Cd(_.hash.outputLen,_.nByteLength,_.hmac)(S,O)}c.BASE._setWindowSize(8);function p(v,y,m,S=I){const O=v;y=Mt("msgHash",y),m=Mt("publicKey",m);const{lowS:_,prehash:d,format:E}=S;if(il(S),"strict"in S)throw new Error("options.strict was renamed to lowS");if(E!==void 0&&E!=="compact"&&E!=="der")throw new Error("format must be compact or der");const q=typeof O=="string"||ki(O),z=!q&&!E&&typeof O=="object"&&O!==null&&typeof O.r=="bigint"&&typeof O.s=="bigint";if(!q&&!z)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");let U,k;try{if(z&&(U=new A(O.r,O.s)),q){try{E!=="compact"&&(U=A.fromDER(O))}catch(ft){if(!(ft instanceof Qr.Err))throw ft}!U&&E!=="der"&&(U=A.fromCompact(O))}k=c.fromHex(m)}catch{return!1}if(!U||_&&U.hasHighS())return!1;d&&(y=e.hash(y));const{r:W,s:Z}=U,J=L(y),X=a(Z),Q=o(J*X),Le=o(W*X),re=c.BASE.multiplyAndAddUnsafe(k,Q,Le)?.toAffine();return re?o(re.x)===W:!1}return{CURVE:e,getPublicKey:$,getSharedSecret:T,sign:f,verify:p,ProjectivePoint:c,Signature:A,utils:D}}function pw(t,e){const r=t.ORDER;let i=pr;for(let g=r-pe;g%gi===pr;g/=gi)i+=pe;const n=i,s=gi<<n-pe-pe,o=s*gi,a=(r-pe)/o,c=(a-pe)/gi,u=o-pe,h=s,l=t.pow(e,a),b=t.pow(e,(a+pe)/gi);let w=(g,x)=>{let A=l,D=t.pow(x,u),$=t.sqr(D);$=t.mul($,x);let P=t.mul(g,$);P=t.pow(P,c),P=t.mul(P,D),D=t.mul(P,x),$=t.mul(P,g);let T=t.mul($,D);P=t.pow(T,h);let N=t.eql(P,t.ONE);D=t.mul($,b),P=t.mul(T,A),$=t.cmov(D,$,N),T=t.cmov(P,T,N);for(let L=n;L>pe;L--){let F=L-gi;F=gi<<F-pe;let B=t.pow(T,F);const C=t.eql(B,t.ONE);D=t.mul($,A),A=t.mul(A,A),B=t.mul(T,A),$=t.cmov(D,$,C),T=t.cmov(B,T,C)}return{isValid:N,value:$}};if(t.ORDER%nl===Vo){const g=(t.ORDER-Vo)/nl,x=t.sqrt(t.neg(e));w=(A,D)=>{let $=t.sqr(D);const P=t.mul(A,D);$=t.mul($,P);let T=t.pow($,g);T=t.mul(T,P);const N=t.mul(T,x),L=t.mul(t.sqr(T),D),F=t.eql(L,A);let B=t.cmov(N,T,F);return{isValid:F,value:B}}}return w}function bw(t,e){if(Wd(t),!t.isValid(e.A)||!t.isValid(e.B)||!t.isValid(e.Z))throw new Error("mapToCurveSimpleSWU: invalid opts");const r=pw(t,e.Z);if(!t.isOdd)throw new Error("Fp.isOdd is not implemented!");return i=>{let n,s,o,a,c,u,h,l;n=t.sqr(i),n=t.mul(n,e.Z),s=t.sqr(n),s=t.add(s,n),o=t.add(s,t.ONE),o=t.mul(o,e.B),a=t.cmov(e.Z,t.neg(s),!t.eql(s,t.ZERO)),a=t.mul(a,e.A),s=t.sqr(o),u=t.sqr(a),c=t.mul(u,e.A),s=t.add(s,c),s=t.mul(s,o),u=t.mul(u,a),c=t.mul(u,e.B),s=t.add(s,c),h=t.mul(n,o);const{isValid:b,value:w}=r(s,u);l=t.mul(n,i),l=t.mul(l,w),h=t.cmov(h,o,b),l=t.cmov(l,w,b);const g=t.isOdd(i)===t.isOdd(l);return l=t.cmov(t.neg(l),l,g),h=t.div(h,a),{x:h,y:l}}}function gw(t){return{hash:t,hmac:(e,...r)=>Vd(t,e,qm(...r)),randomBytes:_d}}function yw(t,e){const r=i=>lw({...t,...gw(i)});return{...r(e),create:r}}const vw=Mr;function yi(t,e){if(ys(t),ys(e),t<0||t>=1<<8*e)throw new Error("invalid I2OSP input: "+t);const r=Array.from({length:e}).fill(0);for(let i=e-1;i>=0;i--)r[i]=t&255,t>>>=8;return new Uint8Array(r)}function mw(t,e){const r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t[i]^e[i];return r}function ys(t){if(!Number.isSafeInteger(t))throw new Error("number expected")}function ww(t,e,r,i){Or(t),Or(e),ys(r),e.length>255&&(e=i(Yt(ko("H2C-OVERSIZE-DST-"),e)));const{outputLen:n,blockLen:s}=i,o=Math.ceil(r/n);if(r>65535||o>255)throw new Error("expand_message_xmd: invalid lenInBytes");const a=Yt(e,yi(e.length,1)),c=yi(0,s),u=yi(r,2),h=new Array(o),l=i(Yt(c,t,u,yi(0,1),a));h[0]=i(Yt(l,yi(1,1),a));for(let w=1;w<=o;w++){const g=[mw(l,h[w-1]),yi(w+1,1),a];h[w]=i(Yt(...g))}return Yt(...h).slice(0,r)}function _w(t,e,r,i,n){if(Or(t),Or(e),ys(r),e.length>255){const s=Math.ceil(2*i/8);e=n.create({dkLen:s}).update(ko("H2C-OVERSIZE-DST-")).update(e).digest()}if(r>65535||e.length>255)throw new Error("expand_message_xof: invalid lenInBytes");return n.create({dkLen:r}).update(t).update(yi(r,2)).update(e).update(yi(e.length,1)).digest()}function sl(t,e,r){Rn(r,{DST:"stringOrUint8Array",p:"bigint",m:"isSafeInteger",k:"isSafeInteger",hash:"hash"});const{p:i,k:n,m:s,hash:o,expand:a,DST:c}=r;Or(t),ys(e);const u=typeof c=="string"?ko(c):c,h=i.toString(2).length,l=Math.ceil((h+n)/8),b=e*s*l;let w;if(a==="xmd")w=ww(t,u,b,o);else if(a==="xof")w=_w(t,u,b,n,o);else if(a==="_internal_pass")w=t;else throw new Error('expand must be "xmd" or "xof"');const g=new Array(e);for(let x=0;x<e;x++){const A=new Array(s);for(let D=0;D<s;D++){const $=l*(D+x*s),P=w.subarray($,$+l);A[D]=pt(vw(P),i)}g[x]=A}return g}function Ew(t,e){const r=e.map(i=>Array.from(i).reverse());return(i,n)=>{const[s,o,a,c]=r.map(u=>u.reduce((h,l)=>t.add(t.mul(h,i),l)));return i=t.div(s,o),n=t.mul(n,t.div(a,c)),{x:i,y:n}}}function xw(t,e,r){if(typeof e!="function")throw new Error("mapToCurve() must be defined");return{hashToCurve(i,n){const s=sl(i,2,{...r,DST:r.DST,...n}),o=t.fromAffine(e(s[0])),a=t.fromAffine(e(s[1])),c=o.add(a).clearCofactor();return c.assertValidity(),c},encodeToCurve(i,n){const s=sl(i,1,{...r,DST:r.encodeDST,...n}),o=t.fromAffine(e(s[0])).clearCofactor();return o.assertValidity(),o},mapToCurve(i){if(!Array.isArray(i))throw new Error("mapToCurve: expected array of bigints");for(const s of i)if(typeof s!="bigint")throw new Error("mapToCurve: expected array of bigints");const n=t.fromAffine(e(i)).clearCofactor();return n.assertValidity(),n}}}const vs=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),Ho=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),ms=BigInt(1),Go=BigInt(2),ol=(t,e)=>(t+e/Go)/e;function al(t){const e=vs,r=BigInt(3),i=BigInt(6),n=BigInt(11),s=BigInt(22),o=BigInt(23),a=BigInt(44),c=BigInt(88),u=t*t*t%e,h=u*u*t%e,l=rr(h,r,e)*h%e,b=rr(l,r,e)*h%e,w=rr(b,Go,e)*u%e,g=rr(w,n,e)*w%e,x=rr(g,s,e)*g%e,A=rr(x,a,e)*x%e,D=rr(A,c,e)*A%e,$=rr(D,a,e)*x%e,P=rr($,r,e)*h%e,T=rr(P,o,e)*g%e,N=rr(T,i,e)*u%e,L=rr(N,Go,e);if(!vi.eql(vi.sqr(L),t))throw new Error("Cannot find square root");return L}const vi=Xd(vs,void 0,void 0,{sqrt:al}),ws=yw({a:BigInt(0),b:BigInt(7),Fp:vi,n:Ho,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:t=>{const e=Ho,r=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),i=-ms*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),n=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),s=r,o=BigInt("0x100000000000000000000000000000000"),a=ol(s*t,e),c=ol(-i*t,e);let u=pt(t-a*r-c*n,e),h=pt(-a*i-c*s,e);const l=u>o,b=h>o;if(l&&(u=e-u),b&&(h=e-h),u>o||h>o)throw new Error("splitScalar: Endomorphism failed, k="+t);return{k1neg:l,k1:u,k2neg:b,k2:h}}}},qo),cl=BigInt(0),ul={};function Wo(t,...e){let r=ul[t];if(r===void 0){const i=qo(Uint8Array.from(t,n=>n.charCodeAt(0)));r=Yt(i,i),ul[t]=r}return qo(Yt(r,...e))}const Qc=t=>t.toRawBytes(!0).slice(1),eu=t=>pi(t,32),tu=t=>pt(t,vs),_s=t=>pt(t,Ho),ru=ws.ProjectivePoint,Sw=(t,e,r)=>ru.BASE.multiplyAndAddUnsafe(t,e,r);function iu(t){let e=ws.utils.normPrivateKeyToScalar(t),r=ru.fromPrivateKey(e);return{scalar:r.hasEvenY()?e:_s(-e),bytes:Qc(r)}}function fl(t){bi("x",t,ms,vs);const e=tu(t*t),r=tu(e*t+BigInt(7));let i=al(r);i%Go!==cl&&(i=tu(-i));const n=new ru(t,i,ms);return n.assertValidity(),n}const Nn=Mr;function hl(...t){return _s(Nn(Wo("BIP0340/challenge",...t)))}function Iw(t){return iu(t).bytes}function Aw(t,e,r=_d(32)){const i=Mt("message",t),{bytes:n,scalar:s}=iu(e),o=Mt("auxRand",r,32),a=eu(s^Nn(Wo("BIP0340/aux",o))),c=Wo("BIP0340/nonce",a,n,i),u=_s(Nn(c));if(u===cl)throw new Error("sign failed: k is zero");const{bytes:h,scalar:l}=iu(u),b=hl(h,n,i),w=new Uint8Array(64);if(w.set(h,0),w.set(eu(_s(l+b*s)),32),!dl(w,i,n))throw new Error("sign: Invalid signature produced");return w}function dl(t,e,r){const i=Mt("signature",t,64),n=Mt("message",e),s=Mt("publicKey",r,32);try{const o=fl(Nn(s)),a=Nn(i.subarray(0,32));if(!Tn(a,ms,vs))return!1;const c=Nn(i.subarray(32,64));if(!Tn(c,ms,Ho))return!1;const u=hl(eu(a),Qc(o),n),h=Sw(o,c,_s(-u));return!(!h||!h.hasEvenY()||h.toAffine().x!==a)}catch{return!1}}const Dw={getPublicKey:Iw,sign:Aw,verify:dl,utils:{randomPrivateKey:ws.utils.randomPrivateKey,lift_x:fl,pointToBytes:Qc,numberToBytesBE:pi,bytesToNumberBE:Mr,taggedHash:Wo,mod:pt}},Ow=Ew(vi,[["0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa8c7","0x7d3d4c80bc321d5b9f315cea7fd44c5d595d2fc0bf63b92dfff1044f17c6581","0x534c328d23f234e6e2a413deca25caece4506144037c40314ecbd0b53d9dd262","0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa88c"],["0xd35771193d94918a9ca34ccbb7b640dd86cd409542f8487d9fe6b745781eb49b","0xedadc6f64383dc1df7c4b2d51b54225406d36b641f5e41bbc52a56612a8c6d14","0x0000000000000000000000000000000000000000000000000000000000000001"],["0x4bda12f684bda12f684bda12f684bda12f684bda12f684bda12f684b8e38e23c","0xc75e0c32d5cb7c0fa9d0a54b12a0a6d5647ab046d686da6fdffc90fc201d71a3","0x29a6194691f91a73715209ef6512e576722830a201be2018a765e85a9ecee931","0x2f684bda12f684bda12f684bda12f684bda12f684bda12f684bda12f38e38d84"],["0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffff93b","0x7a06534bb8bdb49fd5e9e6632722c2989467c1bfc8e8d978dfb425d2685c2573","0x6484aa716545ca2cf3a70c3fa8fe337e0a3d21162f0d6299a7bf8192bfd2a76f","0x0000000000000000000000000000000000000000000000000000000000000001"]].map(t=>t.map(e=>BigInt(e)))),Mw=bw(vi,{A:BigInt("0x3f8731abdd661adca08a5558f0f5d272e953d363cb6f0e5d405447c01a444533"),B:BigInt("1771"),Z:vi.create(BigInt("-11"))}),ll=xw(ws.ProjectivePoint,t=>{const{x:e,y:r}=Mw(vi.create(t[0]));return Ow(e,r)},{DST:"secp256k1_XMD:SHA-256_SSWU_RO_",encodeDST:"secp256k1_XMD:SHA-256_SSWU_NU_",p:vi.ORDER,m:1,k:128,expand:"xmd",hash:qo});var $w=Object.freeze({__proto__:null,secp256k1:ws,schnorr:Dw,hashToCurve:ll.hashToCurve,encodeToCurve:ll.encodeToCurve});function pl(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?globalThis.Buffer.allocUnsafe(t):new Uint8Array(t)}function nu(t,e){e||(e=t.reduce((n,s)=>n+s.length,0));const r=pl(e);let i=0;for(const n of t)r.set(n,i),i+=n.length;return r}function Pw(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),i=0;i<r.length;i++)r[i]=255;for(var n=0;n<t.length;n++){var s=t.charAt(n),o=s.charCodeAt(0);if(r[o]!==255)throw new TypeError(s+" is ambiguous");r[o]=n}var a=t.length,c=t.charAt(0),u=Math.log(a)/Math.log(256),h=Math.log(256)/Math.log(a);function l(g){if(g instanceof Uint8Array||(ArrayBuffer.isView(g)?g=new Uint8Array(g.buffer,g.byteOffset,g.byteLength):Array.isArray(g)&&(g=Uint8Array.from(g))),!(g instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(g.length===0)return"";for(var x=0,A=0,D=0,$=g.length;D!==$&&g[D]===0;)D++,x++;for(var P=($-D)*h+1>>>0,T=new Uint8Array(P);D!==$;){for(var N=g[D],L=0,F=P-1;(N!==0||L<A)&&F!==-1;F--,L++)N+=256*T[F]>>>0,T[F]=N%a>>>0,N=N/a>>>0;if(N!==0)throw new Error("Non-zero carry");A=L,D++}for(var B=P-A;B!==P&&T[B]===0;)B++;for(var C=c.repeat(x);B<P;++B)C+=t.charAt(T[B]);return C}function b(g){if(typeof g!="string")throw new TypeError("Expected String");if(g.length===0)return new Uint8Array;var x=0;if(g[x]!==" "){for(var A=0,D=0;g[x]===c;)A++,x++;for(var $=(g.length-x)*u+1>>>0,P=new Uint8Array($);g[x];){var T=r[g.charCodeAt(x)];if(T===255)return;for(var N=0,L=$-1;(T!==0||N<D)&&L!==-1;L--,N++)T+=a*P[L]>>>0,P[L]=T%256>>>0,T=T/256>>>0;if(T!==0)throw new Error("Non-zero carry");D=N,x++}if(g[x]!==" "){for(var F=$-D;F!==$&&P[F]===0;)F++;for(var B=new Uint8Array(A+($-F)),C=A;F!==$;)B[C++]=P[F++];return B}}}function w(g){var x=b(g);if(x)return x;throw new Error(`Non-${e} character`)}return{encode:l,decodeUnsafe:b,decode:w}}var Tw=Pw,Rw=Tw;const bl=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},Nw=t=>new TextEncoder().encode(t),Cw=t=>new TextDecoder().decode(t);class Bw{constructor(e,r,i){this.name=e,this.prefix=r,this.baseEncode=i}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class Fw{constructor(e,r,i){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=i}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return gl(this,e)}}class Lw{constructor(e){this.decoders=e}or(e){return gl(this,e)}decode(e){const r=e[0],i=this.decoders[r];if(i)return i.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const gl=(t,e)=>new Lw({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});class qw{constructor(e,r,i,n){this.name=e,this.prefix=r,this.baseEncode=i,this.baseDecode=n,this.encoder=new Bw(e,r,i),this.decoder=new Fw(e,r,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const Yo=({name:t,prefix:e,encode:r,decode:i})=>new qw(t,e,r,i),Es=({prefix:t,name:e,alphabet:r})=>{const{encode:i,decode:n}=Rw(r,e);return Yo({prefix:t,name:e,encode:i,decode:s=>bl(n(s))})},zw=(t,e,r,i)=>{const n={};for(let h=0;h<e.length;++h)n[e[h]]=h;let s=t.length;for(;t[s-1]==="=";)--s;const o=new Uint8Array(s*r/8|0);let a=0,c=0,u=0;for(let h=0;h<s;++h){const l=n[t[h]];if(l===void 0)throw new SyntaxError(`Non-${i} character`);c=c<<r|l,a+=r,a>=8&&(a-=8,o[u++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},Uw=(t,e,r)=>{const i=e[e.length-1]==="=",n=(1<<r)-1;let s="",o=0,a=0;for(let c=0;c<t.length;++c)for(a=a<<8|t[c],o+=8;o>r;)o-=r,s+=e[n&a>>o];if(o&&(s+=e[n&a<<r-o]),i)for(;s.length*r&7;)s+="=";return s},Et=({name:t,prefix:e,bitsPerChar:r,alphabet:i})=>Yo({prefix:e,name:t,encode(n){return Uw(n,i,r)},decode(n){return zw(n,i,r,t)}}),kw=Yo({prefix:"\0",name:"identity",encode:t=>Cw(t),decode:t=>Nw(t)});var jw=Object.freeze({__proto__:null,identity:kw});const Kw=Et({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var Vw=Object.freeze({__proto__:null,base2:Kw});const Hw=Et({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var Gw=Object.freeze({__proto__:null,base8:Hw});const Ww=Es({prefix:"9",name:"base10",alphabet:"0123456789"});var Yw=Object.freeze({__proto__:null,base10:Ww});const Xw=Et({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Zw=Et({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var Jw=Object.freeze({__proto__:null,base16:Xw,base16upper:Zw});const Qw=Et({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),e6=Et({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),t6=Et({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),r6=Et({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),i6=Et({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),n6=Et({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),s6=Et({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),o6=Et({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),a6=Et({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var c6=Object.freeze({__proto__:null,base32:Qw,base32upper:e6,base32pad:t6,base32padupper:r6,base32hex:i6,base32hexupper:n6,base32hexpad:s6,base32hexpadupper:o6,base32z:a6});const u6=Es({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),f6=Es({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var h6=Object.freeze({__proto__:null,base36:u6,base36upper:f6});const d6=Es({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),l6=Es({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var p6=Object.freeze({__proto__:null,base58btc:d6,base58flickr:l6});const b6=Et({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),g6=Et({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),y6=Et({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),v6=Et({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var m6=Object.freeze({__proto__:null,base64:b6,base64pad:g6,base64url:y6,base64urlpad:v6});const yl=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),w6=yl.reduce((t,e,r)=>(t[r]=e,t),[]),_6=yl.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function E6(t){return t.reduce((e,r)=>(e+=w6[r],e),"")}function x6(t){const e=[];for(const r of t){const i=_6[r.codePointAt(0)];if(i===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(i)}return new Uint8Array(e)}const S6=Yo({prefix:"\u{1F680}",name:"base256emoji",encode:E6,decode:x6});var I6=Object.freeze({__proto__:null,base256emoji:S6}),A6=ml,vl=128,D6=127,O6=~D6,M6=Math.pow(2,31);function ml(t,e,r){e=e||[],r=r||0;for(var i=r;t>=M6;)e[r++]=t&255|vl,t/=128;for(;t&O6;)e[r++]=t&255|vl,t>>>=7;return e[r]=t|0,ml.bytes=r-i+1,e}var $6=su,P6=128,wl=127;function su(t,i){var r=0,i=i||0,n=0,s=i,o,a=t.length;do{if(s>=a)throw su.bytes=0,new RangeError("Could not decode varint");o=t[s++],r+=n<28?(o&wl)<<n:(o&wl)*Math.pow(2,n),n+=7}while(o>=P6);return su.bytes=s-i,r}var T6=Math.pow(2,7),R6=Math.pow(2,14),N6=Math.pow(2,21),C6=Math.pow(2,28),B6=Math.pow(2,35),F6=Math.pow(2,42),L6=Math.pow(2,49),q6=Math.pow(2,56),z6=Math.pow(2,63),U6=function(t){return t<T6?1:t<R6?2:t<N6?3:t<C6?4:t<B6?5:t<F6?6:t<L6?7:t<q6?8:t<z6?9:10},k6={encode:A6,decode:$6,encodingLength:U6},_l=k6;const El=(t,e,r=0)=>(_l.encode(t,e,r),e),xl=t=>_l.encodingLength(t),ou=(t,e)=>{const r=e.byteLength,i=xl(t),n=i+xl(r),s=new Uint8Array(n+r);return El(t,s,0),El(r,s,i),s.set(e,n),new j6(t,r,e,s)};class j6{constructor(e,r,i,n){this.code=e,this.size=r,this.digest=i,this.bytes=n}}const Sl=({name:t,code:e,encode:r})=>new K6(t,e,r);class K6{constructor(e,r,i){this.name=e,this.code=r,this.encode=i}digest(e){if(e instanceof Uint8Array){const r=this.encode(e);return r instanceof Uint8Array?ou(this.code,r):r.then(i=>ou(this.code,i))}else throw Error("Unknown type, must be binary type")}}const Il=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),V6=Sl({name:"sha2-256",code:18,encode:Il("SHA-256")}),H6=Sl({name:"sha2-512",code:19,encode:Il("SHA-512")});var G6=Object.freeze({__proto__:null,sha256:V6,sha512:H6});const Al=0,W6="identity",Dl=bl;var Y6=Object.freeze({__proto__:null,identity:{code:Al,name:W6,encode:Dl,digest:t=>ou(Al,Dl(t))}});new TextEncoder,new TextDecoder;const Ol={...jw,...Vw,...Gw,...Yw,...Jw,...c6,...h6,...p6,...m6,...I6};({...G6,...Y6});function Ml(t,e,r,i){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:i}}}const $l=Ml("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),au=Ml("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);const e=pl(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),Pl={utf8:$l,"utf-8":$l,hex:Ol.base16,latin1:au,ascii:au,binary:au,...Ol};function ir(t,e="utf8"){const r=Pl[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t,"utf8"):r.decoder.decode(`${r.prefix}${t}`)}function Ft(t,e="utf8"){const r=Pl[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8"):r.encoder.encode(t).substring(1)}var Tl={},X6="elliptic",Z6="6.6.1",J6="EC cryptography",Q6="lib/elliptic.js",e8=["lib"],t8={lint:"eslint lib test","lint:fix":"npm run lint -- --fix",unit:"istanbul test _mocha --reporter=spec test/index.js",test:"npm run lint && npm run unit",version:"grunt dist && git add dist/"},r8={type:"git",url:"git@github.com:indutny/elliptic"},i8=["EC","Elliptic","curve","Cryptography"],n8="Fedor Indutny <fedor@indutny.com>",s8="MIT",o8={url:"https://github.com/indutny/elliptic/issues"},a8="https://github.com/indutny/elliptic",c8={brfs:"^2.0.2",coveralls:"^3.1.0",eslint:"^7.6.0",grunt:"^1.2.1","grunt-browserify":"^5.3.0","grunt-cli":"^1.3.2","grunt-contrib-connect":"^3.0.0","grunt-contrib-copy":"^1.0.0","grunt-contrib-uglify":"^5.0.0","grunt-mocha-istanbul":"^5.0.2","grunt-saucelabs":"^9.0.1",istanbul:"^0.4.5",mocha:"^8.0.1"},u8={"bn.js":"^4.11.9",brorand:"^1.1.0","hash.js":"^1.0.0","hmac-drbg":"^1.0.1",inherits:"^2.0.4","minimalistic-assert":"^1.0.1","minimalistic-crypto-utils":"^1.0.1"},f8={name:X6,version:Z6,description:J6,main:Q6,files:e8,scripts:t8,repository:r8,keywords:i8,author:n8,license:s8,bugs:o8,homepage:a8,devDependencies:c8,dependencies:u8},Xt={},$r={exports:{}},h8={},d8=Object.freeze({__proto__:null,default:h8}),Rl=ja(d8);(function(t){(function(e,r){function i(I,f){if(!I)throw new Error(f||"Assertion failed")}function n(I,f){I.super_=f;var p=function(){};p.prototype=f.prototype,I.prototype=new p,I.prototype.constructor=I}function s(I,f,p){if(s.isBN(I))return I;this.negative=0,this.words=null,this.length=0,this.red=null,I!==null&&((f==="le"||f==="be")&&(p=f,f=10),this._init(I||0,f||10,p||"be"))}typeof e=="object"?e.exports=s:r.BN=s,s.BN=s,s.wordSize=26;var o;try{typeof window<"u"&&typeof window.Buffer<"u"?o=window.Buffer:o=Rl.Buffer}catch{}s.isBN=function(f){return f instanceof s?!0:f!==null&&typeof f=="object"&&f.constructor.wordSize===s.wordSize&&Array.isArray(f.words)},s.max=function(f,p){return f.cmp(p)>0?f:p},s.min=function(f,p){return f.cmp(p)<0?f:p},s.prototype._init=function(f,p,v){if(typeof f=="number")return this._initNumber(f,p,v);if(typeof f=="object")return this._initArray(f,p,v);p==="hex"&&(p=16),i(p===(p|0)&&p>=2&&p<=36),f=f.toString().replace(/\s+/g,"");var y=0;f[0]==="-"&&(y++,this.negative=1),y<f.length&&(p===16?this._parseHex(f,y,v):(this._parseBase(f,p,y),v==="le"&&this._initArray(this.toArray(),p,v)))},s.prototype._initNumber=function(f,p,v){f<0&&(this.negative=1,f=-f),f<67108864?(this.words=[f&67108863],this.length=1):f<4503599627370496?(this.words=[f&67108863,f/67108864&67108863],this.length=2):(i(f<9007199254740992),this.words=[f&67108863,f/67108864&67108863,1],this.length=3),v==="le"&&this._initArray(this.toArray(),p,v)},s.prototype._initArray=function(f,p,v){if(i(typeof f.length=="number"),f.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(f.length/3),this.words=new Array(this.length);for(var y=0;y<this.length;y++)this.words[y]=0;var m,S,O=0;if(v==="be")for(y=f.length-1,m=0;y>=0;y-=3)S=f[y]|f[y-1]<<8|f[y-2]<<16,this.words[m]|=S<<O&67108863,this.words[m+1]=S>>>26-O&67108863,O+=24,O>=26&&(O-=26,m++);else if(v==="le")for(y=0,m=0;y<f.length;y+=3)S=f[y]|f[y+1]<<8|f[y+2]<<16,this.words[m]|=S<<O&67108863,this.words[m+1]=S>>>26-O&67108863,O+=24,O>=26&&(O-=26,m++);return this.strip()};function a(I,f){var p=I.charCodeAt(f);return p>=65&&p<=70?p-55:p>=97&&p<=102?p-87:p-48&15}function c(I,f,p){var v=a(I,p);return p-1>=f&&(v|=a(I,p-1)<<4),v}s.prototype._parseHex=function(f,p,v){this.length=Math.ceil((f.length-p)/6),this.words=new Array(this.length);for(var y=0;y<this.length;y++)this.words[y]=0;var m=0,S=0,O;if(v==="be")for(y=f.length-1;y>=p;y-=2)O=c(f,p,y)<<m,this.words[S]|=O&67108863,m>=18?(m-=18,S+=1,this.words[S]|=O>>>26):m+=8;else{var _=f.length-p;for(y=_%2===0?p+1:p;y<f.length;y+=2)O=c(f,p,y)<<m,this.words[S]|=O&67108863,m>=18?(m-=18,S+=1,this.words[S]|=O>>>26):m+=8}this.strip()};function u(I,f,p,v){for(var y=0,m=Math.min(I.length,p),S=f;S<m;S++){var O=I.charCodeAt(S)-48;y*=v,O>=49?y+=O-49+10:O>=17?y+=O-17+10:y+=O}return y}s.prototype._parseBase=function(f,p,v){this.words=[0],this.length=1;for(var y=0,m=1;m<=67108863;m*=p)y++;y--,m=m/p|0;for(var S=f.length-v,O=S%y,_=Math.min(S,S-O)+v,d=0,E=v;E<_;E+=y)d=u(f,E,E+y,p),this.imuln(m),this.words[0]+d<67108864?this.words[0]+=d:this._iaddn(d);if(O!==0){var q=1;for(d=u(f,E,f.length,p),E=0;E<O;E++)q*=p;this.imuln(q),this.words[0]+d<67108864?this.words[0]+=d:this._iaddn(d)}this.strip()},s.prototype.copy=function(f){f.words=new Array(this.length);for(var p=0;p<this.length;p++)f.words[p]=this.words[p];f.length=this.length,f.negative=this.negative,f.red=this.red},s.prototype.clone=function(){var f=new s(null);return this.copy(f),f},s.prototype._expand=function(f){for(;this.length<f;)this.words[this.length++]=0;return this},s.prototype.strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},s.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},s.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var h=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],l=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],b=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];s.prototype.toString=function(f,p){f=f||10,p=p|0||1;var v;if(f===16||f==="hex"){v="";for(var y=0,m=0,S=0;S<this.length;S++){var O=this.words[S],_=((O<<y|m)&16777215).toString(16);m=O>>>24-y&16777215,y+=2,y>=26&&(y-=26,S--),m!==0||S!==this.length-1?v=h[6-_.length]+_+v:v=_+v}for(m!==0&&(v=m.toString(16)+v);v.length%p!==0;)v="0"+v;return this.negative!==0&&(v="-"+v),v}if(f===(f|0)&&f>=2&&f<=36){var d=l[f],E=b[f];v="";var q=this.clone();for(q.negative=0;!q.isZero();){var z=q.modn(E).toString(f);q=q.idivn(E),q.isZero()?v=z+v:v=h[d-z.length]+z+v}for(this.isZero()&&(v="0"+v);v.length%p!==0;)v="0"+v;return this.negative!==0&&(v="-"+v),v}i(!1,"Base should be between 2 and 36")},s.prototype.toNumber=function(){var f=this.words[0];return this.length===2?f+=this.words[1]*67108864:this.length===3&&this.words[2]===1?f+=4503599627370496+this.words[1]*67108864:this.length>2&&i(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-f:f},s.prototype.toJSON=function(){return this.toString(16)},s.prototype.toBuffer=function(f,p){return i(typeof o<"u"),this.toArrayLike(o,f,p)},s.prototype.toArray=function(f,p){return this.toArrayLike(Array,f,p)},s.prototype.toArrayLike=function(f,p,v){var y=this.byteLength(),m=v||Math.max(1,y);i(y<=m,"byte array longer than desired length"),i(m>0,"Requested array length <= 0"),this.strip();var S=p==="le",O=new f(m),_,d,E=this.clone();if(S){for(d=0;!E.isZero();d++)_=E.andln(255),E.iushrn(8),O[d]=_;for(;d<m;d++)O[d]=0}else{for(d=0;d<m-y;d++)O[d]=0;for(d=0;!E.isZero();d++)_=E.andln(255),E.iushrn(8),O[m-d-1]=_}return O},Math.clz32?s.prototype._countBits=function(f){return 32-Math.clz32(f)}:s.prototype._countBits=function(f){var p=f,v=0;return p>=4096&&(v+=13,p>>>=13),p>=64&&(v+=7,p>>>=7),p>=8&&(v+=4,p>>>=4),p>=2&&(v+=2,p>>>=2),v+p},s.prototype._zeroBits=function(f){if(f===0)return 26;var p=f,v=0;return(p&8191)===0&&(v+=13,p>>>=13),(p&127)===0&&(v+=7,p>>>=7),(p&15)===0&&(v+=4,p>>>=4),(p&3)===0&&(v+=2,p>>>=2),(p&1)===0&&v++,v},s.prototype.bitLength=function(){var f=this.words[this.length-1],p=this._countBits(f);return(this.length-1)*26+p};function w(I){for(var f=new Array(I.bitLength()),p=0;p<f.length;p++){var v=p/26|0,y=p%26;f[p]=(I.words[v]&1<<y)>>>y}return f}s.prototype.zeroBits=function(){if(this.isZero())return 0;for(var f=0,p=0;p<this.length;p++){var v=this._zeroBits(this.words[p]);if(f+=v,v!==26)break}return f},s.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},s.prototype.toTwos=function(f){return this.negative!==0?this.abs().inotn(f).iaddn(1):this.clone()},s.prototype.fromTwos=function(f){return this.testn(f-1)?this.notn(f).iaddn(1).ineg():this.clone()},s.prototype.isNeg=function(){return this.negative!==0},s.prototype.neg=function(){return this.clone().ineg()},s.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},s.prototype.iuor=function(f){for(;this.length<f.length;)this.words[this.length++]=0;for(var p=0;p<f.length;p++)this.words[p]=this.words[p]|f.words[p];return this.strip()},s.prototype.ior=function(f){return i((this.negative|f.negative)===0),this.iuor(f)},s.prototype.or=function(f){return this.length>f.length?this.clone().ior(f):f.clone().ior(this)},s.prototype.uor=function(f){return this.length>f.length?this.clone().iuor(f):f.clone().iuor(this)},s.prototype.iuand=function(f){var p;this.length>f.length?p=f:p=this;for(var v=0;v<p.length;v++)this.words[v]=this.words[v]&f.words[v];return this.length=p.length,this.strip()},s.prototype.iand=function(f){return i((this.negative|f.negative)===0),this.iuand(f)},s.prototype.and=function(f){return this.length>f.length?this.clone().iand(f):f.clone().iand(this)},s.prototype.uand=function(f){return this.length>f.length?this.clone().iuand(f):f.clone().iuand(this)},s.prototype.iuxor=function(f){var p,v;this.length>f.length?(p=this,v=f):(p=f,v=this);for(var y=0;y<v.length;y++)this.words[y]=p.words[y]^v.words[y];if(this!==p)for(;y<p.length;y++)this.words[y]=p.words[y];return this.length=p.length,this.strip()},s.prototype.ixor=function(f){return i((this.negative|f.negative)===0),this.iuxor(f)},s.prototype.xor=function(f){return this.length>f.length?this.clone().ixor(f):f.clone().ixor(this)},s.prototype.uxor=function(f){return this.length>f.length?this.clone().iuxor(f):f.clone().iuxor(this)},s.prototype.inotn=function(f){i(typeof f=="number"&&f>=0);var p=Math.ceil(f/26)|0,v=f%26;this._expand(p),v>0&&p--;for(var y=0;y<p;y++)this.words[y]=~this.words[y]&67108863;return v>0&&(this.words[y]=~this.words[y]&67108863>>26-v),this.strip()},s.prototype.notn=function(f){return this.clone().inotn(f)},s.prototype.setn=function(f,p){i(typeof f=="number"&&f>=0);var v=f/26|0,y=f%26;return this._expand(v+1),p?this.words[v]=this.words[v]|1<<y:this.words[v]=this.words[v]&~(1<<y),this.strip()},s.prototype.iadd=function(f){var p;if(this.negative!==0&&f.negative===0)return this.negative=0,p=this.isub(f),this.negative^=1,this._normSign();if(this.negative===0&&f.negative!==0)return f.negative=0,p=this.isub(f),f.negative=1,p._normSign();var v,y;this.length>f.length?(v=this,y=f):(v=f,y=this);for(var m=0,S=0;S<y.length;S++)p=(v.words[S]|0)+(y.words[S]|0)+m,this.words[S]=p&67108863,m=p>>>26;for(;m!==0&&S<v.length;S++)p=(v.words[S]|0)+m,this.words[S]=p&67108863,m=p>>>26;if(this.length=v.length,m!==0)this.words[this.length]=m,this.length++;else if(v!==this)for(;S<v.length;S++)this.words[S]=v.words[S];return this},s.prototype.add=function(f){var p;return f.negative!==0&&this.negative===0?(f.negative=0,p=this.sub(f),f.negative^=1,p):f.negative===0&&this.negative!==0?(this.negative=0,p=f.sub(this),this.negative=1,p):this.length>f.length?this.clone().iadd(f):f.clone().iadd(this)},s.prototype.isub=function(f){if(f.negative!==0){f.negative=0;var p=this.iadd(f);return f.negative=1,p._normSign()}else if(this.negative!==0)return this.negative=0,this.iadd(f),this.negative=1,this._normSign();var v=this.cmp(f);if(v===0)return this.negative=0,this.length=1,this.words[0]=0,this;var y,m;v>0?(y=this,m=f):(y=f,m=this);for(var S=0,O=0;O<m.length;O++)p=(y.words[O]|0)-(m.words[O]|0)+S,S=p>>26,this.words[O]=p&67108863;for(;S!==0&&O<y.length;O++)p=(y.words[O]|0)+S,S=p>>26,this.words[O]=p&67108863;if(S===0&&O<y.length&&y!==this)for(;O<y.length;O++)this.words[O]=y.words[O];return this.length=Math.max(this.length,O),y!==this&&(this.negative=1),this.strip()},s.prototype.sub=function(f){return this.clone().isub(f)};function g(I,f,p){p.negative=f.negative^I.negative;var v=I.length+f.length|0;p.length=v,v=v-1|0;var y=I.words[0]|0,m=f.words[0]|0,S=y*m,O=S&67108863,_=S/67108864|0;p.words[0]=O;for(var d=1;d<v;d++){for(var E=_>>>26,q=_&67108863,z=Math.min(d,f.length-1),U=Math.max(0,d-I.length+1);U<=z;U++){var k=d-U|0;y=I.words[k]|0,m=f.words[U]|0,S=y*m+q,E+=S/67108864|0,q=S&67108863}p.words[d]=q|0,_=E|0}return _!==0?p.words[d]=_|0:p.length--,p.strip()}var x=function(f,p,v){var y=f.words,m=p.words,S=v.words,O=0,_,d,E,q=y[0]|0,z=q&8191,U=q>>>13,k=y[1]|0,W=k&8191,Z=k>>>13,J=y[2]|0,X=J&8191,Q=J>>>13,Le=y[3]|0,re=Le&8191,ae=Le>>>13,ft=y[4]|0,de=ft&8191,Pe=ft>>>13,ts=y[5]|0,Te=ts&8191,Ae=ts>>>13,cn=y[6]|0,Ee=cn&8191,De=cn>>>13,un=y[7]|0,Oe=un&8191,Me=un>>>13,fn=y[8]|0,ye=fn&8191,xe=fn>>>13,hn=y[9]|0,ce=hn&8191,qe=hn>>>13,Zs=m[0]|0,Ge=Zs&8191,ze=Zs>>>13,dn=m[1]|0,Ue=dn&8191,ke=dn>>>13,Ra=m[2]|0,ge=Ra&8191,je=Ra>>>13,Na=m[3]|0,We=Na&8191,Re=Na>>>13,$i=m[4]|0,Ne=$i&8191,Ce=$i>>>13,rs=m[5]|0,Se=rs&8191,Ye=rs>>>13,Ca=m[6]|0,Xe=Ca&8191,Ze=Ca>>>13,Ba=m[7]|0,Ke=Ba&8191,Be=Ba>>>13,Hr=m[8]|0,Je=Hr&8191,Qe=Hr>>>13,Fa=m[9]|0,et=Fa&8191,tt=Fa>>>13;v.negative=f.negative^p.negative,v.length=19,_=Math.imul(z,Ge),d=Math.imul(z,ze),d=d+Math.imul(U,Ge)|0,E=Math.imul(U,ze);var er=(O+_|0)+((d&8191)<<13)|0;O=(E+(d>>>13)|0)+(er>>>26)|0,er&=67108863,_=Math.imul(W,Ge),d=Math.imul(W,ze),d=d+Math.imul(Z,Ge)|0,E=Math.imul(Z,ze),_=_+Math.imul(z,Ue)|0,d=d+Math.imul(z,ke)|0,d=d+Math.imul(U,Ue)|0,E=E+Math.imul(U,ke)|0;var Js=(O+_|0)+((d&8191)<<13)|0;O=(E+(d>>>13)|0)+(Js>>>26)|0,Js&=67108863,_=Math.imul(X,Ge),d=Math.imul(X,ze),d=d+Math.imul(Q,Ge)|0,E=Math.imul(Q,ze),_=_+Math.imul(W,Ue)|0,d=d+Math.imul(W,ke)|0,d=d+Math.imul(Z,Ue)|0,E=E+Math.imul(Z,ke)|0,_=_+Math.imul(z,ge)|0,d=d+Math.imul(z,je)|0,d=d+Math.imul(U,ge)|0,E=E+Math.imul(U,je)|0;var Qs=(O+_|0)+((d&8191)<<13)|0;O=(E+(d>>>13)|0)+(Qs>>>26)|0,Qs&=67108863,_=Math.imul(re,Ge),d=Math.imul(re,ze),d=d+Math.imul(ae,Ge)|0,E=Math.imul(ae,ze),_=_+Math.imul(X,Ue)|0,d=d+Math.imul(X,ke)|0,d=d+Math.imul(Q,Ue)|0,E=E+Math.imul(Q,ke)|0,_=_+Math.imul(W,ge)|0,d=d+Math.imul(W,je)|0,d=d+Math.imul(Z,ge)|0,E=E+Math.imul(Z,je)|0,_=_+Math.imul(z,We)|0,d=d+Math.imul(z,Re)|0,d=d+Math.imul(U,We)|0,E=E+Math.imul(U,Re)|0;var eo=(O+_|0)+((d&8191)<<13)|0;O=(E+(d>>>13)|0)+(eo>>>26)|0,eo&=67108863,_=Math.imul(de,Ge),d=Math.imul(de,ze),d=d+Math.imul(Pe,Ge)|0,E=Math.imul(Pe,ze),_=_+Math.imul(re,Ue)|0,d=d+Math.imul(re,ke)|0,d=d+Math.imul(ae,Ue)|0,E=E+Math.imul(ae,ke)|0,_=_+Math.imul(X,ge)|0,d=d+Math.imul(X,je)|0,d=d+Math.imul(Q,ge)|0,E=E+Math.imul(Q,je)|0,_=_+Math.imul(W,We)|0,d=d+Math.imul(W,Re)|0,d=d+Math.imul(Z,We)|0,E=E+Math.imul(Z,Re)|0,_=_+Math.imul(z,Ne)|0,d=d+Math.imul(z,Ce)|0,d=d+Math.imul(U,Ne)|0,E=E+Math.imul(U,Ce)|0;var to=(O+_|0)+((d&8191)<<13)|0;O=(E+(d>>>13)|0)+(to>>>26)|0,to&=67108863,_=Math.imul(Te,Ge),d=Math.imul(Te,ze),d=d+Math.imul(Ae,Ge)|0,E=Math.imul(Ae,ze),_=_+Math.imul(de,Ue)|0,d=d+Math.imul(de,ke)|0,d=d+Math.imul(Pe,Ue)|0,E=E+Math.imul(Pe,ke)|0,_=_+Math.imul(re,ge)|0,d=d+Math.imul(re,je)|0,d=d+Math.imul(ae,ge)|0,E=E+Math.imul(ae,je)|0,_=_+Math.imul(X,We)|0,d=d+Math.imul(X,Re)|0,d=d+Math.imul(Q,We)|0,E=E+Math.imul(Q,Re)|0,_=_+Math.imul(W,Ne)|0,d=d+Math.imul(W,Ce)|0,d=d+Math.imul(Z,Ne)|0,E=E+Math.imul(Z,Ce)|0,_=_+Math.imul(z,Se)|0,d=d+Math.imul(z,Ye)|0,d=d+Math.imul(U,Se)|0,E=E+Math.imul(U,Ye)|0;var ro=(O+_|0)+((d&8191)<<13)|0;O=(E+(d>>>13)|0)+(ro>>>26)|0,ro&=67108863,_=Math.imul(Ee,Ge),d=Math.imul(Ee,ze),d=d+Math.imul(De,Ge)|0,E=Math.imul(De,ze),_=_+Math.imul(Te,Ue)|0,d=d+Math.imul(Te,ke)|0,d=d+Math.imul(Ae,Ue)|0,E=E+Math.imul(Ae,ke)|0,_=_+Math.imul(de,ge)|0,d=d+Math.imul(de,je)|0,d=d+Math.imul(Pe,ge)|0,E=E+Math.imul(Pe,je)|0,_=_+Math.imul(re,We)|0,d=d+Math.imul(re,Re)|0,d=d+Math.imul(ae,We)|0,E=E+Math.imul(ae,Re)|0,_=_+Math.imul(X,Ne)|0,d=d+Math.imul(X,Ce)|0,d=d+Math.imul(Q,Ne)|0,E=E+Math.imul(Q,Ce)|0,_=_+Math.imul(W,Se)|0,d=d+Math.imul(W,Ye)|0,d=d+Math.imul(Z,Se)|0,E=E+Math.imul(Z,Ye)|0,_=_+Math.imul(z,Xe)|0,d=d+Math.imul(z,Ze)|0,d=d+Math.imul(U,Xe)|0,E=E+Math.imul(U,Ze)|0;var xr=(O+_|0)+((d&8191)<<13)|0;O=(E+(d>>>13)|0)+(xr>>>26)|0,xr&=67108863,_=Math.imul(Oe,Ge),d=Math.imul(Oe,ze),d=d+Math.imul(Me,Ge)|0,E=Math.imul(Me,ze),_=_+Math.imul(Ee,Ue)|0,d=d+Math.imul(Ee,ke)|0,d=d+Math.imul(De,Ue)|0,E=E+Math.imul(De,ke)|0,_=_+Math.imul(Te,ge)|0,d=d+Math.imul(Te,je)|0,d=d+Math.imul(Ae,ge)|0,E=E+Math.imul(Ae,je)|0,_=_+Math.imul(de,We)|0,d=d+Math.imul(de,Re)|0,d=d+Math.imul(Pe,We)|0,E=E+Math.imul(Pe,Re)|0,_=_+Math.imul(re,Ne)|0,d=d+Math.imul(re,Ce)|0,d=d+Math.imul(ae,Ne)|0,E=E+Math.imul(ae,Ce)|0,_=_+Math.imul(X,Se)|0,d=d+Math.imul(X,Ye)|0,d=d+Math.imul(Q,Se)|0,E=E+Math.imul(Q,Ye)|0,_=_+Math.imul(W,Xe)|0,d=d+Math.imul(W,Ze)|0,d=d+Math.imul(Z,Xe)|0,E=E+Math.imul(Z,Ze)|0,_=_+Math.imul(z,Ke)|0,d=d+Math.imul(z,Be)|0,d=d+Math.imul(U,Ke)|0,E=E+Math.imul(U,Be)|0;var io=(O+_|0)+((d&8191)<<13)|0;O=(E+(d>>>13)|0)+(io>>>26)|0,io&=67108863,_=Math.imul(ye,Ge),d=Math.imul(ye,ze),d=d+Math.imul(xe,Ge)|0,E=Math.imul(xe,ze),_=_+Math.imul(Oe,Ue)|0,d=d+Math.imul(Oe,ke)|0,d=d+Math.imul(Me,Ue)|0,E=E+Math.imul(Me,ke)|0,_=_+Math.imul(Ee,ge)|0,d=d+Math.imul(Ee,je)|0,d=d+Math.imul(De,ge)|0,E=E+Math.imul(De,je)|0,_=_+Math.imul(Te,We)|0,d=d+Math.imul(Te,Re)|0,d=d+Math.imul(Ae,We)|0,E=E+Math.imul(Ae,Re)|0,_=_+Math.imul(de,Ne)|0,d=d+Math.imul(de,Ce)|0,d=d+Math.imul(Pe,Ne)|0,E=E+Math.imul(Pe,Ce)|0,_=_+Math.imul(re,Se)|0,d=d+Math.imul(re,Ye)|0,d=d+Math.imul(ae,Se)|0,E=E+Math.imul(ae,Ye)|0,_=_+Math.imul(X,Xe)|0,d=d+Math.imul(X,Ze)|0,d=d+Math.imul(Q,Xe)|0,E=E+Math.imul(Q,Ze)|0,_=_+Math.imul(W,Ke)|0,d=d+Math.imul(W,Be)|0,d=d+Math.imul(Z,Ke)|0,E=E+Math.imul(Z,Be)|0,_=_+Math.imul(z,Je)|0,d=d+Math.imul(z,Qe)|0,d=d+Math.imul(U,Je)|0,E=E+Math.imul(U,Qe)|0;var no=(O+_|0)+((d&8191)<<13)|0;O=(E+(d>>>13)|0)+(no>>>26)|0,no&=67108863,_=Math.imul(ce,Ge),d=Math.imul(ce,ze),d=d+Math.imul(qe,Ge)|0,E=Math.imul(qe,ze),_=_+Math.imul(ye,Ue)|0,d=d+Math.imul(ye,ke)|0,d=d+Math.imul(xe,Ue)|0,E=E+Math.imul(xe,ke)|0,_=_+Math.imul(Oe,ge)|0,d=d+Math.imul(Oe,je)|0,d=d+Math.imul(Me,ge)|0,E=E+Math.imul(Me,je)|0,_=_+Math.imul(Ee,We)|0,d=d+Math.imul(Ee,Re)|0,d=d+Math.imul(De,We)|0,E=E+Math.imul(De,Re)|0,_=_+Math.imul(Te,Ne)|0,d=d+Math.imul(Te,Ce)|0,d=d+Math.imul(Ae,Ne)|0,E=E+Math.imul(Ae,Ce)|0,_=_+Math.imul(de,Se)|0,d=d+Math.imul(de,Ye)|0,d=d+Math.imul(Pe,Se)|0,E=E+Math.imul(Pe,Ye)|0,_=_+Math.imul(re,Xe)|0,d=d+Math.imul(re,Ze)|0,d=d+Math.imul(ae,Xe)|0,E=E+Math.imul(ae,Ze)|0,_=_+Math.imul(X,Ke)|0,d=d+Math.imul(X,Be)|0,d=d+Math.imul(Q,Ke)|0,E=E+Math.imul(Q,Be)|0,_=_+Math.imul(W,Je)|0,d=d+Math.imul(W,Qe)|0,d=d+Math.imul(Z,Je)|0,E=E+Math.imul(Z,Qe)|0,_=_+Math.imul(z,et)|0,d=d+Math.imul(z,tt)|0,d=d+Math.imul(U,et)|0,E=E+Math.imul(U,tt)|0;var so=(O+_|0)+((d&8191)<<13)|0;O=(E+(d>>>13)|0)+(so>>>26)|0,so&=67108863,_=Math.imul(ce,Ue),d=Math.imul(ce,ke),d=d+Math.imul(qe,Ue)|0,E=Math.imul(qe,ke),_=_+Math.imul(ye,ge)|0,d=d+Math.imul(ye,je)|0,d=d+Math.imul(xe,ge)|0,E=E+Math.imul(xe,je)|0,_=_+Math.imul(Oe,We)|0,d=d+Math.imul(Oe,Re)|0,d=d+Math.imul(Me,We)|0,E=E+Math.imul(Me,Re)|0,_=_+Math.imul(Ee,Ne)|0,d=d+Math.imul(Ee,Ce)|0,d=d+Math.imul(De,Ne)|0,E=E+Math.imul(De,Ce)|0,_=_+Math.imul(Te,Se)|0,d=d+Math.imul(Te,Ye)|0,d=d+Math.imul(Ae,Se)|0,E=E+Math.imul(Ae,Ye)|0,_=_+Math.imul(de,Xe)|0,d=d+Math.imul(de,Ze)|0,d=d+Math.imul(Pe,Xe)|0,E=E+Math.imul(Pe,Ze)|0,_=_+Math.imul(re,Ke)|0,d=d+Math.imul(re,Be)|0,d=d+Math.imul(ae,Ke)|0,E=E+Math.imul(ae,Be)|0,_=_+Math.imul(X,Je)|0,d=d+Math.imul(X,Qe)|0,d=d+Math.imul(Q,Je)|0,E=E+Math.imul(Q,Qe)|0,_=_+Math.imul(W,et)|0,d=d+Math.imul(W,tt)|0,d=d+Math.imul(Z,et)|0,E=E+Math.imul(Z,tt)|0;var oo=(O+_|0)+((d&8191)<<13)|0;O=(E+(d>>>13)|0)+(oo>>>26)|0,oo&=67108863,_=Math.imul(ce,ge),d=Math.imul(ce,je),d=d+Math.imul(qe,ge)|0,E=Math.imul(qe,je),_=_+Math.imul(ye,We)|0,d=d+Math.imul(ye,Re)|0,d=d+Math.imul(xe,We)|0,E=E+Math.imul(xe,Re)|0,_=_+Math.imul(Oe,Ne)|0,d=d+Math.imul(Oe,Ce)|0,d=d+Math.imul(Me,Ne)|0,E=E+Math.imul(Me,Ce)|0,_=_+Math.imul(Ee,Se)|0,d=d+Math.imul(Ee,Ye)|0,d=d+Math.imul(De,Se)|0,E=E+Math.imul(De,Ye)|0,_=_+Math.imul(Te,Xe)|0,d=d+Math.imul(Te,Ze)|0,d=d+Math.imul(Ae,Xe)|0,E=E+Math.imul(Ae,Ze)|0,_=_+Math.imul(de,Ke)|0,d=d+Math.imul(de,Be)|0,d=d+Math.imul(Pe,Ke)|0,E=E+Math.imul(Pe,Be)|0,_=_+Math.imul(re,Je)|0,d=d+Math.imul(re,Qe)|0,d=d+Math.imul(ae,Je)|0,E=E+Math.imul(ae,Qe)|0,_=_+Math.imul(X,et)|0,d=d+Math.imul(X,tt)|0,d=d+Math.imul(Q,et)|0,E=E+Math.imul(Q,tt)|0;var ao=(O+_|0)+((d&8191)<<13)|0;O=(E+(d>>>13)|0)+(ao>>>26)|0,ao&=67108863,_=Math.imul(ce,We),d=Math.imul(ce,Re),d=d+Math.imul(qe,We)|0,E=Math.imul(qe,Re),_=_+Math.imul(ye,Ne)|0,d=d+Math.imul(ye,Ce)|0,d=d+Math.imul(xe,Ne)|0,E=E+Math.imul(xe,Ce)|0,_=_+Math.imul(Oe,Se)|0,d=d+Math.imul(Oe,Ye)|0,d=d+Math.imul(Me,Se)|0,E=E+Math.imul(Me,Ye)|0,_=_+Math.imul(Ee,Xe)|0,d=d+Math.imul(Ee,Ze)|0,d=d+Math.imul(De,Xe)|0,E=E+Math.imul(De,Ze)|0,_=_+Math.imul(Te,Ke)|0,d=d+Math.imul(Te,Be)|0,d=d+Math.imul(Ae,Ke)|0,E=E+Math.imul(Ae,Be)|0,_=_+Math.imul(de,Je)|0,d=d+Math.imul(de,Qe)|0,d=d+Math.imul(Pe,Je)|0,E=E+Math.imul(Pe,Qe)|0,_=_+Math.imul(re,et)|0,d=d+Math.imul(re,tt)|0,d=d+Math.imul(ae,et)|0,E=E+Math.imul(ae,tt)|0;var Pi=(O+_|0)+((d&8191)<<13)|0;O=(E+(d>>>13)|0)+(Pi>>>26)|0,Pi&=67108863,_=Math.imul(ce,Ne),d=Math.imul(ce,Ce),d=d+Math.imul(qe,Ne)|0,E=Math.imul(qe,Ce),_=_+Math.imul(ye,Se)|0,d=d+Math.imul(ye,Ye)|0,d=d+Math.imul(xe,Se)|0,E=E+Math.imul(xe,Ye)|0,_=_+Math.imul(Oe,Xe)|0,d=d+Math.imul(Oe,Ze)|0,d=d+Math.imul(Me,Xe)|0,E=E+Math.imul(Me,Ze)|0,_=_+Math.imul(Ee,Ke)|0,d=d+Math.imul(Ee,Be)|0,d=d+Math.imul(De,Ke)|0,E=E+Math.imul(De,Be)|0,_=_+Math.imul(Te,Je)|0,d=d+Math.imul(Te,Qe)|0,d=d+Math.imul(Ae,Je)|0,E=E+Math.imul(Ae,Qe)|0,_=_+Math.imul(de,et)|0,d=d+Math.imul(de,tt)|0,d=d+Math.imul(Pe,et)|0,E=E+Math.imul(Pe,tt)|0;var co=(O+_|0)+((d&8191)<<13)|0;O=(E+(d>>>13)|0)+(co>>>26)|0,co&=67108863,_=Math.imul(ce,Se),d=Math.imul(ce,Ye),d=d+Math.imul(qe,Se)|0,E=Math.imul(qe,Ye),_=_+Math.imul(ye,Xe)|0,d=d+Math.imul(ye,Ze)|0,d=d+Math.imul(xe,Xe)|0,E=E+Math.imul(xe,Ze)|0,_=_+Math.imul(Oe,Ke)|0,d=d+Math.imul(Oe,Be)|0,d=d+Math.imul(Me,Ke)|0,E=E+Math.imul(Me,Be)|0,_=_+Math.imul(Ee,Je)|0,d=d+Math.imul(Ee,Qe)|0,d=d+Math.imul(De,Je)|0,E=E+Math.imul(De,Qe)|0,_=_+Math.imul(Te,et)|0,d=d+Math.imul(Te,tt)|0,d=d+Math.imul(Ae,et)|0,E=E+Math.imul(Ae,tt)|0;var uo=(O+_|0)+((d&8191)<<13)|0;O=(E+(d>>>13)|0)+(uo>>>26)|0,uo&=67108863,_=Math.imul(ce,Xe),d=Math.imul(ce,Ze),d=d+Math.imul(qe,Xe)|0,E=Math.imul(qe,Ze),_=_+Math.imul(ye,Ke)|0,d=d+Math.imul(ye,Be)|0,d=d+Math.imul(xe,Ke)|0,E=E+Math.imul(xe,Be)|0,_=_+Math.imul(Oe,Je)|0,d=d+Math.imul(Oe,Qe)|0,d=d+Math.imul(Me,Je)|0,E=E+Math.imul(Me,Qe)|0,_=_+Math.imul(Ee,et)|0,d=d+Math.imul(Ee,tt)|0,d=d+Math.imul(De,et)|0,E=E+Math.imul(De,tt)|0;var fr=(O+_|0)+((d&8191)<<13)|0;O=(E+(d>>>13)|0)+(fr>>>26)|0,fr&=67108863,_=Math.imul(ce,Ke),d=Math.imul(ce,Be),d=d+Math.imul(qe,Ke)|0,E=Math.imul(qe,Be),_=_+Math.imul(ye,Je)|0,d=d+Math.imul(ye,Qe)|0,d=d+Math.imul(xe,Je)|0,E=E+Math.imul(xe,Qe)|0,_=_+Math.imul(Oe,et)|0,d=d+Math.imul(Oe,tt)|0,d=d+Math.imul(Me,et)|0,E=E+Math.imul(Me,tt)|0;var fo=(O+_|0)+((d&8191)<<13)|0;O=(E+(d>>>13)|0)+(fo>>>26)|0,fo&=67108863,_=Math.imul(ce,Je),d=Math.imul(ce,Qe),d=d+Math.imul(qe,Je)|0,E=Math.imul(qe,Qe),_=_+Math.imul(ye,et)|0,d=d+Math.imul(ye,tt)|0,d=d+Math.imul(xe,et)|0,E=E+Math.imul(xe,tt)|0;var ho=(O+_|0)+((d&8191)<<13)|0;O=(E+(d>>>13)|0)+(ho>>>26)|0,ho&=67108863,_=Math.imul(ce,et),d=Math.imul(ce,tt),d=d+Math.imul(qe,et)|0,E=Math.imul(qe,tt);var lo=(O+_|0)+((d&8191)<<13)|0;return O=(E+(d>>>13)|0)+(lo>>>26)|0,lo&=67108863,S[0]=er,S[1]=Js,S[2]=Qs,S[3]=eo,S[4]=to,S[5]=ro,S[6]=xr,S[7]=io,S[8]=no,S[9]=so,S[10]=oo,S[11]=ao,S[12]=Pi,S[13]=co,S[14]=uo,S[15]=fr,S[16]=fo,S[17]=ho,S[18]=lo,O!==0&&(S[19]=O,v.length++),v};Math.imul||(x=g);function A(I,f,p){p.negative=f.negative^I.negative,p.length=I.length+f.length;for(var v=0,y=0,m=0;m<p.length-1;m++){var S=y;y=0;for(var O=v&67108863,_=Math.min(m,f.length-1),d=Math.max(0,m-I.length+1);d<=_;d++){var E=m-d,q=I.words[E]|0,z=f.words[d]|0,U=q*z,k=U&67108863;S=S+(U/67108864|0)|0,k=k+O|0,O=k&67108863,S=S+(k>>>26)|0,y+=S>>>26,S&=67108863}p.words[m]=O,v=S,S=y}return v!==0?p.words[m]=v:p.length--,p.strip()}function D(I,f,p){var v=new $;return v.mulp(I,f,p)}s.prototype.mulTo=function(f,p){var v,y=this.length+f.length;return this.length===10&&f.length===10?v=x(this,f,p):y<63?v=g(this,f,p):y<1024?v=A(this,f,p):v=D(this,f,p),v};function $(I,f){this.x=I,this.y=f}$.prototype.makeRBT=function(f){for(var p=new Array(f),v=s.prototype._countBits(f)-1,y=0;y<f;y++)p[y]=this.revBin(y,v,f);return p},$.prototype.revBin=function(f,p,v){if(f===0||f===v-1)return f;for(var y=0,m=0;m<p;m++)y|=(f&1)<<p-m-1,f>>=1;return y},$.prototype.permute=function(f,p,v,y,m,S){for(var O=0;O<S;O++)y[O]=p[f[O]],m[O]=v[f[O]]},$.prototype.transform=function(f,p,v,y,m,S){this.permute(S,f,p,v,y,m);for(var O=1;O<m;O<<=1)for(var _=O<<1,d=Math.cos(2*Math.PI/_),E=Math.sin(2*Math.PI/_),q=0;q<m;q+=_)for(var z=d,U=E,k=0;k<O;k++){var W=v[q+k],Z=y[q+k],J=v[q+k+O],X=y[q+k+O],Q=z*J-U*X;X=z*X+U*J,J=Q,v[q+k]=W+J,y[q+k]=Z+X,v[q+k+O]=W-J,y[q+k+O]=Z-X,k!==_&&(Q=d*z-E*U,U=d*U+E*z,z=Q)}},$.prototype.guessLen13b=function(f,p){var v=Math.max(p,f)|1,y=v&1,m=0;for(v=v/2|0;v;v=v>>>1)m++;return 1<<m+1+y},$.prototype.conjugate=function(f,p,v){if(!(v<=1))for(var y=0;y<v/2;y++){var m=f[y];f[y]=f[v-y-1],f[v-y-1]=m,m=p[y],p[y]=-p[v-y-1],p[v-y-1]=-m}},$.prototype.normalize13b=function(f,p){for(var v=0,y=0;y<p/2;y++){var m=Math.round(f[2*y+1]/p)*8192+Math.round(f[2*y]/p)+v;f[y]=m&67108863,m<67108864?v=0:v=m/67108864|0}return f},$.prototype.convert13b=function(f,p,v,y){for(var m=0,S=0;S<p;S++)m=m+(f[S]|0),v[2*S]=m&8191,m=m>>>13,v[2*S+1]=m&8191,m=m>>>13;for(S=2*p;S<y;++S)v[S]=0;i(m===0),i((m&-8192)===0)},$.prototype.stub=function(f){for(var p=new Array(f),v=0;v<f;v++)p[v]=0;return p},$.prototype.mulp=function(f,p,v){var y=2*this.guessLen13b(f.length,p.length),m=this.makeRBT(y),S=this.stub(y),O=new Array(y),_=new Array(y),d=new Array(y),E=new Array(y),q=new Array(y),z=new Array(y),U=v.words;U.length=y,this.convert13b(f.words,f.length,O,y),this.convert13b(p.words,p.length,E,y),this.transform(O,S,_,d,y,m),this.transform(E,S,q,z,y,m);for(var k=0;k<y;k++){var W=_[k]*q[k]-d[k]*z[k];d[k]=_[k]*z[k]+d[k]*q[k],_[k]=W}return this.conjugate(_,d,y),this.transform(_,d,U,S,y,m),this.conjugate(U,S,y),this.normalize13b(U,y),v.negative=f.negative^p.negative,v.length=f.length+p.length,v.strip()},s.prototype.mul=function(f){var p=new s(null);return p.words=new Array(this.length+f.length),this.mulTo(f,p)},s.prototype.mulf=function(f){var p=new s(null);return p.words=new Array(this.length+f.length),D(this,f,p)},s.prototype.imul=function(f){return this.clone().mulTo(f,this)},s.prototype.imuln=function(f){i(typeof f=="number"),i(f<67108864);for(var p=0,v=0;v<this.length;v++){var y=(this.words[v]|0)*f,m=(y&67108863)+(p&67108863);p>>=26,p+=y/67108864|0,p+=m>>>26,this.words[v]=m&67108863}return p!==0&&(this.words[v]=p,this.length++),this},s.prototype.muln=function(f){return this.clone().imuln(f)},s.prototype.sqr=function(){return this.mul(this)},s.prototype.isqr=function(){return this.imul(this.clone())},s.prototype.pow=function(f){var p=w(f);if(p.length===0)return new s(1);for(var v=this,y=0;y<p.length&&p[y]===0;y++,v=v.sqr());if(++y<p.length)for(var m=v.sqr();y<p.length;y++,m=m.sqr())p[y]!==0&&(v=v.mul(m));return v},s.prototype.iushln=function(f){i(typeof f=="number"&&f>=0);var p=f%26,v=(f-p)/26,y=67108863>>>26-p<<26-p,m;if(p!==0){var S=0;for(m=0;m<this.length;m++){var O=this.words[m]&y,_=(this.words[m]|0)-O<<p;this.words[m]=_|S,S=O>>>26-p}S&&(this.words[m]=S,this.length++)}if(v!==0){for(m=this.length-1;m>=0;m--)this.words[m+v]=this.words[m];for(m=0;m<v;m++)this.words[m]=0;this.length+=v}return this.strip()},s.prototype.ishln=function(f){return i(this.negative===0),this.iushln(f)},s.prototype.iushrn=function(f,p,v){i(typeof f=="number"&&f>=0);var y;p?y=(p-p%26)/26:y=0;var m=f%26,S=Math.min((f-m)/26,this.length),O=67108863^67108863>>>m<<m,_=v;if(y-=S,y=Math.max(0,y),_){for(var d=0;d<S;d++)_.words[d]=this.words[d];_.length=S}if(S!==0)if(this.length>S)for(this.length-=S,d=0;d<this.length;d++)this.words[d]=this.words[d+S];else this.words[0]=0,this.length=1;var E=0;for(d=this.length-1;d>=0&&(E!==0||d>=y);d--){var q=this.words[d]|0;this.words[d]=E<<26-m|q>>>m,E=q&O}return _&&E!==0&&(_.words[_.length++]=E),this.length===0&&(this.words[0]=0,this.length=1),this.strip()},s.prototype.ishrn=function(f,p,v){return i(this.negative===0),this.iushrn(f,p,v)},s.prototype.shln=function(f){return this.clone().ishln(f)},s.prototype.ushln=function(f){return this.clone().iushln(f)},s.prototype.shrn=function(f){return this.clone().ishrn(f)},s.prototype.ushrn=function(f){return this.clone().iushrn(f)},s.prototype.testn=function(f){i(typeof f=="number"&&f>=0);var p=f%26,v=(f-p)/26,y=1<<p;if(this.length<=v)return!1;var m=this.words[v];return!!(m&y)},s.prototype.imaskn=function(f){i(typeof f=="number"&&f>=0);var p=f%26,v=(f-p)/26;if(i(this.negative===0,"imaskn works only with positive numbers"),this.length<=v)return this;if(p!==0&&v++,this.length=Math.min(v,this.length),p!==0){var y=67108863^67108863>>>p<<p;this.words[this.length-1]&=y}return this.strip()},s.prototype.maskn=function(f){return this.clone().imaskn(f)},s.prototype.iaddn=function(f){return i(typeof f=="number"),i(f<67108864),f<0?this.isubn(-f):this.negative!==0?this.length===1&&(this.words[0]|0)<f?(this.words[0]=f-(this.words[0]|0),this.negative=0,this):(this.negative=0,this.isubn(f),this.negative=1,this):this._iaddn(f)},s.prototype._iaddn=function(f){this.words[0]+=f;for(var p=0;p<this.length&&this.words[p]>=67108864;p++)this.words[p]-=67108864,p===this.length-1?this.words[p+1]=1:this.words[p+1]++;return this.length=Math.max(this.length,p+1),this},s.prototype.isubn=function(f){if(i(typeof f=="number"),i(f<67108864),f<0)return this.iaddn(-f);if(this.negative!==0)return this.negative=0,this.iaddn(f),this.negative=1,this;if(this.words[0]-=f,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var p=0;p<this.length&&this.words[p]<0;p++)this.words[p]+=67108864,this.words[p+1]-=1;return this.strip()},s.prototype.addn=function(f){return this.clone().iaddn(f)},s.prototype.subn=function(f){return this.clone().isubn(f)},s.prototype.iabs=function(){return this.negative=0,this},s.prototype.abs=function(){return this.clone().iabs()},s.prototype._ishlnsubmul=function(f,p,v){var y=f.length+v,m;this._expand(y);var S,O=0;for(m=0;m<f.length;m++){S=(this.words[m+v]|0)+O;var _=(f.words[m]|0)*p;S-=_&67108863,O=(S>>26)-(_/67108864|0),this.words[m+v]=S&67108863}for(;m<this.length-v;m++)S=(this.words[m+v]|0)+O,O=S>>26,this.words[m+v]=S&67108863;if(O===0)return this.strip();for(i(O===-1),O=0,m=0;m<this.length;m++)S=-(this.words[m]|0)+O,O=S>>26,this.words[m]=S&67108863;return this.negative=1,this.strip()},s.prototype._wordDiv=function(f,p){var v=this.length-f.length,y=this.clone(),m=f,S=m.words[m.length-1]|0,O=this._countBits(S);v=26-O,v!==0&&(m=m.ushln(v),y.iushln(v),S=m.words[m.length-1]|0);var _=y.length-m.length,d;if(p!=="mod"){d=new s(null),d.length=_+1,d.words=new Array(d.length);for(var E=0;E<d.length;E++)d.words[E]=0}var q=y.clone()._ishlnsubmul(m,1,_);q.negative===0&&(y=q,d&&(d.words[_]=1));for(var z=_-1;z>=0;z--){var U=(y.words[m.length+z]|0)*67108864+(y.words[m.length+z-1]|0);for(U=Math.min(U/S|0,67108863),y._ishlnsubmul(m,U,z);y.negative!==0;)U--,y.negative=0,y._ishlnsubmul(m,1,z),y.isZero()||(y.negative^=1);d&&(d.words[z]=U)}return d&&d.strip(),y.strip(),p!=="div"&&v!==0&&y.iushrn(v),{div:d||null,mod:y}},s.prototype.divmod=function(f,p,v){if(i(!f.isZero()),this.isZero())return{div:new s(0),mod:new s(0)};var y,m,S;return this.negative!==0&&f.negative===0?(S=this.neg().divmod(f,p),p!=="mod"&&(y=S.div.neg()),p!=="div"&&(m=S.mod.neg(),v&&m.negative!==0&&m.iadd(f)),{div:y,mod:m}):this.negative===0&&f.negative!==0?(S=this.divmod(f.neg(),p),p!=="mod"&&(y=S.div.neg()),{div:y,mod:S.mod}):(this.negative&f.negative)!==0?(S=this.neg().divmod(f.neg(),p),p!=="div"&&(m=S.mod.neg(),v&&m.negative!==0&&m.isub(f)),{div:S.div,mod:m}):f.length>this.length||this.cmp(f)<0?{div:new s(0),mod:this}:f.length===1?p==="div"?{div:this.divn(f.words[0]),mod:null}:p==="mod"?{div:null,mod:new s(this.modn(f.words[0]))}:{div:this.divn(f.words[0]),mod:new s(this.modn(f.words[0]))}:this._wordDiv(f,p)},s.prototype.div=function(f){return this.divmod(f,"div",!1).div},s.prototype.mod=function(f){return this.divmod(f,"mod",!1).mod},s.prototype.umod=function(f){return this.divmod(f,"mod",!0).mod},s.prototype.divRound=function(f){var p=this.divmod(f);if(p.mod.isZero())return p.div;var v=p.div.negative!==0?p.mod.isub(f):p.mod,y=f.ushrn(1),m=f.andln(1),S=v.cmp(y);return S<0||m===1&&S===0?p.div:p.div.negative!==0?p.div.isubn(1):p.div.iaddn(1)},s.prototype.modn=function(f){i(f<=67108863);for(var p=(1<<26)%f,v=0,y=this.length-1;y>=0;y--)v=(p*v+(this.words[y]|0))%f;return v},s.prototype.idivn=function(f){i(f<=67108863);for(var p=0,v=this.length-1;v>=0;v--){var y=(this.words[v]|0)+p*67108864;this.words[v]=y/f|0,p=y%f}return this.strip()},s.prototype.divn=function(f){return this.clone().idivn(f)},s.prototype.egcd=function(f){i(f.negative===0),i(!f.isZero());var p=this,v=f.clone();p.negative!==0?p=p.umod(f):p=p.clone();for(var y=new s(1),m=new s(0),S=new s(0),O=new s(1),_=0;p.isEven()&&v.isEven();)p.iushrn(1),v.iushrn(1),++_;for(var d=v.clone(),E=p.clone();!p.isZero();){for(var q=0,z=1;(p.words[0]&z)===0&&q<26;++q,z<<=1);if(q>0)for(p.iushrn(q);q-- >0;)(y.isOdd()||m.isOdd())&&(y.iadd(d),m.isub(E)),y.iushrn(1),m.iushrn(1);for(var U=0,k=1;(v.words[0]&k)===0&&U<26;++U,k<<=1);if(U>0)for(v.iushrn(U);U-- >0;)(S.isOdd()||O.isOdd())&&(S.iadd(d),O.isub(E)),S.iushrn(1),O.iushrn(1);p.cmp(v)>=0?(p.isub(v),y.isub(S),m.isub(O)):(v.isub(p),S.isub(y),O.isub(m))}return{a:S,b:O,gcd:v.iushln(_)}},s.prototype._invmp=function(f){i(f.negative===0),i(!f.isZero());var p=this,v=f.clone();p.negative!==0?p=p.umod(f):p=p.clone();for(var y=new s(1),m=new s(0),S=v.clone();p.cmpn(1)>0&&v.cmpn(1)>0;){for(var O=0,_=1;(p.words[0]&_)===0&&O<26;++O,_<<=1);if(O>0)for(p.iushrn(O);O-- >0;)y.isOdd()&&y.iadd(S),y.iushrn(1);for(var d=0,E=1;(v.words[0]&E)===0&&d<26;++d,E<<=1);if(d>0)for(v.iushrn(d);d-- >0;)m.isOdd()&&m.iadd(S),m.iushrn(1);p.cmp(v)>=0?(p.isub(v),y.isub(m)):(v.isub(p),m.isub(y))}var q;return p.cmpn(1)===0?q=y:q=m,q.cmpn(0)<0&&q.iadd(f),q},s.prototype.gcd=function(f){if(this.isZero())return f.abs();if(f.isZero())return this.abs();var p=this.clone(),v=f.clone();p.negative=0,v.negative=0;for(var y=0;p.isEven()&&v.isEven();y++)p.iushrn(1),v.iushrn(1);do{for(;p.isEven();)p.iushrn(1);for(;v.isEven();)v.iushrn(1);var m=p.cmp(v);if(m<0){var S=p;p=v,v=S}else if(m===0||v.cmpn(1)===0)break;p.isub(v)}while(!0);return v.iushln(y)},s.prototype.invm=function(f){return this.egcd(f).a.umod(f)},s.prototype.isEven=function(){return(this.words[0]&1)===0},s.prototype.isOdd=function(){return(this.words[0]&1)===1},s.prototype.andln=function(f){return this.words[0]&f},s.prototype.bincn=function(f){i(typeof f=="number");var p=f%26,v=(f-p)/26,y=1<<p;if(this.length<=v)return this._expand(v+1),this.words[v]|=y,this;for(var m=y,S=v;m!==0&&S<this.length;S++){var O=this.words[S]|0;O+=m,m=O>>>26,O&=67108863,this.words[S]=O}return m!==0&&(this.words[S]=m,this.length++),this},s.prototype.isZero=function(){return this.length===1&&this.words[0]===0},s.prototype.cmpn=function(f){var p=f<0;if(this.negative!==0&&!p)return-1;if(this.negative===0&&p)return 1;this.strip();var v;if(this.length>1)v=1;else{p&&(f=-f),i(f<=67108863,"Number is too big");var y=this.words[0]|0;v=y===f?0:y<f?-1:1}return this.negative!==0?-v|0:v},s.prototype.cmp=function(f){if(this.negative!==0&&f.negative===0)return-1;if(this.negative===0&&f.negative!==0)return 1;var p=this.ucmp(f);return this.negative!==0?-p|0:p},s.prototype.ucmp=function(f){if(this.length>f.length)return 1;if(this.length<f.length)return-1;for(var p=0,v=this.length-1;v>=0;v--){var y=this.words[v]|0,m=f.words[v]|0;if(y!==m){y<m?p=-1:y>m&&(p=1);break}}return p},s.prototype.gtn=function(f){return this.cmpn(f)===1},s.prototype.gt=function(f){return this.cmp(f)===1},s.prototype.gten=function(f){return this.cmpn(f)>=0},s.prototype.gte=function(f){return this.cmp(f)>=0},s.prototype.ltn=function(f){return this.cmpn(f)===-1},s.prototype.lt=function(f){return this.cmp(f)===-1},s.prototype.lten=function(f){return this.cmpn(f)<=0},s.prototype.lte=function(f){return this.cmp(f)<=0},s.prototype.eqn=function(f){return this.cmpn(f)===0},s.prototype.eq=function(f){return this.cmp(f)===0},s.red=function(f){return new C(f)},s.prototype.toRed=function(f){return i(!this.red,"Already a number in reduction context"),i(this.negative===0,"red works only with positives"),f.convertTo(this)._forceRed(f)},s.prototype.fromRed=function(){return i(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},s.prototype._forceRed=function(f){return this.red=f,this},s.prototype.forceRed=function(f){return i(!this.red,"Already a number in reduction context"),this._forceRed(f)},s.prototype.redAdd=function(f){return i(this.red,"redAdd works only with red numbers"),this.red.add(this,f)},s.prototype.redIAdd=function(f){return i(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,f)},s.prototype.redSub=function(f){return i(this.red,"redSub works only with red numbers"),this.red.sub(this,f)},s.prototype.redISub=function(f){return i(this.red,"redISub works only with red numbers"),this.red.isub(this,f)},s.prototype.redShl=function(f){return i(this.red,"redShl works only with red numbers"),this.red.shl(this,f)},s.prototype.redMul=function(f){return i(this.red,"redMul works only with red numbers"),this.red._verify2(this,f),this.red.mul(this,f)},s.prototype.redIMul=function(f){return i(this.red,"redMul works only with red numbers"),this.red._verify2(this,f),this.red.imul(this,f)},s.prototype.redSqr=function(){return i(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},s.prototype.redISqr=function(){return i(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},s.prototype.redSqrt=function(){return i(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},s.prototype.redInvm=function(){return i(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},s.prototype.redNeg=function(){return i(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},s.prototype.redPow=function(f){return i(this.red&&!f.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,f)};var P={k256:null,p224:null,p192:null,p25519:null};function T(I,f){this.name=I,this.p=new s(f,16),this.n=this.p.bitLength(),this.k=new s(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}T.prototype._tmp=function(){var f=new s(null);return f.words=new Array(Math.ceil(this.n/13)),f},T.prototype.ireduce=function(f){var p=f,v;do this.split(p,this.tmp),p=this.imulK(p),p=p.iadd(this.tmp),v=p.bitLength();while(v>this.n);var y=v<this.n?-1:p.ucmp(this.p);return y===0?(p.words[0]=0,p.length=1):y>0?p.isub(this.p):p.strip!==void 0?p.strip():p._strip(),p},T.prototype.split=function(f,p){f.iushrn(this.n,0,p)},T.prototype.imulK=function(f){return f.imul(this.k)};function N(){T.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}n(N,T),N.prototype.split=function(f,p){for(var v=4194303,y=Math.min(f.length,9),m=0;m<y;m++)p.words[m]=f.words[m];if(p.length=y,f.length<=9){f.words[0]=0,f.length=1;return}var S=f.words[9];for(p.words[p.length++]=S&v,m=10;m<f.length;m++){var O=f.words[m]|0;f.words[m-10]=(O&v)<<4|S>>>22,S=O}S>>>=22,f.words[m-10]=S,S===0&&f.length>10?f.length-=10:f.length-=9},N.prototype.imulK=function(f){f.words[f.length]=0,f.words[f.length+1]=0,f.length+=2;for(var p=0,v=0;v<f.length;v++){var y=f.words[v]|0;p+=y*977,f.words[v]=p&67108863,p=y*64+(p/67108864|0)}return f.words[f.length-1]===0&&(f.length--,f.words[f.length-1]===0&&f.length--),f};function L(){T.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}n(L,T);function F(){T.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}n(F,T);function B(){T.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}n(B,T),B.prototype.imulK=function(f){for(var p=0,v=0;v<f.length;v++){var y=(f.words[v]|0)*19+p,m=y&67108863;y>>>=26,f.words[v]=m,p=y}return p!==0&&(f.words[f.length++]=p),f},s._prime=function(f){if(P[f])return P[f];var p;if(f==="k256")p=new N;else if(f==="p224")p=new L;else if(f==="p192")p=new F;else if(f==="p25519")p=new B;else throw new Error("Unknown prime "+f);return P[f]=p,p};function C(I){if(typeof I=="string"){var f=s._prime(I);this.m=f.p,this.prime=f}else i(I.gtn(1),"modulus must be greater than 1"),this.m=I,this.prime=null}C.prototype._verify1=function(f){i(f.negative===0,"red works only with positives"),i(f.red,"red works only with red numbers")},C.prototype._verify2=function(f,p){i((f.negative|p.negative)===0,"red works only with positives"),i(f.red&&f.red===p.red,"red works only with red numbers")},C.prototype.imod=function(f){return this.prime?this.prime.ireduce(f)._forceRed(this):f.umod(this.m)._forceRed(this)},C.prototype.neg=function(f){return f.isZero()?f.clone():this.m.sub(f)._forceRed(this)},C.prototype.add=function(f,p){this._verify2(f,p);var v=f.add(p);return v.cmp(this.m)>=0&&v.isub(this.m),v._forceRed(this)},C.prototype.iadd=function(f,p){this._verify2(f,p);var v=f.iadd(p);return v.cmp(this.m)>=0&&v.isub(this.m),v},C.prototype.sub=function(f,p){this._verify2(f,p);var v=f.sub(p);return v.cmpn(0)<0&&v.iadd(this.m),v._forceRed(this)},C.prototype.isub=function(f,p){this._verify2(f,p);var v=f.isub(p);return v.cmpn(0)<0&&v.iadd(this.m),v},C.prototype.shl=function(f,p){return this._verify1(f),this.imod(f.ushln(p))},C.prototype.imul=function(f,p){return this._verify2(f,p),this.imod(f.imul(p))},C.prototype.mul=function(f,p){return this._verify2(f,p),this.imod(f.mul(p))},C.prototype.isqr=function(f){return this.imul(f,f.clone())},C.prototype.sqr=function(f){return this.mul(f,f)},C.prototype.sqrt=function(f){if(f.isZero())return f.clone();var p=this.m.andln(3);if(i(p%2===1),p===3){var v=this.m.add(new s(1)).iushrn(2);return this.pow(f,v)}for(var y=this.m.subn(1),m=0;!y.isZero()&&y.andln(1)===0;)m++,y.iushrn(1);i(!y.isZero());var S=new s(1).toRed(this),O=S.redNeg(),_=this.m.subn(1).iushrn(1),d=this.m.bitLength();for(d=new s(2*d*d).toRed(this);this.pow(d,_).cmp(O)!==0;)d.redIAdd(O);for(var E=this.pow(d,y),q=this.pow(f,y.addn(1).iushrn(1)),z=this.pow(f,y),U=m;z.cmp(S)!==0;){for(var k=z,W=0;k.cmp(S)!==0;W++)k=k.redSqr();i(W<U);var Z=this.pow(E,new s(1).iushln(U-W-1));q=q.redMul(Z),E=Z.redSqr(),z=z.redMul(E),U=W}return q},C.prototype.invm=function(f){var p=f._invmp(this.m);return p.negative!==0?(p.negative=0,this.imod(p).redNeg()):this.imod(p)},C.prototype.pow=function(f,p){if(p.isZero())return new s(1).toRed(this);if(p.cmpn(1)===0)return f.clone();var v=4,y=new Array(1<<v);y[0]=new s(1).toRed(this),y[1]=f;for(var m=2;m<y.length;m++)y[m]=this.mul(y[m-1],f);var S=y[0],O=0,_=0,d=p.bitLength()%26;for(d===0&&(d=26),m=p.length-1;m>=0;m--){for(var E=p.words[m],q=d-1;q>=0;q--){var z=E>>q&1;if(S!==y[0]&&(S=this.sqr(S)),z===0&&O===0){_=0;continue}O<<=1,O|=z,_++,!(_!==v&&(m!==0||q!==0))&&(S=this.mul(S,y[O]),_=0,O=0)}d=26}return S},C.prototype.convertTo=function(f){var p=f.umod(this.m);return p===f?p.clone():p},C.prototype.convertFrom=function(f){var p=f.clone();return p.red=null,p},s.mont=function(f){return new G(f)};function G(I){C.call(this,I),this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new s(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}n(G,C),G.prototype.convertTo=function(f){return this.imod(f.ushln(this.shift))},G.prototype.convertFrom=function(f){var p=this.imod(f.mul(this.rinv));return p.red=null,p},G.prototype.imul=function(f,p){if(f.isZero()||p.isZero())return f.words[0]=0,f.length=1,f;var v=f.imul(p),y=v.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),m=v.isub(y).iushrn(this.shift),S=m;return m.cmp(this.m)>=0?S=m.isub(this.m):m.cmpn(0)<0&&(S=m.iadd(this.m)),S._forceRed(this)},G.prototype.mul=function(f,p){if(f.isZero()||p.isZero())return new s(0)._forceRed(this);var v=f.mul(p),y=v.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),m=v.isub(y).iushrn(this.shift),S=m;return m.cmp(this.m)>=0?S=m.isub(this.m):m.cmpn(0)<0&&(S=m.iadd(this.m)),S._forceRed(this)},G.prototype.invm=function(f){var p=this.imod(f._invmp(this.m).mul(this.r2));return p._forceRed(this)}})(t,Nt)})($r);var Ki=Nl;function Nl(t,e){if(!t)throw new Error(e||"Assertion failed")}Nl.equal=function(e,r,i){if(e!=r)throw new Error(i||"Assertion failed: "+e+" != "+r)};var cu={};(function(t){var e=t;function r(s,o){if(Array.isArray(s))return s.slice();if(!s)return[];var a=[];if(typeof s!="string"){for(var c=0;c<s.length;c++)a[c]=s[c]|0;return a}if(o==="hex"){s=s.replace(/[^a-z0-9]+/ig,""),s.length%2!==0&&(s="0"+s);for(var c=0;c<s.length;c+=2)a.push(parseInt(s[c]+s[c+1],16))}else for(var c=0;c<s.length;c++){var u=s.charCodeAt(c),h=u>>8,l=u&255;h?a.push(h,l):a.push(l)}return a}e.toArray=r;function i(s){return s.length===1?"0"+s:s}e.zero2=i;function n(s){for(var o="",a=0;a<s.length;a++)o+=i(s[a].toString(16));return o}e.toHex=n,e.encode=function(o,a){return a==="hex"?n(o):o}})(cu),function(t){var e=t,r=$r.exports,i=Ki,n=cu;e.assert=i,e.toArray=n.toArray,e.zero2=n.zero2,e.toHex=n.toHex,e.encode=n.encode;function s(h,l,b){var w=new Array(Math.max(h.bitLength(),b)+1),g;for(g=0;g<w.length;g+=1)w[g]=0;var x=1<<l+1,A=h.clone();for(g=0;g<w.length;g++){var D,$=A.andln(x-1);A.isOdd()?($>(x>>1)-1?D=(x>>1)-$:D=$,A.isubn(D)):D=0,w[g]=D,A.iushrn(1)}return w}e.getNAF=s;function o(h,l){var b=[[],[]];h=h.clone(),l=l.clone();for(var w=0,g=0,x;h.cmpn(-w)>0||l.cmpn(-g)>0;){var A=h.andln(3)+w&3,D=l.andln(3)+g&3;A===3&&(A=-1),D===3&&(D=-1);var $;(A&1)===0?$=0:(x=h.andln(7)+w&7,(x===3||x===5)&&D===2?$=-A:$=A),b[0].push($);var P;(D&1)===0?P=0:(x=l.andln(7)+g&7,(x===3||x===5)&&A===2?P=-D:P=D),b[1].push(P),2*w===$+1&&(w=1-w),2*g===P+1&&(g=1-g),h.iushrn(1),l.iushrn(1)}return b}e.getJSF=o;function a(h,l,b){var w="_"+l;h.prototype[l]=function(){return this[w]!==void 0?this[w]:this[w]=b.call(this)}}e.cachedProperty=a;function c(h){return typeof h=="string"?e.toArray(h,"hex"):h}e.parseBytes=c;function u(h){return new r(h,"hex","le")}e.intFromLE=u}(Xt);var Xo={exports:{}},uu;Xo.exports=function(e){return uu||(uu=new mi(null)),uu.generate(e)};function mi(t){this.rand=t}if(Xo.exports.Rand=mi,mi.prototype.generate=function(e){return this._rand(e)},mi.prototype._rand=function(e){if(this.rand.getBytes)return this.rand.getBytes(e);for(var r=new Uint8Array(e),i=0;i<r.length;i++)r[i]=this.rand.getByte();return r},typeof self=="object")self.crypto&&self.crypto.getRandomValues?mi.prototype._rand=function(e){var r=new Uint8Array(e);return self.crypto.getRandomValues(r),r}:self.msCrypto&&self.msCrypto.getRandomValues?mi.prototype._rand=function(e){var r=new Uint8Array(e);return self.msCrypto.getRandomValues(r),r}:typeof window=="object"&&(mi.prototype._rand=function(){throw new Error("Not implemented yet")});else try{var Cl=Rl;if(typeof Cl.randomBytes!="function")throw new Error("Not supported");mi.prototype._rand=function(e){return Cl.randomBytes(e)}}catch{}var fu={},Vi=$r.exports,xs=Xt,Zo=xs.getNAF,l8=xs.getJSF,Jo=xs.assert;function wi(t,e){this.type=t,this.p=new Vi(e.p,16),this.red=e.prime?Vi.red(e.prime):Vi.mont(this.p),this.zero=new Vi(0).toRed(this.red),this.one=new Vi(1).toRed(this.red),this.two=new Vi(2).toRed(this.red),this.n=e.n&&new Vi(e.n,16),this.g=e.g&&this.pointFromJSON(e.g,e.gRed),this._wnafT1=new Array(4),this._wnafT2=new Array(4),this._wnafT3=new Array(4),this._wnafT4=new Array(4),this._bitLength=this.n?this.n.bitLength():0;var r=this.n&&this.p.div(this.n);!r||r.cmpn(100)>0?this.redN=null:(this._maxwellTrick=!0,this.redN=this.n.toRed(this.red))}var Qo=wi;wi.prototype.point=function(){throw new Error("Not implemented")},wi.prototype.validate=function(){throw new Error("Not implemented")},wi.prototype._fixedNafMul=function(e,r){Jo(e.precomputed);var i=e._getDoubles(),n=Zo(r,1,this._bitLength),s=(1<<i.step+1)-(i.step%2===0?2:1);s/=3;var o=[],a,c;for(a=0;a<n.length;a+=i.step){c=0;for(var u=a+i.step-1;u>=a;u--)c=(c<<1)+n[u];o.push(c)}for(var h=this.jpoint(null,null,null),l=this.jpoint(null,null,null),b=s;b>0;b--){for(a=0;a<o.length;a++)c=o[a],c===b?l=l.mixedAdd(i.points[a]):c===-b&&(l=l.mixedAdd(i.points[a].neg()));h=h.add(l)}return h.toP()},wi.prototype._wnafMul=function(e,r){var i=4,n=e._getNAFPoints(i);i=n.wnd;for(var s=n.points,o=Zo(r,i,this._bitLength),a=this.jpoint(null,null,null),c=o.length-1;c>=0;c--){for(var u=0;c>=0&&o[c]===0;c--)u++;if(c>=0&&u++,a=a.dblp(u),c<0)break;var h=o[c];Jo(h!==0),e.type==="affine"?h>0?a=a.mixedAdd(s[h-1>>1]):a=a.mixedAdd(s[-h-1>>1].neg()):h>0?a=a.add(s[h-1>>1]):a=a.add(s[-h-1>>1].neg())}return e.type==="affine"?a.toP():a},wi.prototype._wnafMulAdd=function(e,r,i,n,s){var o=this._wnafT1,a=this._wnafT2,c=this._wnafT3,u=0,h,l,b;for(h=0;h<n;h++){b=r[h];var w=b._getNAFPoints(e);o[h]=w.wnd,a[h]=w.points}for(h=n-1;h>=1;h-=2){var g=h-1,x=h;if(o[g]!==1||o[x]!==1){c[g]=Zo(i[g],o[g],this._bitLength),c[x]=Zo(i[x],o[x],this._bitLength),u=Math.max(c[g].length,u),u=Math.max(c[x].length,u);continue}var A=[r[g],null,null,r[x]];r[g].y.cmp(r[x].y)===0?(A[1]=r[g].add(r[x]),A[2]=r[g].toJ().mixedAdd(r[x].neg())):r[g].y.cmp(r[x].y.redNeg())===0?(A[1]=r[g].toJ().mixedAdd(r[x]),A[2]=r[g].add(r[x].neg())):(A[1]=r[g].toJ().mixedAdd(r[x]),A[2]=r[g].toJ().mixedAdd(r[x].neg()));var D=[-3,-1,-5,-7,0,7,5,1,3],$=l8(i[g],i[x]);for(u=Math.max($[0].length,u),c[g]=new Array(u),c[x]=new Array(u),l=0;l<u;l++){var P=$[0][l]|0,T=$[1][l]|0;c[g][l]=D[(P+1)*3+(T+1)],c[x][l]=0,a[g]=A}}var N=this.jpoint(null,null,null),L=this._wnafT4;for(h=u;h>=0;h--){for(var F=0;h>=0;){var B=!0;for(l=0;l<n;l++)L[l]=c[l][h]|0,L[l]!==0&&(B=!1);if(!B)break;F++,h--}if(h>=0&&F++,N=N.dblp(F),h<0)break;for(l=0;l<n;l++){var C=L[l];C!==0&&(C>0?b=a[l][C-1>>1]:C<0&&(b=a[l][-C-1>>1].neg()),b.type==="affine"?N=N.mixedAdd(b):N=N.add(b))}}for(h=0;h<n;h++)a[h]=null;return s?N:N.toP()};function nr(t,e){this.curve=t,this.type=e,this.precomputed=null}wi.BasePoint=nr,nr.prototype.eq=function(){throw new Error("Not implemented")},nr.prototype.validate=function(){return this.curve.validate(this)},wi.prototype.decodePoint=function(e,r){e=xs.toArray(e,r);var i=this.p.byteLength();if((e[0]===4||e[0]===6||e[0]===7)&&e.length-1===2*i){e[0]===6?Jo(e[e.length-1]%2===0):e[0]===7&&Jo(e[e.length-1]%2===1);var n=this.point(e.slice(1,1+i),e.slice(1+i,1+2*i));return n}else if((e[0]===2||e[0]===3)&&e.length-1===i)return this.pointFromX(e.slice(1,1+i),e[0]===3);throw new Error("Unknown point format")},nr.prototype.encodeCompressed=function(e){return this.encode(e,!0)},nr.prototype._encode=function(e){var r=this.curve.p.byteLength(),i=this.getX().toArray("be",r);return e?[this.getY().isEven()?2:3].concat(i):[4].concat(i,this.getY().toArray("be",r))},nr.prototype.encode=function(e,r){return xs.encode(this._encode(r),e)},nr.prototype.precompute=function(e){if(this.precomputed)return this;var r={doubles:null,naf:null,beta:null};return r.naf=this._getNAFPoints(8),r.doubles=this._getDoubles(4,e),r.beta=this._getBeta(),this.precomputed=r,this},nr.prototype._hasDoubles=function(e){if(!this.precomputed)return!1;var r=this.precomputed.doubles;return r?r.points.length>=Math.ceil((e.bitLength()+1)/r.step):!1},nr.prototype._getDoubles=function(e,r){if(this.precomputed&&this.precomputed.doubles)return this.precomputed.doubles;for(var i=[this],n=this,s=0;s<r;s+=e){for(var o=0;o<e;o++)n=n.dbl();i.push(n)}return{step:e,points:i}},nr.prototype._getNAFPoints=function(e){if(this.precomputed&&this.precomputed.naf)return this.precomputed.naf;for(var r=[this],i=(1<<e)-1,n=i===1?null:this.dbl(),s=1;s<i;s++)r[s]=r[s-1].add(n);return{wnd:e,points:r}},nr.prototype._getBeta=function(){return null},nr.prototype.dblp=function(e){for(var r=this,i=0;i<e;i++)r=r.dbl();return r};var Cn={exports:{}};typeof Object.create=="function"?Cn.exports=function(e,r){r&&(e.super_=r,e.prototype=Object.create(r.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:Cn.exports=function(e,r){if(r){e.super_=r;var i=function(){};i.prototype=r.prototype,e.prototype=new i,e.prototype.constructor=e}};var p8=Xt,He=$r.exports,hu=Cn.exports,Bn=Qo,b8=p8.assert;function sr(t){Bn.call(this,"short",t),this.a=new He(t.a,16).toRed(this.red),this.b=new He(t.b,16).toRed(this.red),this.tinv=this.two.redInvm(),this.zeroA=this.a.fromRed().cmpn(0)===0,this.threeA=this.a.fromRed().sub(this.p).cmpn(-3)===0,this.endo=this._getEndomorphism(t),this._endoWnafT1=new Array(4),this._endoWnafT2=new Array(4)}hu(sr,Bn);var g8=sr;sr.prototype._getEndomorphism=function(e){if(!(!this.zeroA||!this.g||!this.n||this.p.modn(3)!==1)){var r,i;if(e.beta)r=new He(e.beta,16).toRed(this.red);else{var n=this._getEndoRoots(this.p);r=n[0].cmp(n[1])<0?n[0]:n[1],r=r.toRed(this.red)}if(e.lambda)i=new He(e.lambda,16);else{var s=this._getEndoRoots(this.n);this.g.mul(s[0]).x.cmp(this.g.x.redMul(r))===0?i=s[0]:(i=s[1],b8(this.g.mul(i).x.cmp(this.g.x.redMul(r))===0))}var o;return e.basis?o=e.basis.map(function(a){return{a:new He(a.a,16),b:new He(a.b,16)}}):o=this._getEndoBasis(i),{beta:r,lambda:i,basis:o}}},sr.prototype._getEndoRoots=function(e){var r=e===this.p?this.red:He.mont(e),i=new He(2).toRed(r).redInvm(),n=i.redNeg(),s=new He(3).toRed(r).redNeg().redSqrt().redMul(i),o=n.redAdd(s).fromRed(),a=n.redSub(s).fromRed();return[o,a]},sr.prototype._getEndoBasis=function(e){for(var r=this.n.ushrn(Math.floor(this.n.bitLength()/2)),i=e,n=this.n.clone(),s=new He(1),o=new He(0),a=new He(0),c=new He(1),u,h,l,b,w,g,x,A=0,D,$;i.cmpn(0)!==0;){var P=n.div(i);D=n.sub(P.mul(i)),$=a.sub(P.mul(s));var T=c.sub(P.mul(o));if(!l&&D.cmp(r)<0)u=x.neg(),h=s,l=D.neg(),b=$;else if(l&&++A===2)break;x=D,n=i,i=D,a=s,s=$,c=o,o=T}w=D.neg(),g=$;var N=l.sqr().add(b.sqr()),L=w.sqr().add(g.sqr());return L.cmp(N)>=0&&(w=u,g=h),l.negative&&(l=l.neg(),b=b.neg()),w.negative&&(w=w.neg(),g=g.neg()),[{a:l,b},{a:w,b:g}]},sr.prototype._endoSplit=function(e){var r=this.endo.basis,i=r[0],n=r[1],s=n.b.mul(e).divRound(this.n),o=i.b.neg().mul(e).divRound(this.n),a=s.mul(i.a),c=o.mul(n.a),u=s.mul(i.b),h=o.mul(n.b),l=e.sub(a).sub(c),b=u.add(h).neg();return{k1:l,k2:b}},sr.prototype.pointFromX=function(e,r){e=new He(e,16),e.red||(e=e.toRed(this.red));var i=e.redSqr().redMul(e).redIAdd(e.redMul(this.a)).redIAdd(this.b),n=i.redSqrt();if(n.redSqr().redSub(i).cmp(this.zero)!==0)throw new Error("invalid point");var s=n.fromRed().isOdd();return(r&&!s||!r&&s)&&(n=n.redNeg()),this.point(e,n)},sr.prototype.validate=function(e){if(e.inf)return!0;var r=e.x,i=e.y,n=this.a.redMul(r),s=r.redSqr().redMul(r).redIAdd(n).redIAdd(this.b);return i.redSqr().redISub(s).cmpn(0)===0},sr.prototype._endoWnafMulAdd=function(e,r,i){for(var n=this._endoWnafT1,s=this._endoWnafT2,o=0;o<e.length;o++){var a=this._endoSplit(r[o]),c=e[o],u=c._getBeta();a.k1.negative&&(a.k1.ineg(),c=c.neg(!0)),a.k2.negative&&(a.k2.ineg(),u=u.neg(!0)),n[o*2]=c,n[o*2+1]=u,s[o*2]=a.k1,s[o*2+1]=a.k2}for(var h=this._wnafMulAdd(1,n,s,o*2,i),l=0;l<o*2;l++)n[l]=null,s[l]=null;return h};function bt(t,e,r,i){Bn.BasePoint.call(this,t,"affine"),e===null&&r===null?(this.x=null,this.y=null,this.inf=!0):(this.x=new He(e,16),this.y=new He(r,16),i&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}hu(bt,Bn.BasePoint),sr.prototype.point=function(e,r,i){return new bt(this,e,r,i)},sr.prototype.pointFromJSON=function(e,r){return bt.fromJSON(this,e,r)},bt.prototype._getBeta=function(){if(this.curve.endo){var e=this.precomputed;if(e&&e.beta)return e.beta;var r=this.curve.point(this.x.redMul(this.curve.endo.beta),this.y);if(e){var i=this.curve,n=function(s){return i.point(s.x.redMul(i.endo.beta),s.y)};e.beta=r,r.precomputed={beta:null,naf:e.naf&&{wnd:e.naf.wnd,points:e.naf.points.map(n)},doubles:e.doubles&&{step:e.doubles.step,points:e.doubles.points.map(n)}}}return r}},bt.prototype.toJSON=function(){return this.precomputed?[this.x,this.y,this.precomputed&&{doubles:this.precomputed.doubles&&{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)},naf:this.precomputed.naf&&{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}}]:[this.x,this.y]},bt.fromJSON=function(e,r,i){typeof r=="string"&&(r=JSON.parse(r));var n=e.point(r[0],r[1],i);if(!r[2])return n;function s(a){return e.point(a[0],a[1],i)}var o=r[2];return n.precomputed={beta:null,doubles:o.doubles&&{step:o.doubles.step,points:[n].concat(o.doubles.points.map(s))},naf:o.naf&&{wnd:o.naf.wnd,points:[n].concat(o.naf.points.map(s))}},n},bt.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+">"},bt.prototype.isInfinity=function(){return this.inf},bt.prototype.add=function(e){if(this.inf)return e;if(e.inf)return this;if(this.eq(e))return this.dbl();if(this.neg().eq(e))return this.curve.point(null,null);if(this.x.cmp(e.x)===0)return this.curve.point(null,null);var r=this.y.redSub(e.y);r.cmpn(0)!==0&&(r=r.redMul(this.x.redSub(e.x).redInvm()));var i=r.redSqr().redISub(this.x).redISub(e.x),n=r.redMul(this.x.redSub(i)).redISub(this.y);return this.curve.point(i,n)},bt.prototype.dbl=function(){if(this.inf)return this;var e=this.y.redAdd(this.y);if(e.cmpn(0)===0)return this.curve.point(null,null);var r=this.curve.a,i=this.x.redSqr(),n=e.redInvm(),s=i.redAdd(i).redIAdd(i).redIAdd(r).redMul(n),o=s.redSqr().redISub(this.x.redAdd(this.x)),a=s.redMul(this.x.redSub(o)).redISub(this.y);return this.curve.point(o,a)},bt.prototype.getX=function(){return this.x.fromRed()},bt.prototype.getY=function(){return this.y.fromRed()},bt.prototype.mul=function(e){return e=new He(e,16),this.isInfinity()?this:this._hasDoubles(e)?this.curve._fixedNafMul(this,e):this.curve.endo?this.curve._endoWnafMulAdd([this],[e]):this.curve._wnafMul(this,e)},bt.prototype.mulAdd=function(e,r,i){var n=[this,r],s=[e,i];return this.curve.endo?this.curve._endoWnafMulAdd(n,s):this.curve._wnafMulAdd(1,n,s,2)},bt.prototype.jmulAdd=function(e,r,i){var n=[this,r],s=[e,i];return this.curve.endo?this.curve._endoWnafMulAdd(n,s,!0):this.curve._wnafMulAdd(1,n,s,2,!0)},bt.prototype.eq=function(e){return this===e||this.inf===e.inf&&(this.inf||this.x.cmp(e.x)===0&&this.y.cmp(e.y)===0)},bt.prototype.neg=function(e){if(this.inf)return this;var r=this.curve.point(this.x,this.y.redNeg());if(e&&this.precomputed){var i=this.precomputed,n=function(s){return s.neg()};r.precomputed={naf:i.naf&&{wnd:i.naf.wnd,points:i.naf.points.map(n)},doubles:i.doubles&&{step:i.doubles.step,points:i.doubles.points.map(n)}}}return r},bt.prototype.toJ=function(){if(this.inf)return this.curve.jpoint(null,null,null);var e=this.curve.jpoint(this.x,this.y,this.curve.one);return e};function xt(t,e,r,i){Bn.BasePoint.call(this,t,"jacobian"),e===null&&r===null&&i===null?(this.x=this.curve.one,this.y=this.curve.one,this.z=new He(0)):(this.x=new He(e,16),this.y=new He(r,16),this.z=new He(i,16)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z===this.curve.one}hu(xt,Bn.BasePoint),sr.prototype.jpoint=function(e,r,i){return new xt(this,e,r,i)},xt.prototype.toP=function(){if(this.isInfinity())return this.curve.point(null,null);var e=this.z.redInvm(),r=e.redSqr(),i=this.x.redMul(r),n=this.y.redMul(r).redMul(e);return this.curve.point(i,n)},xt.prototype.neg=function(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)},xt.prototype.add=function(e){if(this.isInfinity())return e;if(e.isInfinity())return this;var r=e.z.redSqr(),i=this.z.redSqr(),n=this.x.redMul(r),s=e.x.redMul(i),o=this.y.redMul(r.redMul(e.z)),a=e.y.redMul(i.redMul(this.z)),c=n.redSub(s),u=o.redSub(a);if(c.cmpn(0)===0)return u.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var h=c.redSqr(),l=h.redMul(c),b=n.redMul(h),w=u.redSqr().redIAdd(l).redISub(b).redISub(b),g=u.redMul(b.redISub(w)).redISub(o.redMul(l)),x=this.z.redMul(e.z).redMul(c);return this.curve.jpoint(w,g,x)},xt.prototype.mixedAdd=function(e){if(this.isInfinity())return e.toJ();if(e.isInfinity())return this;var r=this.z.redSqr(),i=this.x,n=e.x.redMul(r),s=this.y,o=e.y.redMul(r).redMul(this.z),a=i.redSub(n),c=s.redSub(o);if(a.cmpn(0)===0)return c.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var u=a.redSqr(),h=u.redMul(a),l=i.redMul(u),b=c.redSqr().redIAdd(h).redISub(l).redISub(l),w=c.redMul(l.redISub(b)).redISub(s.redMul(h)),g=this.z.redMul(a);return this.curve.jpoint(b,w,g)},xt.prototype.dblp=function(e){if(e===0)return this;if(this.isInfinity())return this;if(!e)return this.dbl();var r;if(this.curve.zeroA||this.curve.threeA){var i=this;for(r=0;r<e;r++)i=i.dbl();return i}var n=this.curve.a,s=this.curve.tinv,o=this.x,a=this.y,c=this.z,u=c.redSqr().redSqr(),h=a.redAdd(a);for(r=0;r<e;r++){var l=o.redSqr(),b=h.redSqr(),w=b.redSqr(),g=l.redAdd(l).redIAdd(l).redIAdd(n.redMul(u)),x=o.redMul(b),A=g.redSqr().redISub(x.redAdd(x)),D=x.redISub(A),$=g.redMul(D);$=$.redIAdd($).redISub(w);var P=h.redMul(c);r+1<e&&(u=u.redMul(w)),o=A,c=P,h=$}return this.curve.jpoint(o,h.redMul(s),c)},xt.prototype.dbl=function(){return this.isInfinity()?this:this.curve.zeroA?this._zeroDbl():this.curve.threeA?this._threeDbl():this._dbl()},xt.prototype._zeroDbl=function(){var e,r,i;if(this.zOne){var n=this.x.redSqr(),s=this.y.redSqr(),o=s.redSqr(),a=this.x.redAdd(s).redSqr().redISub(n).redISub(o);a=a.redIAdd(a);var c=n.redAdd(n).redIAdd(n),u=c.redSqr().redISub(a).redISub(a),h=o.redIAdd(o);h=h.redIAdd(h),h=h.redIAdd(h),e=u,r=c.redMul(a.redISub(u)).redISub(h),i=this.y.redAdd(this.y)}else{var l=this.x.redSqr(),b=this.y.redSqr(),w=b.redSqr(),g=this.x.redAdd(b).redSqr().redISub(l).redISub(w);g=g.redIAdd(g);var x=l.redAdd(l).redIAdd(l),A=x.redSqr(),D=w.redIAdd(w);D=D.redIAdd(D),D=D.redIAdd(D),e=A.redISub(g).redISub(g),r=x.redMul(g.redISub(e)).redISub(D),i=this.y.redMul(this.z),i=i.redIAdd(i)}return this.curve.jpoint(e,r,i)},xt.prototype._threeDbl=function(){var e,r,i;if(this.zOne){var n=this.x.redSqr(),s=this.y.redSqr(),o=s.redSqr(),a=this.x.redAdd(s).redSqr().redISub(n).redISub(o);a=a.redIAdd(a);var c=n.redAdd(n).redIAdd(n).redIAdd(this.curve.a),u=c.redSqr().redISub(a).redISub(a);e=u;var h=o.redIAdd(o);h=h.redIAdd(h),h=h.redIAdd(h),r=c.redMul(a.redISub(u)).redISub(h),i=this.y.redAdd(this.y)}else{var l=this.z.redSqr(),b=this.y.redSqr(),w=this.x.redMul(b),g=this.x.redSub(l).redMul(this.x.redAdd(l));g=g.redAdd(g).redIAdd(g);var x=w.redIAdd(w);x=x.redIAdd(x);var A=x.redAdd(x);e=g.redSqr().redISub(A),i=this.y.redAdd(this.z).redSqr().redISub(b).redISub(l);var D=b.redSqr();D=D.redIAdd(D),D=D.redIAdd(D),D=D.redIAdd(D),r=g.redMul(x.redISub(e)).redISub(D)}return this.curve.jpoint(e,r,i)},xt.prototype._dbl=function(){var e=this.curve.a,r=this.x,i=this.y,n=this.z,s=n.redSqr().redSqr(),o=r.redSqr(),a=i.redSqr(),c=o.redAdd(o).redIAdd(o).redIAdd(e.redMul(s)),u=r.redAdd(r);u=u.redIAdd(u);var h=u.redMul(a),l=c.redSqr().redISub(h.redAdd(h)),b=h.redISub(l),w=a.redSqr();w=w.redIAdd(w),w=w.redIAdd(w),w=w.redIAdd(w);var g=c.redMul(b).redISub(w),x=i.redAdd(i).redMul(n);return this.curve.jpoint(l,g,x)},xt.prototype.trpl=function(){if(!this.curve.zeroA)return this.dbl().add(this);var e=this.x.redSqr(),r=this.y.redSqr(),i=this.z.redSqr(),n=r.redSqr(),s=e.redAdd(e).redIAdd(e),o=s.redSqr(),a=this.x.redAdd(r).redSqr().redISub(e).redISub(n);a=a.redIAdd(a),a=a.redAdd(a).redIAdd(a),a=a.redISub(o);var c=a.redSqr(),u=n.redIAdd(n);u=u.redIAdd(u),u=u.redIAdd(u),u=u.redIAdd(u);var h=s.redIAdd(a).redSqr().redISub(o).redISub(c).redISub(u),l=r.redMul(h);l=l.redIAdd(l),l=l.redIAdd(l);var b=this.x.redMul(c).redISub(l);b=b.redIAdd(b),b=b.redIAdd(b);var w=this.y.redMul(h.redMul(u.redISub(h)).redISub(a.redMul(c)));w=w.redIAdd(w),w=w.redIAdd(w),w=w.redIAdd(w);var g=this.z.redAdd(a).redSqr().redISub(i).redISub(c);return this.curve.jpoint(b,w,g)},xt.prototype.mul=function(e,r){return e=new He(e,r),this.curve._wnafMul(this,e)},xt.prototype.eq=function(e){if(e.type==="affine")return this.eq(e.toJ());if(this===e)return!0;var r=this.z.redSqr(),i=e.z.redSqr();if(this.x.redMul(i).redISub(e.x.redMul(r)).cmpn(0)!==0)return!1;var n=r.redMul(this.z),s=i.redMul(e.z);return this.y.redMul(s).redISub(e.y.redMul(n)).cmpn(0)===0},xt.prototype.eqXToP=function(e){var r=this.z.redSqr(),i=e.toRed(this.curve.red).redMul(r);if(this.x.cmp(i)===0)return!0;for(var n=e.clone(),s=this.curve.redN.redMul(r);;){if(n.iadd(this.curve.n),n.cmp(this.curve.p)>=0)return!1;if(i.redIAdd(s),this.x.cmp(i)===0)return!0}},xt.prototype.inspect=function(){return this.isInfinity()?"<EC JPoint Infinity>":"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"},xt.prototype.isInfinity=function(){return this.z.cmpn(0)===0};var Fn=$r.exports,Bl=Cn.exports,ea=Qo,y8=Xt;function Ln(t){ea.call(this,"mont",t),this.a=new Fn(t.a,16).toRed(this.red),this.b=new Fn(t.b,16).toRed(this.red),this.i4=new Fn(4).toRed(this.red).redInvm(),this.two=new Fn(2).toRed(this.red),this.a24=this.i4.redMul(this.a.redAdd(this.two))}Bl(Ln,ea);var v8=Ln;Ln.prototype.validate=function(e){var r=e.normalize().x,i=r.redSqr(),n=i.redMul(r).redAdd(i.redMul(this.a)).redAdd(r),s=n.redSqrt();return s.redSqr().cmp(n)===0};function gt(t,e,r){ea.BasePoint.call(this,t,"projective"),e===null&&r===null?(this.x=this.curve.one,this.z=this.curve.zero):(this.x=new Fn(e,16),this.z=new Fn(r,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)))}Bl(gt,ea.BasePoint),Ln.prototype.decodePoint=function(e,r){return this.point(y8.toArray(e,r),1)},Ln.prototype.point=function(e,r){return new gt(this,e,r)},Ln.prototype.pointFromJSON=function(e){return gt.fromJSON(this,e)},gt.prototype.precompute=function(){},gt.prototype._encode=function(){return this.getX().toArray("be",this.curve.p.byteLength())},gt.fromJSON=function(e,r){return new gt(e,r[0],r[1]||e.one)},gt.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},gt.prototype.isInfinity=function(){return this.z.cmpn(0)===0},gt.prototype.dbl=function(){var e=this.x.redAdd(this.z),r=e.redSqr(),i=this.x.redSub(this.z),n=i.redSqr(),s=r.redSub(n),o=r.redMul(n),a=s.redMul(n.redAdd(this.curve.a24.redMul(s)));return this.curve.point(o,a)},gt.prototype.add=function(){throw new Error("Not supported on Montgomery curve")},gt.prototype.diffAdd=function(e,r){var i=this.x.redAdd(this.z),n=this.x.redSub(this.z),s=e.x.redAdd(e.z),o=e.x.redSub(e.z),a=o.redMul(i),c=s.redMul(n),u=r.z.redMul(a.redAdd(c).redSqr()),h=r.x.redMul(a.redISub(c).redSqr());return this.curve.point(u,h)},gt.prototype.mul=function(e){for(var r=e.clone(),i=this,n=this.curve.point(null,null),s=this,o=[];r.cmpn(0)!==0;r.iushrn(1))o.push(r.andln(1));for(var a=o.length-1;a>=0;a--)o[a]===0?(i=i.diffAdd(n,s),n=n.dbl()):(n=i.diffAdd(n,s),i=i.dbl());return n},gt.prototype.mulAdd=function(){throw new Error("Not supported on Montgomery curve")},gt.prototype.jumlAdd=function(){throw new Error("Not supported on Montgomery curve")},gt.prototype.eq=function(e){return this.getX().cmp(e.getX())===0},gt.prototype.normalize=function(){return this.x=this.x.redMul(this.z.redInvm()),this.z=this.curve.one,this},gt.prototype.getX=function(){return this.normalize(),this.x.fromRed()};var m8=Xt,ei=$r.exports,Fl=Cn.exports,ta=Qo,w8=m8.assert;function Pr(t){this.twisted=(t.a|0)!==1,this.mOneA=this.twisted&&(t.a|0)===-1,this.extended=this.mOneA,ta.call(this,"edwards",t),this.a=new ei(t.a,16).umod(this.red.m),this.a=this.a.toRed(this.red),this.c=new ei(t.c,16).toRed(this.red),this.c2=this.c.redSqr(),this.d=new ei(t.d,16).toRed(this.red),this.dd=this.d.redAdd(this.d),w8(!this.twisted||this.c.fromRed().cmpn(1)===0),this.oneC=(t.c|0)===1}Fl(Pr,ta);var _8=Pr;Pr.prototype._mulA=function(e){return this.mOneA?e.redNeg():this.a.redMul(e)},Pr.prototype._mulC=function(e){return this.oneC?e:this.c.redMul(e)},Pr.prototype.jpoint=function(e,r,i,n){return this.point(e,r,i,n)},Pr.prototype.pointFromX=function(e,r){e=new ei(e,16),e.red||(e=e.toRed(this.red));var i=e.redSqr(),n=this.c2.redSub(this.a.redMul(i)),s=this.one.redSub(this.c2.redMul(this.d).redMul(i)),o=n.redMul(s.redInvm()),a=o.redSqrt();if(a.redSqr().redSub(o).cmp(this.zero)!==0)throw new Error("invalid point");var c=a.fromRed().isOdd();return(r&&!c||!r&&c)&&(a=a.redNeg()),this.point(e,a)},Pr.prototype.pointFromY=function(e,r){e=new ei(e,16),e.red||(e=e.toRed(this.red));var i=e.redSqr(),n=i.redSub(this.c2),s=i.redMul(this.d).redMul(this.c2).redSub(this.a),o=n.redMul(s.redInvm());if(o.cmp(this.zero)===0){if(r)throw new Error("invalid point");return this.point(this.zero,e)}var a=o.redSqrt();if(a.redSqr().redSub(o).cmp(this.zero)!==0)throw new Error("invalid point");return a.fromRed().isOdd()!==r&&(a=a.redNeg()),this.point(a,e)},Pr.prototype.validate=function(e){if(e.isInfinity())return!0;e.normalize();var r=e.x.redSqr(),i=e.y.redSqr(),n=r.redMul(this.a).redAdd(i),s=this.c2.redMul(this.one.redAdd(this.d.redMul(r).redMul(i)));return n.cmp(s)===0};function me(t,e,r,i,n){ta.BasePoint.call(this,t,"projective"),e===null&&r===null&&i===null?(this.x=this.curve.zero,this.y=this.curve.one,this.z=this.curve.one,this.t=this.curve.zero,this.zOne=!0):(this.x=new ei(e,16),this.y=new ei(r,16),this.z=i?new ei(i,16):this.curve.one,this.t=n&&new ei(n,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.t&&!this.t.red&&(this.t=this.t.toRed(this.curve.red)),this.zOne=this.z===this.curve.one,this.curve.extended&&!this.t&&(this.t=this.x.redMul(this.y),this.zOne||(this.t=this.t.redMul(this.z.redInvm()))))}Fl(me,ta.BasePoint),Pr.prototype.pointFromJSON=function(e){return me.fromJSON(this,e)},Pr.prototype.point=function(e,r,i,n){return new me(this,e,r,i,n)},me.fromJSON=function(e,r){return new me(e,r[0],r[1],r[2])},me.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},me.prototype.isInfinity=function(){return this.x.cmpn(0)===0&&(this.y.cmp(this.z)===0||this.zOne&&this.y.cmp(this.curve.c)===0)},me.prototype._extDbl=function(){var e=this.x.redSqr(),r=this.y.redSqr(),i=this.z.redSqr();i=i.redIAdd(i);var n=this.curve._mulA(e),s=this.x.redAdd(this.y).redSqr().redISub(e).redISub(r),o=n.redAdd(r),a=o.redSub(i),c=n.redSub(r),u=s.redMul(a),h=o.redMul(c),l=s.redMul(c),b=a.redMul(o);return this.curve.point(u,h,b,l)},me.prototype._projDbl=function(){var e=this.x.redAdd(this.y).redSqr(),r=this.x.redSqr(),i=this.y.redSqr(),n,s,o,a,c,u;if(this.curve.twisted){a=this.curve._mulA(r);var h=a.redAdd(i);this.zOne?(n=e.redSub(r).redSub(i).redMul(h.redSub(this.curve.two)),s=h.redMul(a.redSub(i)),o=h.redSqr().redSub(h).redSub(h)):(c=this.z.redSqr(),u=h.redSub(c).redISub(c),n=e.redSub(r).redISub(i).redMul(u),s=h.redMul(a.redSub(i)),o=h.redMul(u))}else a=r.redAdd(i),c=this.curve._mulC(this.z).redSqr(),u=a.redSub(c).redSub(c),n=this.curve._mulC(e.redISub(a)).redMul(u),s=this.curve._mulC(a).redMul(r.redISub(i)),o=a.redMul(u);return this.curve.point(n,s,o)},me.prototype.dbl=function(){return this.isInfinity()?this:this.curve.extended?this._extDbl():this._projDbl()},me.prototype._extAdd=function(e){var r=this.y.redSub(this.x).redMul(e.y.redSub(e.x)),i=this.y.redAdd(this.x).redMul(e.y.redAdd(e.x)),n=this.t.redMul(this.curve.dd).redMul(e.t),s=this.z.redMul(e.z.redAdd(e.z)),o=i.redSub(r),a=s.redSub(n),c=s.redAdd(n),u=i.redAdd(r),h=o.redMul(a),l=c.redMul(u),b=o.redMul(u),w=a.redMul(c);return this.curve.point(h,l,w,b)},me.prototype._projAdd=function(e){var r=this.z.redMul(e.z),i=r.redSqr(),n=this.x.redMul(e.x),s=this.y.redMul(e.y),o=this.curve.d.redMul(n).redMul(s),a=i.redSub(o),c=i.redAdd(o),u=this.x.redAdd(this.y).redMul(e.x.redAdd(e.y)).redISub(n).redISub(s),h=r.redMul(a).redMul(u),l,b;return this.curve.twisted?(l=r.redMul(c).redMul(s.redSub(this.curve._mulA(n))),b=a.redMul(c)):(l=r.redMul(c).redMul(s.redSub(n)),b=this.curve._mulC(a).redMul(c)),this.curve.point(h,l,b)},me.prototype.add=function(e){return this.isInfinity()?e:e.isInfinity()?this:this.curve.extended?this._extAdd(e):this._projAdd(e)},me.prototype.mul=function(e){return this._hasDoubles(e)?this.curve._fixedNafMul(this,e):this.curve._wnafMul(this,e)},me.prototype.mulAdd=function(e,r,i){return this.curve._wnafMulAdd(1,[this,r],[e,i],2,!1)},me.prototype.jmulAdd=function(e,r,i){return this.curve._wnafMulAdd(1,[this,r],[e,i],2,!0)},me.prototype.normalize=function(){if(this.zOne)return this;var e=this.z.redInvm();return this.x=this.x.redMul(e),this.y=this.y.redMul(e),this.t&&(this.t=this.t.redMul(e)),this.z=this.curve.one,this.zOne=!0,this},me.prototype.neg=function(){return this.curve.point(this.x.redNeg(),this.y,this.z,this.t&&this.t.redNeg())},me.prototype.getX=function(){return this.normalize(),this.x.fromRed()},me.prototype.getY=function(){return this.normalize(),this.y.fromRed()},me.prototype.eq=function(e){return this===e||this.getX().cmp(e.getX())===0&&this.getY().cmp(e.getY())===0},me.prototype.eqXToP=function(e){var r=e.toRed(this.curve.red).redMul(this.z);if(this.x.cmp(r)===0)return!0;for(var i=e.clone(),n=this.curve.redN.redMul(this.z);;){if(i.iadd(this.curve.n),i.cmp(this.curve.p)>=0)return!1;if(r.redIAdd(n),this.x.cmp(r)===0)return!0}},me.prototype.toP=me.prototype.normalize,me.prototype.mixedAdd=me.prototype.add,function(t){var e=t;e.base=Qo,e.short=g8,e.mont=v8,e.edwards=_8}(fu);var ra={},ia={},ne={},E8=Ki,x8=Cn.exports;ne.inherits=x8;function S8(t,e){return(t.charCodeAt(e)&64512)!==55296||e<0||e+1>=t.length?!1:(t.charCodeAt(e+1)&64512)===56320}function I8(t,e){if(Array.isArray(t))return t.slice();if(!t)return[];var r=[];if(typeof t=="string")if(e){if(e==="hex")for(t=t.replace(/[^a-z0-9]+/ig,""),t.length%2!==0&&(t="0"+t),n=0;n<t.length;n+=2)r.push(parseInt(t[n]+t[n+1],16))}else for(var i=0,n=0;n<t.length;n++){var s=t.charCodeAt(n);s<128?r[i++]=s:s<2048?(r[i++]=s>>6|192,r[i++]=s&63|128):S8(t,n)?(s=65536+((s&1023)<<10)+(t.charCodeAt(++n)&1023),r[i++]=s>>18|240,r[i++]=s>>12&63|128,r[i++]=s>>6&63|128,r[i++]=s&63|128):(r[i++]=s>>12|224,r[i++]=s>>6&63|128,r[i++]=s&63|128)}else for(n=0;n<t.length;n++)r[n]=t[n]|0;return r}ne.toArray=I8;function A8(t){for(var e="",r=0;r<t.length;r++)e+=ql(t[r].toString(16));return e}ne.toHex=A8;function Ll(t){var e=t>>>24|t>>>8&65280|t<<8&16711680|(t&255)<<24;return e>>>0}ne.htonl=Ll;function D8(t,e){for(var r="",i=0;i<t.length;i++){var n=t[i];e==="little"&&(n=Ll(n)),r+=zl(n.toString(16))}return r}ne.toHex32=D8;function ql(t){return t.length===1?"0"+t:t}ne.zero2=ql;function zl(t){return t.length===7?"0"+t:t.length===6?"00"+t:t.length===5?"000"+t:t.length===4?"0000"+t:t.length===3?"00000"+t:t.length===2?"000000"+t:t.length===1?"0000000"+t:t}ne.zero8=zl;function O8(t,e,r,i){var n=r-e;E8(n%4===0);for(var s=new Array(n/4),o=0,a=e;o<s.length;o++,a+=4){var c;i==="big"?c=t[a]<<24|t[a+1]<<16|t[a+2]<<8|t[a+3]:c=t[a+3]<<24|t[a+2]<<16|t[a+1]<<8|t[a],s[o]=c>>>0}return s}ne.join32=O8;function M8(t,e){for(var r=new Array(t.length*4),i=0,n=0;i<t.length;i++,n+=4){var s=t[i];e==="big"?(r[n]=s>>>24,r[n+1]=s>>>16&255,r[n+2]=s>>>8&255,r[n+3]=s&255):(r[n+3]=s>>>24,r[n+2]=s>>>16&255,r[n+1]=s>>>8&255,r[n]=s&255)}return r}ne.split32=M8;function $8(t,e){return t>>>e|t<<32-e}ne.rotr32=$8;function P8(t,e){return t<<e|t>>>32-e}ne.rotl32=P8;function T8(t,e){return t+e>>>0}ne.sum32=T8;function R8(t,e,r){return t+e+r>>>0}ne.sum32_3=R8;function N8(t,e,r,i){return t+e+r+i>>>0}ne.sum32_4=N8;function C8(t,e,r,i,n){return t+e+r+i+n>>>0}ne.sum32_5=C8;function B8(t,e,r,i){var n=t[e],s=t[e+1],o=i+s>>>0,a=(o<i?1:0)+r+n;t[e]=a>>>0,t[e+1]=o}ne.sum64=B8;function F8(t,e,r,i){var n=e+i>>>0,s=(n<e?1:0)+t+r;return s>>>0}ne.sum64_hi=F8;function L8(t,e,r,i){var n=e+i;return n>>>0}ne.sum64_lo=L8;function q8(t,e,r,i,n,s,o,a){var c=0,u=e;u=u+i>>>0,c+=u<e?1:0,u=u+s>>>0,c+=u<s?1:0,u=u+a>>>0,c+=u<a?1:0;var h=t+r+n+o+c;return h>>>0}ne.sum64_4_hi=q8;function z8(t,e,r,i,n,s,o,a){var c=e+i+s+a;return c>>>0}ne.sum64_4_lo=z8;function U8(t,e,r,i,n,s,o,a,c,u){var h=0,l=e;l=l+i>>>0,h+=l<e?1:0,l=l+s>>>0,h+=l<s?1:0,l=l+a>>>0,h+=l<a?1:0,l=l+u>>>0,h+=l<u?1:0;var b=t+r+n+o+c+h;return b>>>0}ne.sum64_5_hi=U8;function k8(t,e,r,i,n,s,o,a,c,u){var h=e+i+s+a+u;return h>>>0}ne.sum64_5_lo=k8;function j8(t,e,r){var i=e<<32-r|t>>>r;return i>>>0}ne.rotr64_hi=j8;function K8(t,e,r){var i=t<<32-r|e>>>r;return i>>>0}ne.rotr64_lo=K8;function V8(t,e,r){return t>>>r}ne.shr64_hi=V8;function H8(t,e,r){var i=t<<32-r|e>>>r;return i>>>0}ne.shr64_lo=H8;var qn={},Ul=ne,G8=Ki;function na(){this.pending=null,this.pendingTotal=0,this.blockSize=this.constructor.blockSize,this.outSize=this.constructor.outSize,this.hmacStrength=this.constructor.hmacStrength,this.padLength=this.constructor.padLength/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}qn.BlockHash=na,na.prototype.update=function(e,r){if(e=Ul.toArray(e,r),this.pending?this.pending=this.pending.concat(e):this.pending=e,this.pendingTotal+=e.length,this.pending.length>=this._delta8){e=this.pending;var i=e.length%this._delta8;this.pending=e.slice(e.length-i,e.length),this.pending.length===0&&(this.pending=null),e=Ul.join32(e,0,e.length-i,this.endian);for(var n=0;n<e.length;n+=this._delta32)this._update(e,n,n+this._delta32)}return this},na.prototype.digest=function(e){return this.update(this._pad()),G8(this.pending===null),this._digest(e)},na.prototype._pad=function(){var e=this.pendingTotal,r=this._delta8,i=r-(e+this.padLength)%r,n=new Array(i+this.padLength);n[0]=128;for(var s=1;s<i;s++)n[s]=0;if(e<<=3,this.endian==="big"){for(var o=8;o<this.padLength;o++)n[s++]=0;n[s++]=0,n[s++]=0,n[s++]=0,n[s++]=0,n[s++]=e>>>24&255,n[s++]=e>>>16&255,n[s++]=e>>>8&255,n[s++]=e&255}else for(n[s++]=e&255,n[s++]=e>>>8&255,n[s++]=e>>>16&255,n[s++]=e>>>24&255,n[s++]=0,n[s++]=0,n[s++]=0,n[s++]=0,o=8;o<this.padLength;o++)n[s++]=0;return n};var zn={},Tr={},W8=ne,Rr=W8.rotr32;function Y8(t,e,r,i){if(t===0)return kl(e,r,i);if(t===1||t===3)return Kl(e,r,i);if(t===2)return jl(e,r,i)}Tr.ft_1=Y8;function kl(t,e,r){return t&e^~t&r}Tr.ch32=kl;function jl(t,e,r){return t&e^t&r^e&r}Tr.maj32=jl;function Kl(t,e,r){return t^e^r}Tr.p32=Kl;function X8(t){return Rr(t,2)^Rr(t,13)^Rr(t,22)}Tr.s0_256=X8;function Z8(t){return Rr(t,6)^Rr(t,11)^Rr(t,25)}Tr.s1_256=Z8;function J8(t){return Rr(t,7)^Rr(t,18)^t>>>3}Tr.g0_256=J8;function Q8(t){return Rr(t,17)^Rr(t,19)^t>>>10}Tr.g1_256=Q8;var Un=ne,e4=qn,t4=Tr,du=Un.rotl32,Ss=Un.sum32,r4=Un.sum32_5,i4=t4.ft_1,Vl=e4.BlockHash,n4=[1518500249,1859775393,2400959708,3395469782];function Nr(){if(!(this instanceof Nr))return new Nr;Vl.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.W=new Array(80)}Un.inherits(Nr,Vl);var s4=Nr;Nr.blockSize=512,Nr.outSize=160,Nr.hmacStrength=80,Nr.padLength=64,Nr.prototype._update=function(e,r){for(var i=this.W,n=0;n<16;n++)i[n]=e[r+n];for(;n<i.length;n++)i[n]=du(i[n-3]^i[n-8]^i[n-14]^i[n-16],1);var s=this.h[0],o=this.h[1],a=this.h[2],c=this.h[3],u=this.h[4];for(n=0;n<i.length;n++){var h=~~(n/20),l=r4(du(s,5),i4(h,o,a,c),u,i[n],n4[h]);u=c,c=a,a=du(o,30),o=s,s=l}this.h[0]=Ss(this.h[0],s),this.h[1]=Ss(this.h[1],o),this.h[2]=Ss(this.h[2],a),this.h[3]=Ss(this.h[3],c),this.h[4]=Ss(this.h[4],u)},Nr.prototype._digest=function(e){return e==="hex"?Un.toHex32(this.h,"big"):Un.split32(this.h,"big")};var kn=ne,o4=qn,jn=Tr,a4=Ki,br=kn.sum32,c4=kn.sum32_4,u4=kn.sum32_5,f4=jn.ch32,h4=jn.maj32,d4=jn.s0_256,l4=jn.s1_256,p4=jn.g0_256,b4=jn.g1_256,Hl=o4.BlockHash,g4=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function Cr(){if(!(this instanceof Cr))return new Cr;Hl.call(this),this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.k=g4,this.W=new Array(64)}kn.inherits(Cr,Hl);var Gl=Cr;Cr.blockSize=512,Cr.outSize=256,Cr.hmacStrength=192,Cr.padLength=64,Cr.prototype._update=function(e,r){for(var i=this.W,n=0;n<16;n++)i[n]=e[r+n];for(;n<i.length;n++)i[n]=c4(b4(i[n-2]),i[n-7],p4(i[n-15]),i[n-16]);var s=this.h[0],o=this.h[1],a=this.h[2],c=this.h[3],u=this.h[4],h=this.h[5],l=this.h[6],b=this.h[7];for(a4(this.k.length===i.length),n=0;n<i.length;n++){var w=u4(b,l4(u),f4(u,h,l),this.k[n],i[n]),g=br(d4(s),h4(s,o,a));b=l,l=h,h=u,u=br(c,w),c=a,a=o,o=s,s=br(w,g)}this.h[0]=br(this.h[0],s),this.h[1]=br(this.h[1],o),this.h[2]=br(this.h[2],a),this.h[3]=br(this.h[3],c),this.h[4]=br(this.h[4],u),this.h[5]=br(this.h[5],h),this.h[6]=br(this.h[6],l),this.h[7]=br(this.h[7],b)},Cr.prototype._digest=function(e){return e==="hex"?kn.toHex32(this.h,"big"):kn.split32(this.h,"big")};var lu=ne,Wl=Gl;function ti(){if(!(this instanceof ti))return new ti;Wl.call(this),this.h=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]}lu.inherits(ti,Wl);var y4=ti;ti.blockSize=512,ti.outSize=224,ti.hmacStrength=192,ti.padLength=64,ti.prototype._digest=function(e){return e==="hex"?lu.toHex32(this.h.slice(0,7),"big"):lu.split32(this.h.slice(0,7),"big")};var Kt=ne,v4=qn,m4=Ki,Br=Kt.rotr64_hi,Fr=Kt.rotr64_lo,Yl=Kt.shr64_hi,Xl=Kt.shr64_lo,_i=Kt.sum64,pu=Kt.sum64_hi,bu=Kt.sum64_lo,w4=Kt.sum64_4_hi,_4=Kt.sum64_4_lo,E4=Kt.sum64_5_hi,x4=Kt.sum64_5_lo,Zl=v4.BlockHash,S4=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function gr(){if(!(this instanceof gr))return new gr;Zl.call(this),this.h=[1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209],this.k=S4,this.W=new Array(160)}Kt.inherits(gr,Zl);var Jl=gr;gr.blockSize=1024,gr.outSize=512,gr.hmacStrength=192,gr.padLength=128,gr.prototype._prepareBlock=function(e,r){for(var i=this.W,n=0;n<32;n++)i[n]=e[r+n];for(;n<i.length;n+=2){var s=C4(i[n-4],i[n-3]),o=B4(i[n-4],i[n-3]),a=i[n-14],c=i[n-13],u=R4(i[n-30],i[n-29]),h=N4(i[n-30],i[n-29]),l=i[n-32],b=i[n-31];i[n]=w4(s,o,a,c,u,h,l,b),i[n+1]=_4(s,o,a,c,u,h,l,b)}},gr.prototype._update=function(e,r){this._prepareBlock(e,r);var i=this.W,n=this.h[0],s=this.h[1],o=this.h[2],a=this.h[3],c=this.h[4],u=this.h[5],h=this.h[6],l=this.h[7],b=this.h[8],w=this.h[9],g=this.h[10],x=this.h[11],A=this.h[12],D=this.h[13],$=this.h[14],P=this.h[15];m4(this.k.length===i.length);for(var T=0;T<i.length;T+=2){var N=$,L=P,F=P4(b,w),B=T4(b,w),C=I4(b,w,g,x,A),G=A4(b,w,g,x,A,D),I=this.k[T],f=this.k[T+1],p=i[T],v=i[T+1],y=E4(N,L,F,B,C,G,I,f,p,v),m=x4(N,L,F,B,C,G,I,f,p,v);N=M4(n,s),L=$4(n,s),F=D4(n,s,o,a,c),B=O4(n,s,o,a,c,u);var S=pu(N,L,F,B),O=bu(N,L,F,B);$=A,P=D,A=g,D=x,g=b,x=w,b=pu(h,l,y,m),w=bu(l,l,y,m),h=c,l=u,c=o,u=a,o=n,a=s,n=pu(y,m,S,O),s=bu(y,m,S,O)}_i(this.h,0,n,s),_i(this.h,2,o,a),_i(this.h,4,c,u),_i(this.h,6,h,l),_i(this.h,8,b,w),_i(this.h,10,g,x),_i(this.h,12,A,D),_i(this.h,14,$,P)},gr.prototype._digest=function(e){return e==="hex"?Kt.toHex32(this.h,"big"):Kt.split32(this.h,"big")};function I4(t,e,r,i,n){var s=t&r^~t&n;return s<0&&(s+=4294967296),s}function A4(t,e,r,i,n,s){var o=e&i^~e&s;return o<0&&(o+=4294967296),o}function D4(t,e,r,i,n){var s=t&r^t&n^r&n;return s<0&&(s+=4294967296),s}function O4(t,e,r,i,n,s){var o=e&i^e&s^i&s;return o<0&&(o+=4294967296),o}function M4(t,e){var r=Br(t,e,28),i=Br(e,t,2),n=Br(e,t,7),s=r^i^n;return s<0&&(s+=4294967296),s}function $4(t,e){var r=Fr(t,e,28),i=Fr(e,t,2),n=Fr(e,t,7),s=r^i^n;return s<0&&(s+=4294967296),s}function P4(t,e){var r=Br(t,e,14),i=Br(t,e,18),n=Br(e,t,9),s=r^i^n;return s<0&&(s+=4294967296),s}function T4(t,e){var r=Fr(t,e,14),i=Fr(t,e,18),n=Fr(e,t,9),s=r^i^n;return s<0&&(s+=4294967296),s}function R4(t,e){var r=Br(t,e,1),i=Br(t,e,8),n=Yl(t,e,7),s=r^i^n;return s<0&&(s+=4294967296),s}function N4(t,e){var r=Fr(t,e,1),i=Fr(t,e,8),n=Xl(t,e,7),s=r^i^n;return s<0&&(s+=4294967296),s}function C4(t,e){var r=Br(t,e,19),i=Br(e,t,29),n=Yl(t,e,6),s=r^i^n;return s<0&&(s+=4294967296),s}function B4(t,e){var r=Fr(t,e,19),i=Fr(e,t,29),n=Xl(t,e,6),s=r^i^n;return s<0&&(s+=4294967296),s}var gu=ne,Ql=Jl;function ri(){if(!(this instanceof ri))return new ri;Ql.call(this),this.h=[3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]}gu.inherits(ri,Ql);var F4=ri;ri.blockSize=1024,ri.outSize=384,ri.hmacStrength=192,ri.padLength=128,ri.prototype._digest=function(e){return e==="hex"?gu.toHex32(this.h.slice(0,12),"big"):gu.split32(this.h.slice(0,12),"big")},zn.sha1=s4,zn.sha224=y4,zn.sha256=Gl,zn.sha384=F4,zn.sha512=Jl;var e0={},Hi=ne,L4=qn,sa=Hi.rotl32,t0=Hi.sum32,Is=Hi.sum32_3,r0=Hi.sum32_4,i0=L4.BlockHash;function Lr(){if(!(this instanceof Lr))return new Lr;i0.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.endian="little"}Hi.inherits(Lr,i0),e0.ripemd160=Lr,Lr.blockSize=512,Lr.outSize=160,Lr.hmacStrength=192,Lr.padLength=64,Lr.prototype._update=function(e,r){for(var i=this.h[0],n=this.h[1],s=this.h[2],o=this.h[3],a=this.h[4],c=i,u=n,h=s,l=o,b=a,w=0;w<80;w++){var g=t0(sa(r0(i,n0(w,n,s,o),e[U4[w]+r],q4(w)),j4[w]),a);i=a,a=o,o=sa(s,10),s=n,n=g,g=t0(sa(r0(c,n0(79-w,u,h,l),e[k4[w]+r],z4(w)),K4[w]),b),c=b,b=l,l=sa(h,10),h=u,u=g}g=Is(this.h[1],s,l),this.h[1]=Is(this.h[2],o,b),this.h[2]=Is(this.h[3],a,c),this.h[3]=Is(this.h[4],i,u),this.h[4]=Is(this.h[0],n,h),this.h[0]=g},Lr.prototype._digest=function(e){return e==="hex"?Hi.toHex32(this.h,"little"):Hi.split32(this.h,"little")};function n0(t,e,r,i){return t<=15?e^r^i:t<=31?e&r|~e&i:t<=47?(e|~r)^i:t<=63?e&i|r&~i:e^(r|~i)}function q4(t){return t<=15?0:t<=31?1518500249:t<=47?1859775393:t<=63?2400959708:2840853838}function z4(t){return t<=15?1352829926:t<=31?1548603684:t<=47?1836072691:t<=63?2053994217:0}var U4=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],k4=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],j4=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],K4=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11],V4=ne,H4=Ki;function Kn(t,e,r){if(!(this instanceof Kn))return new Kn(t,e,r);this.Hash=t,this.blockSize=t.blockSize/8,this.outSize=t.outSize/8,this.inner=null,this.outer=null,this._init(V4.toArray(e,r))}var G4=Kn;Kn.prototype._init=function(e){e.length>this.blockSize&&(e=new this.Hash().update(e).digest()),H4(e.length<=this.blockSize);for(var r=e.length;r<this.blockSize;r++)e.push(0);for(r=0;r<e.length;r++)e[r]^=54;for(this.inner=new this.Hash().update(e),r=0;r<e.length;r++)e[r]^=106;this.outer=new this.Hash().update(e)},Kn.prototype.update=function(e,r){return this.inner.update(e,r),this},Kn.prototype.digest=function(e){return this.outer.update(this.inner.digest()),this.outer.digest(e)},function(t){var e=t;e.utils=ne,e.common=qn,e.sha=zn,e.ripemd=e0,e.hmac=G4,e.sha1=e.sha.sha1,e.sha256=e.sha.sha256,e.sha224=e.sha.sha224,e.sha384=e.sha.sha384,e.sha512=e.sha.sha512,e.ripemd160=e.ripemd.ripemd160}(ia);var yu,s0;function W4(){return s0||(s0=1,yu={doubles:{step:4,points:[["e60fce93b59e9ec53011aabc21c23e97b2a31369b87a5ae9c44ee89e2a6dec0a","f7e3507399e595929db99f34f57937101296891e44d23f0be1f32cce69616821"],["8282263212c609d9ea2a6e3e172de238d8c39cabd5ac1ca10646e23fd5f51508","11f8a8098557dfe45e8256e830b60ace62d613ac2f7b17bed31b6eaff6e26caf"],["175e159f728b865a72f99cc6c6fc846de0b93833fd2222ed73fce5b551e5b739","d3506e0d9e3c79eba4ef97a51ff71f5eacb5955add24345c6efa6ffee9fed695"],["363d90d447b00c9c99ceac05b6262ee053441c7e55552ffe526bad8f83ff4640","4e273adfc732221953b445397f3363145b9a89008199ecb62003c7f3bee9de9"],["8b4b5f165df3c2be8c6244b5b745638843e4a781a15bcd1b69f79a55dffdf80c","4aad0a6f68d308b4b3fbd7813ab0da04f9e336546162ee56b3eff0c65fd4fd36"],["723cbaa6e5db996d6bf771c00bd548c7b700dbffa6c0e77bcb6115925232fcda","96e867b5595cc498a921137488824d6e2660a0653779494801dc069d9eb39f5f"],["eebfa4d493bebf98ba5feec812c2d3b50947961237a919839a533eca0e7dd7fa","5d9a8ca3970ef0f269ee7edaf178089d9ae4cdc3a711f712ddfd4fdae1de8999"],["100f44da696e71672791d0a09b7bde459f1215a29b3c03bfefd7835b39a48db0","cdd9e13192a00b772ec8f3300c090666b7ff4a18ff5195ac0fbd5cd62bc65a09"],["e1031be262c7ed1b1dc9227a4a04c017a77f8d4464f3b3852c8acde6e534fd2d","9d7061928940405e6bb6a4176597535af292dd419e1ced79a44f18f29456a00d"],["feea6cae46d55b530ac2839f143bd7ec5cf8b266a41d6af52d5e688d9094696d","e57c6b6c97dce1bab06e4e12bf3ecd5c981c8957cc41442d3155debf18090088"],["da67a91d91049cdcb367be4be6ffca3cfeed657d808583de33fa978bc1ec6cb1","9bacaa35481642bc41f463f7ec9780e5dec7adc508f740a17e9ea8e27a68be1d"],["53904faa0b334cdda6e000935ef22151ec08d0f7bb11069f57545ccc1a37b7c0","5bc087d0bc80106d88c9eccac20d3c1c13999981e14434699dcb096b022771c8"],["8e7bcd0bd35983a7719cca7764ca906779b53a043a9b8bcaeff959f43ad86047","10b7770b2a3da4b3940310420ca9514579e88e2e47fd68b3ea10047e8460372a"],["385eed34c1cdff21e6d0818689b81bde71a7f4f18397e6690a841e1599c43862","283bebc3e8ea23f56701de19e9ebf4576b304eec2086dc8cc0458fe5542e5453"],["6f9d9b803ecf191637c73a4413dfa180fddf84a5947fbc9c606ed86c3fac3a7","7c80c68e603059ba69b8e2a30e45c4d47ea4dd2f5c281002d86890603a842160"],["3322d401243c4e2582a2147c104d6ecbf774d163db0f5e5313b7e0e742d0e6bd","56e70797e9664ef5bfb019bc4ddaf9b72805f63ea2873af624f3a2e96c28b2a0"],["85672c7d2de0b7da2bd1770d89665868741b3f9af7643397721d74d28134ab83","7c481b9b5b43b2eb6374049bfa62c2e5e77f17fcc5298f44c8e3094f790313a6"],["948bf809b1988a46b06c9f1919413b10f9226c60f668832ffd959af60c82a0a","53a562856dcb6646dc6b74c5d1c3418c6d4dff08c97cd2bed4cb7f88d8c8e589"],["6260ce7f461801c34f067ce0f02873a8f1b0e44dfc69752accecd819f38fd8e8","bc2da82b6fa5b571a7f09049776a1ef7ecd292238051c198c1a84e95b2b4ae17"],["e5037de0afc1d8d43d8348414bbf4103043ec8f575bfdc432953cc8d2037fa2d","4571534baa94d3b5f9f98d09fb990bddbd5f5b03ec481f10e0e5dc841d755bda"],["e06372b0f4a207adf5ea905e8f1771b4e7e8dbd1c6a6c5b725866a0ae4fce725","7a908974bce18cfe12a27bb2ad5a488cd7484a7787104870b27034f94eee31dd"],["213c7a715cd5d45358d0bbf9dc0ce02204b10bdde2a3f58540ad6908d0559754","4b6dad0b5ae462507013ad06245ba190bb4850f5f36a7eeddff2c27534b458f2"],["4e7c272a7af4b34e8dbb9352a5419a87e2838c70adc62cddf0cc3a3b08fbd53c","17749c766c9d0b18e16fd09f6def681b530b9614bff7dd33e0b3941817dcaae6"],["fea74e3dbe778b1b10f238ad61686aa5c76e3db2be43057632427e2840fb27b6","6e0568db9b0b13297cf674deccb6af93126b596b973f7b77701d3db7f23cb96f"],["76e64113f677cf0e10a2570d599968d31544e179b760432952c02a4417bdde39","c90ddf8dee4e95cf577066d70681f0d35e2a33d2b56d2032b4b1752d1901ac01"],["c738c56b03b2abe1e8281baa743f8f9a8f7cc643df26cbee3ab150242bcbb891","893fb578951ad2537f718f2eacbfbbbb82314eef7880cfe917e735d9699a84c3"],["d895626548b65b81e264c7637c972877d1d72e5f3a925014372e9f6588f6c14b","febfaa38f2bc7eae728ec60818c340eb03428d632bb067e179363ed75d7d991f"],["b8da94032a957518eb0f6433571e8761ceffc73693e84edd49150a564f676e03","2804dfa44805a1e4d7c99cc9762808b092cc584d95ff3b511488e4e74efdf6e7"],["e80fea14441fb33a7d8adab9475d7fab2019effb5156a792f1a11778e3c0df5d","eed1de7f638e00771e89768ca3ca94472d155e80af322ea9fcb4291b6ac9ec78"],["a301697bdfcd704313ba48e51d567543f2a182031efd6915ddc07bbcc4e16070","7370f91cfb67e4f5081809fa25d40f9b1735dbf7c0a11a130c0d1a041e177ea1"],["90ad85b389d6b936463f9d0512678de208cc330b11307fffab7ac63e3fb04ed4","e507a3620a38261affdcbd9427222b839aefabe1582894d991d4d48cb6ef150"],["8f68b9d2f63b5f339239c1ad981f162ee88c5678723ea3351b7b444c9ec4c0da","662a9f2dba063986de1d90c2b6be215dbbea2cfe95510bfdf23cbf79501fff82"],["e4f3fb0176af85d65ff99ff9198c36091f48e86503681e3e6686fd5053231e11","1e63633ad0ef4f1c1661a6d0ea02b7286cc7e74ec951d1c9822c38576feb73bc"],["8c00fa9b18ebf331eb961537a45a4266c7034f2f0d4e1d0716fb6eae20eae29e","efa47267fea521a1a9dc343a3736c974c2fadafa81e36c54e7d2a4c66702414b"],["e7a26ce69dd4829f3e10cec0a9e98ed3143d084f308b92c0997fddfc60cb3e41","2a758e300fa7984b471b006a1aafbb18d0a6b2c0420e83e20e8a9421cf2cfd51"],["b6459e0ee3662ec8d23540c223bcbdc571cbcb967d79424f3cf29eb3de6b80ef","67c876d06f3e06de1dadf16e5661db3c4b3ae6d48e35b2ff30bf0b61a71ba45"],["d68a80c8280bb840793234aa118f06231d6f1fc67e73c5a5deda0f5b496943e8","db8ba9fff4b586d00c4b1f9177b0e28b5b0e7b8f7845295a294c84266b133120"],["324aed7df65c804252dc0270907a30b09612aeb973449cea4095980fc28d3d5d","648a365774b61f2ff130c0c35aec1f4f19213b0c7e332843967224af96ab7c84"],["4df9c14919cde61f6d51dfdbe5fee5dceec4143ba8d1ca888e8bd373fd054c96","35ec51092d8728050974c23a1d85d4b5d506cdc288490192ebac06cad10d5d"],["9c3919a84a474870faed8a9c1cc66021523489054d7f0308cbfc99c8ac1f98cd","ddb84f0f4a4ddd57584f044bf260e641905326f76c64c8e6be7e5e03d4fc599d"],["6057170b1dd12fdf8de05f281d8e06bb91e1493a8b91d4cc5a21382120a959e5","9a1af0b26a6a4807add9a2daf71df262465152bc3ee24c65e899be932385a2a8"],["a576df8e23a08411421439a4518da31880cef0fba7d4df12b1a6973eecb94266","40a6bf20e76640b2c92b97afe58cd82c432e10a7f514d9f3ee8be11ae1b28ec8"],["7778a78c28dec3e30a05fe9629de8c38bb30d1f5cf9a3a208f763889be58ad71","34626d9ab5a5b22ff7098e12f2ff580087b38411ff24ac563b513fc1fd9f43ac"],["928955ee637a84463729fd30e7afd2ed5f96274e5ad7e5cb09eda9c06d903ac","c25621003d3f42a827b78a13093a95eeac3d26efa8a8d83fc5180e935bcd091f"],["85d0fef3ec6db109399064f3a0e3b2855645b4a907ad354527aae75163d82751","1f03648413a38c0be29d496e582cf5663e8751e96877331582c237a24eb1f962"],["ff2b0dce97eece97c1c9b6041798b85dfdfb6d8882da20308f5404824526087e","493d13fef524ba188af4c4dc54d07936c7b7ed6fb90e2ceb2c951e01f0c29907"],["827fbbe4b1e880ea9ed2b2e6301b212b57f1ee148cd6dd28780e5e2cf856e241","c60f9c923c727b0b71bef2c67d1d12687ff7a63186903166d605b68baec293ec"],["eaa649f21f51bdbae7be4ae34ce6e5217a58fdce7f47f9aa7f3b58fa2120e2b3","be3279ed5bbbb03ac69a80f89879aa5a01a6b965f13f7e59d47a5305ba5ad93d"],["e4a42d43c5cf169d9391df6decf42ee541b6d8f0c9a137401e23632dda34d24f","4d9f92e716d1c73526fc99ccfb8ad34ce886eedfa8d8e4f13a7f7131deba9414"],["1ec80fef360cbdd954160fadab352b6b92b53576a88fea4947173b9d4300bf19","aeefe93756b5340d2f3a4958a7abbf5e0146e77f6295a07b671cdc1cc107cefd"],["146a778c04670c2f91b00af4680dfa8bce3490717d58ba889ddb5928366642be","b318e0ec3354028add669827f9d4b2870aaa971d2f7e5ed1d0b297483d83efd0"],["fa50c0f61d22e5f07e3acebb1aa07b128d0012209a28b9776d76a8793180eef9","6b84c6922397eba9b72cd2872281a68a5e683293a57a213b38cd8d7d3f4f2811"],["da1d61d0ca721a11b1a5bf6b7d88e8421a288ab5d5bba5220e53d32b5f067ec2","8157f55a7c99306c79c0766161c91e2966a73899d279b48a655fba0f1ad836f1"],["a8e282ff0c9706907215ff98e8fd416615311de0446f1e062a73b0610d064e13","7f97355b8db81c09abfb7f3c5b2515888b679a3e50dd6bd6cef7c73111f4cc0c"],["174a53b9c9a285872d39e56e6913cab15d59b1fa512508c022f382de8319497c","ccc9dc37abfc9c1657b4155f2c47f9e6646b3a1d8cb9854383da13ac079afa73"],["959396981943785c3d3e57edf5018cdbe039e730e4918b3d884fdff09475b7ba","2e7e552888c331dd8ba0386a4b9cd6849c653f64c8709385e9b8abf87524f2fd"],["d2a63a50ae401e56d645a1153b109a8fcca0a43d561fba2dbb51340c9d82b151","e82d86fb6443fcb7565aee58b2948220a70f750af484ca52d4142174dcf89405"],["64587e2335471eb890ee7896d7cfdc866bacbdbd3839317b3436f9b45617e073","d99fcdd5bf6902e2ae96dd6447c299a185b90a39133aeab358299e5e9faf6589"],["8481bde0e4e4d885b3a546d3e549de042f0aa6cea250e7fd358d6c86dd45e458","38ee7b8cba5404dd84a25bf39cecb2ca900a79c42b262e556d64b1b59779057e"],["13464a57a78102aa62b6979ae817f4637ffcfed3c4b1ce30bcd6303f6caf666b","69be159004614580ef7e433453ccb0ca48f300a81d0942e13f495a907f6ecc27"],["bc4a9df5b713fe2e9aef430bcc1dc97a0cd9ccede2f28588cada3a0d2d83f366","d3a81ca6e785c06383937adf4b798caa6e8a9fbfa547b16d758d666581f33c1"],["8c28a97bf8298bc0d23d8c749452a32e694b65e30a9472a3954ab30fe5324caa","40a30463a3305193378fedf31f7cc0eb7ae784f0451cb9459e71dc73cbef9482"],["8ea9666139527a8c1dd94ce4f071fd23c8b350c5a4bb33748c4ba111faccae0","620efabbc8ee2782e24e7c0cfb95c5d735b783be9cf0f8e955af34a30e62b945"],["dd3625faef5ba06074669716bbd3788d89bdde815959968092f76cc4eb9a9787","7a188fa3520e30d461da2501045731ca941461982883395937f68d00c644a573"],["f710d79d9eb962297e4f6232b40e8f7feb2bc63814614d692c12de752408221e","ea98e67232d3b3295d3b535532115ccac8612c721851617526ae47a9c77bfc82"]]},naf:{wnd:7,points:[["f9308a019258c31049344f85f89d5229b531c845836f99b08601f113bce036f9","388f7b0f632de8140fe337e62a37f3566500a99934c2231b6cb9fd7584b8e672"],["2f8bde4d1a07209355b4a7250a5c5128e88b84bddc619ab7cba8d569b240efe4","d8ac222636e5e3d6d4dba9dda6c9c426f788271bab0d6840dca87d3aa6ac62d6"],["5cbdf0646e5db4eaa398f365f2ea7a0e3d419b7e0330e39ce92bddedcac4f9bc","6aebca40ba255960a3178d6d861a54dba813d0b813fde7b5a5082628087264da"],["acd484e2f0c7f65309ad178a9f559abde09796974c57e714c35f110dfc27ccbe","cc338921b0a7d9fd64380971763b61e9add888a4375f8e0f05cc262ac64f9c37"],["774ae7f858a9411e5ef4246b70c65aac5649980be5c17891bbec17895da008cb","d984a032eb6b5e190243dd56d7b7b365372db1e2dff9d6a8301d74c9c953c61b"],["f28773c2d975288bc7d1d205c3748651b075fbc6610e58cddeeddf8f19405aa8","ab0902e8d880a89758212eb65cdaf473a1a06da521fa91f29b5cb52db03ed81"],["d7924d4f7d43ea965a465ae3095ff41131e5946f3c85f79e44adbcf8e27e080e","581e2872a86c72a683842ec228cc6defea40af2bd896d3a5c504dc9ff6a26b58"],["defdea4cdb677750a420fee807eacf21eb9898ae79b9768766e4faa04a2d4a34","4211ab0694635168e997b0ead2a93daeced1f4a04a95c0f6cfb199f69e56eb77"],["2b4ea0a797a443d293ef5cff444f4979f06acfebd7e86d277475656138385b6c","85e89bc037945d93b343083b5a1c86131a01f60c50269763b570c854e5c09b7a"],["352bbf4a4cdd12564f93fa332ce333301d9ad40271f8107181340aef25be59d5","321eb4075348f534d59c18259dda3e1f4a1b3b2e71b1039c67bd3d8bcf81998c"],["2fa2104d6b38d11b0230010559879124e42ab8dfeff5ff29dc9cdadd4ecacc3f","2de1068295dd865b64569335bd5dd80181d70ecfc882648423ba76b532b7d67"],["9248279b09b4d68dab21a9b066edda83263c3d84e09572e269ca0cd7f5453714","73016f7bf234aade5d1aa71bdea2b1ff3fc0de2a887912ffe54a32ce97cb3402"],["daed4f2be3a8bf278e70132fb0beb7522f570e144bf615c07e996d443dee8729","a69dce4a7d6c98e8d4a1aca87ef8d7003f83c230f3afa726ab40e52290be1c55"],["c44d12c7065d812e8acf28d7cbb19f9011ecd9e9fdf281b0e6a3b5e87d22e7db","2119a460ce326cdc76c45926c982fdac0e106e861edf61c5a039063f0e0e6482"],["6a245bf6dc698504c89a20cfded60853152b695336c28063b61c65cbd269e6b4","e022cf42c2bd4a708b3f5126f16a24ad8b33ba48d0423b6efd5e6348100d8a82"],["1697ffa6fd9de627c077e3d2fe541084ce13300b0bec1146f95ae57f0d0bd6a5","b9c398f186806f5d27561506e4557433a2cf15009e498ae7adee9d63d01b2396"],["605bdb019981718b986d0f07e834cb0d9deb8360ffb7f61df982345ef27a7479","2972d2de4f8d20681a78d93ec96fe23c26bfae84fb14db43b01e1e9056b8c49"],["62d14dab4150bf497402fdc45a215e10dcb01c354959b10cfe31c7e9d87ff33d","80fc06bd8cc5b01098088a1950eed0db01aa132967ab472235f5642483b25eaf"],["80c60ad0040f27dade5b4b06c408e56b2c50e9f56b9b8b425e555c2f86308b6f","1c38303f1cc5c30f26e66bad7fe72f70a65eed4cbe7024eb1aa01f56430bd57a"],["7a9375ad6167ad54aa74c6348cc54d344cc5dc9487d847049d5eabb0fa03c8fb","d0e3fa9eca8726909559e0d79269046bdc59ea10c70ce2b02d499ec224dc7f7"],["d528ecd9b696b54c907a9ed045447a79bb408ec39b68df504bb51f459bc3ffc9","eecf41253136e5f99966f21881fd656ebc4345405c520dbc063465b521409933"],["49370a4b5f43412ea25f514e8ecdad05266115e4a7ecb1387231808f8b45963","758f3f41afd6ed428b3081b0512fd62a54c3f3afbb5b6764b653052a12949c9a"],["77f230936ee88cbbd73df930d64702ef881d811e0e1498e2f1c13eb1fc345d74","958ef42a7886b6400a08266e9ba1b37896c95330d97077cbbe8eb3c7671c60d6"],["f2dac991cc4ce4b9ea44887e5c7c0bce58c80074ab9d4dbaeb28531b7739f530","e0dedc9b3b2f8dad4da1f32dec2531df9eb5fbeb0598e4fd1a117dba703a3c37"],["463b3d9f662621fb1b4be8fbbe2520125a216cdfc9dae3debcba4850c690d45b","5ed430d78c296c3543114306dd8622d7c622e27c970a1de31cb377b01af7307e"],["f16f804244e46e2a09232d4aff3b59976b98fac14328a2d1a32496b49998f247","cedabd9b82203f7e13d206fcdf4e33d92a6c53c26e5cce26d6579962c4e31df6"],["caf754272dc84563b0352b7a14311af55d245315ace27c65369e15f7151d41d1","cb474660ef35f5f2a41b643fa5e460575f4fa9b7962232a5c32f908318a04476"],["2600ca4b282cb986f85d0f1709979d8b44a09c07cb86d7c124497bc86f082120","4119b88753c15bd6a693b03fcddbb45d5ac6be74ab5f0ef44b0be9475a7e4b40"],["7635ca72d7e8432c338ec53cd12220bc01c48685e24f7dc8c602a7746998e435","91b649609489d613d1d5e590f78e6d74ecfc061d57048bad9e76f302c5b9c61"],["754e3239f325570cdbbf4a87deee8a66b7f2b33479d468fbc1a50743bf56cc18","673fb86e5bda30fb3cd0ed304ea49a023ee33d0197a695d0c5d98093c536683"],["e3e6bd1071a1e96aff57859c82d570f0330800661d1c952f9fe2694691d9b9e8","59c9e0bba394e76f40c0aa58379a3cb6a5a2283993e90c4167002af4920e37f5"],["186b483d056a033826ae73d88f732985c4ccb1f32ba35f4b4cc47fdcf04aa6eb","3b952d32c67cf77e2e17446e204180ab21fb8090895138b4a4a797f86e80888b"],["df9d70a6b9876ce544c98561f4be4f725442e6d2b737d9c91a8321724ce0963f","55eb2dafd84d6ccd5f862b785dc39d4ab157222720ef9da217b8c45cf2ba2417"],["5edd5cc23c51e87a497ca815d5dce0f8ab52554f849ed8995de64c5f34ce7143","efae9c8dbc14130661e8cec030c89ad0c13c66c0d17a2905cdc706ab7399a868"],["290798c2b6476830da12fe02287e9e777aa3fba1c355b17a722d362f84614fba","e38da76dcd440621988d00bcf79af25d5b29c094db2a23146d003afd41943e7a"],["af3c423a95d9f5b3054754efa150ac39cd29552fe360257362dfdecef4053b45","f98a3fd831eb2b749a93b0e6f35cfb40c8cd5aa667a15581bc2feded498fd9c6"],["766dbb24d134e745cccaa28c99bf274906bb66b26dcf98df8d2fed50d884249a","744b1152eacbe5e38dcc887980da38b897584a65fa06cedd2c924f97cbac5996"],["59dbf46f8c94759ba21277c33784f41645f7b44f6c596a58ce92e666191abe3e","c534ad44175fbc300f4ea6ce648309a042ce739a7919798cd85e216c4a307f6e"],["f13ada95103c4537305e691e74e9a4a8dd647e711a95e73cb62dc6018cfd87b8","e13817b44ee14de663bf4bc808341f326949e21a6a75c2570778419bdaf5733d"],["7754b4fa0e8aced06d4167a2c59cca4cda1869c06ebadfb6488550015a88522c","30e93e864e669d82224b967c3020b8fa8d1e4e350b6cbcc537a48b57841163a2"],["948dcadf5990e048aa3874d46abef9d701858f95de8041d2a6828c99e2262519","e491a42537f6e597d5d28a3224b1bc25df9154efbd2ef1d2cbba2cae5347d57e"],["7962414450c76c1689c7b48f8202ec37fb224cf5ac0bfa1570328a8a3d7c77ab","100b610ec4ffb4760d5c1fc133ef6f6b12507a051f04ac5760afa5b29db83437"],["3514087834964b54b15b160644d915485a16977225b8847bb0dd085137ec47ca","ef0afbb2056205448e1652c48e8127fc6039e77c15c2378b7e7d15a0de293311"],["d3cc30ad6b483e4bc79ce2c9dd8bc54993e947eb8df787b442943d3f7b527eaf","8b378a22d827278d89c5e9be8f9508ae3c2ad46290358630afb34db04eede0a4"],["1624d84780732860ce1c78fcbfefe08b2b29823db913f6493975ba0ff4847610","68651cf9b6da903e0914448c6cd9d4ca896878f5282be4c8cc06e2a404078575"],["733ce80da955a8a26902c95633e62a985192474b5af207da6df7b4fd5fc61cd4","f5435a2bd2badf7d485a4d8b8db9fcce3e1ef8e0201e4578c54673bc1dc5ea1d"],["15d9441254945064cf1a1c33bbd3b49f8966c5092171e699ef258dfab81c045c","d56eb30b69463e7234f5137b73b84177434800bacebfc685fc37bbe9efe4070d"],["a1d0fcf2ec9de675b612136e5ce70d271c21417c9d2b8aaaac138599d0717940","edd77f50bcb5a3cab2e90737309667f2641462a54070f3d519212d39c197a629"],["e22fbe15c0af8ccc5780c0735f84dbe9a790badee8245c06c7ca37331cb36980","a855babad5cd60c88b430a69f53a1a7a38289154964799be43d06d77d31da06"],["311091dd9860e8e20ee13473c1155f5f69635e394704eaa74009452246cfa9b3","66db656f87d1f04fffd1f04788c06830871ec5a64feee685bd80f0b1286d8374"],["34c1fd04d301be89b31c0442d3e6ac24883928b45a9340781867d4232ec2dbdf","9414685e97b1b5954bd46f730174136d57f1ceeb487443dc5321857ba73abee"],["f219ea5d6b54701c1c14de5b557eb42a8d13f3abbcd08affcc2a5e6b049b8d63","4cb95957e83d40b0f73af4544cccf6b1f4b08d3c07b27fb8d8c2962a400766d1"],["d7b8740f74a8fbaab1f683db8f45de26543a5490bca627087236912469a0b448","fa77968128d9c92ee1010f337ad4717eff15db5ed3c049b3411e0315eaa4593b"],["32d31c222f8f6f0ef86f7c98d3a3335ead5bcd32abdd94289fe4d3091aa824bf","5f3032f5892156e39ccd3d7915b9e1da2e6dac9e6f26e961118d14b8462e1661"],["7461f371914ab32671045a155d9831ea8793d77cd59592c4340f86cbc18347b5","8ec0ba238b96bec0cbdddcae0aa442542eee1ff50c986ea6b39847b3cc092ff6"],["ee079adb1df1860074356a25aa38206a6d716b2c3e67453d287698bad7b2b2d6","8dc2412aafe3be5c4c5f37e0ecc5f9f6a446989af04c4e25ebaac479ec1c8c1e"],["16ec93e447ec83f0467b18302ee620f7e65de331874c9dc72bfd8616ba9da6b5","5e4631150e62fb40d0e8c2a7ca5804a39d58186a50e497139626778e25b0674d"],["eaa5f980c245f6f038978290afa70b6bd8855897f98b6aa485b96065d537bd99","f65f5d3e292c2e0819a528391c994624d784869d7e6ea67fb18041024edc07dc"],["78c9407544ac132692ee1910a02439958ae04877151342ea96c4b6b35a49f51","f3e0319169eb9b85d5404795539a5e68fa1fbd583c064d2462b675f194a3ddb4"],["494f4be219a1a77016dcd838431aea0001cdc8ae7a6fc688726578d9702857a5","42242a969283a5f339ba7f075e36ba2af925ce30d767ed6e55f4b031880d562c"],["a598a8030da6d86c6bc7f2f5144ea549d28211ea58faa70ebf4c1e665c1fe9b5","204b5d6f84822c307e4b4a7140737aec23fc63b65b35f86a10026dbd2d864e6b"],["c41916365abb2b5d09192f5f2dbeafec208f020f12570a184dbadc3e58595997","4f14351d0087efa49d245b328984989d5caf9450f34bfc0ed16e96b58fa9913"],["841d6063a586fa475a724604da03bc5b92a2e0d2e0a36acfe4c73a5514742881","73867f59c0659e81904f9a1c7543698e62562d6744c169ce7a36de01a8d6154"],["5e95bb399a6971d376026947f89bde2f282b33810928be4ded112ac4d70e20d5","39f23f366809085beebfc71181313775a99c9aed7d8ba38b161384c746012865"],["36e4641a53948fd476c39f8a99fd974e5ec07564b5315d8bf99471bca0ef2f66","d2424b1b1abe4eb8164227b085c9aa9456ea13493fd563e06fd51cf5694c78fc"],["336581ea7bfbbb290c191a2f507a41cf5643842170e914faeab27c2c579f726","ead12168595fe1be99252129b6e56b3391f7ab1410cd1e0ef3dcdcabd2fda224"],["8ab89816dadfd6b6a1f2634fcf00ec8403781025ed6890c4849742706bd43ede","6fdcef09f2f6d0a044e654aef624136f503d459c3e89845858a47a9129cdd24e"],["1e33f1a746c9c5778133344d9299fcaa20b0938e8acff2544bb40284b8c5fb94","60660257dd11b3aa9c8ed618d24edff2306d320f1d03010e33a7d2057f3b3b6"],["85b7c1dcb3cec1b7ee7f30ded79dd20a0ed1f4cc18cbcfcfa410361fd8f08f31","3d98a9cdd026dd43f39048f25a8847f4fcafad1895d7a633c6fed3c35e999511"],["29df9fbd8d9e46509275f4b125d6d45d7fbe9a3b878a7af872a2800661ac5f51","b4c4fe99c775a606e2d8862179139ffda61dc861c019e55cd2876eb2a27d84b"],["a0b1cae06b0a847a3fea6e671aaf8adfdfe58ca2f768105c8082b2e449fce252","ae434102edde0958ec4b19d917a6a28e6b72da1834aff0e650f049503a296cf2"],["4e8ceafb9b3e9a136dc7ff67e840295b499dfb3b2133e4ba113f2e4c0e121e5","cf2174118c8b6d7a4b48f6d534ce5c79422c086a63460502b827ce62a326683c"],["d24a44e047e19b6f5afb81c7ca2f69080a5076689a010919f42725c2b789a33b","6fb8d5591b466f8fc63db50f1c0f1c69013f996887b8244d2cdec417afea8fa3"],["ea01606a7a6c9cdd249fdfcfacb99584001edd28abbab77b5104e98e8e3b35d4","322af4908c7312b0cfbfe369f7a7b3cdb7d4494bc2823700cfd652188a3ea98d"],["af8addbf2b661c8a6c6328655eb96651252007d8c5ea31be4ad196de8ce2131f","6749e67c029b85f52a034eafd096836b2520818680e26ac8f3dfbcdb71749700"],["e3ae1974566ca06cc516d47e0fb165a674a3dabcfca15e722f0e3450f45889","2aeabe7e4531510116217f07bf4d07300de97e4874f81f533420a72eeb0bd6a4"],["591ee355313d99721cf6993ffed1e3e301993ff3ed258802075ea8ced397e246","b0ea558a113c30bea60fc4775460c7901ff0b053d25ca2bdeee98f1a4be5d196"],["11396d55fda54c49f19aa97318d8da61fa8584e47b084945077cf03255b52984","998c74a8cd45ac01289d5833a7beb4744ff536b01b257be4c5767bea93ea57a4"],["3c5d2a1ba39c5a1790000738c9e0c40b8dcdfd5468754b6405540157e017aa7a","b2284279995a34e2f9d4de7396fc18b80f9b8b9fdd270f6661f79ca4c81bd257"],["cc8704b8a60a0defa3a99a7299f2e9c3fbc395afb04ac078425ef8a1793cc030","bdd46039feed17881d1e0862db347f8cf395b74fc4bcdc4e940b74e3ac1f1b13"],["c533e4f7ea8555aacd9777ac5cad29b97dd4defccc53ee7ea204119b2889b197","6f0a256bc5efdf429a2fb6242f1a43a2d9b925bb4a4b3a26bb8e0f45eb596096"],["c14f8f2ccb27d6f109f6d08d03cc96a69ba8c34eec07bbcf566d48e33da6593","c359d6923bb398f7fd4473e16fe1c28475b740dd098075e6c0e8649113dc3a38"],["a6cbc3046bc6a450bac24789fa17115a4c9739ed75f8f21ce441f72e0b90e6ef","21ae7f4680e889bb130619e2c0f95a360ceb573c70603139862afd617fa9b9f"],["347d6d9a02c48927ebfb86c1359b1caf130a3c0267d11ce6344b39f99d43cc38","60ea7f61a353524d1c987f6ecec92f086d565ab687870cb12689ff1e31c74448"],["da6545d2181db8d983f7dcb375ef5866d47c67b1bf31c8cf855ef7437b72656a","49b96715ab6878a79e78f07ce5680c5d6673051b4935bd897fea824b77dc208a"],["c40747cc9d012cb1a13b8148309c6de7ec25d6945d657146b9d5994b8feb1111","5ca560753be2a12fc6de6caf2cb489565db936156b9514e1bb5e83037e0fa2d4"],["4e42c8ec82c99798ccf3a610be870e78338c7f713348bd34c8203ef4037f3502","7571d74ee5e0fb92a7a8b33a07783341a5492144cc54bcc40a94473693606437"],["3775ab7089bc6af823aba2e1af70b236d251cadb0c86743287522a1b3b0dedea","be52d107bcfa09d8bcb9736a828cfa7fac8db17bf7a76a2c42ad961409018cf7"],["cee31cbf7e34ec379d94fb814d3d775ad954595d1314ba8846959e3e82f74e26","8fd64a14c06b589c26b947ae2bcf6bfa0149ef0be14ed4d80f448a01c43b1c6d"],["b4f9eaea09b6917619f6ea6a4eb5464efddb58fd45b1ebefcdc1a01d08b47986","39e5c9925b5a54b07433a4f18c61726f8bb131c012ca542eb24a8ac07200682a"],["d4263dfc3d2df923a0179a48966d30ce84e2515afc3dccc1b77907792ebcc60e","62dfaf07a0f78feb30e30d6295853ce189e127760ad6cf7fae164e122a208d54"],["48457524820fa65a4f8d35eb6930857c0032acc0a4a2de422233eeda897612c4","25a748ab367979d98733c38a1fa1c2e7dc6cc07db2d60a9ae7a76aaa49bd0f77"],["dfeeef1881101f2cb11644f3a2afdfc2045e19919152923f367a1767c11cceda","ecfb7056cf1de042f9420bab396793c0c390bde74b4bbdff16a83ae09a9a7517"],["6d7ef6b17543f8373c573f44e1f389835d89bcbc6062ced36c82df83b8fae859","cd450ec335438986dfefa10c57fea9bcc521a0959b2d80bbf74b190dca712d10"],["e75605d59102a5a2684500d3b991f2e3f3c88b93225547035af25af66e04541f","f5c54754a8f71ee540b9b48728473e314f729ac5308b06938360990e2bfad125"],["eb98660f4c4dfaa06a2be453d5020bc99a0c2e60abe388457dd43fefb1ed620c","6cb9a8876d9cb8520609af3add26cd20a0a7cd8a9411131ce85f44100099223e"],["13e87b027d8514d35939f2e6892b19922154596941888336dc3563e3b8dba942","fef5a3c68059a6dec5d624114bf1e91aac2b9da568d6abeb2570d55646b8adf1"],["ee163026e9fd6fe017c38f06a5be6fc125424b371ce2708e7bf4491691e5764a","1acb250f255dd61c43d94ccc670d0f58f49ae3fa15b96623e5430da0ad6c62b2"],["b268f5ef9ad51e4d78de3a750c2dc89b1e626d43505867999932e5db33af3d80","5f310d4b3c99b9ebb19f77d41c1dee018cf0d34fd4191614003e945a1216e423"],["ff07f3118a9df035e9fad85eb6c7bfe42b02f01ca99ceea3bf7ffdba93c4750d","438136d603e858a3a5c440c38eccbaddc1d2942114e2eddd4740d098ced1f0d8"],["8d8b9855c7c052a34146fd20ffb658bea4b9f69e0d825ebec16e8c3ce2b526a1","cdb559eedc2d79f926baf44fb84ea4d44bcf50fee51d7ceb30e2e7f463036758"],["52db0b5384dfbf05bfa9d472d7ae26dfe4b851ceca91b1eba54263180da32b63","c3b997d050ee5d423ebaf66a6db9f57b3180c902875679de924b69d84a7b375"],["e62f9490d3d51da6395efd24e80919cc7d0f29c3f3fa48c6fff543becbd43352","6d89ad7ba4876b0b22c2ca280c682862f342c8591f1daf5170e07bfd9ccafa7d"],["7f30ea2476b399b4957509c88f77d0191afa2ff5cb7b14fd6d8e7d65aaab1193","ca5ef7d4b231c94c3b15389a5f6311e9daff7bb67b103e9880ef4bff637acaec"],["5098ff1e1d9f14fb46a210fada6c903fef0fb7b4a1dd1d9ac60a0361800b7a00","9731141d81fc8f8084d37c6e7542006b3ee1b40d60dfe5362a5b132fd17ddc0"],["32b78c7de9ee512a72895be6b9cbefa6e2f3c4ccce445c96b9f2c81e2778ad58","ee1849f513df71e32efc3896ee28260c73bb80547ae2275ba497237794c8753c"],["e2cb74fddc8e9fbcd076eef2a7c72b0ce37d50f08269dfc074b581550547a4f7","d3aa2ed71c9dd2247a62df062736eb0baddea9e36122d2be8641abcb005cc4a4"],["8438447566d4d7bedadc299496ab357426009a35f235cb141be0d99cd10ae3a8","c4e1020916980a4da5d01ac5e6ad330734ef0d7906631c4f2390426b2edd791f"],["4162d488b89402039b584c6fc6c308870587d9c46f660b878ab65c82c711d67e","67163e903236289f776f22c25fb8a3afc1732f2b84b4e95dbda47ae5a0852649"],["3fad3fa84caf0f34f0f89bfd2dcf54fc175d767aec3e50684f3ba4a4bf5f683d","cd1bc7cb6cc407bb2f0ca647c718a730cf71872e7d0d2a53fa20efcdfe61826"],["674f2600a3007a00568c1a7ce05d0816c1fb84bf1370798f1c69532faeb1a86b","299d21f9413f33b3edf43b257004580b70db57da0b182259e09eecc69e0d38a5"],["d32f4da54ade74abb81b815ad1fb3b263d82d6c692714bcff87d29bd5ee9f08f","f9429e738b8e53b968e99016c059707782e14f4535359d582fc416910b3eea87"],["30e4e670435385556e593657135845d36fbb6931f72b08cb1ed954f1e3ce3ff6","462f9bce619898638499350113bbc9b10a878d35da70740dc695a559eb88db7b"],["be2062003c51cc3004682904330e4dee7f3dcd10b01e580bf1971b04d4cad297","62188bc49d61e5428573d48a74e1c655b1c61090905682a0d5558ed72dccb9bc"],["93144423ace3451ed29e0fb9ac2af211cb6e84a601df5993c419859fff5df04a","7c10dfb164c3425f5c71a3f9d7992038f1065224f72bb9d1d902a6d13037b47c"],["b015f8044f5fcbdcf21ca26d6c34fb8197829205c7b7d2a7cb66418c157b112c","ab8c1e086d04e813744a655b2df8d5f83b3cdc6faa3088c1d3aea1454e3a1d5f"],["d5e9e1da649d97d89e4868117a465a3a4f8a18de57a140d36b3f2af341a21b52","4cb04437f391ed73111a13cc1d4dd0db1693465c2240480d8955e8592f27447a"],["d3ae41047dd7ca065dbf8ed77b992439983005cd72e16d6f996a5316d36966bb","bd1aeb21ad22ebb22a10f0303417c6d964f8cdd7df0aca614b10dc14d125ac46"],["463e2763d885f958fc66cdd22800f0a487197d0a82e377b49f80af87c897b065","bfefacdb0e5d0fd7df3a311a94de062b26b80c61fbc97508b79992671ef7ca7f"],["7985fdfd127c0567c6f53ec1bb63ec3158e597c40bfe747c83cddfc910641917","603c12daf3d9862ef2b25fe1de289aed24ed291e0ec6708703a5bd567f32ed03"],["74a1ad6b5f76e39db2dd249410eac7f99e74c59cb83d2d0ed5ff1543da7703e9","cc6157ef18c9c63cd6193d83631bbea0093e0968942e8c33d5737fd790e0db08"],["30682a50703375f602d416664ba19b7fc9bab42c72747463a71d0896b22f6da3","553e04f6b018b4fa6c8f39e7f311d3176290d0e0f19ca73f17714d9977a22ff8"],["9e2158f0d7c0d5f26c3791efefa79597654e7a2b2464f52b1ee6c1347769ef57","712fcdd1b9053f09003a3481fa7762e9ffd7c8ef35a38509e2fbf2629008373"],["176e26989a43c9cfeba4029c202538c28172e566e3c4fce7322857f3be327d66","ed8cc9d04b29eb877d270b4878dc43c19aefd31f4eee09ee7b47834c1fa4b1c3"],["75d46efea3771e6e68abb89a13ad747ecf1892393dfc4f1b7004788c50374da8","9852390a99507679fd0b86fd2b39a868d7efc22151346e1a3ca4726586a6bed8"],["809a20c67d64900ffb698c4c825f6d5f2310fb0451c869345b7319f645605721","9e994980d9917e22b76b061927fa04143d096ccc54963e6a5ebfa5f3f8e286c1"],["1b38903a43f7f114ed4500b4eac7083fdefece1cf29c63528d563446f972c180","4036edc931a60ae889353f77fd53de4a2708b26b6f5da72ad3394119daf408f9"]]}}),yu}(function(t){var e=t,r=ia,i=fu,n=Xt,s=n.assert;function o(u){u.type==="short"?this.curve=new i.short(u):u.type==="edwards"?this.curve=new i.edwards(u):this.curve=new i.mont(u),this.g=this.curve.g,this.n=this.curve.n,this.hash=u.hash,s(this.g.validate(),"Invalid curve"),s(this.g.mul(this.n).isInfinity(),"Invalid curve, G*N != O")}e.PresetCurve=o;function a(u,h){Object.defineProperty(e,u,{configurable:!0,enumerable:!0,get:function(){var l=new o(h);return Object.defineProperty(e,u,{configurable:!0,enumerable:!0,value:l}),l}})}a("p192",{type:"short",prime:"p192",p:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff",a:"ffffffff ffffffff ffffffff fffffffe ffffffff fffffffc",b:"64210519 e59c80e7 0fa7e9ab 72243049 feb8deec c146b9b1",n:"ffffffff ffffffff ffffffff 99def836 146bc9b1 b4d22831",hash:r.sha256,gRed:!1,g:["188da80e b03090f6 7cbf20eb 43a18800 f4ff0afd 82ff1012","07192b95 ffc8da78 631011ed 6b24cdd5 73f977a1 1e794811"]}),a("p224",{type:"short",prime:"p224",p:"ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001",a:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff fffffffe",b:"b4050a85 0c04b3ab f5413256 5044b0b7 d7bfd8ba 270b3943 2355ffb4",n:"ffffffff ffffffff ffffffff ffff16a2 e0b8f03e 13dd2945 5c5c2a3d",hash:r.sha256,gRed:!1,g:["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3 56c21122 343280d6 115c1d21","bd376388 b5f723fb 4c22dfe6 cd4375a0 5a074764 44d58199 85007e34"]}),a("p256",{type:"short",prime:null,p:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff ffffffff",a:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff fffffffc",b:"5ac635d8 aa3a93e7 b3ebbd55 769886bc 651d06b0 cc53b0f6 3bce3c3e 27d2604b",n:"ffffffff 00000000 ffffffff ffffffff bce6faad a7179e84 f3b9cac2 fc632551",hash:r.sha256,gRed:!1,g:["6b17d1f2 e12c4247 f8bce6e5 63a440f2 77037d81 2deb33a0 f4a13945 d898c296","4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16 2bce3357 6b315ece cbb64068 37bf51f5"]}),a("p384",{type:"short",prime:null,p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 ffffffff",a:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 fffffffc",b:"b3312fa7 e23ee7e4 988e056b e3f82d19 181d9c6e fe814112 0314088f 5013875a c656398d 8a2ed19d 2a85c8ed d3ec2aef",n:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff c7634d81 f4372ddf 581a0db2 48b0a77a ecec196a ccc52973",hash:r.sha384,gRed:!1,g:["aa87ca22 be8b0537 8eb1c71e f320ad74 6e1d3b62 8ba79b98 59f741e0 82542a38 5502f25d bf55296c 3a545e38 72760ab7","3617de4a 96262c6f 5d9e98bf 9292dc29 f8f41dbd 289a147c e9da3113 b5f0b8c0 0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"]}),a("p521",{type:"short",prime:null,p:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff",a:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffc",b:"00000051 953eb961 8e1c9a1f 929a21a0 b68540ee a2da725b 99b315f3 b8b48991 8ef109e1 56193951 ec7e937b 1652c0bd 3bb1bf07 3573df88 3d2c34f1 ef451fd4 6b503f00",n:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffa 51868783 bf2f966b 7fcc0148 f709a5d0 3bb5c9b8 899c47ae bb6fb71e 91386409",hash:r.sha512,gRed:!1,g:["000000c6 858e06b7 0404e9cd 9e3ecb66 2395b442 9c648139 053fb521 f828af60 6b4d3dba a14b5e77 efe75928 fe1dc127 a2ffa8de 3348b3c1 856a429b f97e7e31 c2e5bd66","00000118 39296a78 9a3bc004 5c8a5fb4 2c7d1bd9 98f54449 579b4468 17afbd17 273e662c 97ee7299 5ef42640 c550b901 3fad0761 353c7086 a272c240 88be9476 9fd16650"]}),a("curve25519",{type:"mont",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"76d06",b:"1",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:r.sha256,gRed:!1,g:["9"]}),a("ed25519",{type:"edwards",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"-1",c:"1",d:"52036cee2b6ffe73 8cc740797779e898 00700a4d4141d8ab 75eb4dca135978a3",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:r.sha256,gRed:!1,g:["216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a","6666666666666666666666666666666666666666666666666666666666666658"]});var c;try{c=W4()}catch{c=void 0}a("secp256k1",{type:"short",prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",hash:r.sha256,beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:!1,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",c]})})(ra);var Y4=ia,Gi=cu,o0=Ki;function Ei(t){if(!(this instanceof Ei))return new Ei(t);this.hash=t.hash,this.predResist=!!t.predResist,this.outLen=this.hash.outSize,this.minEntropy=t.minEntropy||this.hash.hmacStrength,this._reseed=null,this.reseedInterval=null,this.K=null,this.V=null;var e=Gi.toArray(t.entropy,t.entropyEnc||"hex"),r=Gi.toArray(t.nonce,t.nonceEnc||"hex"),i=Gi.toArray(t.pers,t.persEnc||"hex");o0(e.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._init(e,r,i)}var X4=Ei;Ei.prototype._init=function(e,r,i){var n=e.concat(r).concat(i);this.K=new Array(this.outLen/8),this.V=new Array(this.outLen/8);for(var s=0;s<this.V.length;s++)this.K[s]=0,this.V[s]=1;this._update(n),this._reseed=1,this.reseedInterval=281474976710656},Ei.prototype._hmac=function(){return new Y4.hmac(this.hash,this.K)},Ei.prototype._update=function(e){var r=this._hmac().update(this.V).update([0]);e&&(r=r.update(e)),this.K=r.digest(),this.V=this._hmac().update(this.V).digest(),e&&(this.K=this._hmac().update(this.V).update([1]).update(e).digest(),this.V=this._hmac().update(this.V).digest())},Ei.prototype.reseed=function(e,r,i,n){typeof r!="string"&&(n=i,i=r,r=null),e=Gi.toArray(e,r),i=Gi.toArray(i,n),o0(e.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._update(e.concat(i||[])),this._reseed=1},Ei.prototype.generate=function(e,r,i,n){if(this._reseed>this.reseedInterval)throw new Error("Reseed is required");typeof r!="string"&&(n=i,i=r,r=null),i&&(i=Gi.toArray(i,n||"hex"),this._update(i));for(var s=[];s.length<e;)this.V=this._hmac().update(this.V).digest(),s=s.concat(this.V);var o=s.slice(0,e);return this._update(i),this._reseed++,Gi.encode(o,r)};var Z4=$r.exports,J4=Xt,vu=J4.assert;function $t(t,e){this.ec=t,this.priv=null,this.pub=null,e.priv&&this._importPrivate(e.priv,e.privEnc),e.pub&&this._importPublic(e.pub,e.pubEnc)}var Q4=$t;$t.fromPublic=function(e,r,i){return r instanceof $t?r:new $t(e,{pub:r,pubEnc:i})},$t.fromPrivate=function(e,r,i){return r instanceof $t?r:new $t(e,{priv:r,privEnc:i})},$t.prototype.validate=function(){var e=this.getPublic();return e.isInfinity()?{result:!1,reason:"Invalid public key"}:e.validate()?e.mul(this.ec.curve.n).isInfinity()?{result:!0,reason:null}:{result:!1,reason:"Public key * N != O"}:{result:!1,reason:"Public key is not a point"}},$t.prototype.getPublic=function(e,r){return typeof e=="string"&&(r=e,e=null),this.pub||(this.pub=this.ec.g.mul(this.priv)),r?this.pub.encode(r,e):this.pub},$t.prototype.getPrivate=function(e){return e==="hex"?this.priv.toString(16,2):this.priv},$t.prototype._importPrivate=function(e,r){this.priv=new Z4(e,r||16),this.priv=this.priv.umod(this.ec.curve.n)},$t.prototype._importPublic=function(e,r){if(e.x||e.y){this.ec.curve.type==="mont"?vu(e.x,"Need x coordinate"):(this.ec.curve.type==="short"||this.ec.curve.type==="edwards")&&vu(e.x&&e.y,"Need both x and y coordinate"),this.pub=this.ec.curve.point(e.x,e.y);return}this.pub=this.ec.curve.decodePoint(e,r)},$t.prototype.derive=function(e){return e.validate()||vu(e.validate(),"public point not validated"),e.mul(this.priv).getX()},$t.prototype.sign=function(e,r,i){return this.ec.sign(e,this,r,i)},$t.prototype.verify=function(e,r,i){return this.ec.verify(e,r,this,void 0,i)},$t.prototype.inspect=function(){return"<Key priv: "+(this.priv&&this.priv.toString(16,2))+" pub: "+(this.pub&&this.pub.inspect())+" >"};var oa=$r.exports,mu=Xt,e5=mu.assert;function aa(t,e){if(t instanceof aa)return t;this._importDER(t,e)||(e5(t.r&&t.s,"Signature without r or s"),this.r=new oa(t.r,16),this.s=new oa(t.s,16),t.recoveryParam===void 0?this.recoveryParam=null:this.recoveryParam=t.recoveryParam)}var t5=aa;function r5(){this.place=0}function wu(t,e){var r=t[e.place++];if(!(r&128))return r;var i=r&15;if(i===0||i>4||t[e.place]===0)return!1;for(var n=0,s=0,o=e.place;s<i;s++,o++)n<<=8,n|=t[o],n>>>=0;return n<=127?!1:(e.place=o,n)}function a0(t){for(var e=0,r=t.length-1;!t[e]&&!(t[e+1]&128)&&e<r;)e++;return e===0?t:t.slice(e)}aa.prototype._importDER=function(e,r){e=mu.toArray(e,r);var i=new r5;if(e[i.place++]!==48)return!1;var n=wu(e,i);if(n===!1||n+i.place!==e.length||e[i.place++]!==2)return!1;var s=wu(e,i);if(s===!1||(e[i.place]&128)!==0)return!1;var o=e.slice(i.place,s+i.place);if(i.place+=s,e[i.place++]!==2)return!1;var a=wu(e,i);if(a===!1||e.length!==a+i.place||(e[i.place]&128)!==0)return!1;var c=e.slice(i.place,a+i.place);if(o[0]===0)if(o[1]&128)o=o.slice(1);else return!1;if(c[0]===0)if(c[1]&128)c=c.slice(1);else return!1;return this.r=new oa(o),this.s=new oa(c),this.recoveryParam=null,!0};function _u(t,e){if(e<128){t.push(e);return}var r=1+(Math.log(e)/Math.LN2>>>3);for(t.push(r|128);--r;)t.push(e>>>(r<<3)&255);t.push(e)}aa.prototype.toDER=function(e){var r=this.r.toArray(),i=this.s.toArray();for(r[0]&128&&(r=[0].concat(r)),i[0]&128&&(i=[0].concat(i)),r=a0(r),i=a0(i);!i[0]&&!(i[1]&128);)i=i.slice(1);var n=[2];_u(n,r.length),n=n.concat(r),n.push(2),_u(n,i.length);var s=n.concat(i),o=[48];return _u(o,s.length),o=o.concat(s),mu.encode(o,e)};var yr=$r.exports,c0=X4,i5=Xt,Eu=ra,n5=Xo.exports,Wi=i5.assert,xu=Q4,ca=t5;function or(t){if(!(this instanceof or))return new or(t);typeof t=="string"&&(Wi(Object.prototype.hasOwnProperty.call(Eu,t),"Unknown curve "+t),t=Eu[t]),t instanceof Eu.PresetCurve&&(t={curve:t}),this.curve=t.curve.curve,this.n=this.curve.n,this.nh=this.n.ushrn(1),this.g=this.curve.g,this.g=t.curve.g,this.g.precompute(t.curve.n.bitLength()+1),this.hash=t.hash||t.curve.hash}var s5=or;or.prototype.keyPair=function(e){return new xu(this,e)},or.prototype.keyFromPrivate=function(e,r){return xu.fromPrivate(this,e,r)},or.prototype.keyFromPublic=function(e,r){return xu.fromPublic(this,e,r)},or.prototype.genKeyPair=function(e){e||(e={});for(var r=new c0({hash:this.hash,pers:e.pers,persEnc:e.persEnc||"utf8",entropy:e.entropy||n5(this.hash.hmacStrength),entropyEnc:e.entropy&&e.entropyEnc||"utf8",nonce:this.n.toArray()}),i=this.n.byteLength(),n=this.n.sub(new yr(2));;){var s=new yr(r.generate(i));if(!(s.cmp(n)>0))return s.iaddn(1),this.keyFromPrivate(s)}},or.prototype._truncateToN=function(e,r,i){var n;if(yr.isBN(e)||typeof e=="number")e=new yr(e,16),n=e.byteLength();else if(typeof e=="object")n=e.length,e=new yr(e,16);else{var s=e.toString();n=s.length+1>>>1,e=new yr(s,16)}typeof i!="number"&&(i=n*8);var o=i-this.n.bitLength();return o>0&&(e=e.ushrn(o)),!r&&e.cmp(this.n)>=0?e.sub(this.n):e},or.prototype.sign=function(e,r,i,n){if(typeof i=="object"&&(n=i,i=null),n||(n={}),typeof e!="string"&&typeof e!="number"&&!yr.isBN(e)){Wi(typeof e=="object"&&e&&typeof e.length=="number","Expected message to be an array-like, a hex string, or a BN instance"),Wi(e.length>>>0===e.length);for(var s=0;s<e.length;s++)Wi((e[s]&255)===e[s])}r=this.keyFromPrivate(r,i),e=this._truncateToN(e,!1,n.msgBitLength),Wi(!e.isNeg(),"Can not sign a negative message");var o=this.n.byteLength(),a=r.getPrivate().toArray("be",o),c=e.toArray("be",o);Wi(new yr(c).eq(e),"Can not sign message");for(var u=new c0({hash:this.hash,entropy:a,nonce:c,pers:n.pers,persEnc:n.persEnc||"utf8"}),h=this.n.sub(new yr(1)),l=0;;l++){var b=n.k?n.k(l):new yr(u.generate(this.n.byteLength()));if(b=this._truncateToN(b,!0),!(b.cmpn(1)<=0||b.cmp(h)>=0)){var w=this.g.mul(b);if(!w.isInfinity()){var g=w.getX(),x=g.umod(this.n);if(x.cmpn(0)!==0){var A=b.invm(this.n).mul(x.mul(r.getPrivate()).iadd(e));if(A=A.umod(this.n),A.cmpn(0)!==0){var D=(w.getY().isOdd()?1:0)|(g.cmp(x)!==0?2:0);return n.canonical&&A.cmp(this.nh)>0&&(A=this.n.sub(A),D^=1),new ca({r:x,s:A,recoveryParam:D})}}}}}},or.prototype.verify=function(e,r,i,n,s){s||(s={}),e=this._truncateToN(e,!1,s.msgBitLength),i=this.keyFromPublic(i,n),r=new ca(r,"hex");var o=r.r,a=r.s;if(o.cmpn(1)<0||o.cmp(this.n)>=0||a.cmpn(1)<0||a.cmp(this.n)>=0)return!1;var c=a.invm(this.n),u=c.mul(e).umod(this.n),h=c.mul(o).umod(this.n),l;return this.curve._maxwellTrick?(l=this.g.jmulAdd(u,i.getPublic(),h),l.isInfinity()?!1:l.eqXToP(o)):(l=this.g.mulAdd(u,i.getPublic(),h),l.isInfinity()?!1:l.getX().umod(this.n).cmp(o)===0)},or.prototype.recoverPubKey=function(t,e,r,i){Wi((3&r)===r,"The recovery param is more than two bits"),e=new ca(e,i);var n=this.n,s=new yr(t),o=e.r,a=e.s,c=r&1,u=r>>1;if(o.cmp(this.curve.p.umod(this.curve.n))>=0&&u)throw new Error("Unable to find sencond key candinate");u?o=this.curve.pointFromX(o.add(this.curve.n),c):o=this.curve.pointFromX(o,c);var h=e.r.invm(n),l=n.sub(s).mul(h).umod(n),b=a.mul(h).umod(n);return this.g.mulAdd(l,o,b)},or.prototype.getKeyRecoveryParam=function(t,e,r,i){if(e=new ca(e,i),e.recoveryParam!==null)return e.recoveryParam;for(var n=0;n<4;n++){var s;try{s=this.recoverPubKey(t,e,n)}catch{continue}if(s.eq(r))return n}throw new Error("Unable to find valid recovery factor")};var As=Xt,u0=As.assert,f0=As.parseBytes,Vn=As.cachedProperty;function yt(t,e){this.eddsa=t,this._secret=f0(e.secret),t.isPoint(e.pub)?this._pub=e.pub:this._pubBytes=f0(e.pub)}yt.fromPublic=function(e,r){return r instanceof yt?r:new yt(e,{pub:r})},yt.fromSecret=function(e,r){return r instanceof yt?r:new yt(e,{secret:r})},yt.prototype.secret=function(){return this._secret},Vn(yt,"pubBytes",function(){return this.eddsa.encodePoint(this.pub())}),Vn(yt,"pub",function(){return this._pubBytes?this.eddsa.decodePoint(this._pubBytes):this.eddsa.g.mul(this.priv())}),Vn(yt,"privBytes",function(){var e=this.eddsa,r=this.hash(),i=e.encodingLength-1,n=r.slice(0,e.encodingLength);return n[0]&=248,n[i]&=127,n[i]|=64,n}),Vn(yt,"priv",function(){return this.eddsa.decodeInt(this.privBytes())}),Vn(yt,"hash",function(){return this.eddsa.hash().update(this.secret()).digest()}),Vn(yt,"messagePrefix",function(){return this.hash().slice(this.eddsa.encodingLength)}),yt.prototype.sign=function(e){return u0(this._secret,"KeyPair can only verify"),this.eddsa.sign(e,this)},yt.prototype.verify=function(e,r){return this.eddsa.verify(e,r,this)},yt.prototype.getSecret=function(e){return u0(this._secret,"KeyPair is public only"),As.encode(this.secret(),e)},yt.prototype.getPublic=function(e){return As.encode(this.pubBytes(),e)};var o5=yt,a5=$r.exports,ua=Xt,h0=ua.assert,fa=ua.cachedProperty,c5=ua.parseBytes;function Yi(t,e){this.eddsa=t,typeof e!="object"&&(e=c5(e)),Array.isArray(e)&&(h0(e.length===t.encodingLength*2,"Signature has invalid size"),e={R:e.slice(0,t.encodingLength),S:e.slice(t.encodingLength)}),h0(e.R&&e.S,"Signature without R or S"),t.isPoint(e.R)&&(this._R=e.R),e.S instanceof a5&&(this._S=e.S),this._Rencoded=Array.isArray(e.R)?e.R:e.Rencoded,this._Sencoded=Array.isArray(e.S)?e.S:e.Sencoded}fa(Yi,"S",function(){return this.eddsa.decodeInt(this.Sencoded())}),fa(Yi,"R",function(){return this.eddsa.decodePoint(this.Rencoded())}),fa(Yi,"Rencoded",function(){return this.eddsa.encodePoint(this.R())}),fa(Yi,"Sencoded",function(){return this.eddsa.encodeInt(this.S())}),Yi.prototype.toBytes=function(){return this.Rencoded().concat(this.Sencoded())},Yi.prototype.toHex=function(){return ua.encode(this.toBytes(),"hex").toUpperCase()};var u5=Yi,f5=ia,h5=ra,Hn=Xt,d5=Hn.assert,d0=Hn.parseBytes,l0=o5,p0=u5;function Vt(t){if(d5(t==="ed25519","only tested with ed25519 so far"),!(this instanceof Vt))return new Vt(t);t=h5[t].curve,this.curve=t,this.g=t.g,this.g.precompute(t.n.bitLength()+1),this.pointClass=t.point().constructor,this.encodingLength=Math.ceil(t.n.bitLength()/8),this.hash=f5.sha512}var l5=Vt;Vt.prototype.sign=function(e,r){e=d0(e);var i=this.keyFromSecret(r),n=this.hashInt(i.messagePrefix(),e),s=this.g.mul(n),o=this.encodePoint(s),a=this.hashInt(o,i.pubBytes(),e).mul(i.priv()),c=n.add(a).umod(this.curve.n);return this.makeSignature({R:s,S:c,Rencoded:o})},Vt.prototype.verify=function(e,r,i){if(e=d0(e),r=this.makeSignature(r),r.S().gte(r.eddsa.curve.n)||r.S().isNeg())return!1;var n=this.keyFromPublic(i),s=this.hashInt(r.Rencoded(),n.pubBytes(),e),o=this.g.mul(r.S()),a=r.R().add(n.pub().mul(s));return a.eq(o)},Vt.prototype.hashInt=function(){for(var e=this.hash(),r=0;r<arguments.length;r++)e.update(arguments[r]);return Hn.intFromLE(e.digest()).umod(this.curve.n)},Vt.prototype.keyFromPublic=function(e){return l0.fromPublic(this,e)},Vt.prototype.keyFromSecret=function(e){return l0.fromSecret(this,e)},Vt.prototype.makeSignature=function(e){return e instanceof p0?e:new p0(this,e)},Vt.prototype.encodePoint=function(e){var r=e.getY().toArray("le",this.encodingLength);return r[this.encodingLength-1]|=e.getX().isOdd()?128:0,r},Vt.prototype.decodePoint=function(e){e=Hn.parseBytes(e);var r=e.length-1,i=e.slice(0,r).concat(e[r]&-129),n=(e[r]&128)!==0,s=Hn.intFromLE(i);return this.curve.pointFromY(s,n)},Vt.prototype.encodeInt=function(e){return e.toArray("le",this.encodingLength)},Vt.prototype.decodeInt=function(e){return Hn.intFromLE(e)},Vt.prototype.isPoint=function(e){return e instanceof this.pointClass},function(t){var e=t;e.version=f8.version,e.utils=Xt,e.rand=Xo.exports,e.curve=fu,e.curves=ra,e.ec=s5,e.eddsa=l5}(Tl);const p5={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe",batchFetchMessages:"waku_batchFetchMessages"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe",batchFetchMessages:"irn_batchFetchMessages"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe",batchFetchMessages:"iridium_batchFetchMessages"}};var b5=Object.defineProperty,b0=Object.getOwnPropertySymbols,g5=Object.prototype.hasOwnProperty,y5=Object.prototype.propertyIsEnumerable,g0=(t,e,r)=>e in t?b5(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,v5=(t,e)=>{for(var r in e||(e={}))g5.call(e,r)&&g0(t,r,e[r]);if(b0)for(var r of b0(e))y5.call(e,r)&&g0(t,r,e[r]);return t};const m5=":";function ha(t){const[e,r]=t.split(m5);return{namespace:e,reference:r}}function y0(t,e){return t.includes(":")?[t]:e.chains||[]}const w5="ReactNative",Zt={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},_5="js";function da(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function xi(){return!ls()&&!!Ac()&&navigator.product===w5}function E5(){return xi()&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"&&(global==null?void 0:global.Platform.OS)==="android"}function x5(){return xi()&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"&&(global==null?void 0:global.Platform.OS)==="ios"}function Ds(){return!da()&&!!Ac()&&!!ls()}function Os(){return xi()?Zt.reactNative:da()?Zt.node:Ds()?Zt.browser:Zt.unknown}function v0(){var t;try{return xi()&&typeof global<"u"&&typeof(global==null?void 0:global.Application)<"u"?(t=global.Application)==null?void 0:t.applicationId:void 0}catch{return}}function S5(t,e){const r=new URLSearchParams(t);for(const i of Object.keys(e).sort())if(e.hasOwnProperty(i)){const n=e[i];n!==void 0&&r.set(i,n)}return r.toString()}function m0(){return sd()||{name:"",description:"",url:"",icons:[""]}}function I5(){if(Os()===Zt.reactNative&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"){const{OS:r,Version:i}=global.Platform;return[r,i].join("-")}const t=Qv();if(t===null)return"unknown";const e=t.os?t.os.replace(" ","").toLowerCase():"unknown";return t.type==="browser"?[e,t.name,t.version].join("-"):[e,t.version].join("-")}function A5(){var t;const e=Os();return e===Zt.browser?[e,((t=nd())==null?void 0:t.host)||"unknown"].join(":"):e}function w0(t,e,r){const i=I5(),n=A5();return[[t,e].join("-"),[_5,r].join("-"),i,n].join("/")}function D5({protocol:t,version:e,relayUrl:r,sdkVersion:i,auth:n,projectId:s,useOnCloseEvent:o,bundleId:a,packageName:c}){const u=r.split("?"),h=w0(t,e,i),l={auth:n,ua:h,projectId:s,useOnCloseEvent:o||void 0,packageName:c||void 0,bundleId:a||void 0},b=S5(u[1]||"",l);return u[0]+"?"+b}function Xi(t,e){return t.filter(r=>e.includes(r)).length===t.length}function _0(t){return Object.fromEntries(t.entries())}function E0(t){return new Map(Object.entries(t))}function Zi(t=V.FIVE_MINUTES,e){const r=V.toMiliseconds(t||V.FIVE_MINUTES);let i,n,s,o;return{resolve:a=>{s&&i&&(clearTimeout(s),i(a),o=Promise.resolve(a))},reject:a=>{s&&n&&(clearTimeout(s),n(a))},done:()=>new Promise((a,c)=>{if(o)return a(o);s=setTimeout(()=>{const u=new Error(e);o=Promise.reject(u),c(u)},r),i=a,n=c})}}function Si(t,e,r){return new Promise(async(i,n)=>{const s=setTimeout(()=>n(new Error(r)),e);try{const o=await t;i(o)}catch(o){n(o)}clearTimeout(s)})}function x0(t,e){if(typeof e=="string"&&e.startsWith(`${t}:`))return e;if(t.toLowerCase()==="topic"){if(typeof e!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${e}`}else if(t.toLowerCase()==="id"){if(typeof e!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${e}`}throw new Error(`Unknown expirer target type: ${t}`)}function O5(t){return x0("topic",t)}function M5(t){return x0("id",t)}function S0(t){const[e,r]=t.split(":"),i={id:void 0,topic:void 0};if(e==="topic"&&typeof r=="string")i.topic=r;else if(e==="id"&&Number.isInteger(Number(r)))i.id=Number(r);else throw new Error(`Invalid target, expected id:number or topic:string, got ${e}:${r}`);return i}function ct(t,e){return V.fromMiliseconds((e||Date.now())+V.toMiliseconds(t))}function Ii(t){return Date.now()>=V.toMiliseconds(t)}function he(t,e){return`${t}${e?`:${e}`:""}`}function $5(t=[],e=[]){return[...new Set([...t,...e])]}async function P5({id:t,topic:e,wcDeepLink:r}){var i;try{if(!r)return;const n=typeof r=="string"?JSON.parse(r):r,s=n?.href;if(typeof s!="string")return;const o=T5(s,t,e),a=Os();if(a===Zt.browser){if(!((i=ls())!=null&&i.hasFocus())){console.warn("Document does not have focus, skipping deeplink.");return}R5(o)}else a===Zt.reactNative&&typeof(global==null?void 0:global.Linking)<"u"&&await global.Linking.openURL(o)}catch(n){console.error(n)}}function T5(t,e,r){const i=`requestId=${e}&sessionTopic=${r}`;t.endsWith("/")&&(t=t.slice(0,-1));let n=`${t}`;if(t.startsWith("https://t.me")){const s=t.includes("?")?"&startapp=":"?startapp=";n=`${n}${s}${F5(i,!0)}`}else n=`${n}/wc?${i}`;return n}function R5(t){let e="_self";B5()?e="_top":(C5()||t.startsWith("https://")||t.startsWith("http://"))&&(e="_blank"),window.open(t,e,"noreferrer noopener")}async function N5(t,e){let r="";try{if(Ds()&&(r=localStorage.getItem(e),r))return r;r=await t.getItem(e)}catch(i){console.error(i)}return r}function I0(t,e){if(!t.includes(e))return null;const r=t.split(/([&,?,=])/),i=r.indexOf(e);return r[i+2]}function A0(){return typeof crypto<"u"&&crypto!=null&&crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/gu,t=>{const e=Math.random()*16|0;return(t==="x"?e:e&3|8).toString(16)})}function Su(){return typeof process<"u"&&process.env.IS_VITEST==="true"}function C5(){return typeof window<"u"&&(!!window.TelegramWebviewProxy||!!window.Telegram||!!window.TelegramWebviewProxyProto)}function B5(){try{return window.self!==window.top}catch{return!1}}function F5(t,e=!1){const r=Buffer.from(t).toString("base64");return e?r.replace(/[=]/g,""):r}function D0(t){return Buffer.from(t,"base64").toString("utf-8")}function L5(t){return new Promise(e=>setTimeout(e,t))}function Ms(t){if(!Number.isSafeInteger(t)||t<0)throw new Error("positive integer expected, got "+t)}function q5(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function la(t,...e){if(!q5(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function Iu(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");Ms(t.outputLen),Ms(t.blockLen)}function Gn(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function O0(t,e){la(t);const r=e.outputLen;if(t.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}const pa=BigInt(2**32-1),M0=BigInt(32);function z5(t,e=!1){return e?{h:Number(t&pa),l:Number(t>>M0&pa)}:{h:Number(t>>M0&pa)|0,l:Number(t&pa)|0}}function U5(t,e=!1){let r=new Uint32Array(t.length),i=new Uint32Array(t.length);for(let n=0;n<t.length;n++){const{h:s,l:o}=z5(t[n],e);[r[n],i[n]]=[s,o]}return[r,i]}const k5=(t,e,r)=>t<<r|e>>>32-r,j5=(t,e,r)=>e<<r|t>>>32-r,K5=(t,e,r)=>e<<r-32|t>>>64-r,V5=(t,e,r)=>t<<r-32|e>>>64-r,Wn=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;function H5(t){return new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4))}function Au(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function qr(t,e){return t<<32-e|t>>>e}const $0=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function G5(t){return t<<24&4278190080|t<<8&16711680|t>>>8&65280|t>>>24&255}function P0(t){for(let e=0;e<t.length;e++)t[e]=G5(t[e])}function W5(t){if(typeof t!="string")throw new Error("utf8ToBytes expected string, got "+typeof t);return new Uint8Array(new TextEncoder().encode(t))}function Yn(t){return typeof t=="string"&&(t=W5(t)),la(t),t}class Du{clone(){return this._cloneInto()}}function T0(t){const e=i=>t().update(Yn(i)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e}function $s(t=32){if(Wn&&typeof Wn.getRandomValues=="function")return Wn.getRandomValues(new Uint8Array(t));if(Wn&&typeof Wn.randomBytes=="function")return Wn.randomBytes(t);throw new Error("crypto.getRandomValues must be defined")}const R0=[],N0=[],C0=[],Y5=BigInt(0),Ps=BigInt(1),X5=BigInt(2),Z5=BigInt(7),J5=BigInt(256),Q5=BigInt(113);for(let t=0,e=Ps,r=1,i=0;t<24;t++){[r,i]=[i,(2*r+3*i)%5],R0.push(2*(5*i+r)),N0.push((t+1)*(t+2)/2%64);let n=Y5;for(let s=0;s<7;s++)e=(e<<Ps^(e>>Z5)*Q5)%J5,e&X5&&(n^=Ps<<(Ps<<BigInt(s))-Ps);C0.push(n)}const[e9,t9]=U5(C0,!0),B0=(t,e,r)=>r>32?K5(t,e,r):k5(t,e,r),F0=(t,e,r)=>r>32?V5(t,e,r):j5(t,e,r);function r9(t,e=24){const r=new Uint32Array(10);for(let i=24-e;i<24;i++){for(let o=0;o<10;o++)r[o]=t[o]^t[o+10]^t[o+20]^t[o+30]^t[o+40];for(let o=0;o<10;o+=2){const a=(o+8)%10,c=(o+2)%10,u=r[c],h=r[c+1],l=B0(u,h,1)^r[a],b=F0(u,h,1)^r[a+1];for(let w=0;w<50;w+=10)t[o+w]^=l,t[o+w+1]^=b}let n=t[2],s=t[3];for(let o=0;o<24;o++){const a=N0[o],c=B0(n,s,a),u=F0(n,s,a),h=R0[o];n=t[h],s=t[h+1],t[h]=c,t[h+1]=u}for(let o=0;o<50;o+=10){for(let a=0;a<10;a++)r[a]=t[o+a];for(let a=0;a<10;a++)t[o+a]^=~r[(a+2)%10]&r[(a+4)%10]}t[0]^=e9[i],t[1]^=t9[i]}r.fill(0)}class Ou extends Du{constructor(e,r,i,n=!1,s=24){if(super(),this.blockLen=e,this.suffix=r,this.outputLen=i,this.enableXOF=n,this.rounds=s,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,Ms(i),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=H5(this.state)}keccak(){$0||P0(this.state32),r9(this.state32,this.rounds),$0||P0(this.state32),this.posOut=0,this.pos=0}update(e){Gn(this);const{blockLen:r,state:i}=this;e=Yn(e);const n=e.length;for(let s=0;s<n;){const o=Math.min(r-this.pos,n-s);for(let a=0;a<o;a++)i[this.pos++]^=e[s++];this.pos===r&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:r,pos:i,blockLen:n}=this;e[i]^=r,(r&128)!==0&&i===n-1&&this.keccak(),e[n-1]^=128,this.keccak()}writeInto(e){Gn(this,!1),la(e),this.finish();const r=this.state,{blockLen:i}=this;for(let n=0,s=e.length;n<s;){this.posOut>=i&&this.keccak();const o=Math.min(i-this.posOut,s-n);e.set(r.subarray(this.posOut,this.posOut+o),n),this.posOut+=o,n+=o}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return Ms(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(O0(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(e){const{blockLen:r,suffix:i,outputLen:n,rounds:s,enableXOF:o}=this;return e||(e=new Ou(r,i,n,o,s)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=s,e.suffix=i,e.outputLen=n,e.enableXOF=o,e.destroyed=this.destroyed,e}}const i9=(t,e,r)=>T0(()=>new Ou(e,t,r)),n9=i9(1,136,256/8),s9="https://rpc.walletconnect.org/v1";function L0(t){const e=`Ethereum Signed Message:
${t.length}`,r=new TextEncoder().encode(e+t);return"0x"+Buffer.from(n9(r)).toString("hex")}async function o9(t,e,r,i,n,s){switch(r.t){case"eip191":return await a9(t,e,r.s);case"eip1271":return await c9(t,e,r.s,i,n,s);default:throw new Error(`verifySignature failed: Attempted to verify CacaoSignature with unknown type: ${r.t}`)}}async function a9(t,e,r){return(await Zm({hash:L0(e),signature:r})).toLowerCase()===t.toLowerCase()}async function c9(t,e,r,i,n,s){const o=ha(i);if(!o.namespace||!o.reference)throw new Error(`isValidEip1271Signature failed: chainId must be in CAIP-2 format, received: ${i}`);try{const a="0x1626ba7e",c="0000000000000000000000000000000000000000000000000000000000000040",u="0000000000000000000000000000000000000000000000000000000000000041",h=r.substring(2),l=L0(e).substring(2),b=a+l+c+u+h,w=await fetch(`${s||s9}/?chainId=${i}&projectId=${n}`,{method:"POST",body:JSON.stringify({id:u9(),jsonrpc:"2.0",method:"eth_call",params:[{to:t,data:b},"latest"]})}),{result:g}=await w.json();return g?g.slice(0,a.length).toLowerCase()===a.toLowerCase():!1}catch(a){return console.error("isValidEip1271Signature: ",a),!1}}function u9(){return Date.now()+Math.floor(Math.random()*1e3)}var f9=Object.defineProperty,h9=Object.defineProperties,d9=Object.getOwnPropertyDescriptors,q0=Object.getOwnPropertySymbols,l9=Object.prototype.hasOwnProperty,p9=Object.prototype.propertyIsEnumerable,z0=(t,e,r)=>e in t?f9(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,b9=(t,e)=>{for(var r in e||(e={}))l9.call(e,r)&&z0(t,r,e[r]);if(q0)for(var r of q0(e))p9.call(e,r)&&z0(t,r,e[r]);return t},g9=(t,e)=>h9(t,d9(e));const y9="did:pkh:",Mu=t=>t?.split(":"),v9=t=>{const e=t&&Mu(t);if(e)return t.includes(y9)?e[3]:e[1]},$u=t=>{const e=t&&Mu(t);if(e)return e[2]+":"+e[3]},ba=t=>{const e=t&&Mu(t);if(e)return e.pop()};async function U0(t){const{cacao:e,projectId:r}=t,{s:i,p:n}=e,s=k0(n,n.iss),o=ba(n.iss);return await o9(o,s,i,$u(n.iss),r)}const k0=(t,e)=>{const r=`${t.domain} wants you to sign in with your Ethereum account:`,i=ba(e);if(!t.aud&&!t.uri)throw new Error("Either `aud` or `uri` is required to construct the message");let n=t.statement||void 0;const s=`URI: ${t.aud||t.uri}`,o=`Version: ${t.version}`,a=`Chain ID: ${v9(e)}`,c=`Nonce: ${t.nonce}`,u=`Issued At: ${t.iat}`,h=t.exp?`Expiration Time: ${t.exp}`:void 0,l=t.nbf?`Not Before: ${t.nbf}`:void 0,b=t.requestId?`Request ID: ${t.requestId}`:void 0,w=t.resources?`Resources:${t.resources.map(x=>`
- ${x}`).join("")}`:void 0,g=ga(t.resources);if(g){const x=Ts(g);n=D9(n,x)}return[r,i,"",n,"",s,o,a,c,u,h,l,b,w].filter(x=>x!=null).join(`
`)};function m9(t){return Buffer.from(JSON.stringify(t)).toString("base64")}function w9(t){return JSON.parse(Buffer.from(t,"base64").toString("utf-8"))}function Ji(t){if(!t)throw new Error("No recap provided, value is undefined");if(!t.att)throw new Error("No `att` property found");const e=Object.keys(t.att);if(!(e!=null&&e.length))throw new Error("No resources found in `att` property");e.forEach(r=>{const i=t.att[r];if(Array.isArray(i))throw new Error(`Resource must be an object: ${r}`);if(typeof i!="object")throw new Error(`Resource must be an object: ${r}`);if(!Object.keys(i).length)throw new Error(`Resource object is empty: ${r}`);Object.keys(i).forEach(n=>{const s=i[n];if(!Array.isArray(s))throw new Error(`Ability limits ${n} must be an array of objects, found: ${s}`);if(!s.length)throw new Error(`Value of ${n} is empty array, must be an array with objects`);s.forEach(o=>{if(typeof o!="object")throw new Error(`Ability limits (${n}) must be an array of objects, found: ${o}`)})})})}function _9(t,e,r,i={}){return r?.sort((n,s)=>n.localeCompare(s)),{att:{[t]:E9(e,r,i)}}}function E9(t,e,r={}){e=e?.sort((n,s)=>n.localeCompare(s));const i=e.map(n=>({[`${t}/${n}`]:[r]}));return Object.assign({},...i)}function j0(t){return Ji(t),`urn:recap:${m9(t).replace(/=/g,"")}`}function Ts(t){const e=w9(t.replace("urn:recap:",""));return Ji(e),e}function x9(t,e,r){const i=_9(t,e,r);return j0(i)}function S9(t){return t&&t.includes("urn:recap:")}function I9(t,e){const r=Ts(t),i=Ts(e),n=A9(r,i);return j0(n)}function A9(t,e){Ji(t),Ji(e);const r=Object.keys(t.att).concat(Object.keys(e.att)).sort((n,s)=>n.localeCompare(s)),i={att:{}};return r.forEach(n=>{var s,o;Object.keys(((s=t.att)==null?void 0:s[n])||{}).concat(Object.keys(((o=e.att)==null?void 0:o[n])||{})).sort((a,c)=>a.localeCompare(c)).forEach(a=>{var c,u;i.att[n]=g9(b9({},i.att[n]),{[a]:((c=t.att[n])==null?void 0:c[a])||((u=e.att[n])==null?void 0:u[a])})})}),i}function D9(t="",e){Ji(e);const r="I further authorize the stated URI to perform the following actions on my behalf: ";if(t.includes(r))return t;const i=[];let n=0;Object.keys(e.att).forEach(a=>{const c=Object.keys(e.att[a]).map(l=>({ability:l.split("/")[0],action:l.split("/")[1]}));c.sort((l,b)=>l.action.localeCompare(b.action));const u={};c.forEach(l=>{u[l.ability]||(u[l.ability]=[]),u[l.ability].push(l.action)});const h=Object.keys(u).map(l=>(n++,`(${n}) '${l}': '${u[l].join("', '")}' for '${a}'.`));i.push(h.join(", ").replace(".,","."))});const s=i.join(" "),o=`${r}${s}`;return`${t?t+" ":""}${o}`}function K0(t){var e;const r=Ts(t);Ji(r);const i=(e=r.att)==null?void 0:e.eip155;return i?Object.keys(i).map(n=>n.split("/")[1]):[]}function V0(t){const e=Ts(t);Ji(e);const r=[];return Object.values(e.att).forEach(i=>{Object.values(i).forEach(n=>{var s;(s=n?.[0])!=null&&s.chains&&r.push(n[0].chains)})}),[...new Set(r.flat())]}function ga(t){if(!t)return;const e=t?.[t.length-1];return S9(e)?e:void 0}function Pu(t){if(!Number.isSafeInteger(t)||t<0)throw new Error("positive integer expected, got "+t)}function H0(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function Jt(t,...e){if(!H0(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function G0(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function O9(t,e){Jt(t);const r=e.outputLen;if(t.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}function W0(t){if(typeof t!="boolean")throw new Error(`boolean expected, not ${t}`)}const Ai=t=>new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4)),M9=t=>new DataView(t.buffer,t.byteOffset,t.byteLength);if(!(new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68))throw new Error("Non little-endian hardware is not supported");function $9(t){if(typeof t!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(t))}function Tu(t){if(typeof t=="string")t=$9(t);else if(H0(t))t=Ru(t);else throw new Error("Uint8Array expected, got "+typeof t);return t}function P9(t,e){if(e==null||typeof e!="object")throw new Error("options must be defined");return Object.assign(t,e)}function T9(t,e){if(t.length!==e.length)return!1;let r=0;for(let i=0;i<t.length;i++)r|=t[i]^e[i];return r===0}const R9=(t,e)=>{function r(i,...n){if(Jt(i),t.nonceLength!==void 0){const u=n[0];if(!u)throw new Error("nonce / iv required");t.varSizeNonce?Jt(u):Jt(u,t.nonceLength)}const s=t.tagLength;s&&n[1]!==void 0&&Jt(n[1]);const o=e(i,...n),a=(u,h)=>{if(h!==void 0){if(u!==2)throw new Error("cipher output not supported");Jt(h)}};let c=!1;return{encrypt(u,h){if(c)throw new Error("cannot encrypt() twice with same key + nonce");return c=!0,Jt(u),a(o.encrypt.length,h),o.encrypt(u,h)},decrypt(u,h){if(Jt(u),s&&u.length<s)throw new Error("invalid ciphertext length: smaller than tagLength="+s);return a(o.decrypt.length,h),o.decrypt(u,h)}}}return Object.assign(r,t),r};function Y0(t,e,r=!0){if(e===void 0)return new Uint8Array(t);if(e.length!==t)throw new Error("invalid output length, expected "+t+", got: "+e.length);if(r&&!N9(e))throw new Error("invalid output, must be aligned");return e}function X0(t,e,r,i){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,r,i);const n=BigInt(32),s=BigInt(4294967295),o=Number(r>>n&s),a=Number(r&s),c=i?4:0,u=i?0:4;t.setUint32(e+c,o,i),t.setUint32(e+u,a,i)}function N9(t){return t.byteOffset%4===0}function Ru(t){return Uint8Array.from(t)}function Xn(...t){for(let e=0;e<t.length;e++)t[e].fill(0)}const Z0=t=>Uint8Array.from(t.split("").map(e=>e.charCodeAt(0))),C9=Z0("expand 16-byte k"),B9=Z0("expand 32-byte k"),F9=Ai(C9),L9=Ai(B9);function ue(t,e){return t<<e|t>>>32-e}function Nu(t){return t.byteOffset%4===0}const ya=64,q9=16,J0=2**32-1,Q0=new Uint32Array;function z9(t,e,r,i,n,s,o,a){const c=n.length,u=new Uint8Array(ya),h=Ai(u),l=Nu(n)&&Nu(s),b=l?Ai(n):Q0,w=l?Ai(s):Q0;for(let g=0;g<c;o++){if(t(e,r,i,h,o,a),o>=J0)throw new Error("arx: counter overflow");const x=Math.min(ya,c-g);if(l&&x===ya){const A=g/4;if(g%4!==0)throw new Error("arx: invalid block position");for(let D=0,$;D<q9;D++)$=A+D,w[$]=b[$]^h[D];g+=ya;continue}for(let A=0,D;A<x;A++)D=g+A,s[D]=n[D]^u[A];g+=x}}function U9(t,e){const{allowShortKeys:r,extendNonceFn:i,counterLength:n,counterRight:s,rounds:o}=P9({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},e);if(typeof t!="function")throw new Error("core must be a function");return Pu(n),Pu(o),W0(s),W0(r),(a,c,u,h,l=0)=>{Jt(a),Jt(c),Jt(u);const b=u.length;if(h===void 0&&(h=new Uint8Array(b)),Jt(h),Pu(l),l<0||l>=J0)throw new Error("arx: counter overflow");if(h.length<b)throw new Error(`arx: output (${h.length}) is shorter than data (${b})`);const w=[];let g=a.length,x,A;if(g===32)w.push(x=Ru(a)),A=L9;else if(g===16&&r)x=new Uint8Array(32),x.set(a),x.set(a,16),A=F9,w.push(x);else throw new Error(`arx: invalid 32-byte key, got length=${g}`);Nu(c)||w.push(c=Ru(c));const D=Ai(x);if(i){if(c.length!==24)throw new Error("arx: extended nonce must be 24 bytes");i(A,D,Ai(c.subarray(0,16)),D),c=c.subarray(16)}const $=16-n;if($!==c.length)throw new Error(`arx: nonce must be ${$} or 16 bytes`);if($!==12){const T=new Uint8Array(12);T.set(c,s?0:12-c.length),c=T,w.push(c)}const P=Ai(c);return z9(t,A,D,P,u,h,l,o),Xn(...w),h}}const St=(t,e)=>t[e++]&255|(t[e++]&255)<<8;class k9{constructor(e){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,e=Tu(e),Jt(e,32);const r=St(e,0),i=St(e,2),n=St(e,4),s=St(e,6),o=St(e,8),a=St(e,10),c=St(e,12),u=St(e,14);this.r[0]=r&8191,this.r[1]=(r>>>13|i<<3)&8191,this.r[2]=(i>>>10|n<<6)&7939,this.r[3]=(n>>>7|s<<9)&8191,this.r[4]=(s>>>4|o<<12)&255,this.r[5]=o>>>1&8190,this.r[6]=(o>>>14|a<<2)&8191,this.r[7]=(a>>>11|c<<5)&8065,this.r[8]=(c>>>8|u<<8)&8191,this.r[9]=u>>>5&127;for(let h=0;h<8;h++)this.pad[h]=St(e,16+2*h)}process(e,r,i=!1){const n=i?0:2048,{h:s,r:o}=this,a=o[0],c=o[1],u=o[2],h=o[3],l=o[4],b=o[5],w=o[6],g=o[7],x=o[8],A=o[9],D=St(e,r+0),$=St(e,r+2),P=St(e,r+4),T=St(e,r+6),N=St(e,r+8),L=St(e,r+10),F=St(e,r+12),B=St(e,r+14);let C=s[0]+(D&8191),G=s[1]+((D>>>13|$<<3)&8191),I=s[2]+(($>>>10|P<<6)&8191),f=s[3]+((P>>>7|T<<9)&8191),p=s[4]+((T>>>4|N<<12)&8191),v=s[5]+(N>>>1&8191),y=s[6]+((N>>>14|L<<2)&8191),m=s[7]+((L>>>11|F<<5)&8191),S=s[8]+((F>>>8|B<<8)&8191),O=s[9]+(B>>>5|n),_=0,d=_+C*a+G*(5*A)+I*(5*x)+f*(5*g)+p*(5*w);_=d>>>13,d&=8191,d+=v*(5*b)+y*(5*l)+m*(5*h)+S*(5*u)+O*(5*c),_+=d>>>13,d&=8191;let E=_+C*c+G*a+I*(5*A)+f*(5*x)+p*(5*g);_=E>>>13,E&=8191,E+=v*(5*w)+y*(5*b)+m*(5*l)+S*(5*h)+O*(5*u),_+=E>>>13,E&=8191;let q=_+C*u+G*c+I*a+f*(5*A)+p*(5*x);_=q>>>13,q&=8191,q+=v*(5*g)+y*(5*w)+m*(5*b)+S*(5*l)+O*(5*h),_+=q>>>13,q&=8191;let z=_+C*h+G*u+I*c+f*a+p*(5*A);_=z>>>13,z&=8191,z+=v*(5*x)+y*(5*g)+m*(5*w)+S*(5*b)+O*(5*l),_+=z>>>13,z&=8191;let U=_+C*l+G*h+I*u+f*c+p*a;_=U>>>13,U&=8191,U+=v*(5*A)+y*(5*x)+m*(5*g)+S*(5*w)+O*(5*b),_+=U>>>13,U&=8191;let k=_+C*b+G*l+I*h+f*u+p*c;_=k>>>13,k&=8191,k+=v*a+y*(5*A)+m*(5*x)+S*(5*g)+O*(5*w),_+=k>>>13,k&=8191;let W=_+C*w+G*b+I*l+f*h+p*u;_=W>>>13,W&=8191,W+=v*c+y*a+m*(5*A)+S*(5*x)+O*(5*g),_+=W>>>13,W&=8191;let Z=_+C*g+G*w+I*b+f*l+p*h;_=Z>>>13,Z&=8191,Z+=v*u+y*c+m*a+S*(5*A)+O*(5*x),_+=Z>>>13,Z&=8191;let J=_+C*x+G*g+I*w+f*b+p*l;_=J>>>13,J&=8191,J+=v*h+y*u+m*c+S*a+O*(5*A),_+=J>>>13,J&=8191;let X=_+C*A+G*x+I*g+f*w+p*b;_=X>>>13,X&=8191,X+=v*l+y*h+m*u+S*c+O*a,_+=X>>>13,X&=8191,_=(_<<2)+_|0,_=_+d|0,d=_&8191,_=_>>>13,E+=_,s[0]=d,s[1]=E,s[2]=q,s[3]=z,s[4]=U,s[5]=k,s[6]=W,s[7]=Z,s[8]=J,s[9]=X}finalize(){const{h:e,pad:r}=this,i=new Uint16Array(10);let n=e[1]>>>13;e[1]&=8191;for(let a=2;a<10;a++)e[a]+=n,n=e[a]>>>13,e[a]&=8191;e[0]+=n*5,n=e[0]>>>13,e[0]&=8191,e[1]+=n,n=e[1]>>>13,e[1]&=8191,e[2]+=n,i[0]=e[0]+5,n=i[0]>>>13,i[0]&=8191;for(let a=1;a<10;a++)i[a]=e[a]+n,n=i[a]>>>13,i[a]&=8191;i[9]-=8192;let s=(n^1)-1;for(let a=0;a<10;a++)i[a]&=s;s=~s;for(let a=0;a<10;a++)e[a]=e[a]&s|i[a];e[0]=(e[0]|e[1]<<13)&65535,e[1]=(e[1]>>>3|e[2]<<10)&65535,e[2]=(e[2]>>>6|e[3]<<7)&65535,e[3]=(e[3]>>>9|e[4]<<4)&65535,e[4]=(e[4]>>>12|e[5]<<1|e[6]<<14)&65535,e[5]=(e[6]>>>2|e[7]<<11)&65535,e[6]=(e[7]>>>5|e[8]<<8)&65535,e[7]=(e[8]>>>8|e[9]<<5)&65535;let o=e[0]+r[0];e[0]=o&65535;for(let a=1;a<8;a++)o=(e[a]+r[a]|0)+(o>>>16)|0,e[a]=o&65535;Xn(i)}update(e){G0(this);const{buffer:r,blockLen:i}=this;e=Tu(e);const n=e.length;for(let s=0;s<n;){const o=Math.min(i-this.pos,n-s);if(o===i){for(;i<=n-s;s+=i)this.process(e,s);continue}r.set(e.subarray(s,s+o),this.pos),this.pos+=o,s+=o,this.pos===i&&(this.process(r,0,!1),this.pos=0)}return this}destroy(){Xn(this.h,this.r,this.buffer,this.pad)}digestInto(e){G0(this),O9(e,this),this.finished=!0;const{buffer:r,h:i}=this;let{pos:n}=this;if(n){for(r[n++]=1;n<16;n++)r[n]=0;this.process(r,0,!0)}this.finalize();let s=0;for(let o=0;o<8;o++)e[s++]=i[o]>>>0,e[s++]=i[o]>>>8;return e}digest(){const{buffer:e,outputLen:r}=this;this.digestInto(e);const i=e.slice(0,r);return this.destroy(),i}}function j9(t){const e=(i,n)=>t(n).update(Tu(i)).digest(),r=t(new Uint8Array(32));return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=i=>t(i),e}const K9=j9(t=>new k9(t));function V9(t,e,r,i,n,s=20){let o=t[0],a=t[1],c=t[2],u=t[3],h=e[0],l=e[1],b=e[2],w=e[3],g=e[4],x=e[5],A=e[6],D=e[7],$=n,P=r[0],T=r[1],N=r[2],L=o,F=a,B=c,C=u,G=h,I=l,f=b,p=w,v=g,y=x,m=A,S=D,O=$,_=P,d=T,E=N;for(let z=0;z<s;z+=2)L=L+G|0,O=ue(O^L,16),v=v+O|0,G=ue(G^v,12),L=L+G|0,O=ue(O^L,8),v=v+O|0,G=ue(G^v,7),F=F+I|0,_=ue(_^F,16),y=y+_|0,I=ue(I^y,12),F=F+I|0,_=ue(_^F,8),y=y+_|0,I=ue(I^y,7),B=B+f|0,d=ue(d^B,16),m=m+d|0,f=ue(f^m,12),B=B+f|0,d=ue(d^B,8),m=m+d|0,f=ue(f^m,7),C=C+p|0,E=ue(E^C,16),S=S+E|0,p=ue(p^S,12),C=C+p|0,E=ue(E^C,8),S=S+E|0,p=ue(p^S,7),L=L+I|0,E=ue(E^L,16),m=m+E|0,I=ue(I^m,12),L=L+I|0,E=ue(E^L,8),m=m+E|0,I=ue(I^m,7),F=F+f|0,O=ue(O^F,16),S=S+O|0,f=ue(f^S,12),F=F+f|0,O=ue(O^F,8),S=S+O|0,f=ue(f^S,7),B=B+p|0,_=ue(_^B,16),v=v+_|0,p=ue(p^v,12),B=B+p|0,_=ue(_^B,8),v=v+_|0,p=ue(p^v,7),C=C+G|0,d=ue(d^C,16),y=y+d|0,G=ue(G^y,12),C=C+G|0,d=ue(d^C,8),y=y+d|0,G=ue(G^y,7);let q=0;i[q++]=o+L|0,i[q++]=a+F|0,i[q++]=c+B|0,i[q++]=u+C|0,i[q++]=h+G|0,i[q++]=l+I|0,i[q++]=b+f|0,i[q++]=w+p|0,i[q++]=g+v|0,i[q++]=x+y|0,i[q++]=A+m|0,i[q++]=D+S|0,i[q++]=$+O|0,i[q++]=P+_|0,i[q++]=T+d|0,i[q++]=N+E|0}const H9=U9(V9,{counterRight:!1,counterLength:4,allowShortKeys:!1}),G9=new Uint8Array(16),ep=(t,e)=>{t.update(e);const r=e.length%16;r&&t.update(G9.subarray(r))},W9=new Uint8Array(32);function tp(t,e,r,i,n){const s=t(e,r,W9),o=K9.create(s);n&&ep(o,n),ep(o,i);const a=new Uint8Array(16),c=M9(a);X0(c,0,BigInt(n?n.length:0),!0),X0(c,8,BigInt(i.length),!0),o.update(a);const u=o.digest();return Xn(s,a),u}const Y9=t=>(e,r,i)=>({encrypt(n,s){const o=n.length;s=Y0(o+16,s,!1),s.set(n);const a=s.subarray(0,-16);t(e,r,a,a,1);const c=tp(t,e,r,a,i);return s.set(c,o),Xn(c),s},decrypt(n,s){s=Y0(n.length-16,s,!1);const o=n.subarray(0,-16),a=n.subarray(-16),c=tp(t,e,r,o,i);if(!T9(a,c))throw new Error("invalid tag");return s.set(n.subarray(0,-16)),t(e,r,s,s,1),Xn(c),s}}),rp=R9({blockSize:64,nonceLength:12,tagLength:16},Y9(H9));class ip extends Du{constructor(e,r){super(),this.finished=!1,this.destroyed=!1,Iu(e);const i=Yn(r);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const n=this.blockLen,s=new Uint8Array(n);s.set(i.length>n?e.create().update(i).digest():i);for(let o=0;o<s.length;o++)s[o]^=54;this.iHash.update(s),this.oHash=e.create();for(let o=0;o<s.length;o++)s[o]^=106;this.oHash.update(s),s.fill(0)}update(e){return Gn(this),this.iHash.update(e),this}digestInto(e){Gn(this),la(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:r,iHash:i,finished:n,destroyed:s,blockLen:o,outputLen:a}=this;return e=e,e.finished=n,e.destroyed=s,e.blockLen=o,e.outputLen=a,e.oHash=r._cloneInto(e.oHash),e.iHash=i._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const Cu=(t,e,r)=>new ip(t,e).update(r).digest();Cu.create=(t,e)=>new ip(t,e);function X9(t,e,r){return Iu(t),r===void 0&&(r=new Uint8Array(t.outputLen)),Cu(t,Yn(r),Yn(e))}const Bu=new Uint8Array([0]),np=new Uint8Array;function Z9(t,e,r,i=32){if(Iu(t),Ms(i),i>255*t.outputLen)throw new Error("Length should be <= 255*HashLen");const n=Math.ceil(i/t.outputLen);r===void 0&&(r=np);const s=new Uint8Array(n*t.outputLen),o=Cu.create(t,e),a=o._cloneInto(),c=new Uint8Array(o.outputLen);for(let u=0;u<n;u++)Bu[0]=u+1,a.update(u===0?np:c).update(r).update(Bu).digestInto(c),s.set(c,t.outputLen*u),o._cloneInto(a);return o.destroy(),a.destroy(),c.fill(0),Bu.fill(0),s.slice(0,i)}const J9=(t,e,r,i,n)=>Z9(t,X9(t,e,r),i,n);function Q9(t,e,r,i){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,r,i);const n=BigInt(32),s=BigInt(4294967295),o=Number(r>>n&s),a=Number(r&s),c=i?4:0,u=i?0:4;t.setUint32(e+c,o,i),t.setUint32(e+u,a,i)}function e7(t,e,r){return t&e^~t&r}function t7(t,e,r){return t&e^t&r^e&r}class r7 extends Du{constructor(e,r,i,n){super(),this.blockLen=e,this.outputLen=r,this.padOffset=i,this.isLE=n,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=Au(this.buffer)}update(e){Gn(this);const{view:r,buffer:i,blockLen:n}=this;e=Yn(e);const s=e.length;for(let o=0;o<s;){const a=Math.min(n-this.pos,s-o);if(a===n){const c=Au(e);for(;n<=s-o;o+=n)this.process(c,o);continue}i.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===n&&(this.process(r,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){Gn(this),O0(e,this),this.finished=!0;const{buffer:r,view:i,blockLen:n,isLE:s}=this;let{pos:o}=this;r[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>n-o&&(this.process(i,0),o=0);for(let l=o;l<n;l++)r[l]=0;Q9(i,n-8,BigInt(this.length*8),s),this.process(i,0);const a=Au(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const u=c/4,h=this.get();if(u>h.length)throw new Error("_sha2: outputLen bigger than state");for(let l=0;l<u;l++)a.setUint32(4*l,h[l],s)}digest(){const{buffer:e,outputLen:r}=this;this.digestInto(e);const i=e.slice(0,r);return this.destroy(),i}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:r,buffer:i,length:n,finished:s,destroyed:o,pos:a}=this;return e.length=n,e.pos=a,e.finished=s,e.destroyed=o,n%r&&e.buffer.set(i),e}}const i7=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Di=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Oi=new Uint32Array(64);class n7 extends r7{constructor(){super(64,32,8,!1),this.A=Di[0]|0,this.B=Di[1]|0,this.C=Di[2]|0,this.D=Di[3]|0,this.E=Di[4]|0,this.F=Di[5]|0,this.G=Di[6]|0,this.H=Di[7]|0}get(){const{A:e,B:r,C:i,D:n,E:s,F:o,G:a,H:c}=this;return[e,r,i,n,s,o,a,c]}set(e,r,i,n,s,o,a,c){this.A=e|0,this.B=r|0,this.C=i|0,this.D=n|0,this.E=s|0,this.F=o|0,this.G=a|0,this.H=c|0}process(e,r){for(let l=0;l<16;l++,r+=4)Oi[l]=e.getUint32(r,!1);for(let l=16;l<64;l++){const b=Oi[l-15],w=Oi[l-2],g=qr(b,7)^qr(b,18)^b>>>3,x=qr(w,17)^qr(w,19)^w>>>10;Oi[l]=x+Oi[l-7]+g+Oi[l-16]|0}let{A:i,B:n,C:s,D:o,E:a,F:c,G:u,H:h}=this;for(let l=0;l<64;l++){const b=qr(a,6)^qr(a,11)^qr(a,25),w=h+b+e7(a,c,u)+i7[l]+Oi[l]|0,g=(qr(i,2)^qr(i,13)^qr(i,22))+t7(i,n,s)|0;h=u,u=c,c=a,a=o+w|0,o=s,s=n,n=i,i=w+g|0}i=i+this.A|0,n=n+this.B|0,s=s+this.C|0,o=o+this.D|0,a=a+this.E|0,c=c+this.F|0,u=u+this.G|0,h=h+this.H|0,this.set(i,n,s,o,a,c,u,h)}roundClean(){Oi.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}const va=T0(()=>new n7);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const sp=BigInt(0);function Fu(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function op(t){if(!Fu(t))throw new Error("Uint8Array expected")}const s7=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function o7(t){op(t);let e="";for(let r=0;r<t.length;r++)e+=s7[t[r]];return e}function a7(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return t===""?sp:BigInt("0x"+t)}const ii={_0:48,_9:57,A:65,F:70,a:97,f:102};function ap(t){if(t>=ii._0&&t<=ii._9)return t-ii._0;if(t>=ii.A&&t<=ii.F)return t-(ii.A-10);if(t>=ii.a&&t<=ii.f)return t-(ii.a-10)}function cp(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);const e=t.length,r=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);const i=new Uint8Array(r);for(let n=0,s=0;n<r;n++,s+=2){const o=ap(t.charCodeAt(s)),a=ap(t.charCodeAt(s+1));if(o===void 0||a===void 0){const c=t[s]+t[s+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+s)}i[n]=o*16+a}return i}function up(t){return op(t),a7(o7(Uint8Array.from(t).reverse()))}function c7(t,e){return cp(t.toString(16).padStart(e*2,"0"))}function u7(t,e){return c7(t,e).reverse()}function fp(t,e,r){let i;if(typeof e=="string")try{i=cp(e)}catch(s){throw new Error(t+" must be hex string or Uint8Array, cause: "+s)}else if(Fu(e))i=Uint8Array.from(e);else throw new Error(t+" must be hex string or Uint8Array");const n=i.length;if(typeof r=="number"&&n!==r)throw new Error(t+" of length "+r+" expected, got "+n);return i}const Lu=t=>typeof t=="bigint"&&sp<=t;function f7(t,e,r){return Lu(t)&&Lu(e)&&Lu(r)&&e<=t&&t<r}function hp(t,e,r,i){if(!f7(e,r,i))throw new Error("expected valid "+t+": "+r+" <= n < "+i+", got "+e)}const h7={bigint:t=>typeof t=="bigint",function:t=>typeof t=="function",boolean:t=>typeof t=="boolean",string:t=>typeof t=="string",stringOrUint8Array:t=>typeof t=="string"||Fu(t),isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>typeof t=="function"&&Number.isSafeInteger(t.outputLen)};function d7(t,e,r={}){const i=(n,s,o)=>{const a=h7[s];if(typeof a!="function")throw new Error("invalid validator function");const c=t[n];if(!(o&&c===void 0)&&!a(c,t))throw new Error("param "+String(n)+" is invalid. Expected "+s+", got "+c)};for(const[n,s]of Object.entries(e))i(n,s,!1);for(const[n,s]of Object.entries(r))i(n,s,!0);return t}const Zn=BigInt(0),ma=BigInt(1);function dp(t,e){const r=t%e;return r>=Zn?r:e+r}function l7(t,e,r){if(e<Zn)throw new Error("invalid exponent, negatives unsupported");if(r<=Zn)throw new Error("invalid modulus");if(r===ma)return Zn;let i=ma;for(;e>Zn;)e&ma&&(i=i*t%r),t=t*t%r,e>>=ma;return i}function vr(t,e,r){let i=t;for(;e-- >Zn;)i*=i,i%=r;return i}BigInt(0),BigInt(1),BigInt(0),BigInt(1),BigInt(2),BigInt(8);const Jn=BigInt(0),qu=BigInt(1);function p7(t){return d7(t,{a:"bigint"},{montgomeryBits:"isSafeInteger",nByteLength:"isSafeInteger",adjustScalarBytes:"function",domain:"function",powPminus2:"function",Gu:"bigint"}),Object.freeze(v5({},t))}function b7(t){const e=p7(t),{P:r}=e,i=$=>dp($,r),n=e.montgomeryBits,s=Math.ceil(n/8),o=e.nByteLength,a=e.adjustScalarBytes||($=>$),c=e.powPminus2||($=>l7($,r-BigInt(2),r));function u($,P,T){const N=i($*(P-T));return P=i(P-N),T=i(T+N),[P,T]}const h=(e.a-BigInt(2))/BigInt(4);function l($,P){hp("u",$,Jn,r),hp("scalar",P,Jn,r);const T=P,N=$;let L=qu,F=Jn,B=$,C=qu,G=Jn,I;for(let p=BigInt(n-1);p>=Jn;p--){const v=T>>p&qu;G^=v,I=u(G,L,B),L=I[0],B=I[1],I=u(G,F,C),F=I[0],C=I[1],G=v;const y=L+F,m=i(y*y),S=L-F,O=i(S*S),_=m-O,d=B+C,E=B-C,q=i(E*y),z=i(d*S),U=q+z,k=q-z;B=i(U*U),C=i(N*i(k*k)),L=i(m*O),F=i(_*(m+i(h*_)))}I=u(G,L,B),L=I[0],B=I[1],I=u(G,F,C),F=I[0],C=I[1];const f=c(F);return i(L*f)}function b($){return u7(i($),s)}function w($){const P=fp("u coordinate",$,s);return o===32&&(P[31]&=127),up(P)}function g($){const P=fp("scalar",$),T=P.length;if(T!==s&&T!==o){let N=""+s+" or "+o;throw new Error("invalid scalar, expected "+N+" bytes, got "+T)}return up(a(P))}function x($,P){const T=w(P),N=g($),L=l(T,N);if(L===Jn)throw new Error("invalid private or public key received");return b(L)}const A=b(e.Gu);function D($){return x($,A)}return{scalarMult:x,scalarMultBase:D,getSharedSecret:($,P)=>x($,P),getPublicKey:$=>D($),utils:{randomPrivateKey:()=>e.randomBytes(e.nByteLength)},GuBytes:A}}const zu=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949");BigInt(0);const g7=BigInt(1),lp=BigInt(2),y7=BigInt(3),v7=BigInt(5);BigInt(8);function m7(t){const e=BigInt(10),r=BigInt(20),i=BigInt(40),n=BigInt(80),s=zu,o=t*t%s*t%s,a=vr(o,lp,s)*o%s,c=vr(a,g7,s)*t%s,u=vr(c,v7,s)*c%s,h=vr(u,e,s)*u%s,l=vr(h,r,s)*h%s,b=vr(l,i,s)*l%s,w=vr(b,n,s)*b%s,g=vr(w,n,s)*b%s,x=vr(g,e,s)*u%s;return{pow_p_5_8:vr(x,lp,s)*t%s,b2:o}}function w7(t){return t[0]&=248,t[31]&=127,t[31]|=64,t}const Uu=b7({P:zu,a:BigInt(486662),montgomeryBits:255,nByteLength:32,Gu:BigInt(9),powPminus2:t=>{const e=zu,{pow_p_5_8:r,b2:i}=m7(t);return dp(vr(r,y7,e)*i,e)},adjustScalarBytes:w7,randomBytes:$s}),pp="base10",Pt="base16",Mi="base64pad",Rs="base64url",Ns="utf8",bp=0,ni=1,Cs=2,_7=0,gp=1,Bs=12,ku=32;function E7(){const t=Uu.utils.randomPrivateKey(),e=Uu.getPublicKey(t);return{privateKey:Ft(t,Pt),publicKey:Ft(e,Pt)}}function ju(){const t=$s(ku);return Ft(t,Pt)}function x7(t,e){const r=Uu.getSharedSecret(ir(t,Pt),ir(e,Pt)),i=J9(va,r,void 0,void 0,ku);return Ft(i,Pt)}function wa(t){const e=va(ir(t,Pt));return Ft(e,Pt)}function si(t){const e=va(ir(t,Ns));return Ft(e,Pt)}function yp(t){return ir(`${t}`,pp)}function Qi(t){return Number(Ft(t,pp))}function S7(t){const e=yp(typeof t.type<"u"?t.type:bp);if(Qi(e)===ni&&typeof t.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const r=typeof t.senderPublicKey<"u"?ir(t.senderPublicKey,Pt):void 0,i=typeof t.iv<"u"?ir(t.iv,Pt):$s(Bs),n=ir(t.symKey,Pt),s=rp(n,i).encrypt(ir(t.message,Ns));return vp({type:e,sealed:s,iv:i,senderPublicKey:r,encoding:t.encoding})}function I7(t){const e=ir(t.symKey,Pt),{sealed:r,iv:i}=Fs(t),n=rp(e,i).decrypt(r);if(n===null)throw new Error("Failed to decrypt");return Ft(n,Ns)}function A7(t,e){const r=yp(Cs),i=$s(Bs),n=ir(t,Ns);return vp({type:r,sealed:n,iv:i,encoding:e})}function D7(t,e){const{sealed:r}=Fs({encoded:t,encoding:e});return Ft(r,Ns)}function vp(t){const{encoding:e=Mi}=t;if(Qi(t.type)===Cs)return Ft(nu([t.type,t.sealed]),e);if(Qi(t.type)===ni){if(typeof t.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return Ft(nu([t.type,t.senderPublicKey,t.iv,t.sealed]),e)}return Ft(nu([t.type,t.iv,t.sealed]),e)}function Fs(t){const{encoded:e,encoding:r=Mi}=t,i=ir(e,r),n=i.slice(_7,gp),s=gp;if(Qi(n)===ni){const u=s+ku,h=u+Bs,l=i.slice(s,u),b=i.slice(u,h),w=i.slice(h);return{type:n,sealed:w,iv:b,senderPublicKey:l}}if(Qi(n)===Cs){const u=i.slice(s),h=$s(Bs);return{type:n,sealed:u,iv:h}}const o=s+Bs,a=i.slice(s,o),c=i.slice(o);return{type:n,sealed:c,iv:a}}function O7(t,e){const r=Fs({encoded:t,encoding:e?.encoding});return mp({type:Qi(r.type),senderPublicKey:typeof r.senderPublicKey<"u"?Ft(r.senderPublicKey,Pt):void 0,receiverPublicKey:e?.receiverPublicKey})}function mp(t){const e=t?.type||bp;if(e===ni){if(typeof t?.senderPublicKey>"u")throw new Error("missing sender public key");if(typeof t?.receiverPublicKey>"u")throw new Error("missing receiver public key")}return{type:e,senderPublicKey:t?.senderPublicKey,receiverPublicKey:t?.receiverPublicKey}}function wp(t){return t.type===ni&&typeof t.senderPublicKey=="string"&&typeof t.receiverPublicKey=="string"}function _p(t){return t.type===Cs}function M7(t){return new Tl.ec("p256").keyFromPublic({x:Buffer.from(t.x,"base64").toString("hex"),y:Buffer.from(t.y,"base64").toString("hex")},"hex")}function $7(t){let e=t.replace(/-/g,"+").replace(/_/g,"/");const r=e.length%4;return r>0&&(e+="=".repeat(4-r)),e}function P7(t){return Buffer.from($7(t),"base64")}function T7(t,e){const[r,i,n]=t.split("."),s=P7(n);if(s.length!==64)throw new Error("Invalid signature length");const o=s.slice(0,32).toString("hex"),a=s.slice(32,64).toString("hex"),c=`${r}.${i}`,u=va(c),h=M7(e),l=Ft(u,Pt);if(!h.verify(l,{r:o,s:a}))throw new Error("Invalid signature");return Ic(t).payload}const R7="irn";function _a(t){return t?.relay||{protocol:R7}}function Ls(t){const e=p5[t];if(typeof e>"u")throw new Error(`Relay Protocol not supported: ${t}`);return e}function N7(t,e="-"){const r={},i="relay"+e;return Object.keys(t).forEach(n=>{if(n.startsWith(i)){const s=n.replace(i,""),o=t[n];r[s]=o}}),r}function Ep(t){if(!t.includes("wc:")){const u=D0(t);u!=null&&u.includes("wc:")&&(t=u)}t=t.includes("wc://")?t.replace("wc://",""):t,t=t.includes("wc:")?t.replace("wc:",""):t;const e=t.indexOf(":"),r=t.indexOf("?")!==-1?t.indexOf("?"):void 0,i=t.substring(0,e),n=t.substring(e+1,r).split("@"),s=typeof r<"u"?t.substring(r):"",o=new URLSearchParams(s),a={};o.forEach((u,h)=>{a[h]=u});const c=typeof a.methods=="string"?a.methods.split(","):void 0;return{protocol:i,topic:C7(n[0]),version:parseInt(n[1],10),symKey:a.symKey,relay:N7(a),methods:c,expiryTimestamp:a.expiryTimestamp?parseInt(a.expiryTimestamp,10):void 0}}function C7(t){return t.startsWith("//")?t.substring(2):t}function B7(t,e="-"){const r="relay",i={};return Object.keys(t).forEach(n=>{const s=n,o=r+e+s;t[s]&&(i[o]=t[s])}),i}function xp(t){const e=new URLSearchParams,r=B7(t.relay);Object.keys(r).sort().forEach(n=>{e.set(n,r[n])}),e.set("symKey",t.symKey),t.expiryTimestamp&&e.set("expiryTimestamp",t.expiryTimestamp.toString()),t.methods&&e.set("methods",t.methods.join(","));const i=e.toString();return`${t.protocol}:${t.topic}@${t.version}?${i}`}function Ea(t,e,r){return`${t}?wc_ev=${r}&topic=${e}`}function Qn(t){const e=[];return t.forEach(r=>{const[i,n]=r.split(":");e.push(`${i}:${n}`)}),e}function F7(t){const e=[];return Object.values(t).forEach(r=>{e.push(...Qn(r.accounts))}),e}function L7(t,e){const r=[];return Object.values(t).forEach(i=>{Qn(i.accounts).includes(e)&&r.push(...i.methods)}),r}function q7(t,e){const r=[];return Object.values(t).forEach(i=>{Qn(i.accounts).includes(e)&&r.push(...i.events)}),r}function z7(t){const e={};return t?.forEach(r=>{var i;const[n,s]=r.split(":");e[n]||(e[n]={accounts:[],chains:[],events:[],methods:[]}),e[n].accounts.push(r),(i=e[n].chains)==null||i.push(`${n}:${s}`)}),e}function Sp(t,e){e=e.map(i=>i.replace("did:pkh:",""));const r=z7(e);for(const[i,n]of Object.entries(r))n.methods?n.methods=$5(n.methods,t):n.methods=t,n.events=["chainChanged","accountsChanged"];return r}const U7={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},k7={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function H(t,e){const{message:r,code:i}=k7[t];return{message:e?`${r} ${e}`:r,code:i}}function we(t,e){const{message:r,code:i}=U7[t];return{message:e?`${r} ${e}`:r,code:i}}function qs(t,e){return Array.isArray(t)?typeof e<"u"&&t.length?t.every(e):!0:!1}function xa(t){return Object.getPrototypeOf(t)===Object.prototype&&Object.keys(t).length}function Lt(t){return typeof t>"u"}function st(t,e){return e&&Lt(t)?!0:typeof t=="string"&&!!t.trim().length}function Ku(t,e){return e&&Lt(t)?!0:typeof t=="number"&&!isNaN(t)}function j7(t,e){const{requiredNamespaces:r}=e,i=Object.keys(t.namespaces),n=Object.keys(r);let s=!0;return Xi(n,i)?(i.forEach(o=>{const{accounts:a,methods:c,events:u}=t.namespaces[o],h=Qn(a),l=r[o];(!Xi(y0(o,l),h)||!Xi(l.methods,c)||!Xi(l.events,u))&&(s=!1)}),s):!1}function Sa(t){return st(t,!1)&&t.includes(":")?t.split(":").length===2:!1}function K7(t){if(st(t,!1)&&t.includes(":")){const e=t.split(":");if(e.length===3){const r=e[0]+":"+e[1];return!!e[2]&&Sa(r)}}return!1}function V7(t){function e(r){try{return typeof new URL(r)<"u"}catch{return!1}}try{if(st(t,!1)){if(e(t))return!0;const r=D0(t);return e(r)}}catch{}return!1}function H7(t){var e;return(e=t?.proposer)==null?void 0:e.publicKey}function G7(t){return t?.topic}function W7(t,e){let r=null;return st(t?.publicKey,!1)||(r=H("MISSING_OR_INVALID",`${e} controller public key should be a string`)),r}function Ip(t){let e=!0;return qs(t)?t.length&&(e=t.every(r=>st(r,!1))):e=!1,e}function Y7(t,e,r){let i=null;return qs(e)&&e.length?e.forEach(n=>{i||Sa(n)||(i=we("UNSUPPORTED_CHAINS",`${r}, chain ${n} should be a string and conform to "namespace:chainId" format`))}):Sa(t)||(i=we("UNSUPPORTED_CHAINS",`${r}, chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }`)),i}function X7(t,e,r){let i=null;return Object.entries(t).forEach(([n,s])=>{if(i)return;const o=Y7(n,y0(n,s),`${e} ${r}`);o&&(i=o)}),i}function Z7(t,e){let r=null;return qs(t)?t.forEach(i=>{r||K7(i)||(r=we("UNSUPPORTED_ACCOUNTS",`${e}, account ${i} should be a string and conform to "namespace:chainId:address" format`))}):r=we("UNSUPPORTED_ACCOUNTS",`${e}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),r}function J7(t,e){let r=null;return Object.values(t).forEach(i=>{if(r)return;const n=Z7(i?.accounts,`${e} namespace`);n&&(r=n)}),r}function Q7(t,e){let r=null;return Ip(t?.methods)?Ip(t?.events)||(r=we("UNSUPPORTED_EVENTS",`${e}, events should be an array of strings or empty array for no events`)):r=we("UNSUPPORTED_METHODS",`${e}, methods should be an array of strings or empty array for no methods`),r}function Ap(t,e){let r=null;return Object.values(t).forEach(i=>{if(r)return;const n=Q7(i,`${e}, namespace`);n&&(r=n)}),r}function e_(t,e,r){let i=null;if(t&&xa(t)){const n=Ap(t,e);n&&(i=n);const s=X7(t,e,r);s&&(i=s)}else i=H("MISSING_OR_INVALID",`${e}, ${r} should be an object with data`);return i}function Vu(t,e){let r=null;if(t&&xa(t)){const i=Ap(t,e);i&&(r=i);const n=J7(t,e);n&&(r=n)}else r=H("MISSING_OR_INVALID",`${e}, namespaces should be an object with data`);return r}function Dp(t){return st(t.protocol,!0)}function t_(t,e){let r=!1;return e&&!t?r=!0:t&&qs(t)&&t.length&&t.forEach(i=>{r=Dp(i)}),r}function r_(t){return typeof t=="number"}function Ht(t){return typeof t<"u"&&typeof t!==null}function i_(t){return!(!t||typeof t!="object"||!t.code||!Ku(t.code,!1)||!t.message||!st(t.message,!1))}function n_(t){return!(Lt(t)||!st(t.method,!1))}function s_(t){return!(Lt(t)||Lt(t.result)&&Lt(t.error)||!Ku(t.id,!1)||!st(t.jsonrpc,!1))}function o_(t){return!(Lt(t)||!st(t.name,!1))}function Op(t,e){return!(!Sa(e)||!F7(t).includes(e))}function a_(t,e,r){return st(r,!1)?L7(t,e).includes(r):!1}function c_(t,e,r){return st(r,!1)?q7(t,e).includes(r):!1}function Mp(t,e,r){let i=null;const n=u_(t),s=f_(e),o=Object.keys(n),a=Object.keys(s),c=$p(Object.keys(t)),u=$p(Object.keys(e)),h=c.filter(l=>!u.includes(l));return h.length&&(i=H("NON_CONFORMING_NAMESPACES",`${r} namespaces keys don't satisfy requiredNamespaces.
      Required: ${h.toString()}
      Received: ${Object.keys(e).toString()}`)),Xi(o,a)||(i=H("NON_CONFORMING_NAMESPACES",`${r} namespaces chains don't satisfy required namespaces.
      Required: ${o.toString()}
      Approved: ${a.toString()}`)),Object.keys(e).forEach(l=>{if(!l.includes(":")||i)return;const b=Qn(e[l].accounts);b.includes(l)||(i=H("NON_CONFORMING_NAMESPACES",`${r} namespaces accounts don't satisfy namespace accounts for ${l}
        Required: ${l}
        Approved: ${b.toString()}`))}),o.forEach(l=>{i||(Xi(n[l].methods,s[l].methods)?Xi(n[l].events,s[l].events)||(i=H("NON_CONFORMING_NAMESPACES",`${r} namespaces events don't satisfy namespace events for ${l}`)):i=H("NON_CONFORMING_NAMESPACES",`${r} namespaces methods don't satisfy namespace methods for ${l}`))}),i}function u_(t){const e={};return Object.keys(t).forEach(r=>{var i;r.includes(":")?e[r]=t[r]:(i=t[r].chains)==null||i.forEach(n=>{e[n]={methods:t[r].methods,events:t[r].events}})}),e}function $p(t){return[...new Set(t.map(e=>e.includes(":")?e.split(":")[0]:e))]}function f_(t){const e={};return Object.keys(t).forEach(r=>{if(r.includes(":"))e[r]=t[r];else{const i=Qn(t[r].accounts);i?.forEach(n=>{e[n]={accounts:t[r].accounts.filter(s=>s.includes(`${n}:`)),methods:t[r].methods,events:t[r].events}})}}),e}function h_(t,e){return Ku(t,!1)&&t<=e.max&&t>=e.min}function Pp(){const t=Os();return new Promise(e=>{switch(t){case Zt.browser:e(d_());break;case Zt.reactNative:e(l_());break;case Zt.node:e(p_());break;default:e(!0)}})}function d_(){return Ds()&&navigator?.onLine}async function l_(){if(xi()&&typeof global<"u"&&global!=null&&global.NetInfo){const t=await(global==null?void 0:global.NetInfo.fetch());return t?.isConnected}return!0}function p_(){return!0}function b_(t){switch(Os()){case Zt.browser:g_(t);break;case Zt.reactNative:y_(t);break}}function g_(t){!xi()&&Ds()&&(window.addEventListener("online",()=>t(!0)),window.addEventListener("offline",()=>t(!1)))}function y_(t){xi()&&typeof global<"u"&&global!=null&&global.NetInfo&&global?.NetInfo.addEventListener(e=>t(e?.isConnected))}const Hu={};class zs{static get(e){return Hu[e]}static set(e,r){Hu[e]=r}static delete(e){delete Hu[e]}}const v_="PARSE_ERROR",m_="INVALID_REQUEST",w_="METHOD_NOT_FOUND",__="INVALID_PARAMS",Tp="INTERNAL_ERROR",Gu="SERVER_ERROR",E_=[-32700,-32600,-32601,-32602,-32603],Us={[v_]:{code:-32700,message:"Parse error"},[m_]:{code:-32600,message:"Invalid Request"},[w_]:{code:-32601,message:"Method not found"},[__]:{code:-32602,message:"Invalid params"},[Tp]:{code:-32603,message:"Internal error"},[Gu]:{code:-32e3,message:"Server error"}},Rp=Gu;function x_(t){return E_.includes(t)}function Np(t){return Object.keys(Us).includes(t)?Us[t]:Us[Rp]}function S_(t){const e=Object.values(Us).find(r=>r.code===t);return e||Us[Rp]}function I_(t,e,r){return t.message.includes("getaddrinfo ENOTFOUND")||t.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${r} RPC url at ${e}`):t}var Cp={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var Wu=function(t,e){return Wu=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)i.hasOwnProperty(n)&&(r[n]=i[n])},Wu(t,e)};function A_(t,e){Wu(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var Yu=function(){return Yu=Object.assign||function(e){for(var r,i=1,n=arguments.length;i<n;i++){r=arguments[i];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Yu.apply(this,arguments)};function D_(t,e){var r={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(r[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(t);n<i.length;n++)e.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(t,i[n])&&(r[i[n]]=t[i[n]]);return r}function O_(t,e,r,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,r):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,r,i);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(n<3?o(s):n>3?o(e,r,s):o(e,r))||s);return n>3&&s&&Object.defineProperty(e,r,s),s}function M_(t,e){return function(r,i){e(r,i,t)}}function $_(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function P_(t,e,r,i){function n(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function a(h){try{u(i.next(h))}catch(l){o(l)}}function c(h){try{u(i.throw(h))}catch(l){o(l)}}function u(h){h.done?s(h.value):n(h.value).then(a,c)}u((i=i.apply(t,e||[])).next())})}function T_(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},i,n,s,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(u){return function(h){return c([u,h])}}function c(u){if(i)throw new TypeError("Generator is already executing.");for(;r;)try{if(i=1,n&&(s=u[0]&2?n.return:u[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,u[1])).done)return s;switch(n=0,s&&(u=[u[0]&2,s.value]),u[0]){case 0:case 1:s=u;break;case 4:return r.label++,{value:u[1],done:!1};case 5:r.label++,n=u[1],u=[0];continue;case 7:u=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(u[0]===6||u[0]===2)){r=0;continue}if(u[0]===3&&(!s||u[1]>s[0]&&u[1]<s[3])){r.label=u[1];break}if(u[0]===6&&r.label<s[1]){r.label=s[1],s=u;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(u);break}s[2]&&r.ops.pop(),r.trys.pop();continue}u=e.call(t,r)}catch(h){u=[6,h],n=0}finally{i=s=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}function R_(t,e,r,i){i===void 0&&(i=r),t[i]=e[r]}function N_(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function Xu(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],i=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Bp(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var i=r.call(t),n,s=[],o;try{for(;(e===void 0||e-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(a){o={error:a}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return s}function C_(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(Bp(arguments[e]));return t}function B_(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var i=Array(t),n=0,e=0;e<r;e++)for(var s=arguments[e],o=0,a=s.length;o<a;o++,n++)i[n]=s[o];return i}function ks(t){return this instanceof ks?(this.v=t,this):new ks(t)}function F_(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=r.apply(t,e||[]),n,s=[];return n={},o("next"),o("throw"),o("return"),n[Symbol.asyncIterator]=function(){return this},n;function o(b){i[b]&&(n[b]=function(w){return new Promise(function(g,x){s.push([b,w,g,x])>1||a(b,w)})})}function a(b,w){try{c(i[b](w))}catch(g){l(s[0][3],g)}}function c(b){b.value instanceof ks?Promise.resolve(b.value.v).then(u,h):l(s[0][2],b)}function u(b){a("next",b)}function h(b){a("throw",b)}function l(b,w){b(w),s.shift(),s.length&&a(s[0][0],s[0][1])}}function L_(t){var e,r;return e={},i("next"),i("throw",function(n){throw n}),i("return"),e[Symbol.iterator]=function(){return this},e;function i(n,s){e[n]=t[n]?function(o){return(r=!r)?{value:ks(t[n](o)),done:n==="return"}:s?s(o):o}:s}}function q_(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof Xu=="function"?Xu(t):t[Symbol.iterator](),r={},i("next"),i("throw"),i("return"),r[Symbol.asyncIterator]=function(){return this},r);function i(s){r[s]=t[s]&&function(o){return new Promise(function(a,c){o=t[s](o),n(a,c,o.done,o.value)})}}function n(s,o,a,c){Promise.resolve(c).then(function(u){s({value:u,done:a})},o)}}function z_(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function U_(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function k_(t){return t&&t.__esModule?t:{default:t}}function j_(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function K_(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}var V_=Object.freeze({__proto__:null,__extends:A_,get __assign(){return Yu},__rest:D_,__decorate:O_,__param:M_,__metadata:$_,__awaiter:P_,__generator:T_,__createBinding:R_,__exportStar:N_,__values:Xu,__read:Bp,__spread:C_,__spreadArrays:B_,__await:ks,__asyncGenerator:F_,__asyncDelegator:L_,__asyncValues:q_,__makeTemplateObject:z_,__importStar:U_,__importDefault:k_,__classPrivateFieldGet:j_,__classPrivateFieldSet:K_}),H_=ja(V_),oi={},Fp;function G_(){if(Fp)return oi;Fp=1,Object.defineProperty(oi,"__esModule",{value:!0}),oi.isBrowserCryptoAvailable=oi.getSubtleCrypto=oi.getBrowerCrypto=void 0;function t(){return Nt?.crypto||Nt?.msCrypto||{}}oi.getBrowerCrypto=t;function e(){const i=t();return i.subtle||i.webkitSubtle}oi.getSubtleCrypto=e;function r(){return!!t()&&!!e()}return oi.isBrowserCryptoAvailable=r,oi}var ai={},Lp;function W_(){if(Lp)return ai;Lp=1,Object.defineProperty(ai,"__esModule",{value:!0}),ai.isBrowser=ai.isNode=ai.isReactNative=void 0;function t(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}ai.isReactNative=t;function e(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}ai.isNode=e;function r(){return!t()&&!e()}return ai.isBrowser=r,ai}(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=H_;e.__exportStar(G_(),t),e.__exportStar(W_(),t)})(Cp);function zr(t=3){const e=Date.now()*Math.pow(10,t),r=Math.floor(Math.random()*Math.pow(10,t));return e+r}function en(t=6){return BigInt(zr(t))}function tn(t,e,r){return{id:r||zr(),jsonrpc:"2.0",method:t,params:e}}function Zu(t,e){return{id:t,jsonrpc:"2.0",result:e}}function Ju(t,e,r){return{id:t,jsonrpc:"2.0",error:Y_(e,r)}}function Y_(t,e){return typeof t>"u"?Np(Tp):(typeof t=="string"&&(t=Object.assign(Object.assign({},Np(Gu)),{message:t})),typeof e<"u"&&(t.data=e),x_(t.code)&&(t=S_(t.code)),t)}class X_{}class Z_ extends X_{constructor(){super()}}class J_ extends Z_{constructor(e){super()}}const Q_="^wss?:";function eE(t){const e=t.match(new RegExp(/^\w+:/,"gi"));if(!(!e||!e.length))return e[0]}function tE(t,e){const r=eE(t);return typeof r>"u"?!1:new RegExp(e).test(r)}function qp(t){return tE(t,Q_)}function rE(t){return new RegExp("wss?://localhost(:d{2,5})?").test(t)}function zp(t){return typeof t=="object"&&"id"in t&&"jsonrpc"in t&&t.jsonrpc==="2.0"}function Qu(t){return zp(t)&&"method"in t}function Ia(t){return zp(t)&&(Ur(t)||ar(t))}function Ur(t){return"result"in t}function ar(t){return"error"in t}class iE extends J_{constructor(e){super(e),this.events=new zt.exports.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(e),this.connection.connected&&this.registerEventListeners()}async connect(e=this.connection){await this.open(e)}async disconnect(){await this.close()}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async request(e,r){return this.requestStrict(tn(e.method,e.params||[],e.id||en().toString()),r)}async requestStrict(e,r){return new Promise(async(i,n)=>{if(!this.connection.connected)try{await this.open()}catch(s){n(s)}this.events.on(`${e.id}`,s=>{ar(s)?n(s.error):i(s.result)});try{await this.connection.send(e,r)}catch(s){n(s)}})}setConnection(e=this.connection){return e}onPayload(e){this.events.emit("payload",e),Ia(e)?this.events.emit(`${e.id}`,e):this.events.emit("message",{type:e.method,data:e.params})}onClose(e){e&&e.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${e.code} ${e.reason?`(${e.reason})`:""}`)),this.events.emit("disconnect")}async open(e=this.connection){this.connection===e&&this.connection.connected||(this.connection.connected&&this.close(),typeof e=="string"&&(await this.connection.open(e),e=this.connection),this.connection=this.setConnection(e),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",e=>this.onPayload(e)),this.connection.on("close",e=>this.onClose(e)),this.connection.on("error",e=>this.events.emit("error",e)),this.connection.on("register_error",e=>this.onClose()),this.hasRegisteredEventListeners=!0)}}const nE=()=>typeof WebSocket<"u"?WebSocket:typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:require("ws"),sE=()=>typeof WebSocket<"u"||typeof global<"u"&&typeof global.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u",Up=t=>t.split("?")[0],kp=10,oE=nE();class aE{constructor(e){if(this.url=e,this.events=new zt.exports.EventEmitter,this.registering=!1,!qp(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);this.url=e}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async open(e=this.url){await this.register(e)}async close(){return new Promise((e,r)=>{if(typeof this.socket>"u"){r(new Error("Connection already closed"));return}this.socket.onclose=i=>{this.onClose(i),e()},this.socket.close()})}async send(e){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(Li(e))}catch(r){this.onError(e.id,r)}}register(e=this.url){if(!qp(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((i,n)=>{this.events.once("register_error",s=>{this.resetMaxListeners(),n(s)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return n(new Error("WebSocket connection is missing or invalid"));i(this.socket)})})}return this.url=e,this.registering=!0,new Promise((r,i)=>{const n=Cp.isReactNative()?void 0:{rejectUnauthorized:!rE(e)},s=new oE(e,[],n);sE()?s.onerror=o=>{const a=o;i(this.emitError(a.error))}:s.on("error",o=>{i(this.emitError(o))}),s.onopen=()=>{this.onOpen(s),r(s)}})}onOpen(e){e.onmessage=r=>this.onPayload(r),e.onclose=r=>this.onClose(r),this.socket=e,this.registering=!1,this.events.emit("open")}onClose(e){this.socket=void 0,this.registering=!1,this.events.emit("close",e)}onPayload(e){if(typeof e.data>"u")return;const r=typeof e.data=="string"?vn(e.data):e.data;this.events.emit("payload",r)}onError(e,r){const i=this.parseError(r),n=i.message||i.toString(),s=Ju(e,n);this.events.emit("payload",s)}parseError(e,r=this.url){return I_(e,Up(r),"WS")}resetMaxListeners(){this.events.getMaxListeners()>kp&&this.events.setMaxListeners(kp)}emitError(e){const r=this.parseError(new Error(e?.message||`WebSocket connection failed for host: ${Up(this.url)}`));return this.events.emit("register_error",r),r}}var ef={exports:{}};(function(t,e){var r=200,i="__lodash_hash_undefined__",n=1,s=2,o=9007199254740991,a="[object Arguments]",c="[object Array]",u="[object AsyncFunction]",h="[object Boolean]",l="[object Date]",b="[object Error]",w="[object Function]",g="[object GeneratorFunction]",x="[object Map]",A="[object Number]",D="[object Null]",$="[object Object]",P="[object Promise]",T="[object Proxy]",N="[object RegExp]",L="[object Set]",F="[object String]",B="[object Symbol]",C="[object Undefined]",G="[object WeakMap]",I="[object ArrayBuffer]",f="[object DataView]",p="[object Float32Array]",v="[object Float64Array]",y="[object Int8Array]",m="[object Int16Array]",S="[object Int32Array]",O="[object Uint8Array]",_="[object Uint8ClampedArray]",d="[object Uint16Array]",E="[object Uint32Array]",q=/[\\^$.*+?()[\]{}|]/g,z=/^\[object .+?Constructor\]$/,U=/^(?:0|[1-9]\d*)$/,k={};k[p]=k[v]=k[y]=k[m]=k[S]=k[O]=k[_]=k[d]=k[E]=!0,k[a]=k[c]=k[I]=k[h]=k[f]=k[l]=k[b]=k[w]=k[x]=k[A]=k[$]=k[N]=k[L]=k[F]=k[G]=!1;var W=typeof Nt=="object"&&Nt&&Nt.Object===Object&&Nt,Z=typeof self=="object"&&self&&self.Object===Object&&self,J=W||Z||Function("return this")(),X=e&&!e.nodeType&&e,Q=X&&!0&&t&&!t.nodeType&&t,Le=Q&&Q.exports===X,re=Le&&W.process,ae=function(){try{return re&&re.binding&&re.binding("util")}catch{}}(),ft=ae&&ae.isTypedArray;function de(M,R){for(var j=-1,Y=M==null?0:M.length,$e=0,ee=[];++j<Y;){var rt=M[j];R(rt,j,M)&&(ee[$e++]=rt)}return ee}function Pe(M,R){for(var j=-1,Y=R.length,$e=M.length;++j<Y;)M[$e+j]=R[j];return M}function ts(M,R){for(var j=-1,Y=M==null?0:M.length;++j<Y;)if(R(M[j],j,M))return!0;return!1}function Te(M,R){for(var j=-1,Y=Array(M);++j<M;)Y[j]=R(j);return Y}function Ae(M){return function(R){return M(R)}}function cn(M,R){return M.has(R)}function Ee(M,R){return M?.[R]}function De(M){var R=-1,j=Array(M.size);return M.forEach(function(Y,$e){j[++R]=[$e,Y]}),j}function un(M,R){return function(j){return M(R(j))}}function Oe(M){var R=-1,j=Array(M.size);return M.forEach(function(Y){j[++R]=Y}),j}var Me=Array.prototype,fn=Function.prototype,ye=Object.prototype,xe=J["__core-js_shared__"],hn=fn.toString,ce=ye.hasOwnProperty,qe=function(){var M=/[^.]+$/.exec(xe&&xe.keys&&xe.keys.IE_PROTO||"");return M?"Symbol(src)_1."+M:""}(),Zs=ye.toString,Ge=RegExp("^"+hn.call(ce).replace(q,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ze=Le?J.Buffer:void 0,dn=J.Symbol,Ue=J.Uint8Array,ke=ye.propertyIsEnumerable,Ra=Me.splice,ge=dn?dn.toStringTag:void 0,je=Object.getOwnPropertySymbols,Na=ze?ze.isBuffer:void 0,We=un(Object.keys,Object),Re=is(J,"DataView"),$i=is(J,"Map"),Ne=is(J,"Promise"),Ce=is(J,"Set"),rs=is(J,"WeakMap"),Se=is(Object,"create"),Ye=ln(Re),Ca=ln($i),Xe=ln(Ne),Ze=ln(Ce),Ba=ln(rs),Ke=dn?dn.prototype:void 0,Be=Ke?Ke.valueOf:void 0;function Hr(M){var R=-1,j=M==null?0:M.length;for(this.clear();++R<j;){var Y=M[R];this.set(Y[0],Y[1])}}function Je(){this.__data__=Se?Se(null):{},this.size=0}function Qe(M){var R=this.has(M)&&delete this.__data__[M];return this.size-=R?1:0,R}function Fa(M){var R=this.__data__;if(Se){var j=R[M];return j===i?void 0:j}return ce.call(R,M)?R[M]:void 0}function et(M){var R=this.__data__;return Se?R[M]!==void 0:ce.call(R,M)}function tt(M,R){var j=this.__data__;return this.size+=this.has(M)?0:1,j[M]=Se&&R===void 0?i:R,this}Hr.prototype.clear=Je,Hr.prototype.delete=Qe,Hr.prototype.get=Fa,Hr.prototype.has=et,Hr.prototype.set=tt;function er(M){var R=-1,j=M==null?0:M.length;for(this.clear();++R<j;){var Y=M[R];this.set(Y[0],Y[1])}}function Js(){this.__data__=[],this.size=0}function Qs(M){var R=this.__data__,j=La(R,M);if(j<0)return!1;var Y=R.length-1;return j==Y?R.pop():Ra.call(R,j,1),--this.size,!0}function eo(M){var R=this.__data__,j=La(R,M);return j<0?void 0:R[j][1]}function to(M){return La(this.__data__,M)>-1}function ro(M,R){var j=this.__data__,Y=La(j,M);return Y<0?(++this.size,j.push([M,R])):j[Y][1]=R,this}er.prototype.clear=Js,er.prototype.delete=Qs,er.prototype.get=eo,er.prototype.has=to,er.prototype.set=ro;function xr(M){var R=-1,j=M==null?0:M.length;for(this.clear();++R<j;){var Y=M[R];this.set(Y[0],Y[1])}}function io(){this.size=0,this.__data__={hash:new Hr,map:new($i||er),string:new Hr}}function no(M){var R=qa(this,M).delete(M);return this.size-=R?1:0,R}function so(M){return qa(this,M).get(M)}function oo(M){return qa(this,M).has(M)}function ao(M,R){var j=qa(this,M),Y=j.size;return j.set(M,R),this.size+=j.size==Y?0:1,this}xr.prototype.clear=io,xr.prototype.delete=no,xr.prototype.get=so,xr.prototype.has=oo,xr.prototype.set=ao;function Pi(M){var R=-1,j=M==null?0:M.length;for(this.__data__=new xr;++R<j;)this.add(M[R])}function co(M){return this.__data__.set(M,i),this}function uo(M){return this.__data__.has(M)}Pi.prototype.add=Pi.prototype.push=co,Pi.prototype.has=uo;function fr(M){var R=this.__data__=new er(M);this.size=R.size}function fo(){this.__data__=new er,this.size=0}function ho(M){var R=this.__data__,j=R.delete(M);return this.size=R.size,j}function lo(M){return this.__data__.get(M)}function qI(M){return this.__data__.has(M)}function zI(M,R){var j=this.__data__;if(j instanceof er){var Y=j.__data__;if(!$i||Y.length<r-1)return Y.push([M,R]),this.size=++j.size,this;j=this.__data__=new xr(Y)}return j.set(M,R),this.size=j.size,this}fr.prototype.clear=fo,fr.prototype.delete=ho,fr.prototype.get=lo,fr.prototype.has=qI,fr.prototype.set=zI;function UI(M,R){var j=za(M),Y=!j&&rA(M),$e=!j&&!Y&&xf(M),ee=!j&&!Y&&!$e&&V1(M),rt=j||Y||$e||ee,wt=rt?Te(M.length,String):[],Ot=wt.length;for(var Ve in M)(R||ce.call(M,Ve))&&!(rt&&(Ve=="length"||$e&&(Ve=="offset"||Ve=="parent")||ee&&(Ve=="buffer"||Ve=="byteLength"||Ve=="byteOffset")||ZI(Ve,Ot)))&&wt.push(Ve);return wt}function La(M,R){for(var j=M.length;j--;)if(U1(M[j][0],R))return j;return-1}function kI(M,R,j){var Y=R(M);return za(M)?Y:Pe(Y,j(M))}function po(M){return M==null?M===void 0?C:D:ge&&ge in Object(M)?YI(M):tA(M)}function F1(M){return bo(M)&&po(M)==a}function L1(M,R,j,Y,$e){return M===R?!0:M==null||R==null||!bo(M)&&!bo(R)?M!==M&&R!==R:jI(M,R,j,Y,L1,$e)}function jI(M,R,j,Y,$e,ee){var rt=za(M),wt=za(R),Ot=rt?c:Ti(M),Ve=wt?c:Ti(R);Ot=Ot==a?$:Ot,Ve=Ve==a?$:Ve;var tr=Ot==$,Sr=Ve==$,Rt=Ot==Ve;if(Rt&&xf(M)){if(!xf(R))return!1;rt=!0,tr=!1}if(Rt&&!tr)return ee||(ee=new fr),rt||V1(M)?q1(M,R,j,Y,$e,ee):GI(M,R,Ot,j,Y,$e,ee);if(!(j&n)){var hr=tr&&ce.call(M,"__wrapped__"),dr=Sr&&ce.call(R,"__wrapped__");if(hr||dr){var Ri=hr?M.value():M,ui=dr?R.value():R;return ee||(ee=new fr),$e(Ri,ui,j,Y,ee)}}return Rt?(ee||(ee=new fr),WI(M,R,j,Y,$e,ee)):!1}function KI(M){if(!K1(M)||QI(M))return!1;var R=k1(M)?Ge:z;return R.test(ln(M))}function VI(M){return bo(M)&&j1(M.length)&&!!k[po(M)]}function HI(M){if(!eA(M))return We(M);var R=[];for(var j in Object(M))ce.call(M,j)&&j!="constructor"&&R.push(j);return R}function q1(M,R,j,Y,$e,ee){var rt=j&n,wt=M.length,Ot=R.length;if(wt!=Ot&&!(rt&&Ot>wt))return!1;var Ve=ee.get(M);if(Ve&&ee.get(R))return Ve==R;var tr=-1,Sr=!0,Rt=j&s?new Pi:void 0;for(ee.set(M,R),ee.set(R,M);++tr<wt;){var hr=M[tr],dr=R[tr];if(Y)var Ri=rt?Y(dr,hr,tr,R,M,ee):Y(hr,dr,tr,M,R,ee);if(Ri!==void 0){if(Ri)continue;Sr=!1;break}if(Rt){if(!ts(R,function(ui,pn){if(!cn(Rt,pn)&&(hr===ui||$e(hr,ui,j,Y,ee)))return Rt.push(pn)})){Sr=!1;break}}else if(!(hr===dr||$e(hr,dr,j,Y,ee))){Sr=!1;break}}return ee.delete(M),ee.delete(R),Sr}function GI(M,R,j,Y,$e,ee,rt){switch(j){case f:if(M.byteLength!=R.byteLength||M.byteOffset!=R.byteOffset)return!1;M=M.buffer,R=R.buffer;case I:return!(M.byteLength!=R.byteLength||!ee(new Ue(M),new Ue(R)));case h:case l:case A:return U1(+M,+R);case b:return M.name==R.name&&M.message==R.message;case N:case F:return M==R+"";case x:var wt=De;case L:var Ot=Y&n;if(wt||(wt=Oe),M.size!=R.size&&!Ot)return!1;var Ve=rt.get(M);if(Ve)return Ve==R;Y|=s,rt.set(M,R);var tr=q1(wt(M),wt(R),Y,$e,ee,rt);return rt.delete(M),tr;case B:if(Be)return Be.call(M)==Be.call(R)}return!1}function WI(M,R,j,Y,$e,ee){var rt=j&n,wt=z1(M),Ot=wt.length,Ve=z1(R),tr=Ve.length;if(Ot!=tr&&!rt)return!1;for(var Sr=Ot;Sr--;){var Rt=wt[Sr];if(!(rt?Rt in R:ce.call(R,Rt)))return!1}var hr=ee.get(M);if(hr&&ee.get(R))return hr==R;var dr=!0;ee.set(M,R),ee.set(R,M);for(var Ri=rt;++Sr<Ot;){Rt=wt[Sr];var ui=M[Rt],pn=R[Rt];if(Y)var H1=rt?Y(pn,ui,Rt,R,M,ee):Y(ui,pn,Rt,M,R,ee);if(!(H1===void 0?ui===pn||$e(ui,pn,j,Y,ee):H1)){dr=!1;break}Ri||(Ri=Rt=="constructor")}if(dr&&!Ri){var Ua=M.constructor,ka=R.constructor;Ua!=ka&&"constructor"in M&&"constructor"in R&&!(typeof Ua=="function"&&Ua instanceof Ua&&typeof ka=="function"&&ka instanceof ka)&&(dr=!1)}return ee.delete(M),ee.delete(R),dr}function z1(M){return kI(M,sA,XI)}function qa(M,R){var j=M.__data__;return JI(R)?j[typeof R=="string"?"string":"hash"]:j.map}function is(M,R){var j=Ee(M,R);return KI(j)?j:void 0}function YI(M){var R=ce.call(M,ge),j=M[ge];try{M[ge]=void 0;var Y=!0}catch{}var $e=Zs.call(M);return Y&&(R?M[ge]=j:delete M[ge]),$e}var XI=je?function(M){return M==null?[]:(M=Object(M),de(je(M),function(R){return ke.call(M,R)}))}:oA,Ti=po;(Re&&Ti(new Re(new ArrayBuffer(1)))!=f||$i&&Ti(new $i)!=x||Ne&&Ti(Ne.resolve())!=P||Ce&&Ti(new Ce)!=L||rs&&Ti(new rs)!=G)&&(Ti=function(M){var R=po(M),j=R==$?M.constructor:void 0,Y=j?ln(j):"";if(Y)switch(Y){case Ye:return f;case Ca:return x;case Xe:return P;case Ze:return L;case Ba:return G}return R});function ZI(M,R){return R=R??o,!!R&&(typeof M=="number"||U.test(M))&&M>-1&&M%1==0&&M<R}function JI(M){var R=typeof M;return R=="string"||R=="number"||R=="symbol"||R=="boolean"?M!=="__proto__":M===null}function QI(M){return!!qe&&qe in M}function eA(M){var R=M&&M.constructor,j=typeof R=="function"&&R.prototype||ye;return M===j}function tA(M){return Zs.call(M)}function ln(M){if(M!=null){try{return hn.call(M)}catch{}try{return M+""}catch{}}return""}function U1(M,R){return M===R||M!==M&&R!==R}var rA=F1(function(){return arguments}())?F1:function(M){return bo(M)&&ce.call(M,"callee")&&!ke.call(M,"callee")},za=Array.isArray;function iA(M){return M!=null&&j1(M.length)&&!k1(M)}var xf=Na||aA;function nA(M,R){return L1(M,R)}function k1(M){if(!K1(M))return!1;var R=po(M);return R==w||R==g||R==u||R==T}function j1(M){return typeof M=="number"&&M>-1&&M%1==0&&M<=o}function K1(M){var R=typeof M;return M!=null&&(R=="object"||R=="function")}function bo(M){return M!=null&&typeof M=="object"}var V1=ft?Ae(ft):VI;function sA(M){return iA(M)?UI(M):HI(M)}function oA(){return[]}function aA(){return!1}t.exports=nA})(ef,ef.exports);var cE=ef.exports,uE=Object.defineProperty,jp=Object.getOwnPropertySymbols,fE=Object.prototype.hasOwnProperty,hE=Object.prototype.propertyIsEnumerable,Kp=(t,e,r)=>e in t?uE(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,qt=(t,e)=>{for(var r in e||(e={}))fE.call(e,r)&&Kp(t,r,e[r]);if(jp)for(var r of jp(e))hE.call(e,r)&&Kp(t,r,e[r]);return t};const Vp="wc",Hp=2,Aa="core",kr=`${Vp}@2:${Aa}:`,dE={name:Aa,logger:"error"},lE={database:":memory:"},pE="crypto",Gp="client_ed25519_seed",bE=V.ONE_DAY,gE="keychain",yE="0.3",vE="messages",mE="0.3",Wp=V.SIX_HOURS,wE="publisher",Yp="irn",_E="error",Xp="wss://relay.walletconnect.org",EE="relayer",vt={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},xE="_subscription",cr={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},SE=.1,tf="2.19.0",Ie={link_mode:"link_mode",relay:"relay"},IE="0.3",AE="WALLETCONNECT_CLIENT_ID",Zp="WALLETCONNECT_LINK_MODE_APPS",Qt={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},DE="subscription",OE="0.3",ME=V.FIVE_SECONDS*1e3,$E="pairing",PE="0.3",js={wc_pairingDelete:{req:{ttl:V.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:V.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:V.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:V.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:V.ONE_DAY,prompt:!1,tag:0},res:{ttl:V.ONE_DAY,prompt:!1,tag:0}}},rn={create:"pairing_create",expire:"pairing_expire",delete:"pairing_delete",ping:"pairing_ping"},mr={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},TE="history",RE="0.3",NE="expirer",ur={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},CE="0.3",BE="verify-api",FE="https://verify.walletconnect.com",Jp="https://verify.walletconnect.org",Ks=Jp,LE=`${Ks}/v3`,qE=[FE,Jp],zE="echo",UE="https://echo.walletconnect.com",jr={pairing_started:"pairing_started",pairing_uri_validation_success:"pairing_uri_validation_success",pairing_uri_not_expired:"pairing_uri_not_expired",store_new_pairing:"store_new_pairing",subscribing_pairing_topic:"subscribing_pairing_topic",subscribe_pairing_topic_success:"subscribe_pairing_topic_success",existing_pairing:"existing_pairing",pairing_not_expired:"pairing_not_expired",emit_inactive_pairing:"emit_inactive_pairing",emit_session_proposal:"emit_session_proposal",subscribing_to_pairing_topic:"subscribing_to_pairing_topic"},ci={no_wss_connection:"no_wss_connection",no_internet_connection:"no_internet_connection",malformed_pairing_uri:"malformed_pairing_uri",active_pairing_already_exists:"active_pairing_already_exists",subscribe_pairing_topic_failure:"subscribe_pairing_topic_failure",pairing_expired:"pairing_expired",proposal_expired:"proposal_expired",proposal_listener_not_found:"proposal_listener_not_found"},wr={session_approve_started:"session_approve_started",proposal_not_expired:"proposal_not_expired",session_namespaces_validation_success:"session_namespaces_validation_success",create_session_topic:"create_session_topic",subscribing_session_topic:"subscribing_session_topic",subscribe_session_topic_success:"subscribe_session_topic_success",publishing_session_approve:"publishing_session_approve",session_approve_publish_success:"session_approve_publish_success",store_session:"store_session",publishing_session_settle:"publishing_session_settle",session_settle_publish_success:"session_settle_publish_success"},nn={no_internet_connection:"no_internet_connection",no_wss_connection:"no_wss_connection",proposal_expired:"proposal_expired",subscribe_session_topic_failure:"subscribe_session_topic_failure",session_approve_publish_failure:"session_approve_publish_failure",session_settle_publish_failure:"session_settle_publish_failure",session_approve_namespace_validation_failure:"session_approve_namespace_validation_failure",proposal_not_found:"proposal_not_found"},sn={authenticated_session_approve_started:"authenticated_session_approve_started",authenticated_session_not_expired:"authenticated_session_not_expired",chains_caip2_compliant:"chains_caip2_compliant",chains_evm_compliant:"chains_evm_compliant",create_authenticated_session_topic:"create_authenticated_session_topic",cacaos_verified:"cacaos_verified",store_authenticated_session:"store_authenticated_session",subscribing_authenticated_session_topic:"subscribing_authenticated_session_topic",subscribe_authenticated_session_topic_success:"subscribe_authenticated_session_topic_success",publishing_authenticated_session_approve:"publishing_authenticated_session_approve",authenticated_session_approve_publish_success:"authenticated_session_approve_publish_success"},Vs={no_internet_connection:"no_internet_connection",no_wss_connection:"no_wss_connection",missing_session_authenticate_request:"missing_session_authenticate_request",session_authenticate_request_expired:"session_authenticate_request_expired",chains_caip2_compliant_failure:"chains_caip2_compliant_failure",chains_evm_compliant_failure:"chains_evm_compliant_failure",invalid_cacao:"invalid_cacao",subscribe_authenticated_session_topic_failure:"subscribe_authenticated_session_topic_failure",authenticated_session_approve_publish_failure:"authenticated_session_approve_publish_failure",authenticated_session_pending_request_not_found:"authenticated_session_pending_request_not_found"},kE=.1,jE="event-client",KE=86400,VE="https://pulse.walletconnect.org/batch";function HE(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),i=0;i<r.length;i++)r[i]=255;for(var n=0;n<t.length;n++){var s=t.charAt(n),o=s.charCodeAt(0);if(r[o]!==255)throw new TypeError(s+" is ambiguous");r[o]=n}var a=t.length,c=t.charAt(0),u=Math.log(a)/Math.log(256),h=Math.log(256)/Math.log(a);function l(g){if(g instanceof Uint8Array||(ArrayBuffer.isView(g)?g=new Uint8Array(g.buffer,g.byteOffset,g.byteLength):Array.isArray(g)&&(g=Uint8Array.from(g))),!(g instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(g.length===0)return"";for(var x=0,A=0,D=0,$=g.length;D!==$&&g[D]===0;)D++,x++;for(var P=($-D)*h+1>>>0,T=new Uint8Array(P);D!==$;){for(var N=g[D],L=0,F=P-1;(N!==0||L<A)&&F!==-1;F--,L++)N+=256*T[F]>>>0,T[F]=N%a>>>0,N=N/a>>>0;if(N!==0)throw new Error("Non-zero carry");A=L,D++}for(var B=P-A;B!==P&&T[B]===0;)B++;for(var C=c.repeat(x);B<P;++B)C+=t.charAt(T[B]);return C}function b(g){if(typeof g!="string")throw new TypeError("Expected String");if(g.length===0)return new Uint8Array;var x=0;if(g[x]!==" "){for(var A=0,D=0;g[x]===c;)A++,x++;for(var $=(g.length-x)*u+1>>>0,P=new Uint8Array($);g[x];){var T=r[g.charCodeAt(x)];if(T===255)return;for(var N=0,L=$-1;(T!==0||N<D)&&L!==-1;L--,N++)T+=a*P[L]>>>0,P[L]=T%256>>>0,T=T/256>>>0;if(T!==0)throw new Error("Non-zero carry");D=N,x++}if(g[x]!==" "){for(var F=$-D;F!==$&&P[F]===0;)F++;for(var B=new Uint8Array(A+($-F)),C=A;F!==$;)B[C++]=P[F++];return B}}}function w(g){var x=b(g);if(x)return x;throw new Error(`Non-${e} character`)}return{encode:l,decodeUnsafe:b,decode:w}}var GE=HE,WE=GE;const Qp=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},YE=t=>new TextEncoder().encode(t),XE=t=>new TextDecoder().decode(t);class ZE{constructor(e,r,i){this.name=e,this.prefix=r,this.baseEncode=i}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class JE{constructor(e,r,i){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=i}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return e1(this,e)}}class QE{constructor(e){this.decoders=e}or(e){return e1(this,e)}decode(e){const r=e[0],i=this.decoders[r];if(i)return i.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const e1=(t,e)=>new QE(qt(qt({},t.decoders||{[t.prefix]:t}),e.decoders||{[e.prefix]:e}));class ex{constructor(e,r,i,n){this.name=e,this.prefix=r,this.baseEncode=i,this.baseDecode=n,this.encoder=new ZE(e,r,i),this.decoder=new JE(e,r,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const Da=({name:t,prefix:e,encode:r,decode:i})=>new ex(t,e,r,i),Hs=({prefix:t,name:e,alphabet:r})=>{const{encode:i,decode:n}=WE(r,e);return Da({prefix:t,name:e,encode:i,decode:s=>Qp(n(s))})},tx=(t,e,r,i)=>{const n={};for(let h=0;h<e.length;++h)n[e[h]]=h;let s=t.length;for(;t[s-1]==="=";)--s;const o=new Uint8Array(s*r/8|0);let a=0,c=0,u=0;for(let h=0;h<s;++h){const l=n[t[h]];if(l===void 0)throw new SyntaxError(`Non-${i} character`);c=c<<r|l,a+=r,a>=8&&(a-=8,o[u++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},rx=(t,e,r)=>{const i=e[e.length-1]==="=",n=(1<<r)-1;let s="",o=0,a=0;for(let c=0;c<t.length;++c)for(a=a<<8|t[c],o+=8;o>r;)o-=r,s+=e[n&a>>o];if(o&&(s+=e[n&a<<r-o]),i)for(;s.length*r&7;)s+="=";return s},It=({name:t,prefix:e,bitsPerChar:r,alphabet:i})=>Da({prefix:e,name:t,encode(n){return rx(n,i,r)},decode(n){return tx(n,i,r,t)}}),ix=Da({prefix:"\0",name:"identity",encode:t=>XE(t),decode:t=>YE(t)});var nx=Object.freeze({__proto__:null,identity:ix});const sx=It({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var ox=Object.freeze({__proto__:null,base2:sx});const ax=It({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var cx=Object.freeze({__proto__:null,base8:ax});const ux=Hs({prefix:"9",name:"base10",alphabet:"0123456789"});var fx=Object.freeze({__proto__:null,base10:ux});const hx=It({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),dx=It({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var lx=Object.freeze({__proto__:null,base16:hx,base16upper:dx});const px=It({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),bx=It({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),gx=It({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),yx=It({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),vx=It({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),mx=It({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),wx=It({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),_x=It({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Ex=It({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var xx=Object.freeze({__proto__:null,base32:px,base32upper:bx,base32pad:gx,base32padupper:yx,base32hex:vx,base32hexupper:mx,base32hexpad:wx,base32hexpadupper:_x,base32z:Ex});const Sx=Hs({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Ix=Hs({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var Ax=Object.freeze({__proto__:null,base36:Sx,base36upper:Ix});const Dx=Hs({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Ox=Hs({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Mx=Object.freeze({__proto__:null,base58btc:Dx,base58flickr:Ox});const $x=It({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Px=It({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Tx=It({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Rx=It({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var Nx=Object.freeze({__proto__:null,base64:$x,base64pad:Px,base64url:Tx,base64urlpad:Rx});const t1=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),Cx=t1.reduce((t,e,r)=>(t[r]=e,t),[]),Bx=t1.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function Fx(t){return t.reduce((e,r)=>(e+=Cx[r],e),"")}function Lx(t){const e=[];for(const r of t){const i=Bx[r.codePointAt(0)];if(i===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(i)}return new Uint8Array(e)}const qx=Da({prefix:"\u{1F680}",name:"base256emoji",encode:Fx,decode:Lx});var zx=Object.freeze({__proto__:null,base256emoji:qx}),Ux=i1,r1=128,kx=127,jx=~kx,Kx=Math.pow(2,31);function i1(t,e,r){e=e||[],r=r||0;for(var i=r;t>=Kx;)e[r++]=t&255|r1,t/=128;for(;t&jx;)e[r++]=t&255|r1,t>>>=7;return e[r]=t|0,i1.bytes=r-i+1,e}var Vx=rf,Hx=128,n1=127;function rf(t,i){var r=0,i=i||0,n=0,s=i,o,a=t.length;do{if(s>=a)throw rf.bytes=0,new RangeError("Could not decode varint");o=t[s++],r+=n<28?(o&n1)<<n:(o&n1)*Math.pow(2,n),n+=7}while(o>=Hx);return rf.bytes=s-i,r}var Gx=Math.pow(2,7),Wx=Math.pow(2,14),Yx=Math.pow(2,21),Xx=Math.pow(2,28),Zx=Math.pow(2,35),Jx=Math.pow(2,42),Qx=Math.pow(2,49),eS=Math.pow(2,56),tS=Math.pow(2,63),rS=function(t){return t<Gx?1:t<Wx?2:t<Yx?3:t<Xx?4:t<Zx?5:t<Jx?6:t<Qx?7:t<eS?8:t<tS?9:10},iS={encode:Ux,decode:Vx,encodingLength:rS},s1=iS;const o1=(t,e,r=0)=>(s1.encode(t,e,r),e),a1=t=>s1.encodingLength(t),nf=(t,e)=>{const r=e.byteLength,i=a1(t),n=i+a1(r),s=new Uint8Array(n+r);return o1(t,s,0),o1(r,s,i),s.set(e,n),new nS(t,r,e,s)};class nS{constructor(e,r,i,n){this.code=e,this.size=r,this.digest=i,this.bytes=n}}const c1=({name:t,code:e,encode:r})=>new sS(t,e,r);class sS{constructor(e,r,i){this.name=e,this.code=r,this.encode=i}digest(e){if(e instanceof Uint8Array){const r=this.encode(e);return r instanceof Uint8Array?nf(this.code,r):r.then(i=>nf(this.code,i))}else throw Error("Unknown type, must be binary type")}}const u1=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),oS=c1({name:"sha2-256",code:18,encode:u1("SHA-256")}),aS=c1({name:"sha2-512",code:19,encode:u1("SHA-512")});var cS=Object.freeze({__proto__:null,sha256:oS,sha512:aS});const f1=0,uS="identity",h1=Qp;var fS=Object.freeze({__proto__:null,identity:{code:f1,name:uS,encode:h1,digest:t=>nf(f1,h1(t))}});new TextEncoder,new TextDecoder;const d1=qt(qt(qt(qt(qt(qt(qt(qt(qt(qt({},nx),ox),cx),fx),lx),xx),Ax),Mx),Nx),zx);qt(qt({},cS),fS);function hS(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?globalThis.Buffer.allocUnsafe(t):new Uint8Array(t)}function l1(t,e,r,i){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:i}}}const p1=l1("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),sf=l1("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);const e=hS(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),dS=qt({utf8:p1,"utf-8":p1,hex:d1.base16,latin1:sf,ascii:sf,binary:sf},d1);function lS(t,e="utf8"){const r=dS[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t,"utf8"):r.decoder.decode(`${r.prefix}${t}`)}var pS=Object.defineProperty,bS=(t,e,r)=>e in t?pS(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Kr=(t,e,r)=>bS(t,typeof e!="symbol"?e+"":e,r);class gS{constructor(e,r){this.core=e,this.logger=r,Kr(this,"keychain",new Map),Kr(this,"name",gE),Kr(this,"version",yE),Kr(this,"initialized",!1),Kr(this,"storagePrefix",kr),Kr(this,"init",async()=>{if(!this.initialized){const i=await this.getKeyChain();typeof i<"u"&&(this.keychain=i),this.initialized=!0}}),Kr(this,"has",i=>(this.isInitialized(),this.keychain.has(i))),Kr(this,"set",async(i,n)=>{this.isInitialized(),this.keychain.set(i,n),await this.persist()}),Kr(this,"get",i=>{this.isInitialized();const n=this.keychain.get(i);if(typeof n>"u"){const{message:s}=H("NO_MATCHING_KEY",`${this.name}: ${i}`);throw new Error(s)}return n}),Kr(this,"del",async i=>{this.isInitialized(),this.keychain.delete(i),await this.persist()}),this.core=e,this.logger=Ct(r,this.name)}get context(){return kt(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(e){await this.core.storage.setItem(this.storageKey,_0(e))}async getKeyChain(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?E0(e):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:e}=H("NOT_INITIALIZED",this.name);throw new Error(e)}}}var yS=Object.defineProperty,vS=(t,e,r)=>e in t?yS(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,At=(t,e,r)=>vS(t,typeof e!="symbol"?e+"":e,r);class mS{constructor(e,r,i){this.core=e,this.logger=r,At(this,"name",pE),At(this,"keychain"),At(this,"randomSessionIdentifier",ju()),At(this,"initialized",!1),At(this,"init",async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)}),At(this,"hasKeys",n=>(this.isInitialized(),this.keychain.has(n))),At(this,"getClientId",async()=>{this.isInitialized();const n=await this.getClientSeed(),s=Qh(n);return Jh(s.publicKey)}),At(this,"generateKeyPair",()=>{this.isInitialized();const n=E7();return this.setPrivateKey(n.publicKey,n.privateKey)}),At(this,"signJWT",async n=>{this.isInitialized();const s=await this.getClientSeed(),o=Qh(s),a=this.randomSessionIdentifier;return await Kv(a,n,bE,o)}),At(this,"generateSharedKey",(n,s,o)=>{this.isInitialized();const a=this.getPrivateKey(n),c=x7(a,s);return this.setSymKey(c,o)}),At(this,"setSymKey",async(n,s)=>{this.isInitialized();const o=s||wa(n);return await this.keychain.set(o,n),o}),At(this,"deleteKeyPair",async n=>{this.isInitialized(),await this.keychain.del(n)}),At(this,"deleteSymKey",async n=>{this.isInitialized(),await this.keychain.del(n)}),At(this,"encode",async(n,s,o)=>{this.isInitialized();const a=mp(o),c=Li(s);if(_p(a))return A7(c,o?.encoding);if(wp(a)){const b=a.senderPublicKey,w=a.receiverPublicKey;n=await this.generateSharedKey(b,w)}const u=this.getSymKey(n),{type:h,senderPublicKey:l}=a;return S7({type:h,symKey:u,message:c,senderPublicKey:l,encoding:o?.encoding})}),At(this,"decode",async(n,s,o)=>{this.isInitialized();const a=O7(s,o);if(_p(a)){const c=D7(s,o?.encoding);return vn(c)}if(wp(a)){const c=a.receiverPublicKey,u=a.senderPublicKey;n=await this.generateSharedKey(c,u)}try{const c=this.getSymKey(n),u=I7({symKey:c,encoded:s,encoding:o?.encoding});return vn(u)}catch(c){this.logger.error(`Failed to decode message from topic: '${n}', clientId: '${await this.getClientId()}'`),this.logger.error(c)}}),At(this,"getPayloadType",(n,s=Mi)=>{const o=Fs({encoded:n,encoding:s});return Qi(o.type)}),At(this,"getPayloadSenderPublicKey",(n,s=Mi)=>{const o=Fs({encoded:n,encoding:s});return o.senderPublicKey?Ft(o.senderPublicKey,Pt):void 0}),this.core=e,this.logger=Ct(r,this.name),this.keychain=i||new gS(this.core,this.logger)}get context(){return kt(this.logger)}async setPrivateKey(e,r){return await this.keychain.set(e,r),e}getPrivateKey(e){return this.keychain.get(e)}async getClientSeed(){let e="";try{e=this.keychain.get(Gp)}catch{e=ju(),await this.keychain.set(Gp,e)}return lS(e,"base16")}getSymKey(e){return this.keychain.get(e)}isInitialized(){if(!this.initialized){const{message:e}=H("NOT_INITIALIZED",this.name);throw new Error(e)}}}var wS=Object.defineProperty,_S=(t,e,r)=>e in t?wS(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Vr=(t,e,r)=>_S(t,typeof e!="symbol"?e+"":e,r);class ES extends jg{constructor(e,r){super(e,r),this.logger=e,this.core=r,Vr(this,"messages",new Map),Vr(this,"name",vE),Vr(this,"version",mE),Vr(this,"initialized",!1),Vr(this,"storagePrefix",kr),Vr(this,"init",async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const i=await this.getRelayerMessages();typeof i<"u"&&(this.messages=i),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(i){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(i)}finally{this.initialized=!0}}}),Vr(this,"set",async(i,n)=>{this.isInitialized();const s=si(n);let o=this.messages.get(i);return typeof o>"u"&&(o={}),typeof o[s]<"u"||(o[s]=n,this.messages.set(i,o),await this.persist()),s}),Vr(this,"get",i=>{this.isInitialized();let n=this.messages.get(i);return typeof n>"u"&&(n={}),n}),Vr(this,"has",(i,n)=>{this.isInitialized();const s=this.get(i),o=si(n);return typeof s[o]<"u"}),Vr(this,"del",async i=>{this.isInitialized(),this.messages.delete(i),await this.persist()}),this.logger=Ct(e,this.name),this.core=r}get context(){return kt(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setRelayerMessages(e){await this.core.storage.setItem(this.storageKey,_0(e))}async getRelayerMessages(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?E0(e):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:e}=H("NOT_INITIALIZED",this.name);throw new Error(e)}}}var xS=Object.defineProperty,SS=Object.defineProperties,IS=Object.getOwnPropertyDescriptors,b1=Object.getOwnPropertySymbols,AS=Object.prototype.hasOwnProperty,DS=Object.prototype.propertyIsEnumerable,of=(t,e,r)=>e in t?xS(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Oa=(t,e)=>{for(var r in e||(e={}))AS.call(e,r)&&of(t,r,e[r]);if(b1)for(var r of b1(e))DS.call(e,r)&&of(t,r,e[r]);return t},af=(t,e)=>SS(t,IS(e)),_r=(t,e,r)=>of(t,typeof e!="symbol"?e+"":e,r);class OS extends Kg{constructor(e,r){super(e,r),this.relayer=e,this.logger=r,_r(this,"events",new zt.exports.EventEmitter),_r(this,"name",wE),_r(this,"queue",new Map),_r(this,"publishTimeout",V.toMiliseconds(V.ONE_MINUTE)),_r(this,"initialPublishTimeout",V.toMiliseconds(V.ONE_SECOND*15)),_r(this,"needsTransportRestart",!1),_r(this,"publish",async(i,n,s)=>{var o;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:i,message:n,opts:s}});const a=s?.ttl||Wp,c=_a(s),u=s?.prompt||!1,h=s?.tag||0,l=s?.id||en().toString(),b={topic:i,message:n,opts:{ttl:a,relay:c,prompt:u,tag:h,id:l,attestation:s?.attestation,tvf:s?.tvf}},w=`Failed to publish payload, please try again. id:${l} tag:${h}`;try{const g=new Promise(async x=>{const A=({id:$})=>{b.opts.id===$&&(this.removeRequestFromQueue($),this.relayer.events.removeListener(vt.publish,A),x(b))};this.relayer.events.on(vt.publish,A);const D=Si(new Promise(($,P)=>{this.rpcPublish({topic:i,message:n,ttl:a,prompt:u,tag:h,id:l,attestation:s?.attestation,tvf:s?.tvf}).then($).catch(T=>{this.logger.warn(T,T?.message),P(T)})}),this.initialPublishTimeout,`Failed initial publish, retrying.... id:${l} tag:${h}`);try{await D,this.events.removeListener(vt.publish,A)}catch($){this.queue.set(l,af(Oa({},b),{attempt:1})),this.logger.warn($,$?.message)}});this.logger.trace({type:"method",method:"publish",params:{id:l,topic:i,message:n,opts:s}}),await Si(g,this.publishTimeout,w)}catch(g){if(this.logger.debug("Failed to Publish Payload"),this.logger.error(g),(o=s?.internal)!=null&&o.throwOnFailedPublish)throw g}finally{this.queue.delete(l)}}),_r(this,"on",(i,n)=>{this.events.on(i,n)}),_r(this,"once",(i,n)=>{this.events.once(i,n)}),_r(this,"off",(i,n)=>{this.events.off(i,n)}),_r(this,"removeListener",(i,n)=>{this.events.removeListener(i,n)}),this.relayer=e,this.logger=Ct(r,this.name),this.registerEventListeners()}get context(){return kt(this.logger)}async rpcPublish(e){var r,i,n,s;const{topic:o,message:a,ttl:c=Wp,prompt:u,tag:h,id:l,attestation:b,tvf:w}=e,g={method:Ls(_a().protocol).publish,params:Oa({topic:o,message:a,ttl:c,prompt:u,tag:h,attestation:b},w),id:l};Lt((r=g.params)==null?void 0:r.prompt)&&((i=g.params)==null||delete i.prompt),Lt((n=g.params)==null?void 0:n.tag)&&((s=g.params)==null||delete s.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:g});const x=await this.relayer.request(g);return this.relayer.events.emit(vt.publish,e),this.logger.debug("Successfully Published Payload"),x}removeRequestFromQueue(e){this.queue.delete(e)}checkQueue(){this.queue.forEach(async(e,r)=>{const i=e.attempt+1;this.queue.set(r,af(Oa({},e),{attempt:i}));const{topic:n,message:s,opts:o,attestation:a}=e;this.logger.warn({},`Publisher: queue->publishing: ${e.opts.id}, tag: ${e.opts.tag}, attempt: ${i}`),await this.rpcPublish(af(Oa({},e),{topic:n,message:s,ttl:o.ttl,prompt:o.prompt,tag:o.tag,id:o.id,attestation:a,tvf:o.tvf})),this.logger.warn({},`Publisher: queue->published: ${e.opts.id}`)})}registerEventListeners(){this.relayer.core.heartbeat.on(yn.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(vt.connection_stalled);return}this.checkQueue()}),this.relayer.on(vt.message_ack,e=>{this.removeRequestFromQueue(e.id.toString())})}}var MS=Object.defineProperty,$S=(t,e,r)=>e in t?MS(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,es=(t,e,r)=>$S(t,typeof e!="symbol"?e+"":e,r);class PS{constructor(){es(this,"map",new Map),es(this,"set",(e,r)=>{const i=this.get(e);this.exists(e,r)||this.map.set(e,[...i,r])}),es(this,"get",e=>this.map.get(e)||[]),es(this,"exists",(e,r)=>this.get(e).includes(r)),es(this,"delete",(e,r)=>{if(typeof r>"u"){this.map.delete(e);return}if(!this.map.has(e))return;const i=this.get(e);if(!this.exists(e,r))return;const n=i.filter(s=>s!==r);if(!n.length){this.map.delete(e);return}this.map.set(e,n)}),es(this,"clear",()=>{this.map.clear()})}get topics(){return Array.from(this.map.keys())}}var TS=Object.defineProperty,RS=Object.defineProperties,NS=Object.getOwnPropertyDescriptors,g1=Object.getOwnPropertySymbols,CS=Object.prototype.hasOwnProperty,BS=Object.prototype.propertyIsEnumerable,cf=(t,e,r)=>e in t?TS(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Gs=(t,e)=>{for(var r in e||(e={}))CS.call(e,r)&&cf(t,r,e[r]);if(g1)for(var r of g1(e))BS.call(e,r)&&cf(t,r,e[r]);return t},uf=(t,e)=>RS(t,NS(e)),be=(t,e,r)=>cf(t,typeof e!="symbol"?e+"":e,r);class FS extends Gg{constructor(e,r){super(e,r),this.relayer=e,this.logger=r,be(this,"subscriptions",new Map),be(this,"topicMap",new PS),be(this,"events",new zt.exports.EventEmitter),be(this,"name",DE),be(this,"version",OE),be(this,"pending",new Map),be(this,"cached",[]),be(this,"initialized",!1),be(this,"pendingSubscriptionWatchLabel","pending_sub_watch_label"),be(this,"pollingInterval",20),be(this,"storagePrefix",kr),be(this,"subscribeTimeout",V.toMiliseconds(V.ONE_MINUTE)),be(this,"initialSubscribeTimeout",V.toMiliseconds(V.ONE_SECOND*15)),be(this,"clientId"),be(this,"batchSubscribeTopicsLimit",500),be(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),await this.restore()),this.initialized=!0}),be(this,"subscribe",async(i,n)=>{this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:i,opts:n}});try{const s=_a(n),o={topic:i,relay:s,transportType:n?.transportType};this.pending.set(i,o);const a=await this.rpcSubscribe(i,s,n);return typeof a=="string"&&(this.onSubscribe(a,o),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:i,opts:n}})),a}catch(s){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(s),s}}),be(this,"unsubscribe",async(i,n)=>{this.isInitialized(),typeof n?.id<"u"?await this.unsubscribeById(i,n.id,n):await this.unsubscribeByTopic(i,n)}),be(this,"isSubscribed",async i=>{if(this.topics.includes(i))return!0;const n=`${this.pendingSubscriptionWatchLabel}_${i}`;return await new Promise((s,o)=>{const a=new V.Watch;a.start(n);const c=setInterval(()=>{(!this.pending.has(i)&&this.topics.includes(i)||this.cached.some(u=>u.topic===i))&&(clearInterval(c),a.stop(n),s(!0)),a.elapsed(n)>=ME&&(clearInterval(c),a.stop(n),o(new Error("Subscription resolution timeout")))},this.pollingInterval)}).catch(()=>!1)}),be(this,"on",(i,n)=>{this.events.on(i,n)}),be(this,"once",(i,n)=>{this.events.once(i,n)}),be(this,"off",(i,n)=>{this.events.off(i,n)}),be(this,"removeListener",(i,n)=>{this.events.removeListener(i,n)}),be(this,"start",async()=>{await this.onConnect()}),be(this,"stop",async()=>{await this.onDisconnect()}),be(this,"restart",async()=>{await this.restore(),await this.onRestart()}),be(this,"checkPending",async()=>{if(this.pending.size===0&&(!this.initialized||!this.relayer.connected))return;const i=[];this.pending.forEach(n=>{i.push(n)}),await this.batchSubscribe(i)}),be(this,"registerEventListeners",()=>{this.relayer.core.heartbeat.on(yn.pulse,async()=>{await this.checkPending()}),this.events.on(Qt.created,async i=>{const n=Qt.created;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,data:i}),await this.persist()}),this.events.on(Qt.deleted,async i=>{const n=Qt.deleted;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,data:i}),await this.persist()})}),this.relayer=e,this.logger=Ct(r,this.name),this.clientId=""}get context(){return kt(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}get hasAnyTopics(){return this.topicMap.topics.length>0||this.pending.size>0||this.cached.length>0||this.subscriptions.size>0}hasSubscription(e,r){let i=!1;try{i=this.getSubscription(e).topic===r}catch{}return i}reset(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(e,r){const i=this.topicMap.get(e);await Promise.all(i.map(async n=>await this.unsubscribeById(e,n,r)))}async unsubscribeById(e,r,i){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:r,opts:i}});try{const n=_a(i);await this.restartToComplete({topic:e,id:r,relay:n}),await this.rpcUnsubscribe(e,r,n);const s=we("USER_DISCONNECTED",`${this.name}, ${e}`);await this.onUnsubscribe(e,r,s),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:r,opts:i}})}catch(n){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(n),n}}async rpcSubscribe(e,r,i){var n;(!i||i?.transportType===Ie.relay)&&await this.restartToComplete({topic:e,id:e,relay:r});const s={method:Ls(r.protocol).subscribe,params:{topic:e}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});const o=(n=i?.internal)==null?void 0:n.throwOnFailedPublish;try{const a=await this.getSubscriptionId(e);if(i?.transportType===Ie.link_mode)return setTimeout(()=>{(this.relayer.connected||this.relayer.connecting)&&this.relayer.request(s).catch(h=>this.logger.warn(h))},V.toMiliseconds(V.ONE_SECOND)),a;const c=new Promise(async h=>{const l=b=>{b.topic===e&&(this.events.removeListener(Qt.created,l),h(b.id))};this.events.on(Qt.created,l);try{const b=await Si(new Promise((w,g)=>{this.relayer.request(s).catch(x=>{this.logger.warn(x,x?.message),g(x)}).then(w)}),this.initialSubscribeTimeout,`Subscribing to ${e} failed, please try again`);this.events.removeListener(Qt.created,l),h(b)}catch{}}),u=await Si(c,this.subscribeTimeout,`Subscribing to ${e} failed, please try again`);if(!u&&o)throw new Error(`Subscribing to ${e} failed, please try again`);return u?a:null}catch(a){if(this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(vt.connection_stalled),o)throw a}return null}async rpcBatchSubscribe(e){if(!e.length)return;const r=e[0].relay,i={method:Ls(r.protocol).batchSubscribe,params:{topics:e.map(n=>n.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:i});try{await await Si(new Promise(n=>{this.relayer.request(i).catch(s=>this.logger.warn(s)).then(n)}),this.subscribeTimeout,"rpcBatchSubscribe failed, please try again")}catch{this.relayer.events.emit(vt.connection_stalled)}}async rpcBatchFetchMessages(e){if(!e.length)return;const r=e[0].relay,i={method:Ls(r.protocol).batchFetchMessages,params:{topics:e.map(s=>s.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:i});let n;try{n=await await Si(new Promise((s,o)=>{this.relayer.request(i).catch(a=>{this.logger.warn(a),o(a)}).then(s)}),this.subscribeTimeout,"rpcBatchFetchMessages failed, please try again")}catch{this.relayer.events.emit(vt.connection_stalled)}return n}rpcUnsubscribe(e,r,i){const n={method:Ls(i.protocol).unsubscribe,params:{topic:e,id:r}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n}),this.relayer.request(n)}onSubscribe(e,r){this.setSubscription(e,uf(Gs({},r),{id:e})),this.pending.delete(r.topic)}onBatchSubscribe(e){e.length&&e.forEach(r=>{this.setSubscription(r.id,Gs({},r)),this.pending.delete(r.topic)})}async onUnsubscribe(e,r,i){this.events.removeAllListeners(r),this.hasSubscription(r,e)&&this.deleteSubscription(r,i),await this.relayer.messages.del(e)}async setRelayerSubscriptions(e){await this.relayer.core.storage.setItem(this.storageKey,e)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(e,r){this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:r}),this.addSubscription(e,r)}addSubscription(e,r){this.subscriptions.set(e,Gs({},r)),this.topicMap.set(r.topic,e),this.events.emit(Qt.created,r)}getSubscription(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});const r=this.subscriptions.get(e);if(!r){const{message:i}=H("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(i)}return r}deleteSubscription(e,r){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:r});const i=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(i.topic,e),this.events.emit(Qt.deleted,uf(Gs({},i),{reason:r}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(Qt.sync)}async onRestart(){if(this.cached.length){const e=[...this.cached],r=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let i=0;i<r;i++){const n=e.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(n)}}this.events.emit(Qt.resubscribed)}async restore(){try{const e=await this.getRelayerSubscriptions();if(typeof e>"u"||!e.length)return;if(this.subscriptions.size){const{message:r}=H("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(e){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(e)}}async batchSubscribe(e){e.length&&(await this.rpcBatchSubscribe(e),this.onBatchSubscribe(await Promise.all(e.map(async r=>uf(Gs({},r),{id:await this.getSubscriptionId(r.topic)})))))}async batchFetchMessages(e){if(!e.length)return;this.logger.trace(`Fetching batch messages for ${e.length} subscriptions`);const r=await this.rpcBatchFetchMessages(e);r&&r.messages&&(await L5(V.toMiliseconds(V.ONE_SECOND)),await this.relayer.handleBatchMessageEvents(r.messages))}async onConnect(){await this.restart(),this.reset()}onDisconnect(){this.onDisable()}isInitialized(){if(!this.initialized){const{message:e}=H("NOT_INITIALIZED",this.name);throw new Error(e)}}async restartToComplete(e){!this.relayer.connected&&!this.relayer.connecting&&(this.cached.push(e),await this.relayer.transportOpen())}async getClientId(){return this.clientId||(this.clientId=await this.relayer.core.crypto.getClientId()),this.clientId}async getSubscriptionId(e){return si(e+await this.getClientId())}}var LS=Object.defineProperty,y1=Object.getOwnPropertySymbols,qS=Object.prototype.hasOwnProperty,zS=Object.prototype.propertyIsEnumerable,ff=(t,e,r)=>e in t?LS(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,v1=(t,e)=>{for(var r in e||(e={}))qS.call(e,r)&&ff(t,r,e[r]);if(y1)for(var r of y1(e))zS.call(e,r)&&ff(t,r,e[r]);return t},fe=(t,e,r)=>ff(t,typeof e!="symbol"?e+"":e,r);class US extends Vg{constructor(e){super(e),fe(this,"protocol","wc"),fe(this,"version",2),fe(this,"core"),fe(this,"logger"),fe(this,"events",new zt.exports.EventEmitter),fe(this,"provider"),fe(this,"messages"),fe(this,"subscriber"),fe(this,"publisher"),fe(this,"name",EE),fe(this,"transportExplicitlyClosed",!1),fe(this,"initialized",!1),fe(this,"connectionAttemptInProgress",!1),fe(this,"relayUrl"),fe(this,"projectId"),fe(this,"packageName"),fe(this,"bundleId"),fe(this,"hasExperiencedNetworkDisruption",!1),fe(this,"pingTimeout"),fe(this,"heartBeatTimeout",V.toMiliseconds(V.THIRTY_SECONDS+V.FIVE_SECONDS)),fe(this,"reconnectTimeout"),fe(this,"connectPromise"),fe(this,"reconnectInProgress",!1),fe(this,"requestsInFlight",[]),fe(this,"connectTimeout",V.toMiliseconds(V.ONE_SECOND*15)),fe(this,"request",async r=>{var i,n;this.logger.debug("Publishing Request Payload");const s=r.id||en().toString();await this.toEstablishConnection();try{this.logger.trace({id:s,method:r.method,topic:(i=r.params)==null?void 0:i.topic},"relayer.request - publishing...");const o=`${s}:${((n=r.params)==null?void 0:n.tag)||""}`;this.requestsInFlight.push(o);const a=await this.provider.request(r);return this.requestsInFlight=this.requestsInFlight.filter(c=>c!==o),a}catch(o){throw this.logger.debug(`Failed to Publish Request: ${s}`),o}}),fe(this,"resetPingTimeout",()=>{if(da())try{clearTimeout(this.pingTimeout),this.pingTimeout=setTimeout(()=>{var r,i,n;this.logger.debug({},"pingTimeout: Connection stalled, terminating..."),(n=(i=(r=this.provider)==null?void 0:r.connection)==null?void 0:i.socket)==null||n.terminate()},this.heartBeatTimeout)}catch(r){this.logger.warn(r,r?.message)}}),fe(this,"onPayloadHandler",r=>{this.onProviderPayload(r),this.resetPingTimeout()}),fe(this,"onConnectHandler",()=>{this.logger.warn({},"Relayer connected \u{1F6DC}"),this.startPingTimeout(),this.events.emit(vt.connect)}),fe(this,"onDisconnectHandler",()=>{this.logger.warn({},"Relayer disconnected \u{1F6D1}"),this.requestsInFlight=[],this.onProviderDisconnect()}),fe(this,"onProviderErrorHandler",r=>{this.logger.fatal(`Fatal socket error: ${r.message}`),this.events.emit(vt.error,r),this.logger.fatal("Fatal socket error received, closing transport"),this.transportClose()}),fe(this,"registerProviderListeners",()=>{this.provider.on(cr.payload,this.onPayloadHandler),this.provider.on(cr.connect,this.onConnectHandler),this.provider.on(cr.disconnect,this.onDisconnectHandler),this.provider.on(cr.error,this.onProviderErrorHandler)}),this.core=e.core,this.logger=typeof e.logger<"u"&&typeof e.logger!="string"?Ct(e.logger,this.name):Gr(nc({level:e.logger||_E})),this.messages=new ES(this.logger,e.core),this.subscriber=new FS(this,this.logger),this.publisher=new OS(this,this.logger),this.relayUrl=e?.relayUrl||Xp,this.projectId=e.projectId,E5()?this.packageName=v0():x5()&&(this.bundleId=v0()),this.provider={}}async init(){if(this.logger.trace("Initialized"),this.registerEventListeners(),await Promise.all([this.messages.init(),this.subscriber.init()]),this.initialized=!0,this.subscriber.hasAnyTopics)try{await this.transportOpen()}catch(e){this.logger.warn(e,e?.message)}}get context(){return kt(this.logger)}get connected(){var e,r,i;return((i=(r=(e=this.provider)==null?void 0:e.connection)==null?void 0:r.socket)==null?void 0:i.readyState)===1||!1}get connecting(){var e,r,i;return((i=(r=(e=this.provider)==null?void 0:e.connection)==null?void 0:r.socket)==null?void 0:i.readyState)===0||this.connectPromise!==void 0||!1}async publish(e,r,i){this.isInitialized(),await this.publisher.publish(e,r,i),await this.recordMessageEvent({topic:e,message:r,publishedAt:Date.now(),transportType:Ie.relay})}async subscribe(e,r){var i,n,s;this.isInitialized(),(!(r!=null&&r.transportType)||r?.transportType==="relay")&&await this.toEstablishConnection();const o=typeof((i=r?.internal)==null?void 0:i.throwOnFailedPublish)>"u"?!0:(n=r?.internal)==null?void 0:n.throwOnFailedPublish;let a=((s=this.subscriber.topicMap.get(e))==null?void 0:s[0])||"",c;const u=h=>{h.topic===e&&(this.subscriber.off(Qt.created,u),c())};return await Promise.all([new Promise(h=>{c=h,this.subscriber.on(Qt.created,u)}),new Promise(async(h,l)=>{a=await this.subscriber.subscribe(e,v1({internal:{throwOnFailedPublish:o}},r)).catch(b=>{o&&l(b)})||a,h()})]),a}async unsubscribe(e,r){this.isInitialized(),await this.subscriber.unsubscribe(e,r)}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async transportDisconnect(){this.provider.disconnect&&(this.hasExperiencedNetworkDisruption||this.connected)?await Si(this.provider.disconnect(),2e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.onProviderDisconnect()}async transportClose(){this.transportExplicitlyClosed=!0,await this.transportDisconnect()}async transportOpen(e){if(!this.subscriber.hasAnyTopics){this.logger.warn("Starting WS connection skipped because the client has no topics to work with.");return}if(this.connectPromise?(this.logger.debug({},"Waiting for existing connection attempt to resolve..."),await this.connectPromise,this.logger.debug({},"Existing connection attempt resolved")):(this.connectPromise=new Promise(async(r,i)=>{await this.connect(e).then(r).catch(i).finally(()=>{this.connectPromise=void 0})}),await this.connectPromise),!this.connected)throw new Error(`Couldn't establish socket connection to the relay server: ${this.relayUrl}`)}async restartTransport(e){this.logger.debug({},"Restarting transport..."),!this.connectionAttemptInProgress&&(this.relayUrl=e||this.relayUrl,await this.confirmOnlineStateOrThrow(),await this.transportClose(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await Pp())throw new Error("No internet connection detected. Please restart your network and try again.")}async handleBatchMessageEvents(e){if(e?.length===0){this.logger.trace("Batch message events is empty. Ignoring...");return}const r=e.sort((i,n)=>i.publishedAt-n.publishedAt);this.logger.debug(`Batch of ${r.length} message events sorted`);for(const i of r)try{await this.onMessageEvent(i)}catch(n){this.logger.warn(n,"Error while processing batch message event: "+n?.message)}this.logger.trace(`Batch of ${r.length} message events processed`)}async onLinkMessageEvent(e,r){const{topic:i}=e;if(!r.sessionExists){const n=ct(V.FIVE_MINUTES),s={topic:i,expiry:n,relay:{protocol:"irn"},active:!1};await this.core.pairing.pairings.set(i,s)}this.events.emit(vt.message,e),await this.recordMessageEvent(e)}async connect(e){await this.confirmOnlineStateOrThrow(),e&&e!==this.relayUrl&&(this.relayUrl=e,await this.transportDisconnect()),this.connectionAttemptInProgress=!0,this.transportExplicitlyClosed=!1;let r=1;for(;r<6;){try{if(this.transportExplicitlyClosed)break;this.logger.debug({},`Connecting to ${this.relayUrl}, attempt: ${r}...`),await this.createProvider(),await new Promise(async(i,n)=>{const s=()=>{n(new Error("Connection interrupted while trying to subscribe"))};this.provider.once(cr.disconnect,s),await Si(new Promise((o,a)=>{this.provider.connect().then(o).catch(a)}),this.connectTimeout,`Socket stalled when trying to connect to ${this.relayUrl}`).catch(o=>{n(o)}).finally(()=>{this.provider.off(cr.disconnect,s),clearTimeout(this.reconnectTimeout)}),await new Promise(async(o,a)=>{const c=()=>{a(new Error("Connection interrupted while trying to subscribe"))};this.provider.once(cr.disconnect,c),await this.subscriber.start().then(o).catch(a).finally(()=>{this.provider.off(cr.disconnect,c)})}),this.hasExperiencedNetworkDisruption=!1,i()})}catch(i){await this.subscriber.stop();const n=i;this.logger.warn({},n.message),this.hasExperiencedNetworkDisruption=!0}finally{this.connectionAttemptInProgress=!1}if(this.connected){this.logger.debug({},`Connected to ${this.relayUrl} successfully on attempt: ${r}`);break}await new Promise(i=>setTimeout(i,V.toMiliseconds(r*1))),r++}}startPingTimeout(){var e,r,i,n,s;if(da())try{(r=(e=this.provider)==null?void 0:e.connection)!=null&&r.socket&&((s=(n=(i=this.provider)==null?void 0:i.connection)==null?void 0:n.socket)==null||s.on("ping",()=>{this.resetPingTimeout()})),this.resetPingTimeout()}catch(o){this.logger.warn(o,o?.message)}}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();const e=await this.core.crypto.signJWT(this.relayUrl);this.provider=new iE(new aE(D5({sdkVersion:tf,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:e,useOnCloseEvent:!0,bundleId:this.bundleId,packageName:this.packageName}))),this.registerProviderListeners()}async recordMessageEvent(e){const{topic:r,message:i}=e;await this.messages.set(r,i)}async shouldIgnoreMessageEvent(e){const{topic:r,message:i}=e;if(!i||i.length===0)return this.logger.warn(`Ignoring invalid/empty message: ${i}`),!0;if(!await this.subscriber.isSubscribed(r))return this.logger.warn(`Ignoring message for non-subscribed topic ${r}`),!0;const n=this.messages.has(r,i);return n&&this.logger.warn(`Ignoring duplicate message: ${i}`),n}async onProviderPayload(e){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:e}),Qu(e)){if(!e.method.endsWith(xE))return;const r=e.params,{topic:i,message:n,publishedAt:s,attestation:o}=r.data,a={topic:i,message:n,publishedAt:s,transportType:Ie.relay,attestation:o};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(v1({type:"event",event:r.id},a)),this.events.emit(r.id,a),await this.acknowledgePayload(e),await this.onMessageEvent(a)}else Ia(e)&&this.events.emit(vt.message_ack,e)}async onMessageEvent(e){await this.shouldIgnoreMessageEvent(e)||(this.events.emit(vt.message,e),await this.recordMessageEvent(e))}async acknowledgePayload(e){const r=Zu(e.id,!0);await this.provider.connection.send(r)}unregisterProviderListeners(){this.provider.off(cr.payload,this.onPayloadHandler),this.provider.off(cr.connect,this.onConnectHandler),this.provider.off(cr.disconnect,this.onDisconnectHandler),this.provider.off(cr.error,this.onProviderErrorHandler),clearTimeout(this.pingTimeout)}async registerEventListeners(){let e=await Pp();b_(async r=>{e!==r&&(e=r,r?await this.transportOpen().catch(i=>this.logger.error(i,i?.message)):(this.hasExperiencedNetworkDisruption=!0,await this.transportDisconnect(),this.transportExplicitlyClosed=!1))})}async onProviderDisconnect(){clearTimeout(this.pingTimeout),this.events.emit(vt.disconnect),this.connectionAttemptInProgress=!1,!this.reconnectInProgress&&(this.reconnectInProgress=!0,await this.subscriber.stop(),this.subscriber.hasAnyTopics&&(this.transportExplicitlyClosed||(this.reconnectTimeout=setTimeout(async()=>{await this.transportOpen().catch(e=>this.logger.error(e,e?.message)),this.reconnectTimeout=void 0,this.reconnectInProgress=!1},V.toMiliseconds(SE)))))}isInitialized(){if(!this.initialized){const{message:e}=H("NOT_INITIALIZED",this.name);throw new Error(e)}}async toEstablishConnection(){await this.confirmOnlineStateOrThrow(),!this.connected&&await this.connect()}}var kS=Object.defineProperty,m1=Object.getOwnPropertySymbols,jS=Object.prototype.hasOwnProperty,KS=Object.prototype.propertyIsEnumerable,hf=(t,e,r)=>e in t?kS(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,w1=(t,e)=>{for(var r in e||(e={}))jS.call(e,r)&&hf(t,r,e[r]);if(m1)for(var r of m1(e))KS.call(e,r)&&hf(t,r,e[r]);return t},Gt=(t,e,r)=>hf(t,typeof e!="symbol"?e+"":e,r);class on extends Hg{constructor(e,r,i,n=kr,s=void 0){super(e,r,i,n),this.core=e,this.logger=r,this.name=i,Gt(this,"map",new Map),Gt(this,"version",IE),Gt(this,"cached",[]),Gt(this,"initialized",!1),Gt(this,"getKey"),Gt(this,"storagePrefix",kr),Gt(this,"recentlyDeleted",[]),Gt(this,"recentlyDeletedLimit",200),Gt(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(o=>{this.getKey&&o!==null&&!Lt(o)?this.map.set(this.getKey(o),o):H7(o)?this.map.set(o.id,o):G7(o)&&this.map.set(o.topic,o)}),this.cached=[],this.initialized=!0)}),Gt(this,"set",async(o,a)=>{this.isInitialized(),this.map.has(o)?await this.update(o,a):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:o,value:a}),this.map.set(o,a),await this.persist())}),Gt(this,"get",o=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:o}),this.getData(o))),Gt(this,"getAll",o=>(this.isInitialized(),o?this.values.filter(a=>Object.keys(o).every(c=>cE(a[c],o[c]))):this.values)),Gt(this,"update",async(o,a)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:o,update:a});const c=w1(w1({},this.getData(o)),a);this.map.set(o,c),await this.persist()}),Gt(this,"delete",async(o,a)=>{this.isInitialized(),this.map.has(o)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:o,reason:a}),this.map.delete(o),this.addToRecentlyDeleted(o),await this.persist())}),this.logger=Ct(r,this.name),this.storagePrefix=n,this.getKey=s}get context(){return kt(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}addToRecentlyDeleted(e){this.recentlyDeleted.push(e),this.recentlyDeleted.length>=this.recentlyDeletedLimit&&this.recentlyDeleted.splice(0,this.recentlyDeletedLimit/2)}async setDataStore(e){await this.core.storage.setItem(this.storageKey,e)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(e){const r=this.map.get(e);if(!r){if(this.recentlyDeleted.includes(e)){const{message:n}=H("MISSING_OR_INVALID",`Record was recently deleted - ${this.name}: ${e}`);throw this.logger.error(n),new Error(n)}const{message:i}=H("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(i),new Error(i)}return r}async persist(){await this.setDataStore(this.values)}async restore(){try{const e=await this.getDataStore();if(typeof e>"u"||!e.length)return;if(this.map.size){const{message:r}=H("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(e){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(e)}}isInitialized(){if(!this.initialized){const{message:e}=H("NOT_INITIALIZED",this.name);throw new Error(e)}}}var VS=Object.defineProperty,HS=(t,e,r)=>e in t?VS(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,se=(t,e,r)=>HS(t,typeof e!="symbol"?e+"":e,r);class GS{constructor(e,r){this.core=e,this.logger=r,se(this,"name",$E),se(this,"version",PE),se(this,"events",new zt.exports),se(this,"pairings"),se(this,"initialized",!1),se(this,"storagePrefix",kr),se(this,"ignoredPayloadTypes",[ni]),se(this,"registeredMethods",[]),se(this,"init",async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))}),se(this,"register",({methods:i})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...i])]}),se(this,"create",async i=>{this.isInitialized();const n=ju(),s=await this.core.crypto.setSymKey(n),o=ct(V.FIVE_MINUTES),a={protocol:Yp},c={topic:s,expiry:o,relay:a,active:!1,methods:i?.methods},u=xp({protocol:this.core.protocol,version:this.core.version,topic:s,symKey:n,relay:a,expiryTimestamp:o,methods:i?.methods});return this.events.emit(rn.create,c),this.core.expirer.set(s,o),await this.pairings.set(s,c),await this.core.relayer.subscribe(s,{transportType:i?.transportType}),{topic:s,uri:u}}),se(this,"pair",async i=>{this.isInitialized();const n=this.core.eventClient.createEvent({properties:{topic:i?.uri,trace:[jr.pairing_started]}});this.isValidPair(i,n);const{topic:s,symKey:o,relay:a,expiryTimestamp:c,methods:u}=Ep(i.uri);n.props.properties.topic=s,n.addTrace(jr.pairing_uri_validation_success),n.addTrace(jr.pairing_uri_not_expired);let h;if(this.pairings.keys.includes(s)){if(h=this.pairings.get(s),n.addTrace(jr.existing_pairing),h.active)throw n.setError(ci.active_pairing_already_exists),new Error(`Pairing already exists: ${s}. Please try again with a new connection URI.`);n.addTrace(jr.pairing_not_expired)}const l=c||ct(V.FIVE_MINUTES),b={topic:s,relay:a,expiry:l,active:!1,methods:u};this.core.expirer.set(s,l),await this.pairings.set(s,b),n.addTrace(jr.store_new_pairing),i.activatePairing&&await this.activate({topic:s}),this.events.emit(rn.create,b),n.addTrace(jr.emit_inactive_pairing),this.core.crypto.keychain.has(s)||await this.core.crypto.setSymKey(o,s),n.addTrace(jr.subscribing_pairing_topic);try{await this.core.relayer.confirmOnlineStateOrThrow()}catch{n.setError(ci.no_internet_connection)}try{await this.core.relayer.subscribe(s,{relay:a})}catch(w){throw n.setError(ci.subscribe_pairing_topic_failure),w}return n.addTrace(jr.subscribe_pairing_topic_success),b}),se(this,"activate",async({topic:i})=>{this.isInitialized();const n=ct(V.FIVE_MINUTES);this.core.expirer.set(i,n),await this.pairings.update(i,{active:!0,expiry:n})}),se(this,"ping",async i=>{this.isInitialized(),await this.isValidPing(i),this.logger.warn("ping() is deprecated and will be removed in the next major release.");const{topic:n}=i;if(this.pairings.keys.includes(n)){const s=await this.sendRequest(n,"wc_pairingPing",{}),{done:o,resolve:a,reject:c}=Zi();this.events.once(he("pairing_ping",s),({error:u})=>{u?c(u):a()}),await o()}}),se(this,"updateExpiry",async({topic:i,expiry:n})=>{this.isInitialized(),await this.pairings.update(i,{expiry:n})}),se(this,"updateMetadata",async({topic:i,metadata:n})=>{this.isInitialized(),await this.pairings.update(i,{peerMetadata:n})}),se(this,"getPairings",()=>(this.isInitialized(),this.pairings.values)),se(this,"disconnect",async i=>{this.isInitialized(),await this.isValidDisconnect(i);const{topic:n}=i;this.pairings.keys.includes(n)&&(await this.sendRequest(n,"wc_pairingDelete",we("USER_DISCONNECTED")),await this.deletePairing(n))}),se(this,"formatUriFromPairing",i=>{this.isInitialized();const{topic:n,relay:s,expiry:o,methods:a}=i,c=this.core.crypto.keychain.get(n);return xp({protocol:this.core.protocol,version:this.core.version,topic:n,symKey:c,relay:s,expiryTimestamp:o,methods:a})}),se(this,"sendRequest",async(i,n,s)=>{const o=tn(n,s),a=await this.core.crypto.encode(i,o),c=js[n].req;return this.core.history.set(i,o),this.core.relayer.publish(i,a,c),o.id}),se(this,"sendResult",async(i,n,s)=>{const o=Zu(i,s),a=await this.core.crypto.encode(n,o),c=(await this.core.history.get(n,i)).request.method,u=js[c].res;await this.core.relayer.publish(n,a,u),await this.core.history.resolve(o)}),se(this,"sendError",async(i,n,s)=>{const o=Ju(i,s),a=await this.core.crypto.encode(n,o),c=(await this.core.history.get(n,i)).request.method,u=js[c]?js[c].res:js.unregistered_method.res;await this.core.relayer.publish(n,a,u),await this.core.history.resolve(o)}),se(this,"deletePairing",async(i,n)=>{await this.core.relayer.unsubscribe(i),await Promise.all([this.pairings.delete(i,we("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(i),n?Promise.resolve():this.core.expirer.del(i)])}),se(this,"cleanup",async()=>{const i=this.pairings.getAll().filter(n=>Ii(n.expiry));await Promise.all(i.map(n=>this.deletePairing(n.topic)))}),se(this,"onRelayEventRequest",i=>{const{topic:n,payload:s}=i;switch(s.method){case"wc_pairingPing":return this.onPairingPingRequest(n,s);case"wc_pairingDelete":return this.onPairingDeleteRequest(n,s);default:return this.onUnknownRpcMethodRequest(n,s)}}),se(this,"onRelayEventResponse",async i=>{const{topic:n,payload:s}=i,o=(await this.core.history.get(n,s.id)).request.method;switch(o){case"wc_pairingPing":return this.onPairingPingResponse(n,s);default:return this.onUnknownRpcMethodResponse(o)}}),se(this,"onPairingPingRequest",async(i,n)=>{const{id:s}=n;try{this.isValidPing({topic:i}),await this.sendResult(s,i,!0),this.events.emit(rn.ping,{id:s,topic:i})}catch(o){await this.sendError(s,i,o),this.logger.error(o)}}),se(this,"onPairingPingResponse",(i,n)=>{const{id:s}=n;setTimeout(()=>{Ur(n)?this.events.emit(he("pairing_ping",s),{}):ar(n)&&this.events.emit(he("pairing_ping",s),{error:n.error})},500)}),se(this,"onPairingDeleteRequest",async(i,n)=>{const{id:s}=n;try{this.isValidDisconnect({topic:i}),await this.deletePairing(i),this.events.emit(rn.delete,{id:s,topic:i})}catch(o){await this.sendError(s,i,o),this.logger.error(o)}}),se(this,"onUnknownRpcMethodRequest",async(i,n)=>{const{id:s,method:o}=n;try{if(this.registeredMethods.includes(o))return;const a=we("WC_METHOD_UNSUPPORTED",o);await this.sendError(s,i,a),this.logger.error(a)}catch(a){await this.sendError(s,i,a),this.logger.error(a)}}),se(this,"onUnknownRpcMethodResponse",i=>{this.registeredMethods.includes(i)||this.logger.error(we("WC_METHOD_UNSUPPORTED",i))}),se(this,"isValidPair",(i,n)=>{var s;if(!Ht(i)){const{message:a}=H("MISSING_OR_INVALID",`pair() params: ${i}`);throw n.setError(ci.malformed_pairing_uri),new Error(a)}if(!V7(i.uri)){const{message:a}=H("MISSING_OR_INVALID",`pair() uri: ${i.uri}`);throw n.setError(ci.malformed_pairing_uri),new Error(a)}const o=Ep(i?.uri);if(!((s=o?.relay)!=null&&s.protocol)){const{message:a}=H("MISSING_OR_INVALID","pair() uri#relay-protocol");throw n.setError(ci.malformed_pairing_uri),new Error(a)}if(!(o!=null&&o.symKey)){const{message:a}=H("MISSING_OR_INVALID","pair() uri#symKey");throw n.setError(ci.malformed_pairing_uri),new Error(a)}if(o!=null&&o.expiryTimestamp&&V.toMiliseconds(o?.expiryTimestamp)<Date.now()){n.setError(ci.pairing_expired);const{message:a}=H("EXPIRED","pair() URI has expired. Please try again with a new connection URI.");throw new Error(a)}}),se(this,"isValidPing",async i=>{if(!Ht(i)){const{message:s}=H("MISSING_OR_INVALID",`ping() params: ${i}`);throw new Error(s)}const{topic:n}=i;await this.isValidPairingTopic(n)}),se(this,"isValidDisconnect",async i=>{if(!Ht(i)){const{message:s}=H("MISSING_OR_INVALID",`disconnect() params: ${i}`);throw new Error(s)}const{topic:n}=i;await this.isValidPairingTopic(n)}),se(this,"isValidPairingTopic",async i=>{if(!st(i,!1)){const{message:n}=H("MISSING_OR_INVALID",`pairing topic should be a string: ${i}`);throw new Error(n)}if(!this.pairings.keys.includes(i)){const{message:n}=H("NO_MATCHING_KEY",`pairing topic doesn't exist: ${i}`);throw new Error(n)}if(Ii(this.pairings.get(i).expiry)){await this.deletePairing(i);const{message:n}=H("EXPIRED",`pairing topic: ${i}`);throw new Error(n)}}),this.core=e,this.logger=Ct(r,this.name),this.pairings=new on(this.core,this.logger,this.name,this.storagePrefix)}get context(){return kt(this.logger)}isInitialized(){if(!this.initialized){const{message:e}=H("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.core.relayer.on(vt.message,async e=>{const{topic:r,message:i,transportType:n}=e;if(!this.pairings.keys.includes(r)||n===Ie.link_mode||this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(i)))return;const s=await this.core.crypto.decode(r,i);try{Qu(s)?(this.core.history.set(r,s),this.onRelayEventRequest({topic:r,payload:s})):Ia(s)&&(await this.core.history.resolve(s),await this.onRelayEventResponse({topic:r,payload:s}),this.core.history.delete(r,s.id))}catch(o){this.logger.error(o)}})}registerExpirerEvents(){this.core.expirer.on(ur.expired,async e=>{const{topic:r}=S0(e.target);r&&this.pairings.keys.includes(r)&&(await this.deletePairing(r,!0),this.events.emit(rn.expire,{topic:r}))})}}var WS=Object.defineProperty,YS=(t,e,r)=>e in t?WS(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Dt=(t,e,r)=>YS(t,typeof e!="symbol"?e+"":e,r);class XS extends kg{constructor(e,r){super(e,r),this.core=e,this.logger=r,Dt(this,"records",new Map),Dt(this,"events",new zt.exports.EventEmitter),Dt(this,"name",TE),Dt(this,"version",RE),Dt(this,"cached",[]),Dt(this,"initialized",!1),Dt(this,"storagePrefix",kr),Dt(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(i=>this.records.set(i.id,i)),this.cached=[],this.registerEventListeners(),this.initialized=!0)}),Dt(this,"set",(i,n,s)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:i,request:n,chainId:s}),this.records.has(n.id))return;const o={id:n.id,topic:i,request:{method:n.method,params:n.params||null},chainId:s,expiry:ct(V.THIRTY_DAYS)};this.records.set(o.id,o),this.persist(),this.events.emit(mr.created,o)}),Dt(this,"resolve",async i=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:i}),!this.records.has(i.id))return;const n=await this.getRecord(i.id);typeof n.response>"u"&&(n.response=ar(i)?{error:i.error}:{result:i.result},this.records.set(n.id,n),this.persist(),this.events.emit(mr.updated,n))}),Dt(this,"get",async(i,n)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:i,id:n}),await this.getRecord(n))),Dt(this,"delete",(i,n)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:n}),this.values.forEach(s=>{if(s.topic===i){if(typeof n<"u"&&s.id!==n)return;this.records.delete(s.id),this.events.emit(mr.deleted,s)}}),this.persist()}),Dt(this,"exists",async(i,n)=>(this.isInitialized(),this.records.has(n)?(await this.getRecord(n)).topic===i:!1)),Dt(this,"on",(i,n)=>{this.events.on(i,n)}),Dt(this,"once",(i,n)=>{this.events.once(i,n)}),Dt(this,"off",(i,n)=>{this.events.off(i,n)}),Dt(this,"removeListener",(i,n)=>{this.events.removeListener(i,n)}),this.logger=Ct(r,this.name)}get context(){return kt(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const e=[];return this.values.forEach(r=>{if(typeof r.response<"u")return;const i={topic:r.topic,request:tn(r.request.method,r.request.params,r.id),chainId:r.chainId};return e.push(i)}),e}async setJsonRpcRecords(e){await this.core.storage.setItem(this.storageKey,e)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(e){this.isInitialized();const r=this.records.get(e);if(!r){const{message:i}=H("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(i)}return r}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(mr.sync)}async restore(){try{const e=await this.getJsonRpcRecords();if(typeof e>"u"||!e.length)return;if(this.records.size){const{message:r}=H("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}}registerEventListeners(){this.events.on(mr.created,e=>{const r=mr.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e})}),this.events.on(mr.updated,e=>{const r=mr.updated;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e})}),this.events.on(mr.deleted,e=>{const r=mr.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e})}),this.core.heartbeat.on(yn.pulse,()=>{this.cleanup()})}cleanup(){try{this.isInitialized();let e=!1;this.records.forEach(r=>{V.toMiliseconds(r.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${r.id}`),this.records.delete(r.id),this.events.emit(mr.deleted,r,!1),e=!0)}),e&&this.persist()}catch(e){this.logger.warn(e)}}isInitialized(){if(!this.initialized){const{message:e}=H("NOT_INITIALIZED",this.name);throw new Error(e)}}}var ZS=Object.defineProperty,JS=(t,e,r)=>e in t?ZS(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Tt=(t,e,r)=>JS(t,typeof e!="symbol"?e+"":e,r);class QS extends Wg{constructor(e,r){super(e,r),this.core=e,this.logger=r,Tt(this,"expirations",new Map),Tt(this,"events",new zt.exports.EventEmitter),Tt(this,"name",NE),Tt(this,"version",CE),Tt(this,"cached",[]),Tt(this,"initialized",!1),Tt(this,"storagePrefix",kr),Tt(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(i=>this.expirations.set(i.target,i)),this.cached=[],this.registerEventListeners(),this.initialized=!0)}),Tt(this,"has",i=>{try{const n=this.formatTarget(i);return typeof this.getExpiration(n)<"u"}catch{return!1}}),Tt(this,"set",(i,n)=>{this.isInitialized();const s=this.formatTarget(i),o={target:s,expiry:n};this.expirations.set(s,o),this.checkExpiry(s,o),this.events.emit(ur.created,{target:s,expiration:o})}),Tt(this,"get",i=>{this.isInitialized();const n=this.formatTarget(i);return this.getExpiration(n)}),Tt(this,"del",i=>{if(this.isInitialized(),this.has(i)){const n=this.formatTarget(i),s=this.getExpiration(n);this.expirations.delete(n),this.events.emit(ur.deleted,{target:n,expiration:s})}}),Tt(this,"on",(i,n)=>{this.events.on(i,n)}),Tt(this,"once",(i,n)=>{this.events.once(i,n)}),Tt(this,"off",(i,n)=>{this.events.off(i,n)}),Tt(this,"removeListener",(i,n)=>{this.events.removeListener(i,n)}),this.logger=Ct(r,this.name)}get context(){return kt(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(e){if(typeof e=="string")return O5(e);if(typeof e=="number")return M5(e);const{message:r}=H("UNKNOWN_TYPE",`Target type: ${typeof e}`);throw new Error(r)}async setExpirations(e){await this.core.storage.setItem(this.storageKey,e)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(ur.sync)}async restore(){try{const e=await this.getExpirations();if(typeof e>"u"||!e.length)return;if(this.expirations.size){const{message:r}=H("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(e){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(e)}}getExpiration(e){const r=this.expirations.get(e);if(!r){const{message:i}=H("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.warn(i),new Error(i)}return r}checkExpiry(e,r){const{expiry:i}=r;V.toMiliseconds(i)-Date.now()<=0&&this.expire(e,r)}expire(e,r){this.expirations.delete(e),this.events.emit(ur.expired,{target:e,expiration:r})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((e,r)=>this.checkExpiry(r,e))}registerEventListeners(){this.core.heartbeat.on(yn.pulse,()=>this.checkExpirations()),this.events.on(ur.created,e=>{const r=ur.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()}),this.events.on(ur.expired,e=>{const r=ur.expired;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()}),this.events.on(ur.deleted,e=>{const r=ur.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=H("NOT_INITIALIZED",this.name);throw new Error(e)}}}var eI=Object.defineProperty,tI=(t,e,r)=>e in t?eI(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,ot=(t,e,r)=>tI(t,typeof e!="symbol"?e+"":e,r);class rI extends Yg{constructor(e,r,i){super(e,r,i),this.core=e,this.logger=r,this.store=i,ot(this,"name",BE),ot(this,"abortController"),ot(this,"isDevEnv"),ot(this,"verifyUrlV3",LE),ot(this,"storagePrefix",kr),ot(this,"version",Hp),ot(this,"publicKey"),ot(this,"fetchPromise"),ot(this,"init",async()=>{var n;this.isDevEnv||(this.publicKey=await this.store.getItem(this.storeKey),this.publicKey&&V.toMiliseconds((n=this.publicKey)==null?void 0:n.expiresAt)<Date.now()&&(this.logger.debug("verify v2 public key expired"),await this.removePublicKey()))}),ot(this,"register",async n=>{if(!Ds()||this.isDevEnv)return;const s=window.location.origin,{id:o,decryptedId:a}=n,c=`${this.verifyUrlV3}/attestation?projectId=${this.core.projectId}&origin=${s}&id=${o}&decryptedId=${a}`;try{const u=ls(),h=this.startAbortTimer(V.ONE_SECOND*5),l=await new Promise((b,w)=>{const g=()=>{window.removeEventListener("message",A),u.body.removeChild(x),w("attestation aborted")};this.abortController.signal.addEventListener("abort",g);const x=u.createElement("iframe");x.src=c,x.style.display="none",x.addEventListener("error",g,{signal:this.abortController.signal});const A=D=>{if(D.data&&typeof D.data=="string")try{const $=JSON.parse(D.data);if($.type==="verify_attestation"){if(Ic($.attestation).payload.id!==o)return;clearInterval(h),u.body.removeChild(x),this.abortController.signal.removeEventListener("abort",g),window.removeEventListener("message",A),b($.attestation===null?"":$.attestation)}}catch($){this.logger.warn($)}};u.body.appendChild(x),window.addEventListener("message",A,{signal:this.abortController.signal})});return this.logger.debug("jwt attestation",l),l}catch(u){this.logger.warn(u)}return""}),ot(this,"resolve",async n=>{if(this.isDevEnv)return"";const{attestationId:s,hash:o,encryptedId:a}=n;if(s===""){this.logger.debug("resolve: attestationId is empty, skipping");return}if(s){if(Ic(s).payload.id!==a)return;const u=await this.isValidJwtAttestation(s);if(u){if(!u.isVerified){this.logger.warn("resolve: jwt attestation: origin url not verified");return}return u}}if(!o)return;const c=this.getVerifyUrl(n?.verifyUrl);return this.fetchAttestation(o,c)}),ot(this,"fetchAttestation",async(n,s)=>{this.logger.debug(`resolving attestation: ${n} from url: ${s}`);const o=this.startAbortTimer(V.ONE_SECOND*5),a=await fetch(`${s}/attestation/${n}?v2Supported=true`,{signal:this.abortController.signal});return clearTimeout(o),a.status===200?await a.json():void 0}),ot(this,"getVerifyUrl",n=>{let s=n||Ks;return qE.includes(s)||(this.logger.info(`verify url: ${s}, not included in trusted list, assigning default: ${Ks}`),s=Ks),s}),ot(this,"fetchPublicKey",async()=>{try{this.logger.debug(`fetching public key from: ${this.verifyUrlV3}`);const n=this.startAbortTimer(V.FIVE_SECONDS),s=await fetch(`${this.verifyUrlV3}/public-key`,{signal:this.abortController.signal});return clearTimeout(n),await s.json()}catch(n){this.logger.warn(n)}}),ot(this,"persistPublicKey",async n=>{this.logger.debug("persisting public key to local storage",n),await this.store.setItem(this.storeKey,n),this.publicKey=n}),ot(this,"removePublicKey",async()=>{this.logger.debug("removing verify v2 public key from storage"),await this.store.removeItem(this.storeKey),this.publicKey=void 0}),ot(this,"isValidJwtAttestation",async n=>{const s=await this.getPublicKey();try{if(s)return this.validateAttestation(n,s)}catch(a){this.logger.error(a),this.logger.warn("error validating attestation")}const o=await this.fetchAndPersistPublicKey();try{if(o)return this.validateAttestation(n,o)}catch(a){this.logger.error(a),this.logger.warn("error validating attestation")}}),ot(this,"getPublicKey",async()=>this.publicKey?this.publicKey:await this.fetchAndPersistPublicKey()),ot(this,"fetchAndPersistPublicKey",async()=>{if(this.fetchPromise)return await this.fetchPromise,this.publicKey;this.fetchPromise=new Promise(async s=>{const o=await this.fetchPublicKey();o&&(await this.persistPublicKey(o),s(o))});const n=await this.fetchPromise;return this.fetchPromise=void 0,n}),ot(this,"validateAttestation",(n,s)=>{const o=T7(n,s.publicKey),a={hasExpired:V.toMiliseconds(o.exp)<Date.now(),payload:o};if(a.hasExpired)throw this.logger.warn("resolve: jwt attestation expired"),new Error("JWT attestation expired");return{origin:a.payload.origin,isScam:a.payload.isScam,isVerified:a.payload.isVerified}}),this.logger=Ct(r,this.name),this.abortController=new AbortController,this.isDevEnv=Su(),this.init()}get storeKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//verify:public:key"}get context(){return kt(this.logger)}startAbortTimer(e){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),V.toMiliseconds(e))}}var iI=Object.defineProperty,nI=(t,e,r)=>e in t?iI(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,_1=(t,e,r)=>nI(t,typeof e!="symbol"?e+"":e,r);class sI extends Xg{constructor(e,r){super(e,r),this.projectId=e,this.logger=r,_1(this,"context",zE),_1(this,"registerDeviceToken",async i=>{const{clientId:n,token:s,notificationType:o,enableEncrypted:a=!1}=i,c=`${UE}/${this.projectId}/clients`;await fetch(c,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:n,type:o,token:s,always_raw:a})})}),this.logger=Ct(r,this.context)}}var oI=Object.defineProperty,E1=Object.getOwnPropertySymbols,aI=Object.prototype.hasOwnProperty,cI=Object.prototype.propertyIsEnumerable,df=(t,e,r)=>e in t?oI(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Ws=(t,e)=>{for(var r in e||(e={}))aI.call(e,r)&&df(t,r,e[r]);if(E1)for(var r of E1(e))cI.call(e,r)&&df(t,r,e[r]);return t},mt=(t,e,r)=>df(t,typeof e!="symbol"?e+"":e,r);class uI extends Zg{constructor(e,r,i=!0){super(e,r,i),this.core=e,this.logger=r,mt(this,"context",jE),mt(this,"storagePrefix",kr),mt(this,"storageVersion",kE),mt(this,"events",new Map),mt(this,"shouldPersist",!1),mt(this,"init",async()=>{if(!Su())try{const n={eventId:A0(),timestamp:Date.now(),domain:this.getAppDomain(),props:{event:"INIT",type:"",properties:{client_id:await this.core.crypto.getClientId(),user_agent:w0(this.core.relayer.protocol,this.core.relayer.version,tf)}}};await this.sendEvent([n])}catch(n){this.logger.warn(n)}}),mt(this,"createEvent",n=>{const{event:s="ERROR",type:o="",properties:{topic:a,trace:c}}=n,u=A0(),h=this.core.projectId||"",l=Date.now(),b=Ws({eventId:u,timestamp:l,props:{event:s,type:o,properties:{topic:a,trace:c}},bundleId:h,domain:this.getAppDomain()},this.setMethods(u));return this.telemetryEnabled&&(this.events.set(u,b),this.shouldPersist=!0),b}),mt(this,"getEvent",n=>{const{eventId:s,topic:o}=n;if(s)return this.events.get(s);const a=Array.from(this.events.values()).find(c=>c.props.properties.topic===o);if(a)return Ws(Ws({},a),this.setMethods(a.eventId))}),mt(this,"deleteEvent",n=>{const{eventId:s}=n;this.events.delete(s),this.shouldPersist=!0}),mt(this,"setEventListeners",()=>{this.core.heartbeat.on(yn.pulse,async()=>{this.shouldPersist&&await this.persist(),this.events.forEach(n=>{V.fromMiliseconds(Date.now())-V.fromMiliseconds(n.timestamp)>KE&&(this.events.delete(n.eventId),this.shouldPersist=!0)})})}),mt(this,"setMethods",n=>({addTrace:s=>this.addTrace(n,s),setError:s=>this.setError(n,s)})),mt(this,"addTrace",(n,s)=>{const o=this.events.get(n);o&&(o.props.properties.trace.push(s),this.events.set(n,o),this.shouldPersist=!0)}),mt(this,"setError",(n,s)=>{const o=this.events.get(n);o&&(o.props.type=s,o.timestamp=Date.now(),this.events.set(n,o),this.shouldPersist=!0)}),mt(this,"persist",async()=>{await this.core.storage.setItem(this.storageKey,Array.from(this.events.values())),this.shouldPersist=!1}),mt(this,"restore",async()=>{try{const n=await this.core.storage.getItem(this.storageKey)||[];if(!n.length)return;n.forEach(s=>{this.events.set(s.eventId,Ws(Ws({},s),this.setMethods(s.eventId)))})}catch(n){this.logger.warn(n)}}),mt(this,"submit",async()=>{if(!this.telemetryEnabled||this.events.size===0)return;const n=[];for(const[s,o]of this.events)o.props.type&&n.push(o);if(n.length!==0)try{if((await this.sendEvent(n)).ok)for(const s of n)this.events.delete(s.eventId),this.shouldPersist=!0}catch(s){this.logger.warn(s)}}),mt(this,"sendEvent",async n=>{const s=this.getAppDomain()?"":"&sp=desktop";return await fetch(`${VE}?projectId=${this.core.projectId}&st=events_sdk&sv=js-${tf}${s}`,{method:"POST",body:JSON.stringify(n)})}),mt(this,"getAppDomain",()=>m0().url),this.logger=Ct(r,this.context),this.telemetryEnabled=i,i?this.restore().then(async()=>{await this.submit(),this.setEventListeners()}):this.persist()}get storageKey(){return this.storagePrefix+this.storageVersion+this.core.customStoragePrefix+"//"+this.context}}var fI=Object.defineProperty,x1=Object.getOwnPropertySymbols,hI=Object.prototype.hasOwnProperty,dI=Object.prototype.propertyIsEnumerable,lf=(t,e,r)=>e in t?fI(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,S1=(t,e)=>{for(var r in e||(e={}))hI.call(e,r)&&lf(t,r,e[r]);if(x1)for(var r of x1(e))dI.call(e,r)&&lf(t,r,e[r]);return t},_e=(t,e,r)=>lf(t,typeof e!="symbol"?e+"":e,r);class pf extends Lg{constructor(e){var r;super(e),_e(this,"protocol",Vp),_e(this,"version",Hp),_e(this,"name",Aa),_e(this,"relayUrl"),_e(this,"projectId"),_e(this,"customStoragePrefix"),_e(this,"events",new zt.exports.EventEmitter),_e(this,"logger"),_e(this,"heartbeat"),_e(this,"relayer"),_e(this,"crypto"),_e(this,"storage"),_e(this,"history"),_e(this,"expirer"),_e(this,"pairing"),_e(this,"verify"),_e(this,"echoClient"),_e(this,"linkModeSupportedApps"),_e(this,"eventClient"),_e(this,"initialized",!1),_e(this,"logChunkController"),_e(this,"on",(o,a)=>this.events.on(o,a)),_e(this,"once",(o,a)=>this.events.once(o,a)),_e(this,"off",(o,a)=>this.events.off(o,a)),_e(this,"removeListener",(o,a)=>this.events.removeListener(o,a)),_e(this,"dispatchEnvelope",({topic:o,message:a,sessionExists:c})=>{if(!o||!a)return;const u={topic:o,message:a,publishedAt:Date.now(),transportType:Ie.link_mode};this.relayer.onLinkMessageEvent(u,{sessionExists:c})}),this.projectId=e?.projectId,this.relayUrl=e?.relayUrl||Xp,this.customStoragePrefix=e!=null&&e.customStoragePrefix?`:${e.customStoragePrefix}`:"";const i=nc({level:typeof e?.logger=="string"&&e.logger?e.logger:dE.logger,name:Aa}),{logger:n,chunkLoggerController:s}=Cg({opts:i,maxSizeInBytes:e?.maxLogBlobSizeInBytes,loggerOverride:e?.logger});this.logChunkController=s,(r=this.logChunkController)!=null&&r.downloadLogsBlobInBrowser&&(window.downloadLogsBlobInBrowser=async()=>{var o,a;(o=this.logChunkController)!=null&&o.downloadLogsBlobInBrowser&&((a=this.logChunkController)==null||a.downloadLogsBlobInBrowser({clientId:await this.crypto.getClientId()}))}),this.logger=Ct(n,this.name),this.heartbeat=new Za,this.crypto=new mS(this,this.logger,e?.keychain),this.history=new XS(this,this.logger),this.expirer=new QS(this,this.logger),this.storage=e!=null&&e.storage?e.storage:new ag(S1(S1({},lE),e?.storageOptions)),this.relayer=new US({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new GS(this,this.logger),this.verify=new rI(this,this.logger,this.storage),this.echoClient=new sI(this.projectId||"",this.logger),this.linkModeSupportedApps=[],this.eventClient=new uI(this,this.logger,e?.telemetryEnabled)}static async init(e){const r=new pf(e);await r.initialize();const i=await r.crypto.getClientId();return await r.storage.setItem(AE,i),r}get context(){return kt(this.logger)}async start(){this.initialized||await this.initialize()}async getLogsBlob(){var e;return(e=this.logChunkController)==null?void 0:e.logsToBlob({clientId:await this.crypto.getClientId()})}async addLinkModeSupportedApp(e){this.linkModeSupportedApps.includes(e)||(this.linkModeSupportedApps.push(e),await this.storage.setItem(Zp,this.linkModeSupportedApps))}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.linkModeSupportedApps=await this.storage.getItem(Zp)||[],this.initialized=!0,this.logger.info("Core Initialization Success")}catch(e){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,e),this.logger.error(e.message),e}}}const lI=pf,bf="wc",gf=2,yf="client",Ma=`${bf}@${gf}:${yf}:`,$a={name:yf,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.org"},pI={session_proposal:"session_proposal",session_update:"session_update",session_extend:"session_extend",session_ping:"session_ping",session_delete:"session_delete",session_expire:"session_expire",session_request:"session_request",session_request_sent:"session_request_sent",session_event:"session_event",proposal_expire:"proposal_expire",session_authenticate:"session_authenticate",session_request_expire:"session_request_expire",session_connect:"session_connect"},bI={database:":memory:"},vf="WALLETCONNECT_DEEPLINK_CHOICE",gI={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},yI="history",vI="0.3",I1="proposal",mI=V.THIRTY_DAYS,mf="Proposal expired",A1="session",an=V.SEVEN_DAYS,D1="engine",ut={wc_sessionPropose:{req:{ttl:V.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:V.FIVE_MINUTES,prompt:!1,tag:1101},reject:{ttl:V.FIVE_MINUTES,prompt:!1,tag:1120},autoReject:{ttl:V.FIVE_MINUTES,prompt:!1,tag:1121}},wc_sessionSettle:{req:{ttl:V.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:V.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:V.ONE_DAY,prompt:!1,tag:1104},res:{ttl:V.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:V.ONE_DAY,prompt:!1,tag:1106},res:{ttl:V.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:V.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:V.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:V.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:V.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:V.ONE_DAY,prompt:!1,tag:1112},res:{ttl:V.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:V.ONE_DAY,prompt:!1,tag:1114},res:{ttl:V.ONE_DAY,prompt:!1,tag:1115}},wc_sessionAuthenticate:{req:{ttl:V.ONE_HOUR,prompt:!0,tag:1116},res:{ttl:V.ONE_HOUR,prompt:!1,tag:1117},reject:{ttl:V.FIVE_MINUTES,prompt:!1,tag:1118},autoReject:{ttl:V.FIVE_MINUTES,prompt:!1,tag:1119}}},Pa={min:V.FIVE_MINUTES,max:V.SEVEN_DAYS},Er={idle:"IDLE",active:"ACTIVE"},wf={eth_sendTransaction:{key:""},eth_sendRawTransaction:{key:""},wallet_sendCalls:{key:""},solana_signTransaction:{key:"signature"},solana_signAllTransactions:{key:"transactions"},solana_signAndSendTransaction:{key:"signature"}},O1="request",M1=["wc_sessionPropose","wc_sessionRequest","wc_authRequest","wc_sessionAuthenticate"],$1="wc",wI=1.5,P1="auth",T1="authKeys",R1="pairingTopics",N1="requests",Ys=`${$1}@${1.5}:${P1}:`,Xs=`${Ys}:PUB_KEY`;var _I=Object.defineProperty,EI=Object.defineProperties,xI=Object.getOwnPropertyDescriptors,C1=Object.getOwnPropertySymbols,SI=Object.prototype.hasOwnProperty,II=Object.prototype.propertyIsEnumerable,_f=(t,e,r)=>e in t?_I(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Fe=(t,e)=>{for(var r in e||(e={}))SI.call(e,r)&&_f(t,r,e[r]);if(C1)for(var r of C1(e))II.call(e,r)&&_f(t,r,e[r]);return t},Wt=(t,e)=>EI(t,xI(e)),K=(t,e,r)=>_f(t,typeof e!="symbol"?e+"":e,r);class AI extends ty{constructor(e){super(e),K(this,"name",D1),K(this,"events",new zt.exports),K(this,"initialized",!1),K(this,"requestQueue",{state:Er.idle,queue:[]}),K(this,"sessionRequestQueue",{state:Er.idle,queue:[]}),K(this,"requestQueueDelay",V.ONE_SECOND),K(this,"expectedPairingMethodMap",new Map),K(this,"recentlyDeletedMap",new Map),K(this,"recentlyDeletedLimit",200),K(this,"relayMessageCache",[]),K(this,"pendingSessions",new Map),K(this,"init",async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),await this.registerLinkModeListeners(),this.client.core.pairing.register({methods:Object.keys(ut)}),this.initialized=!0,setTimeout(()=>{this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},V.toMiliseconds(this.requestQueueDelay)))}),K(this,"connect",async r=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();const i=Wt(Fe({},r),{requiredNamespaces:r.requiredNamespaces||{},optionalNamespaces:r.optionalNamespaces||{}});await this.isValidConnect(i);const{pairingTopic:n,requiredNamespaces:s,optionalNamespaces:o,sessionProperties:a,relays:c}=i;let u=n,h,l=!1;try{if(u){const N=this.client.core.pairing.pairings.get(u);this.client.logger.warn("connect() with existing pairing topic is deprecated and will be removed in the next major release."),l=N.active}}catch(N){throw this.client.logger.error(`connect() -> pairing.get(${u}) failed`),N}if(!u||!l){const{topic:N,uri:L}=await this.client.core.pairing.create();u=N,h=L}if(!u){const{message:N}=H("NO_MATCHING_KEY",`connect() pairing topic: ${u}`);throw new Error(N)}const b=await this.client.core.crypto.generateKeyPair(),w=ut.wc_sessionPropose.req.ttl||V.FIVE_MINUTES,g=ct(w),x=Wt(Fe({requiredNamespaces:s,optionalNamespaces:o,relays:c??[{protocol:Yp}],proposer:{publicKey:b,metadata:this.client.metadata},expiryTimestamp:g,pairingTopic:u},a&&{sessionProperties:a}),{id:zr()}),A=he("session_connect",x.id),{reject:D,resolve:$,done:P}=Zi(w,mf),T=({id:N})=>{N===x.id&&(this.client.events.off("proposal_expire",T),this.pendingSessions.delete(x.id),this.events.emit(A,{error:{message:mf,code:0}}))};return this.client.events.on("proposal_expire",T),this.events.once(A,({error:N,session:L})=>{this.client.events.off("proposal_expire",T),N?D(N):L&&$(L)}),await this.sendRequest({topic:u,method:"wc_sessionPropose",params:x,throwOnFailedPublish:!0,clientRpcId:x.id}),await this.setProposal(x.id,x),{uri:h,approval:P}}),K(this,"pair",async r=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{return await this.client.core.pairing.pair(r)}catch(i){throw this.client.logger.error("pair() failed"),i}}),K(this,"approve",async r=>{var i,n,s;const o=this.client.core.eventClient.createEvent({properties:{topic:(i=r?.id)==null?void 0:i.toString(),trace:[wr.session_approve_started]}});try{this.isInitialized(),await this.confirmOnlineStateOrThrow()}catch(B){throw o.setError(nn.no_internet_connection),B}try{await this.isValidProposalId(r?.id)}catch(B){throw this.client.logger.error(`approve() -> proposal.get(${r?.id}) failed`),o.setError(nn.proposal_not_found),B}try{await this.isValidApprove(r)}catch(B){throw this.client.logger.error("approve() -> isValidApprove() failed"),o.setError(nn.session_approve_namespace_validation_failure),B}const{id:a,relayProtocol:c,namespaces:u,sessionProperties:h,sessionConfig:l}=r,b=this.client.proposal.get(a);this.client.core.eventClient.deleteEvent({eventId:o.eventId});const{pairingTopic:w,proposer:g,requiredNamespaces:x,optionalNamespaces:A}=b;let D=(n=this.client.core.eventClient)==null?void 0:n.getEvent({topic:w});D||(D=(s=this.client.core.eventClient)==null?void 0:s.createEvent({type:wr.session_approve_started,properties:{topic:w,trace:[wr.session_approve_started,wr.session_namespaces_validation_success]}}));const $=await this.client.core.crypto.generateKeyPair(),P=g.publicKey,T=await this.client.core.crypto.generateSharedKey($,P),N=Fe(Fe({relay:{protocol:c??"irn"},namespaces:u,controller:{publicKey:$,metadata:this.client.metadata},expiry:ct(an)},h&&{sessionProperties:h}),l&&{sessionConfig:l}),L=Ie.relay;D.addTrace(wr.subscribing_session_topic);try{await this.client.core.relayer.subscribe(T,{transportType:L})}catch(B){throw D.setError(nn.subscribe_session_topic_failure),B}D.addTrace(wr.subscribe_session_topic_success);const F=Wt(Fe({},N),{topic:T,requiredNamespaces:x,optionalNamespaces:A,pairingTopic:w,acknowledged:!1,self:N.controller,peer:{publicKey:g.publicKey,metadata:g.metadata},controller:$,transportType:Ie.relay});await this.client.session.set(T,F),D.addTrace(wr.store_session);try{D.addTrace(wr.publishing_session_settle),await this.sendRequest({topic:T,method:"wc_sessionSettle",params:N,throwOnFailedPublish:!0}).catch(B=>{throw D?.setError(nn.session_settle_publish_failure),B}),D.addTrace(wr.session_settle_publish_success),D.addTrace(wr.publishing_session_approve),await this.sendResult({id:a,topic:w,result:{relay:{protocol:c??"irn"},responderPublicKey:$},throwOnFailedPublish:!0}).catch(B=>{throw D?.setError(nn.session_approve_publish_failure),B}),D.addTrace(wr.session_approve_publish_success)}catch(B){throw this.client.logger.error(B),this.client.session.delete(T,we("USER_DISCONNECTED")),await this.client.core.relayer.unsubscribe(T),B}return this.client.core.eventClient.deleteEvent({eventId:D.eventId}),await this.client.core.pairing.updateMetadata({topic:w,metadata:g.metadata}),await this.client.proposal.delete(a,we("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:w}),await this.setExpiry(T,ct(an)),{topic:T,acknowledged:()=>Promise.resolve(this.client.session.get(T))}}),K(this,"reject",async r=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidReject(r)}catch(o){throw this.client.logger.error("reject() -> isValidReject() failed"),o}const{id:i,reason:n}=r;let s;try{s=this.client.proposal.get(i).pairingTopic}catch(o){throw this.client.logger.error(`reject() -> proposal.get(${i}) failed`),o}s&&(await this.sendError({id:i,topic:s,error:n,rpcOpts:ut.wc_sessionPropose.reject}),await this.client.proposal.delete(i,we("USER_DISCONNECTED")))}),K(this,"update",async r=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidUpdate(r)}catch(l){throw this.client.logger.error("update() -> isValidUpdate() failed"),l}const{topic:i,namespaces:n}=r,{done:s,resolve:o,reject:a}=Zi(),c=zr(),u=en().toString(),h=this.client.session.get(i).namespaces;return this.events.once(he("session_update",c),({error:l})=>{l?a(l):o()}),await this.client.session.update(i,{namespaces:n}),await this.sendRequest({topic:i,method:"wc_sessionUpdate",params:{namespaces:n},throwOnFailedPublish:!0,clientRpcId:c,relayRpcId:u}).catch(l=>{this.client.logger.error(l),this.client.session.update(i,{namespaces:h}),a(l)}),{acknowledged:s}}),K(this,"extend",async r=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidExtend(r)}catch(c){throw this.client.logger.error("extend() -> isValidExtend() failed"),c}const{topic:i}=r,n=zr(),{done:s,resolve:o,reject:a}=Zi();return this.events.once(he("session_extend",n),({error:c})=>{c?a(c):o()}),await this.setExpiry(i,ct(an)),this.sendRequest({topic:i,method:"wc_sessionExtend",params:{},clientRpcId:n,throwOnFailedPublish:!0}).catch(c=>{a(c)}),{acknowledged:s}}),K(this,"request",async r=>{this.isInitialized();try{await this.isValidRequest(r)}catch(D){throw this.client.logger.error("request() -> isValidRequest() failed"),D}const{chainId:i,request:n,topic:s,expiry:o=ut.wc_sessionRequest.req.ttl}=r,a=this.client.session.get(s);a?.transportType===Ie.relay&&await this.confirmOnlineStateOrThrow();const c=zr(),u=en().toString(),{done:h,resolve:l,reject:b}=Zi(o,"Request expired. Please try again.");this.events.once(he("session_request",c),({error:D,result:$})=>{D?b(D):l($)});const w="wc_sessionRequest",g=this.getAppLinkIfEnabled(a.peer.metadata,a.transportType);if(g)return await this.sendRequest({clientRpcId:c,relayRpcId:u,topic:s,method:w,params:{request:Wt(Fe({},n),{expiryTimestamp:ct(o)}),chainId:i},expiry:o,throwOnFailedPublish:!0,appLink:g}).catch(D=>b(D)),this.client.events.emit("session_request_sent",{topic:s,request:n,chainId:i,id:c}),await h();const x={request:Wt(Fe({},n),{expiryTimestamp:ct(o)}),chainId:i},A=this.shouldSetTVF(w,x);return await Promise.all([new Promise(async D=>{await this.sendRequest(Fe({clientRpcId:c,relayRpcId:u,topic:s,method:w,params:x,expiry:o,throwOnFailedPublish:!0},A&&{tvf:this.getTVFParams(c,x)})).catch($=>b($)),this.client.events.emit("session_request_sent",{topic:s,request:n,chainId:i,id:c}),D()}),new Promise(async D=>{var $;if(!(($=a.sessionConfig)!=null&&$.disableDeepLink)){const P=await N5(this.client.core.storage,vf);await P5({id:c,topic:s,wcDeepLink:P})}D()}),h()]).then(D=>D[2])}),K(this,"respond",async r=>{this.isInitialized(),await this.isValidRespond(r);const{topic:i,response:n}=r,{id:s}=n,o=this.client.session.get(i);o.transportType===Ie.relay&&await this.confirmOnlineStateOrThrow();const a=this.getAppLinkIfEnabled(o.peer.metadata,o.transportType);Ur(n)?await this.sendResult({id:s,topic:i,result:n.result,throwOnFailedPublish:!0,appLink:a}):ar(n)&&await this.sendError({id:s,topic:i,error:n.error,appLink:a}),this.cleanupAfterResponse(r)}),K(this,"ping",async r=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidPing(r)}catch(n){throw this.client.logger.error("ping() -> isValidPing() failed"),n}const{topic:i}=r;if(this.client.session.keys.includes(i)){const n=zr(),s=en().toString(),{done:o,resolve:a,reject:c}=Zi();this.events.once(he("session_ping",n),({error:u})=>{u?c(u):a()}),await Promise.all([this.sendRequest({topic:i,method:"wc_sessionPing",params:{},throwOnFailedPublish:!0,clientRpcId:n,relayRpcId:s}),o()])}else this.client.core.pairing.pairings.keys.includes(i)&&(this.client.logger.warn("ping() on pairing topic is deprecated and will be removed in the next major release."),await this.client.core.pairing.ping({topic:i}))}),K(this,"emit",async r=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidEmit(r);const{topic:i,event:n,chainId:s}=r,o=en().toString(),a=zr();await this.sendRequest({topic:i,method:"wc_sessionEvent",params:{event:n,chainId:s},throwOnFailedPublish:!0,relayRpcId:o,clientRpcId:a})}),K(this,"disconnect",async r=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidDisconnect(r);const{topic:i}=r;if(this.client.session.keys.includes(i))await this.sendRequest({topic:i,method:"wc_sessionDelete",params:we("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession({topic:i,emitEvent:!1});else if(this.client.core.pairing.pairings.keys.includes(i))await this.client.core.pairing.disconnect({topic:i});else{const{message:n}=H("MISMATCHED_TOPIC",`Session or pairing topic not found: ${i}`);throw new Error(n)}}),K(this,"find",r=>(this.isInitialized(),this.client.session.getAll().filter(i=>j7(i,r)))),K(this,"getPendingSessionRequests",()=>this.client.pendingRequest.getAll()),K(this,"authenticate",async(r,i)=>{var n;this.isInitialized(),this.isValidAuthenticate(r);const s=i&&this.client.core.linkModeSupportedApps.includes(i)&&((n=this.client.metadata.redirect)==null?void 0:n.linkMode),o=s?Ie.link_mode:Ie.relay;o===Ie.relay&&await this.confirmOnlineStateOrThrow();const{chains:a,statement:c="",uri:u,domain:h,nonce:l,type:b,exp:w,nbf:g,methods:x=[],expiry:A}=r,D=[...r.resources||[]],{topic:$,uri:P}=await this.client.core.pairing.create({methods:["wc_sessionAuthenticate"],transportType:o});this.client.logger.info({message:"Generated new pairing",pairing:{topic:$,uri:P}});const T=await this.client.core.crypto.generateKeyPair(),N=wa(T);if(await Promise.all([this.client.auth.authKeys.set(Xs,{responseTopic:N,publicKey:T}),this.client.auth.pairingTopics.set(N,{topic:N,pairingTopic:$})]),await this.client.core.relayer.subscribe(N,{transportType:o}),this.client.logger.info(`sending request to new pairing topic: ${$}`),x.length>0){const{namespace:_}=ha(a[0]);let d=x9(_,"request",x);ga(D)&&(d=I9(d,D.pop())),D.push(d)}const L=A&&A>ut.wc_sessionAuthenticate.req.ttl?A:ut.wc_sessionAuthenticate.req.ttl,F={authPayload:{type:b??"caip122",chains:a,statement:c,aud:u,domain:h,version:"1",nonce:l,iat:new Date().toISOString(),exp:w,nbf:g,resources:D},requester:{publicKey:T,metadata:this.client.metadata},expiryTimestamp:ct(L)},B={eip155:{chains:a,methods:[...new Set(["personal_sign",...x])],events:["chainChanged","accountsChanged"]}},C={requiredNamespaces:{},optionalNamespaces:B,relays:[{protocol:"irn"}],pairingTopic:$,proposer:{publicKey:T,metadata:this.client.metadata},expiryTimestamp:ct(ut.wc_sessionPropose.req.ttl),id:zr()},{done:G,resolve:I,reject:f}=Zi(L,"Request expired"),p=zr(),v=he("session_connect",C.id),y=he("session_request",p),m=async({error:_,session:d})=>{this.events.off(y,S),_?f(_):d&&I({session:d})},S=async _=>{var d,E,q;if(await this.deletePendingAuthRequest(p,{message:"fulfilled",code:0}),_.error){const X=we("WC_METHOD_UNSUPPORTED","wc_sessionAuthenticate");return _.error.code===X.code?void 0:(this.events.off(v,m),f(_.error.message))}await this.deleteProposal(C.id),this.events.off(v,m);const{cacaos:z,responder:U}=_.result,k=[],W=[];for(const X of z){await U0({cacao:X,projectId:this.client.core.projectId})||(this.client.logger.error(X,"Signature verification failed"),f(we("SESSION_SETTLEMENT_FAILED","Signature verification failed")));const{p:Q}=X,Le=ga(Q.resources),re=[$u(Q.iss)],ae=ba(Q.iss);if(Le){const ft=K0(Le),de=V0(Le);k.push(...ft),re.push(...de)}for(const ft of re)W.push(`${ft}:${ae}`)}const Z=await this.client.core.crypto.generateSharedKey(T,U.publicKey);let J;k.length>0&&(J={topic:Z,acknowledged:!0,self:{publicKey:T,metadata:this.client.metadata},peer:U,controller:U.publicKey,expiry:ct(an),requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:$,namespaces:Sp([...new Set(k)],[...new Set(W)]),transportType:o},await this.client.core.relayer.subscribe(Z,{transportType:o}),await this.client.session.set(Z,J),$&&await this.client.core.pairing.updateMetadata({topic:$,metadata:U.metadata}),J=this.client.session.get(Z)),(d=this.client.metadata.redirect)!=null&&d.linkMode&&(E=U.metadata.redirect)!=null&&E.linkMode&&(q=U.metadata.redirect)!=null&&q.universal&&i&&(this.client.core.addLinkModeSupportedApp(U.metadata.redirect.universal),this.client.session.update(Z,{transportType:Ie.link_mode})),I({auths:z,session:J})};this.events.once(v,m),this.events.once(y,S);let O;try{if(s){const _=tn("wc_sessionAuthenticate",F,p);this.client.core.history.set($,_);const d=await this.client.core.crypto.encode("",_,{type:Cs,encoding:Rs});O=Ea(i,$,d)}else await Promise.all([this.sendRequest({topic:$,method:"wc_sessionAuthenticate",params:F,expiry:r.expiry,throwOnFailedPublish:!0,clientRpcId:p}),this.sendRequest({topic:$,method:"wc_sessionPropose",params:C,expiry:ut.wc_sessionPropose.req.ttl,throwOnFailedPublish:!0,clientRpcId:C.id})])}catch(_){throw this.events.off(v,m),this.events.off(y,S),_}return await this.setProposal(C.id,C),await this.setAuthRequest(p,{request:Wt(Fe({},F),{verifyContext:{}}),pairingTopic:$,transportType:o}),{uri:O??P,response:G}}),K(this,"approveSessionAuthenticate",async r=>{const{id:i,auths:n}=r,s=this.client.core.eventClient.createEvent({properties:{topic:i.toString(),trace:[sn.authenticated_session_approve_started]}});try{this.isInitialized()}catch(A){throw s.setError(Vs.no_internet_connection),A}const o=this.getPendingAuthRequest(i);if(!o)throw s.setError(Vs.authenticated_session_pending_request_not_found),new Error(`Could not find pending auth request with id ${i}`);const a=o.transportType||Ie.relay;a===Ie.relay&&await this.confirmOnlineStateOrThrow();const c=o.requester.publicKey,u=await this.client.core.crypto.generateKeyPair(),h=wa(c),l={type:ni,receiverPublicKey:c,senderPublicKey:u},b=[],w=[];for(const A of n){if(!await U0({cacao:A,projectId:this.client.core.projectId})){s.setError(Vs.invalid_cacao);const N=we("SESSION_SETTLEMENT_FAILED","Signature verification failed");throw await this.sendError({id:i,topic:h,error:N,encodeOpts:l}),new Error(N.message)}s.addTrace(sn.cacaos_verified);const{p:D}=A,$=ga(D.resources),P=[$u(D.iss)],T=ba(D.iss);if($){const N=K0($),L=V0($);b.push(...N),P.push(...L)}for(const N of P)w.push(`${N}:${T}`)}const g=await this.client.core.crypto.generateSharedKey(u,c);s.addTrace(sn.create_authenticated_session_topic);let x;if(b?.length>0){x={topic:g,acknowledged:!0,self:{publicKey:u,metadata:this.client.metadata},peer:{publicKey:c,metadata:o.requester.metadata},controller:c,expiry:ct(an),authentication:n,requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:o.pairingTopic,namespaces:Sp([...new Set(b)],[...new Set(w)]),transportType:a},s.addTrace(sn.subscribing_authenticated_session_topic);try{await this.client.core.relayer.subscribe(g,{transportType:a})}catch(A){throw s.setError(Vs.subscribe_authenticated_session_topic_failure),A}s.addTrace(sn.subscribe_authenticated_session_topic_success),await this.client.session.set(g,x),s.addTrace(sn.store_authenticated_session),await this.client.core.pairing.updateMetadata({topic:o.pairingTopic,metadata:o.requester.metadata})}s.addTrace(sn.publishing_authenticated_session_approve);try{await this.sendResult({topic:h,id:i,result:{cacaos:n,responder:{publicKey:u,metadata:this.client.metadata}},encodeOpts:l,throwOnFailedPublish:!0,appLink:this.getAppLinkIfEnabled(o.requester.metadata,a)})}catch(A){throw s.setError(Vs.authenticated_session_approve_publish_failure),A}return await this.client.auth.requests.delete(i,{message:"fulfilled",code:0}),await this.client.core.pairing.activate({topic:o.pairingTopic}),this.client.core.eventClient.deleteEvent({eventId:s.eventId}),{session:x}}),K(this,"rejectSessionAuthenticate",async r=>{this.isInitialized();const{id:i,reason:n}=r,s=this.getPendingAuthRequest(i);if(!s)throw new Error(`Could not find pending auth request with id ${i}`);s.transportType===Ie.relay&&await this.confirmOnlineStateOrThrow();const o=s.requester.publicKey,a=await this.client.core.crypto.generateKeyPair(),c=wa(o),u={type:ni,receiverPublicKey:o,senderPublicKey:a};await this.sendError({id:i,topic:c,error:n,encodeOpts:u,rpcOpts:ut.wc_sessionAuthenticate.reject,appLink:this.getAppLinkIfEnabled(s.requester.metadata,s.transportType)}),await this.client.auth.requests.delete(i,{message:"rejected",code:0}),await this.client.proposal.delete(i,we("USER_DISCONNECTED"))}),K(this,"formatAuthMessage",r=>{this.isInitialized();const{request:i,iss:n}=r;return k0(i,n)}),K(this,"processRelayMessageCache",()=>{setTimeout(async()=>{if(this.relayMessageCache.length!==0)for(;this.relayMessageCache.length>0;)try{const r=this.relayMessageCache.shift();r&&await this.onRelayMessage(r)}catch(r){this.client.logger.error(r)}},50)}),K(this,"cleanupDuplicatePairings",async r=>{if(r.pairingTopic)try{const i=this.client.core.pairing.pairings.get(r.pairingTopic),n=this.client.core.pairing.pairings.getAll().filter(s=>{var o,a;return((o=s.peerMetadata)==null?void 0:o.url)&&((a=s.peerMetadata)==null?void 0:a.url)===r.peer.metadata.url&&s.topic&&s.topic!==i.topic});if(n.length===0)return;this.client.logger.info(`Cleaning up ${n.length} duplicate pairing(s)`),await Promise.all(n.map(s=>this.client.core.pairing.disconnect({topic:s.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(i){this.client.logger.error(i)}}),K(this,"deleteSession",async r=>{var i;const{topic:n,expirerHasDeleted:s=!1,emitEvent:o=!0,id:a=0}=r,{self:c}=this.client.session.get(n);await this.client.core.relayer.unsubscribe(n),await this.client.session.delete(n,we("USER_DISCONNECTED")),this.addToRecentlyDeleted(n,"session"),this.client.core.crypto.keychain.has(c.publicKey)&&await this.client.core.crypto.deleteKeyPair(c.publicKey),this.client.core.crypto.keychain.has(n)&&await this.client.core.crypto.deleteSymKey(n),s||this.client.core.expirer.del(n),this.client.core.storage.removeItem(vf).catch(u=>this.client.logger.warn(u)),this.getPendingSessionRequests().forEach(u=>{u.topic===n&&this.deletePendingSessionRequest(u.id,we("USER_DISCONNECTED"))}),n===((i=this.sessionRequestQueue.queue[0])==null?void 0:i.topic)&&(this.sessionRequestQueue.state=Er.idle),o&&this.client.events.emit("session_delete",{id:a,topic:n})}),K(this,"deleteProposal",async(r,i)=>{if(i)try{const n=this.client.proposal.get(r),s=this.client.core.eventClient.getEvent({topic:n.pairingTopic});s?.setError(nn.proposal_expired)}catch{}await Promise.all([this.client.proposal.delete(r,we("USER_DISCONNECTED")),i?Promise.resolve():this.client.core.expirer.del(r)]),this.addToRecentlyDeleted(r,"proposal")}),K(this,"deletePendingSessionRequest",async(r,i,n=!1)=>{await Promise.all([this.client.pendingRequest.delete(r,i),n?Promise.resolve():this.client.core.expirer.del(r)]),this.addToRecentlyDeleted(r,"request"),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(s=>s.id!==r),n&&(this.sessionRequestQueue.state=Er.idle,this.client.events.emit("session_request_expire",{id:r}))}),K(this,"deletePendingAuthRequest",async(r,i,n=!1)=>{await Promise.all([this.client.auth.requests.delete(r,i),n?Promise.resolve():this.client.core.expirer.del(r)])}),K(this,"setExpiry",async(r,i)=>{this.client.session.keys.includes(r)&&(this.client.core.expirer.set(r,i),await this.client.session.update(r,{expiry:i}))}),K(this,"setProposal",async(r,i)=>{this.client.core.expirer.set(r,ct(ut.wc_sessionPropose.req.ttl)),await this.client.proposal.set(r,i)}),K(this,"setAuthRequest",async(r,i)=>{const{request:n,pairingTopic:s,transportType:o=Ie.relay}=i;this.client.core.expirer.set(r,n.expiryTimestamp),await this.client.auth.requests.set(r,{authPayload:n.authPayload,requester:n.requester,expiryTimestamp:n.expiryTimestamp,id:r,pairingTopic:s,verifyContext:n.verifyContext,transportType:o})}),K(this,"setPendingSessionRequest",async r=>{const{id:i,topic:n,params:s,verifyContext:o}=r,a=s.request.expiryTimestamp||ct(ut.wc_sessionRequest.req.ttl);this.client.core.expirer.set(i,a),await this.client.pendingRequest.set(i,{id:i,topic:n,params:s,verifyContext:o})}),K(this,"sendRequest",async r=>{const{topic:i,method:n,params:s,expiry:o,relayRpcId:a,clientRpcId:c,throwOnFailedPublish:u,appLink:h,tvf:l}=r,b=tn(n,s,c);let w;const g=!!h;try{const D=g?Rs:Mi;w=await this.client.core.crypto.encode(i,b,{encoding:D})}catch(D){throw await this.cleanup(),this.client.logger.error(`sendRequest() -> core.crypto.encode() for topic ${i} failed`),D}let x;if(M1.includes(n)){const D=si(JSON.stringify(b)),$=si(w);x=await this.client.core.verify.register({id:$,decryptedId:D})}const A=ut[n].req;if(A.attestation=x,o&&(A.ttl=o),a&&(A.id=a),this.client.core.history.set(i,b),g){const D=Ea(h,i,w);await global.Linking.openURL(D,this.client.name)}else{const D=ut[n].req;o&&(D.ttl=o),a&&(D.id=a),D.tvf=Wt(Fe({},l),{correlationId:b.id}),u?(D.internal=Wt(Fe({},D.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(i,w,D)):this.client.core.relayer.publish(i,w,D).catch($=>this.client.logger.error($))}return b.id}),K(this,"sendResult",async r=>{const{id:i,topic:n,result:s,throwOnFailedPublish:o,encodeOpts:a,appLink:c}=r,u=Zu(i,s);let h;const l=c&&typeof(global==null?void 0:global.Linking)<"u";try{const g=l?Rs:Mi;h=await this.client.core.crypto.encode(n,u,Wt(Fe({},a||{}),{encoding:g}))}catch(g){throw await this.cleanup(),this.client.logger.error(`sendResult() -> core.crypto.encode() for topic ${n} failed`),g}let b,w;try{b=await this.client.core.history.get(n,i);const g=b.request;try{this.shouldSetTVF(g.method,g.params)&&(w=this.getTVFParams(i,g.params,s))}catch(x){this.client.logger.warn("sendResult() -> getTVFParams() failed",x)}}catch(g){throw this.client.logger.error(`sendResult() -> history.get(${n}, ${i}) failed`),g}if(l){const g=Ea(c,n,h);await global.Linking.openURL(g,this.client.name)}else{const g=b.request.method,x=ut[g].res;x.tvf=Wt(Fe({},w),{correlationId:i}),o?(x.internal=Wt(Fe({},x.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(n,h,x)):this.client.core.relayer.publish(n,h,x).catch(A=>this.client.logger.error(A))}await this.client.core.history.resolve(u)}),K(this,"sendError",async r=>{const{id:i,topic:n,error:s,encodeOpts:o,rpcOpts:a,appLink:c}=r,u=Ju(i,s);let h;const l=c&&typeof(global==null?void 0:global.Linking)<"u";try{const w=l?Rs:Mi;h=await this.client.core.crypto.encode(n,u,Wt(Fe({},o||{}),{encoding:w}))}catch(w){throw await this.cleanup(),this.client.logger.error(`sendError() -> core.crypto.encode() for topic ${n} failed`),w}let b;try{b=await this.client.core.history.get(n,i)}catch(w){throw this.client.logger.error(`sendError() -> history.get(${n}, ${i}) failed`),w}if(l){const w=Ea(c,n,h);await global.Linking.openURL(w,this.client.name)}else{const w=b.request.method,g=a||ut[w].res;this.client.core.relayer.publish(n,h,g)}await this.client.core.history.resolve(u)}),K(this,"cleanup",async()=>{const r=[],i=[];this.client.session.getAll().forEach(n=>{let s=!1;Ii(n.expiry)&&(s=!0),this.client.core.crypto.keychain.has(n.topic)||(s=!0),s&&r.push(n.topic)}),this.client.proposal.getAll().forEach(n=>{Ii(n.expiryTimestamp)&&i.push(n.id)}),await Promise.all([...r.map(n=>this.deleteSession({topic:n})),...i.map(n=>this.deleteProposal(n))])}),K(this,"onRelayEventRequest",async r=>{this.requestQueue.queue.push(r),await this.processRequestsQueue()}),K(this,"processRequestsQueue",async()=>{if(this.requestQueue.state===Er.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=Er.active;const r=this.requestQueue.queue.shift();if(r)try{await this.processRequest(r)}catch(i){this.client.logger.warn(i)}}this.requestQueue.state=Er.idle}),K(this,"processRequest",async r=>{const{topic:i,payload:n,attestation:s,transportType:o,encryptedId:a}=r,c=n.method;if(!this.shouldIgnorePairingRequest({topic:i,requestMethod:c}))switch(c){case"wc_sessionPropose":return await this.onSessionProposeRequest({topic:i,payload:n,attestation:s,encryptedId:a});case"wc_sessionSettle":return await this.onSessionSettleRequest(i,n);case"wc_sessionUpdate":return await this.onSessionUpdateRequest(i,n);case"wc_sessionExtend":return await this.onSessionExtendRequest(i,n);case"wc_sessionPing":return await this.onSessionPingRequest(i,n);case"wc_sessionDelete":return await this.onSessionDeleteRequest(i,n);case"wc_sessionRequest":return await this.onSessionRequest({topic:i,payload:n,attestation:s,encryptedId:a,transportType:o});case"wc_sessionEvent":return await this.onSessionEventRequest(i,n);case"wc_sessionAuthenticate":return await this.onSessionAuthenticateRequest({topic:i,payload:n,attestation:s,encryptedId:a,transportType:o});default:return this.client.logger.info(`Unsupported request method ${c}`)}}),K(this,"onRelayEventResponse",async r=>{const{topic:i,payload:n,transportType:s}=r,o=(await this.client.core.history.get(i,n.id)).request.method;switch(o){case"wc_sessionPropose":return this.onSessionProposeResponse(i,n,s);case"wc_sessionSettle":return this.onSessionSettleResponse(i,n);case"wc_sessionUpdate":return this.onSessionUpdateResponse(i,n);case"wc_sessionExtend":return this.onSessionExtendResponse(i,n);case"wc_sessionPing":return this.onSessionPingResponse(i,n);case"wc_sessionRequest":return this.onSessionRequestResponse(i,n);case"wc_sessionAuthenticate":return this.onSessionAuthenticateResponse(i,n);default:return this.client.logger.info(`Unsupported response method ${o}`)}}),K(this,"onRelayEventUnknownPayload",r=>{const{topic:i}=r,{message:n}=H("MISSING_OR_INVALID",`Decoded payload on topic ${i} is not identifiable as a JSON-RPC request or a response.`);throw new Error(n)}),K(this,"shouldIgnorePairingRequest",r=>{const{topic:i,requestMethod:n}=r,s=this.expectedPairingMethodMap.get(i);return!s||s.includes(n)?!1:!!(s.includes("wc_sessionAuthenticate")&&this.client.events.listenerCount("session_authenticate")>0)}),K(this,"onSessionProposeRequest",async r=>{const{topic:i,payload:n,attestation:s,encryptedId:o}=r,{params:a,id:c}=n;try{const u=this.client.core.eventClient.getEvent({topic:i});this.client.events.listenerCount("session_proposal")===0&&(console.warn("No listener for session_proposal event"),u?.setError(ci.proposal_listener_not_found)),this.isValidConnect(Fe({},n.params));const h=a.expiryTimestamp||ct(ut.wc_sessionPropose.req.ttl),l=Fe({id:c,pairingTopic:i,expiryTimestamp:h},a);await this.setProposal(c,l);const b=await this.getVerifyContext({attestationId:s,hash:si(JSON.stringify(n)),encryptedId:o,metadata:l.proposer.metadata});u?.addTrace(jr.emit_session_proposal),this.client.events.emit("session_proposal",{id:c,params:l,verifyContext:b})}catch(u){await this.sendError({id:c,topic:i,error:u,rpcOpts:ut.wc_sessionPropose.autoReject}),this.client.logger.error(u)}}),K(this,"onSessionProposeResponse",async(r,i,n)=>{const{id:s}=i;if(Ur(i)){const{result:o}=i;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:o});const a=this.client.proposal.get(s);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:a});const c=a.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:c});const u=o.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:u});const h=await this.client.core.crypto.generateSharedKey(c,u);this.pendingSessions.set(s,{sessionTopic:h,pairingTopic:r,proposalId:s,publicKey:c});const l=await this.client.core.relayer.subscribe(h,{transportType:n});this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:l}),await this.client.core.pairing.activate({topic:r})}else if(ar(i)){await this.client.proposal.delete(s,we("USER_DISCONNECTED"));const o=he("session_connect",s);if(this.events.listenerCount(o)===0)throw new Error(`emitting ${o} without any listeners, 954`);this.events.emit(o,{error:i.error})}}),K(this,"onSessionSettleRequest",async(r,i)=>{const{id:n,params:s}=i;try{this.isValidSessionSettleRequest(s);const{relay:o,controller:a,expiry:c,namespaces:u,sessionProperties:h,sessionConfig:l}=i.params,b=[...this.pendingSessions.values()].find(x=>x.sessionTopic===r);if(!b)return this.client.logger.error(`Pending session not found for topic ${r}`);const w=this.client.proposal.get(b.proposalId),g=Wt(Fe(Fe({topic:r,relay:o,expiry:c,namespaces:u,acknowledged:!0,pairingTopic:b.pairingTopic,requiredNamespaces:w.requiredNamespaces,optionalNamespaces:w.optionalNamespaces,controller:a.publicKey,self:{publicKey:b.publicKey,metadata:this.client.metadata},peer:{publicKey:a.publicKey,metadata:a.metadata}},h&&{sessionProperties:h}),l&&{sessionConfig:l}),{transportType:Ie.relay});await this.client.session.set(g.topic,g),await this.setExpiry(g.topic,g.expiry),await this.client.core.pairing.updateMetadata({topic:b.pairingTopic,metadata:g.peer.metadata}),this.client.events.emit("session_connect",{session:g}),this.events.emit(he("session_connect",b.proposalId),{session:g}),this.pendingSessions.delete(b.proposalId),this.deleteProposal(b.proposalId,!1),this.cleanupDuplicatePairings(g),await this.sendResult({id:i.id,topic:r,result:!0,throwOnFailedPublish:!0})}catch(o){await this.sendError({id:n,topic:r,error:o}),this.client.logger.error(o)}}),K(this,"onSessionSettleResponse",async(r,i)=>{const{id:n}=i;Ur(i)?(await this.client.session.update(r,{acknowledged:!0}),this.events.emit(he("session_approve",n),{})):ar(i)&&(await this.client.session.delete(r,we("USER_DISCONNECTED")),this.events.emit(he("session_approve",n),{error:i.error}))}),K(this,"onSessionUpdateRequest",async(r,i)=>{const{params:n,id:s}=i;try{const o=`${r}_session_update`,a=zs.get(o);if(a&&this.isRequestOutOfSync(a,s)){this.client.logger.warn(`Discarding out of sync request - ${s}`),this.sendError({id:s,topic:r,error:we("INVALID_UPDATE_REQUEST")});return}this.isValidUpdate(Fe({topic:r},n));try{zs.set(o,s),await this.client.session.update(r,{namespaces:n.namespaces}),await this.sendResult({id:s,topic:r,result:!0,throwOnFailedPublish:!0})}catch(c){throw zs.delete(o),c}this.client.events.emit("session_update",{id:s,topic:r,params:n})}catch(o){await this.sendError({id:s,topic:r,error:o}),this.client.logger.error(o)}}),K(this,"isRequestOutOfSync",(r,i)=>i.toString().slice(0,-3)<r.toString().slice(0,-3)),K(this,"onSessionUpdateResponse",(r,i)=>{const{id:n}=i,s=he("session_update",n);if(this.events.listenerCount(s)===0)throw new Error(`emitting ${s} without any listeners`);Ur(i)?this.events.emit(he("session_update",n),{}):ar(i)&&this.events.emit(he("session_update",n),{error:i.error})}),K(this,"onSessionExtendRequest",async(r,i)=>{const{id:n}=i;try{this.isValidExtend({topic:r}),await this.setExpiry(r,ct(an)),await this.sendResult({id:n,topic:r,result:!0,throwOnFailedPublish:!0}),this.client.events.emit("session_extend",{id:n,topic:r})}catch(s){await this.sendError({id:n,topic:r,error:s}),this.client.logger.error(s)}}),K(this,"onSessionExtendResponse",(r,i)=>{const{id:n}=i,s=he("session_extend",n);if(this.events.listenerCount(s)===0)throw new Error(`emitting ${s} without any listeners`);Ur(i)?this.events.emit(he("session_extend",n),{}):ar(i)&&this.events.emit(he("session_extend",n),{error:i.error})}),K(this,"onSessionPingRequest",async(r,i)=>{const{id:n}=i;try{this.isValidPing({topic:r}),await this.sendResult({id:n,topic:r,result:!0,throwOnFailedPublish:!0}),this.client.events.emit("session_ping",{id:n,topic:r})}catch(s){await this.sendError({id:n,topic:r,error:s}),this.client.logger.error(s)}}),K(this,"onSessionPingResponse",(r,i)=>{const{id:n}=i,s=he("session_ping",n);if(this.events.listenerCount(s)===0)throw new Error(`emitting ${s} without any listeners`);setTimeout(()=>{Ur(i)?this.events.emit(he("session_ping",n),{}):ar(i)&&this.events.emit(he("session_ping",n),{error:i.error})},500)}),K(this,"onSessionDeleteRequest",async(r,i)=>{const{id:n}=i;try{this.isValidDisconnect({topic:r,reason:i.params}),Promise.all([new Promise(s=>{this.client.core.relayer.once(vt.publish,async()=>{s(await this.deleteSession({topic:r,id:n}))})}),this.sendResult({id:n,topic:r,result:!0,throwOnFailedPublish:!0}),this.cleanupPendingSentRequestsForTopic({topic:r,error:we("USER_DISCONNECTED")})]).catch(s=>this.client.logger.error(s))}catch(s){this.client.logger.error(s)}}),K(this,"onSessionRequest",async r=>{var i,n,s;const{topic:o,payload:a,attestation:c,encryptedId:u,transportType:h}=r,{id:l,params:b}=a;try{await this.isValidRequest(Fe({topic:o},b));const w=this.client.session.get(o),g=await this.getVerifyContext({attestationId:c,hash:si(JSON.stringify(tn("wc_sessionRequest",b,l))),encryptedId:u,metadata:w.peer.metadata,transportType:h}),x={id:l,topic:o,params:b,verifyContext:g};await this.setPendingSessionRequest(x),h===Ie.link_mode&&(i=w.peer.metadata.redirect)!=null&&i.universal&&this.client.core.addLinkModeSupportedApp((n=w.peer.metadata.redirect)==null?void 0:n.universal),(s=this.client.signConfig)!=null&&s.disableRequestQueue?this.emitSessionRequest(x):(this.addSessionRequestToSessionRequestQueue(x),this.processSessionRequestQueue())}catch(w){await this.sendError({id:l,topic:o,error:w}),this.client.logger.error(w)}}),K(this,"onSessionRequestResponse",(r,i)=>{const{id:n}=i,s=he("session_request",n);if(this.events.listenerCount(s)===0)throw new Error(`emitting ${s} without any listeners`);Ur(i)?this.events.emit(he("session_request",n),{result:i.result}):ar(i)&&this.events.emit(he("session_request",n),{error:i.error})}),K(this,"onSessionEventRequest",async(r,i)=>{const{id:n,params:s}=i;try{const o=`${r}_session_event_${s.event.name}`,a=zs.get(o);if(a&&this.isRequestOutOfSync(a,n)){this.client.logger.info(`Discarding out of sync request - ${n}`);return}this.isValidEmit(Fe({topic:r},s)),this.client.events.emit("session_event",{id:n,topic:r,params:s}),zs.set(o,n)}catch(o){await this.sendError({id:n,topic:r,error:o}),this.client.logger.error(o)}}),K(this,"onSessionAuthenticateResponse",(r,i)=>{const{id:n}=i;this.client.logger.trace({type:"method",method:"onSessionAuthenticateResponse",topic:r,payload:i}),Ur(i)?this.events.emit(he("session_request",n),{result:i.result}):ar(i)&&this.events.emit(he("session_request",n),{error:i.error})}),K(this,"onSessionAuthenticateRequest",async r=>{var i;const{topic:n,payload:s,attestation:o,encryptedId:a,transportType:c}=r;try{const{requester:u,authPayload:h,expiryTimestamp:l}=s.params,b=await this.getVerifyContext({attestationId:o,hash:si(JSON.stringify(s)),encryptedId:a,metadata:u.metadata,transportType:c}),w={requester:u,pairingTopic:n,id:s.id,authPayload:h,verifyContext:b,expiryTimestamp:l};await this.setAuthRequest(s.id,{request:w,pairingTopic:n,transportType:c}),c===Ie.link_mode&&(i=u.metadata.redirect)!=null&&i.universal&&this.client.core.addLinkModeSupportedApp(u.metadata.redirect.universal),this.client.events.emit("session_authenticate",{topic:n,params:s.params,id:s.id,verifyContext:b})}catch(u){this.client.logger.error(u);const h=s.params.requester.publicKey,l=await this.client.core.crypto.generateKeyPair(),b=this.getAppLinkIfEnabled(s.params.requester.metadata,c),w={type:ni,receiverPublicKey:h,senderPublicKey:l};await this.sendError({id:s.id,topic:n,error:u,encodeOpts:w,rpcOpts:ut.wc_sessionAuthenticate.autoReject,appLink:b})}}),K(this,"addSessionRequestToSessionRequestQueue",r=>{this.sessionRequestQueue.queue.push(r)}),K(this,"cleanupAfterResponse",r=>{this.deletePendingSessionRequest(r.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=Er.idle,this.processSessionRequestQueue()},V.toMiliseconds(this.requestQueueDelay))}),K(this,"cleanupPendingSentRequestsForTopic",({topic:r,error:i})=>{const n=this.client.core.history.pending;n.length>0&&n.filter(s=>s.topic===r&&s.request.method==="wc_sessionRequest").forEach(s=>{const o=s.request.id,a=he("session_request",o);if(this.events.listenerCount(a)===0)throw new Error(`emitting ${a} without any listeners`);this.events.emit(he("session_request",s.request.id),{error:i})})}),K(this,"processSessionRequestQueue",()=>{if(this.sessionRequestQueue.state===Er.active){this.client.logger.info("session request queue is already active.");return}const r=this.sessionRequestQueue.queue[0];if(!r){this.client.logger.info("session request queue is empty.");return}try{this.sessionRequestQueue.state=Er.active,this.emitSessionRequest(r)}catch(i){this.client.logger.error(i)}}),K(this,"emitSessionRequest",r=>{this.client.events.emit("session_request",r)}),K(this,"onPairingCreated",r=>{if(r.methods&&this.expectedPairingMethodMap.set(r.topic,r.methods),r.active)return;const i=this.client.proposal.getAll().find(n=>n.pairingTopic===r.topic);i&&this.onSessionProposeRequest({topic:r.topic,payload:tn("wc_sessionPropose",{requiredNamespaces:i.requiredNamespaces,optionalNamespaces:i.optionalNamespaces,relays:i.relays,proposer:i.proposer,sessionProperties:i.sessionProperties},i.id)})}),K(this,"isValidConnect",async r=>{if(!Ht(r)){const{message:c}=H("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(r)}`);throw new Error(c)}const{pairingTopic:i,requiredNamespaces:n,optionalNamespaces:s,sessionProperties:o,relays:a}=r;if(Lt(i)||await this.isValidPairingTopic(i),!t_(a,!0)){const{message:c}=H("MISSING_OR_INVALID",`connect() relays: ${a}`);throw new Error(c)}!Lt(n)&&xa(n)!==0&&this.validateNamespaces(n,"requiredNamespaces"),!Lt(s)&&xa(s)!==0&&this.validateNamespaces(s,"optionalNamespaces"),Lt(o)||this.validateSessionProps(o,"sessionProperties")}),K(this,"validateNamespaces",(r,i)=>{const n=e_(r,"connect()",i);if(n)throw new Error(n.message)}),K(this,"isValidApprove",async r=>{if(!Ht(r))throw new Error(H("MISSING_OR_INVALID",`approve() params: ${r}`).message);const{id:i,namespaces:n,relayProtocol:s,sessionProperties:o}=r;this.checkRecentlyDeleted(i),await this.isValidProposalId(i);const a=this.client.proposal.get(i),c=Vu(n,"approve()");if(c)throw new Error(c.message);const u=Mp(a.requiredNamespaces,n,"approve()");if(u)throw new Error(u.message);if(!st(s,!0)){const{message:h}=H("MISSING_OR_INVALID",`approve() relayProtocol: ${s}`);throw new Error(h)}Lt(o)||this.validateSessionProps(o,"sessionProperties")}),K(this,"isValidReject",async r=>{if(!Ht(r)){const{message:s}=H("MISSING_OR_INVALID",`reject() params: ${r}`);throw new Error(s)}const{id:i,reason:n}=r;if(this.checkRecentlyDeleted(i),await this.isValidProposalId(i),!i_(n)){const{message:s}=H("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(n)}`);throw new Error(s)}}),K(this,"isValidSessionSettleRequest",r=>{if(!Ht(r)){const{message:u}=H("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${r}`);throw new Error(u)}const{relay:i,controller:n,namespaces:s,expiry:o}=r;if(!Dp(i)){const{message:u}=H("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(u)}const a=W7(n,"onSessionSettleRequest()");if(a)throw new Error(a.message);const c=Vu(s,"onSessionSettleRequest()");if(c)throw new Error(c.message);if(Ii(o)){const{message:u}=H("EXPIRED","onSessionSettleRequest()");throw new Error(u)}}),K(this,"isValidUpdate",async r=>{if(!Ht(r)){const{message:c}=H("MISSING_OR_INVALID",`update() params: ${r}`);throw new Error(c)}const{topic:i,namespaces:n}=r;this.checkRecentlyDeleted(i),await this.isValidSessionTopic(i);const s=this.client.session.get(i),o=Vu(n,"update()");if(o)throw new Error(o.message);const a=Mp(s.requiredNamespaces,n,"update()");if(a)throw new Error(a.message)}),K(this,"isValidExtend",async r=>{if(!Ht(r)){const{message:n}=H("MISSING_OR_INVALID",`extend() params: ${r}`);throw new Error(n)}const{topic:i}=r;this.checkRecentlyDeleted(i),await this.isValidSessionTopic(i)}),K(this,"isValidRequest",async r=>{if(!Ht(r)){const{message:c}=H("MISSING_OR_INVALID",`request() params: ${r}`);throw new Error(c)}const{topic:i,request:n,chainId:s,expiry:o}=r;this.checkRecentlyDeleted(i),await this.isValidSessionTopic(i);const{namespaces:a}=this.client.session.get(i);if(!Op(a,s)){const{message:c}=H("MISSING_OR_INVALID",`request() chainId: ${s}`);throw new Error(c)}if(!n_(n)){const{message:c}=H("MISSING_OR_INVALID",`request() ${JSON.stringify(n)}`);throw new Error(c)}if(!a_(a,s,n.method)){const{message:c}=H("MISSING_OR_INVALID",`request() method: ${n.method}`);throw new Error(c)}if(o&&!h_(o,Pa)){const{message:c}=H("MISSING_OR_INVALID",`request() expiry: ${o}. Expiry must be a number (in seconds) between ${Pa.min} and ${Pa.max}`);throw new Error(c)}}),K(this,"isValidRespond",async r=>{var i;if(!Ht(r)){const{message:o}=H("MISSING_OR_INVALID",`respond() params: ${r}`);throw new Error(o)}const{topic:n,response:s}=r;try{await this.isValidSessionTopic(n)}catch(o){throw(i=r?.response)!=null&&i.id&&this.cleanupAfterResponse(r),o}if(!s_(s)){const{message:o}=H("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(s)}`);throw new Error(o)}}),K(this,"isValidPing",async r=>{if(!Ht(r)){const{message:n}=H("MISSING_OR_INVALID",`ping() params: ${r}`);throw new Error(n)}const{topic:i}=r;await this.isValidSessionOrPairingTopic(i)}),K(this,"isValidEmit",async r=>{if(!Ht(r)){const{message:a}=H("MISSING_OR_INVALID",`emit() params: ${r}`);throw new Error(a)}const{topic:i,event:n,chainId:s}=r;await this.isValidSessionTopic(i);const{namespaces:o}=this.client.session.get(i);if(!Op(o,s)){const{message:a}=H("MISSING_OR_INVALID",`emit() chainId: ${s}`);throw new Error(a)}if(!o_(n)){const{message:a}=H("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(n)}`);throw new Error(a)}if(!c_(o,s,n.name)){const{message:a}=H("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(n)}`);throw new Error(a)}}),K(this,"isValidDisconnect",async r=>{if(!Ht(r)){const{message:n}=H("MISSING_OR_INVALID",`disconnect() params: ${r}`);throw new Error(n)}const{topic:i}=r;await this.isValidSessionOrPairingTopic(i)}),K(this,"isValidAuthenticate",r=>{const{chains:i,uri:n,domain:s,nonce:o}=r;if(!Array.isArray(i)||i.length===0)throw new Error("chains is required and must be a non-empty array");if(!st(n,!1))throw new Error("uri is required parameter");if(!st(s,!1))throw new Error("domain is required parameter");if(!st(o,!1))throw new Error("nonce is required parameter");if([...new Set(i.map(c=>ha(c).namespace))].length>1)throw new Error("Multi-namespace requests are not supported. Please request single namespace only.");const{namespace:a}=ha(i[0]);if(a!=="eip155")throw new Error("Only eip155 namespace is supported for authenticated sessions. Please use .connect() for non-eip155 chains.")}),K(this,"getVerifyContext",async r=>{const{attestationId:i,hash:n,encryptedId:s,metadata:o,transportType:a}=r,c={verified:{verifyUrl:o.verifyUrl||Ks,validation:"UNKNOWN",origin:o.url||""}};try{if(a===Ie.link_mode){const h=this.getAppLinkIfEnabled(o,a);return c.verified.validation=h&&new URL(h).origin===new URL(o.url).origin?"VALID":"INVALID",c}const u=await this.client.core.verify.resolve({attestationId:i,hash:n,encryptedId:s,verifyUrl:o.verifyUrl});u&&(c.verified.origin=u.origin,c.verified.isScam=u.isScam,c.verified.validation=u.origin===new URL(o.url).origin?"VALID":"INVALID")}catch(u){this.client.logger.warn(u)}return this.client.logger.debug(`Verify context: ${JSON.stringify(c)}`),c}),K(this,"validateSessionProps",(r,i)=>{Object.values(r).forEach(n=>{if(!st(n,!1)){const{message:s}=H("MISSING_OR_INVALID",`${i} must be in Record<string, string> format. Received: ${JSON.stringify(n)}`);throw new Error(s)}})}),K(this,"getPendingAuthRequest",r=>{const i=this.client.auth.requests.get(r);return typeof i=="object"?i:void 0}),K(this,"addToRecentlyDeleted",(r,i)=>{if(this.recentlyDeletedMap.set(r,i),this.recentlyDeletedMap.size>=this.recentlyDeletedLimit){let n=0;const s=this.recentlyDeletedLimit/2;for(const o of this.recentlyDeletedMap.keys()){if(n++>=s)break;this.recentlyDeletedMap.delete(o)}}}),K(this,"checkRecentlyDeleted",r=>{const i=this.recentlyDeletedMap.get(r);if(i){const{message:n}=H("MISSING_OR_INVALID",`Record was recently deleted - ${i}: ${r}`);throw new Error(n)}}),K(this,"isLinkModeEnabled",(r,i)=>{var n,s,o,a,c,u,h,l,b;return!r||i!==Ie.link_mode?!1:((s=(n=this.client.metadata)==null?void 0:n.redirect)==null?void 0:s.linkMode)===!0&&((a=(o=this.client.metadata)==null?void 0:o.redirect)==null?void 0:a.universal)!==void 0&&((u=(c=this.client.metadata)==null?void 0:c.redirect)==null?void 0:u.universal)!==""&&((h=r?.redirect)==null?void 0:h.universal)!==void 0&&((l=r?.redirect)==null?void 0:l.universal)!==""&&((b=r?.redirect)==null?void 0:b.linkMode)===!0&&this.client.core.linkModeSupportedApps.includes(r.redirect.universal)&&typeof(global==null?void 0:global.Linking)<"u"}),K(this,"getAppLinkIfEnabled",(r,i)=>{var n;return this.isLinkModeEnabled(r,i)?(n=r?.redirect)==null?void 0:n.universal:void 0}),K(this,"handleLinkModeMessage",({url:r})=>{if(!r||!r.includes("wc_ev")||!r.includes("topic"))return;const i=I0(r,"topic")||"",n=decodeURIComponent(I0(r,"wc_ev")||""),s=this.client.session.keys.includes(i);s&&this.client.session.update(i,{transportType:Ie.link_mode}),this.client.core.dispatchEnvelope({topic:i,message:n,sessionExists:s})}),K(this,"registerLinkModeListeners",async()=>{var r;if(Su()||xi()&&(r=this.client.metadata.redirect)!=null&&r.linkMode){const i=global==null?void 0:global.Linking;if(typeof i<"u"){i.addEventListener("url",this.handleLinkModeMessage,this.client.name);const n=await i.getInitialURL();n&&setTimeout(()=>{this.handleLinkModeMessage({url:n})},50)}}}),K(this,"shouldSetTVF",(r,i)=>{if(!i||r!=="wc_sessionRequest")return!1;const{request:n}=i;return Object.keys(wf).includes(n.method)}),K(this,"getTVFParams",(r,i,n)=>{var s,o;try{const a=i.request.method,c=this.extractTxHashesFromResult(a,n);return Wt(Fe({correlationId:r,rpcMethods:[a],chainId:i.chainId},this.isValidContractData(i.request.params)&&{contractAddresses:[(o=(s=i.request.params)==null?void 0:s[0])==null?void 0:o.to]}),{txHashes:c})}catch(a){this.client.logger.warn("Error getting TVF params",a)}return{}}),K(this,"isValidContractData",r=>{var i;if(!r)return!1;try{const n=r?.data||((i=r?.[0])==null?void 0:i.data);if(!n.startsWith("0x"))return!1;const s=n.slice(2);return/^[0-9a-fA-F]*$/.test(s)?s.length%2===0:!1}catch{}return!1}),K(this,"extractTxHashesFromResult",(r,i)=>{try{const n=wf[r];if(typeof i=="string")return[i];const s=i[n.key];if(qs(s))return s;if(typeof s=="string")return[s]}catch(n){this.client.logger.warn("Error extracting tx hashes from result",n)}return[]})}isInitialized(){if(!this.initialized){const{message:e}=H("NOT_INITIALIZED",this.name);throw new Error(e)}}async confirmOnlineStateOrThrow(){await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(vt.message,e=>{!this.initialized||this.relayMessageCache.length>0?this.relayMessageCache.push(e):this.onRelayMessage(e)})}async onRelayMessage(e){const{topic:r,message:i,attestation:n,transportType:s}=e,{publicKey:o}=this.client.auth.authKeys.keys.includes(Xs)?this.client.auth.authKeys.get(Xs):{responseTopic:void 0,publicKey:void 0},a=await this.client.core.crypto.decode(r,i,{receiverPublicKey:o,encoding:s===Ie.link_mode?Rs:Mi});try{Qu(a)?(this.client.core.history.set(r,a),this.onRelayEventRequest({topic:r,payload:a,attestation:n,transportType:s,encryptedId:si(i)})):Ia(a)?(await this.client.core.history.resolve(a),await this.onRelayEventResponse({topic:r,payload:a,transportType:s}),this.client.core.history.delete(r,a.id)):this.onRelayEventUnknownPayload({topic:r,payload:a,transportType:s})}catch(c){this.client.logger.error(c)}}registerExpirerEvents(){this.client.core.expirer.on(ur.expired,async e=>{const{topic:r,id:i}=S0(e.target);if(i&&this.client.pendingRequest.keys.includes(i))return await this.deletePendingSessionRequest(i,H("EXPIRED"),!0);if(i&&this.client.auth.requests.keys.includes(i))return await this.deletePendingAuthRequest(i,H("EXPIRED"),!0);r?this.client.session.keys.includes(r)&&(await this.deleteSession({topic:r,expirerHasDeleted:!0}),this.client.events.emit("session_expire",{topic:r})):i&&(await this.deleteProposal(i,!0),this.client.events.emit("proposal_expire",{id:i}))})}registerPairingEvents(){this.client.core.pairing.events.on(rn.create,e=>this.onPairingCreated(e)),this.client.core.pairing.events.on(rn.delete,e=>{this.addToRecentlyDeleted(e.topic,"pairing")})}isValidPairingTopic(e){if(!st(e,!1)){const{message:r}=H("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw new Error(r)}if(!this.client.core.pairing.pairings.keys.includes(e)){const{message:r}=H("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw new Error(r)}if(Ii(this.client.core.pairing.pairings.get(e).expiry)){const{message:r}=H("EXPIRED",`pairing topic: ${e}`);throw new Error(r)}}async isValidSessionTopic(e){if(!st(e,!1)){const{message:r}=H("MISSING_OR_INVALID",`session topic should be a string: ${e}`);throw new Error(r)}if(this.checkRecentlyDeleted(e),!this.client.session.keys.includes(e)){const{message:r}=H("NO_MATCHING_KEY",`session topic doesn't exist: ${e}`);throw new Error(r)}if(Ii(this.client.session.get(e).expiry)){await this.deleteSession({topic:e});const{message:r}=H("EXPIRED",`session topic: ${e}`);throw new Error(r)}if(!this.client.core.crypto.keychain.has(e)){const{message:r}=H("MISSING_OR_INVALID",`session topic does not exist in keychain: ${e}`);throw await this.deleteSession({topic:e}),new Error(r)}}async isValidSessionOrPairingTopic(e){if(this.checkRecentlyDeleted(e),this.client.session.keys.includes(e))await this.isValidSessionTopic(e);else if(this.client.core.pairing.pairings.keys.includes(e))this.isValidPairingTopic(e);else if(st(e,!1)){const{message:r}=H("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${e}`);throw new Error(r)}else{const{message:r}=H("MISSING_OR_INVALID",`session or pairing topic should be a string: ${e}`);throw new Error(r)}}async isValidProposalId(e){if(!r_(e)){const{message:r}=H("MISSING_OR_INVALID",`proposal id should be a number: ${e}`);throw new Error(r)}if(!this.client.proposal.keys.includes(e)){const{message:r}=H("NO_MATCHING_KEY",`proposal id doesn't exist: ${e}`);throw new Error(r)}if(Ii(this.client.proposal.get(e).expiryTimestamp)){await this.deleteProposal(e);const{message:r}=H("EXPIRED",`proposal id: ${e}`);throw new Error(r)}}}class DI extends on{constructor(e,r){super(e,r,I1,Ma),this.core=e,this.logger=r}}class B1 extends on{constructor(e,r){super(e,r,A1,Ma),this.core=e,this.logger=r}}class OI extends on{constructor(e,r){super(e,r,O1,Ma,i=>i.id),this.core=e,this.logger=r}}class MI extends on{constructor(e,r){super(e,r,T1,Ys,()=>Xs),this.core=e,this.logger=r}}class $I extends on{constructor(e,r){super(e,r,R1,Ys),this.core=e,this.logger=r}}class PI extends on{constructor(e,r){super(e,r,N1,Ys,i=>i.id),this.core=e,this.logger=r}}var TI=Object.defineProperty,RI=(t,e,r)=>e in t?TI(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Ef=(t,e,r)=>RI(t,typeof e!="symbol"?e+"":e,r);class NI{constructor(e,r){this.core=e,this.logger=r,Ef(this,"authKeys"),Ef(this,"pairingTopics"),Ef(this,"requests"),this.authKeys=new MI(this.core,this.logger),this.pairingTopics=new $I(this.core,this.logger),this.requests=new PI(this.core,this.logger)}async init(){await this.authKeys.init(),await this.pairingTopics.init(),await this.requests.init()}}var CI=Object.defineProperty,BI=(t,e,r)=>e in t?CI(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,oe=(t,e,r)=>BI(t,typeof e!="symbol"?e+"":e,r);class Ta extends ey{constructor(e){super(e),oe(this,"protocol",bf),oe(this,"version",gf),oe(this,"name",$a.name),oe(this,"metadata"),oe(this,"core"),oe(this,"logger"),oe(this,"events",new zt.exports.EventEmitter),oe(this,"engine"),oe(this,"session"),oe(this,"proposal"),oe(this,"pendingRequest"),oe(this,"auth"),oe(this,"signConfig"),oe(this,"on",(i,n)=>this.events.on(i,n)),oe(this,"once",(i,n)=>this.events.once(i,n)),oe(this,"off",(i,n)=>this.events.off(i,n)),oe(this,"removeListener",(i,n)=>this.events.removeListener(i,n)),oe(this,"removeAllListeners",i=>this.events.removeAllListeners(i)),oe(this,"connect",async i=>{try{return await this.engine.connect(i)}catch(n){throw this.logger.error(n.message),n}}),oe(this,"pair",async i=>{try{return await this.engine.pair(i)}catch(n){throw this.logger.error(n.message),n}}),oe(this,"approve",async i=>{try{return await this.engine.approve(i)}catch(n){throw this.logger.error(n.message),n}}),oe(this,"reject",async i=>{try{return await this.engine.reject(i)}catch(n){throw this.logger.error(n.message),n}}),oe(this,"update",async i=>{try{return await this.engine.update(i)}catch(n){throw this.logger.error(n.message),n}}),oe(this,"extend",async i=>{try{return await this.engine.extend(i)}catch(n){throw this.logger.error(n.message),n}}),oe(this,"request",async i=>{try{return await this.engine.request(i)}catch(n){throw this.logger.error(n.message),n}}),oe(this,"respond",async i=>{try{return await this.engine.respond(i)}catch(n){throw this.logger.error(n.message),n}}),oe(this,"ping",async i=>{try{return await this.engine.ping(i)}catch(n){throw this.logger.error(n.message),n}}),oe(this,"emit",async i=>{try{return await this.engine.emit(i)}catch(n){throw this.logger.error(n.message),n}}),oe(this,"disconnect",async i=>{try{return await this.engine.disconnect(i)}catch(n){throw this.logger.error(n.message),n}}),oe(this,"find",i=>{try{return this.engine.find(i)}catch(n){throw this.logger.error(n.message),n}}),oe(this,"getPendingSessionRequests",()=>{try{return this.engine.getPendingSessionRequests()}catch(i){throw this.logger.error(i.message),i}}),oe(this,"authenticate",async(i,n)=>{try{return await this.engine.authenticate(i,n)}catch(s){throw this.logger.error(s.message),s}}),oe(this,"formatAuthMessage",i=>{try{return this.engine.formatAuthMessage(i)}catch(n){throw this.logger.error(n.message),n}}),oe(this,"approveSessionAuthenticate",async i=>{try{return await this.engine.approveSessionAuthenticate(i)}catch(n){throw this.logger.error(n.message),n}}),oe(this,"rejectSessionAuthenticate",async i=>{try{return await this.engine.rejectSessionAuthenticate(i)}catch(n){throw this.logger.error(n.message),n}}),this.name=e?.name||$a.name,this.metadata=e?.metadata||m0(),this.signConfig=e?.signConfig;const r=typeof e?.logger<"u"&&typeof e?.logger!="string"?e.logger:Gr(nc({level:e?.logger||$a.logger}));this.core=e?.core||new lI(e),this.logger=Ct(r,this.name),this.session=new B1(this.core,this.logger),this.proposal=new DI(this.core,this.logger),this.pendingRequest=new OI(this.core,this.logger),this.engine=new AI(this),this.auth=new NI(this.core,this.logger)}static async init(e){const r=new Ta(e);return await r.initialize(),r}get context(){return kt(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.auth.init(),await this.engine.init(),this.logger.info("SignClient Initialization Success"),setTimeout(()=>{this.engine.processRelayMessageCache()},V.toMiliseconds(V.ONE_SECOND))}catch(e){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(e.message),e}}}const FI=B1,LI=Ta;ie.AUTH_CONTEXT=P1,ie.AUTH_KEYS_CONTEXT=T1,ie.AUTH_PAIRING_TOPIC_CONTEXT=R1,ie.AUTH_PROTOCOL=$1,ie.AUTH_PUBLIC_KEY_NAME=Xs,ie.AUTH_REQUEST_CONTEXT=N1,ie.AUTH_STORAGE_PREFIX=Ys,ie.AUTH_VERSION=wI,ie.ENGINE_CONTEXT=D1,ie.ENGINE_QUEUE_STATES=Er,ie.ENGINE_RPC_OPTS=ut,ie.HISTORY_CONTEXT=yI,ie.HISTORY_EVENTS=gI,ie.HISTORY_STORAGE_VERSION=vI,ie.METHODS_TO_VERIFY=M1,ie.PROPOSAL_CONTEXT=I1,ie.PROPOSAL_EXPIRY=mI,ie.PROPOSAL_EXPIRY_MESSAGE=mf,ie.REQUEST_CONTEXT=O1,ie.SESSION_CONTEXT=A1,ie.SESSION_EXPIRY=an,ie.SESSION_REQUEST_EXPIRY_BOUNDARIES=Pa,ie.SIGN_CLIENT_CONTEXT=yf,ie.SIGN_CLIENT_DEFAULT=$a,ie.SIGN_CLIENT_EVENTS=pI,ie.SIGN_CLIENT_PROTOCOL=bf,ie.SIGN_CLIENT_STORAGE_OPTIONS=bI,ie.SIGN_CLIENT_STORAGE_PREFIX=Ma,ie.SIGN_CLIENT_VERSION=gf,ie.SessionStore=FI,ie.SignClient=LI,ie.TVF_METHODS=wf,ie.WALLETCONNECT_DEEPLINK_CHOICE=vf,ie.default=Ta,Object.defineProperty(ie,"__esModule",{value:!0})});
//# sourceMappingURL=index.umd.js.map
