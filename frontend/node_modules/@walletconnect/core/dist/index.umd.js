(function(H,_t){typeof exports=="object"&&typeof module<"u"?_t(exports):typeof define=="function"&&define.amd?define(["exports"],_t):(H=typeof globalThis<"u"?globalThis:H||self,_t(H["@walletconnect/core"]={}))})(this,function(H){"use strict";var _t=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Bo(t){var e=t.default;if(typeof e=="function"){var r=function(){return e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(t).forEach(function(n){var i=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(r,n,i.get?i:{enumerable:!0,get:function(){return t[n]}})}),r}var Ut={exports:{}},Mn=typeof Reflect=="object"?Reflect:null,Gc=Mn&&typeof Mn.apply=="function"?Mn.apply:function(e,r,n){return Function.prototype.apply.call(e,r,n)},ps;Mn&&typeof Mn.ownKeys=="function"?ps=Mn.ownKeys:Object.getOwnPropertySymbols?ps=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:ps=function(e){return Object.getOwnPropertyNames(e)};function Y0(t){console&&console.warn&&console.warn(t)}var Yc=Number.isNaN||function(e){return e!==e};function fe(){fe.init.call(this)}Ut.exports=fe,Ut.exports.once=Q0,fe.EventEmitter=fe,fe.prototype._events=void 0,fe.prototype._eventsCount=0,fe.prototype._maxListeners=void 0;var Xc=10;function bs(t){if(typeof t!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}Object.defineProperty(fe,"defaultMaxListeners",{enumerable:!0,get:function(){return Xc},set:function(t){if(typeof t!="number"||t<0||Yc(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");Xc=t}}),fe.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},fe.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||Yc(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function Zc(t){return t._maxListeners===void 0?fe.defaultMaxListeners:t._maxListeners}fe.prototype.getMaxListeners=function(){return Zc(this)},fe.prototype.emit=function(e){for(var r=[],n=1;n<arguments.length;n++)r.push(arguments[n]);var i=e==="error",s=this._events;if(s!==void 0)i=i&&s.error===void 0;else if(!i)return!1;if(i){var o;if(r.length>0&&(o=r[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var c=s[e];if(c===void 0)return!1;if(typeof c=="function")Gc(c,this,r);else for(var u=c.length,d=rf(c,u),n=0;n<u;++n)Gc(d[n],this,r);return!0};function Jc(t,e,r,n){var i,s,o;if(bs(r),s=t._events,s===void 0?(s=t._events=Object.create(null),t._eventsCount=0):(s.newListener!==void 0&&(t.emit("newListener",e,r.listener?r.listener:r),s=t._events),o=s[e]),o===void 0)o=s[e]=r,++t._eventsCount;else if(typeof o=="function"?o=s[e]=n?[r,o]:[o,r]:n?o.unshift(r):o.push(r),i=Zc(t),i>0&&o.length>i&&!o.warned){o.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=t,a.type=e,a.count=o.length,Y0(a)}return t}fe.prototype.addListener=function(e,r){return Jc(this,e,r,!1)},fe.prototype.on=fe.prototype.addListener,fe.prototype.prependListener=function(e,r){return Jc(this,e,r,!0)};function X0(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Qc(t,e,r){var n={fired:!1,wrapFn:void 0,target:t,type:e,listener:r},i=X0.bind(n);return i.listener=r,n.wrapFn=i,i}fe.prototype.once=function(e,r){return bs(r),this.on(e,Qc(this,e,r)),this},fe.prototype.prependOnceListener=function(e,r){return bs(r),this.prependListener(e,Qc(this,e,r)),this},fe.prototype.removeListener=function(e,r){var n,i,s,o,a;if(bs(r),i=this._events,i===void 0)return this;if(n=i[e],n===void 0)return this;if(n===r||n.listener===r)--this._eventsCount===0?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,n.listener||r));else if(typeof n!="function"){for(s=-1,o=n.length-1;o>=0;o--)if(n[o]===r||n[o].listener===r){a=n[o].listener,s=o;break}if(s<0)return this;s===0?n.shift():Z0(n,s),n.length===1&&(i[e]=n[0]),i.removeListener!==void 0&&this.emit("removeListener",e,a||r)}return this},fe.prototype.off=fe.prototype.removeListener,fe.prototype.removeAllListeners=function(e){var r,n,i;if(n=this._events,n===void 0)return this;if(n.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):n[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete n[e]),this;if(arguments.length===0){var s=Object.keys(n),o;for(i=0;i<s.length;++i)o=s[i],o!=="removeListener"&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(r=n[e],typeof r=="function")this.removeListener(e,r);else if(r!==void 0)for(i=r.length-1;i>=0;i--)this.removeListener(e,r[i]);return this};function ef(t,e,r){var n=t._events;if(n===void 0)return[];var i=n[e];return i===void 0?[]:typeof i=="function"?r?[i.listener||i]:[i]:r?J0(i):rf(i,i.length)}fe.prototype.listeners=function(e){return ef(this,e,!0)},fe.prototype.rawListeners=function(e){return ef(this,e,!1)},fe.listenerCount=function(t,e){return typeof t.listenerCount=="function"?t.listenerCount(e):tf.call(t,e)},fe.prototype.listenerCount=tf;function tf(t){var e=this._events;if(e!==void 0){var r=e[t];if(typeof r=="function")return 1;if(r!==void 0)return r.length}return 0}fe.prototype.eventNames=function(){return this._eventsCount>0?ps(this._events):[]};function rf(t,e){for(var r=new Array(e),n=0;n<e;++n)r[n]=t[n];return r}function Z0(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function J0(t){for(var e=new Array(t.length),r=0;r<e.length;++r)e[r]=t[r].listener||t[r];return e}function Q0(t,e){return new Promise(function(r,n){function i(o){t.removeListener(e,s),n(o)}function s(){typeof t.removeListener=="function"&&t.removeListener("error",i),r([].slice.call(arguments))}nf(t,e,s,{once:!0}),e!=="error"&&e1(t,i,{once:!0})})}function e1(t,e,r){typeof t.on=="function"&&nf(t,"error",e,r)}function nf(t,e,r,n){if(typeof t.on=="function")n.once?t.once(e,r):t.on(e,r);else if(typeof t.addEventListener=="function")t.addEventListener(e,function i(s){n.once&&t.removeEventListener(e,i),r(s)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t)}var G={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var Po=function(t,e){return Po=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},Po(t,e)};function t1(t,e){Po(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var No=function(){return No=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},No.apply(this,arguments)};function r1(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}function n1(t,e,r,n){var i=arguments.length,s=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,r):n,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,r,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,r,s):o(e,r))||s);return i>3&&s&&Object.defineProperty(e,r,s),s}function i1(t,e){return function(r,n){e(r,n,t)}}function s1(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function o1(t,e,r,n){function i(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function a(d){try{u(n.next(d))}catch(p){o(p)}}function c(d){try{u(n.throw(d))}catch(p){o(p)}}function u(d){d.done?s(d.value):i(d.value).then(a,c)}u((n=n.apply(t,e||[])).next())})}function a1(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(u){return function(d){return c([u,d])}}function c(u){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(s=u[0]&2?i.return:u[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,u[1])).done)return s;switch(i=0,s&&(u=[u[0]&2,s.value]),u[0]){case 0:case 1:s=u;break;case 4:return r.label++,{value:u[1],done:!1};case 5:r.label++,i=u[1],u=[0];continue;case 7:u=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(u[0]===6||u[0]===2)){r=0;continue}if(u[0]===3&&(!s||u[1]>s[0]&&u[1]<s[3])){r.label=u[1];break}if(u[0]===6&&r.label<s[1]){r.label=s[1],s=u;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(u);break}s[2]&&r.ops.pop(),r.trys.pop();continue}u=e.call(t,r)}catch(d){u=[6,d],i=0}finally{n=s=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}function c1(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}function f1(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function Co(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function sf(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),i,s=[],o;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(a){o={error:a}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return s}function u1(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(sf(arguments[e]));return t}function h1(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var n=Array(t),i=0,e=0;e<r;e++)for(var s=arguments[e],o=0,a=s.length;o<a;o++,i++)n[i]=s[o];return n}function gi(t){return this instanceof gi?(this.v=t,this):new gi(t)}function d1(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(t,e||[]),i,s=[];return i={},o("next"),o("throw"),o("return"),i[Symbol.asyncIterator]=function(){return this},i;function o(y){n[y]&&(i[y]=function(_){return new Promise(function(w,D){s.push([y,_,w,D])>1||a(y,_)})})}function a(y,_){try{c(n[y](_))}catch(w){p(s[0][3],w)}}function c(y){y.value instanceof gi?Promise.resolve(y.value.v).then(u,d):p(s[0][2],y)}function u(y){a("next",y)}function d(y){a("throw",y)}function p(y,_){y(_),s.shift(),s.length&&a(s[0][0],s[0][1])}}function l1(t){var e,r;return e={},n("next"),n("throw",function(i){throw i}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(i,s){e[i]=t[i]?function(o){return(r=!r)?{value:gi(t[i](o)),done:i==="return"}:s?s(o):o}:s}}function p1(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof Co=="function"?Co(t):t[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(s){r[s]=t[s]&&function(o){return new Promise(function(a,c){o=t[s](o),i(a,c,o.done,o.value)})}}function i(s,o,a,c){Promise.resolve(c).then(function(u){s({value:u,done:a})},o)}}function b1(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function g1(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function v1(t){return t&&t.__esModule?t:{default:t}}function y1(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function m1(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}var w1=Object.freeze({__proto__:null,__extends:t1,get __assign(){return No},__rest:r1,__decorate:n1,__param:i1,__metadata:s1,__awaiter:o1,__generator:a1,__createBinding:c1,__exportStar:f1,__values:Co,__read:sf,__spread:u1,__spreadArrays:h1,__await:gi,__asyncGenerator:d1,__asyncDelegator:l1,__asyncValues:p1,__makeTemplateObject:b1,__importStar:g1,__importDefault:v1,__classPrivateFieldGet:y1,__classPrivateFieldSet:m1}),gs=Bo(w1),Lo={},vi={},of;function _1(){if(of)return vi;of=1,Object.defineProperty(vi,"__esModule",{value:!0}),vi.delay=void 0;function t(e){return new Promise(r=>{setTimeout(()=>{r(!0)},e)})}return vi.delay=t,vi}var tn={},$o={},rn={},af;function E1(){return af||(af=1,Object.defineProperty(rn,"__esModule",{value:!0}),rn.ONE_THOUSAND=rn.ONE_HUNDRED=void 0,rn.ONE_HUNDRED=100,rn.ONE_THOUSAND=1e3),rn}var Fo={},cf;function x1(){return cf||(cf=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.ONE_YEAR=t.FOUR_WEEKS=t.THREE_WEEKS=t.TWO_WEEKS=t.ONE_WEEK=t.THIRTY_DAYS=t.SEVEN_DAYS=t.FIVE_DAYS=t.THREE_DAYS=t.ONE_DAY=t.TWENTY_FOUR_HOURS=t.TWELVE_HOURS=t.SIX_HOURS=t.THREE_HOURS=t.ONE_HOUR=t.SIXTY_MINUTES=t.THIRTY_MINUTES=t.TEN_MINUTES=t.FIVE_MINUTES=t.ONE_MINUTE=t.SIXTY_SECONDS=t.THIRTY_SECONDS=t.TEN_SECONDS=t.FIVE_SECONDS=t.ONE_SECOND=void 0,t.ONE_SECOND=1,t.FIVE_SECONDS=5,t.TEN_SECONDS=10,t.THIRTY_SECONDS=30,t.SIXTY_SECONDS=60,t.ONE_MINUTE=t.SIXTY_SECONDS,t.FIVE_MINUTES=t.ONE_MINUTE*5,t.TEN_MINUTES=t.ONE_MINUTE*10,t.THIRTY_MINUTES=t.ONE_MINUTE*30,t.SIXTY_MINUTES=t.ONE_MINUTE*60,t.ONE_HOUR=t.SIXTY_MINUTES,t.THREE_HOURS=t.ONE_HOUR*3,t.SIX_HOURS=t.ONE_HOUR*6,t.TWELVE_HOURS=t.ONE_HOUR*12,t.TWENTY_FOUR_HOURS=t.ONE_HOUR*24,t.ONE_DAY=t.TWENTY_FOUR_HOURS,t.THREE_DAYS=t.ONE_DAY*3,t.FIVE_DAYS=t.ONE_DAY*5,t.SEVEN_DAYS=t.ONE_DAY*7,t.THIRTY_DAYS=t.ONE_DAY*30,t.ONE_WEEK=t.SEVEN_DAYS,t.TWO_WEEKS=t.ONE_WEEK*2,t.THREE_WEEKS=t.ONE_WEEK*3,t.FOUR_WEEKS=t.ONE_WEEK*4,t.ONE_YEAR=t.ONE_DAY*365}(Fo)),Fo}var ff;function uf(){return ff||(ff=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=gs;e.__exportStar(E1(),t),e.__exportStar(x1(),t)}($o)),$o}var hf;function S1(){if(hf)return tn;hf=1,Object.defineProperty(tn,"__esModule",{value:!0}),tn.fromMiliseconds=tn.toMiliseconds=void 0;const t=uf();function e(n){return n*t.ONE_THOUSAND}tn.toMiliseconds=e;function r(n){return Math.floor(n/t.ONE_THOUSAND)}return tn.fromMiliseconds=r,tn}var df;function I1(){return df||(df=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=gs;e.__exportStar(_1(),t),e.__exportStar(S1(),t)}(Lo)),Lo}var Tn={},lf;function A1(){if(lf)return Tn;lf=1,Object.defineProperty(Tn,"__esModule",{value:!0}),Tn.Watch=void 0;class t{constructor(){this.timestamps=new Map}start(r){if(this.timestamps.has(r))throw new Error(`Watch already started for label: ${r}`);this.timestamps.set(r,{started:Date.now()})}stop(r){const n=this.get(r);if(typeof n.elapsed<"u")throw new Error(`Watch already stopped for label: ${r}`);const i=Date.now()-n.started;this.timestamps.set(r,{started:n.started,elapsed:i})}get(r){const n=this.timestamps.get(r);if(typeof n>"u")throw new Error(`No timestamp found for label: ${r}`);return n}elapsed(r){const n=this.get(r);return n.elapsed||Date.now()-n.started}}return Tn.Watch=t,Tn.default=t,Tn}var zo={},yi={},pf;function D1(){if(pf)return yi;pf=1,Object.defineProperty(yi,"__esModule",{value:!0}),yi.IWatch=void 0;class t{}return yi.IWatch=t,yi}var bf;function O1(){return bf||(bf=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),gs.__exportStar(D1(),t)}(zo)),zo}(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=gs;e.__exportStar(I1(),t),e.__exportStar(A1(),t),e.__exportStar(O1(),t),e.__exportStar(uf(),t)})(G);class nn{}class M1 extends nn{constructor(e){super()}}const gf=G.FIVE_SECONDS,Rn={pulse:"heartbeat_pulse"};class Uo extends M1{constructor(e){super(e),this.events=new Ut.exports.EventEmitter,this.interval=gf,this.interval=e?.interval||gf}static async init(e){const r=new Uo(e);return await r.init(),r}async init(){await this.initialize()}stop(){clearInterval(this.intervalRef)}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async initialize(){this.intervalRef=setInterval(()=>this.pulse(),G.toMiliseconds(this.interval))}pulse(){this.events.emit(Rn.pulse)}}const T1=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,R1=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,B1=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function P1(t,e){if(t==="__proto__"||t==="constructor"&&e&&typeof e=="object"&&"prototype"in e){N1(t);return}return e}function N1(t){console.warn(`[destr] Dropping "${t}" key to prevent prototype pollution.`)}function vs(t,e={}){if(typeof t!="string")return t;const r=t.trim();if(t[0]==='"'&&t.endsWith('"')&&!t.includes("\\"))return r.slice(1,-1);if(r.length<=9){const n=r.toLowerCase();if(n==="true")return!0;if(n==="false")return!1;if(n==="undefined")return;if(n==="null")return null;if(n==="nan")return Number.NaN;if(n==="infinity")return Number.POSITIVE_INFINITY;if(n==="-infinity")return Number.NEGATIVE_INFINITY}if(!B1.test(t)){if(e.strict)throw new SyntaxError("[destr] Invalid JSON");return t}try{if(T1.test(t)||R1.test(t)){if(e.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(t,P1)}return JSON.parse(t)}catch(n){if(e.strict)throw n;return t}}function C1(t){return!t||typeof t.then!="function"?Promise.resolve(t):t}function et(t,...e){try{return C1(t(...e))}catch(r){return Promise.reject(r)}}function L1(t){const e=typeof t;return t===null||e!=="object"&&e!=="function"}function $1(t){const e=Object.getPrototypeOf(t);return!e||e.isPrototypeOf(Object)}function ys(t){if(L1(t))return String(t);if($1(t)||Array.isArray(t))return JSON.stringify(t);if(typeof t.toJSON=="function")return ys(t.toJSON());throw new Error("[unstorage] Cannot stringify value!")}const ko="base64:";function F1(t){return typeof t=="string"?t:ko+k1(t)}function z1(t){return typeof t!="string"||!t.startsWith(ko)?t:U1(t.slice(ko.length))}function U1(t){return globalThis.Buffer?Buffer.from(t,"base64"):Uint8Array.from(globalThis.atob(t),e=>e.codePointAt(0))}function k1(t){return globalThis.Buffer?Buffer.from(t).toString("base64"):globalThis.btoa(String.fromCodePoint(...t))}function It(t){return t&&t.split("?")[0]?.replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,"")||""}function j1(...t){return It(t.join(":"))}function ms(t){return t=It(t),t?t+":":""}function o7(t){return t}const q1="memory",H1=()=>{const t=new Map;return{name:q1,getInstance:()=>t,hasItem(e){return t.has(e)},getItem(e){return t.get(e)??null},getItemRaw(e){return t.get(e)??null},setItem(e,r){t.set(e,r)},setItemRaw(e,r){t.set(e,r)},removeItem(e){t.delete(e)},getKeys(){return[...t.keys()]},clear(){t.clear()},dispose(){t.clear()}}};function K1(t={}){const e={mounts:{"":t.driver||H1()},mountpoints:[""],watching:!1,watchListeners:[],unwatch:{}},r=u=>{for(const d of e.mountpoints)if(u.startsWith(d))return{base:d,relativeKey:u.slice(d.length),driver:e.mounts[d]};return{base:"",relativeKey:u,driver:e.mounts[""]}},n=(u,d)=>e.mountpoints.filter(p=>p.startsWith(u)||d&&u.startsWith(p)).map(p=>({relativeBase:u.length>p.length?u.slice(p.length):void 0,mountpoint:p,driver:e.mounts[p]})),i=(u,d)=>{if(e.watching){d=It(d);for(const p of e.watchListeners)p(u,d)}},s=async()=>{if(!e.watching){e.watching=!0;for(const u in e.mounts)e.unwatch[u]=await vf(e.mounts[u],i,u)}},o=async()=>{if(e.watching){for(const u in e.unwatch)await e.unwatch[u]();e.unwatch={},e.watching=!1}},a=(u,d,p)=>{const y=new Map,_=w=>{let D=y.get(w.base);return D||(D={driver:w.driver,base:w.base,items:[]},y.set(w.base,D)),D};for(const w of u){const D=typeof w=="string",O=It(D?w:w.key),M=D?void 0:w.value,T=D||!w.options?d:{...d,...w.options},B=r(O);_(B).items.push({key:O,value:M,relativeKey:B.relativeKey,options:T})}return Promise.all([...y.values()].map(w=>p(w))).then(w=>w.flat())},c={hasItem(u,d={}){u=It(u);const{relativeKey:p,driver:y}=r(u);return et(y.hasItem,p,d)},getItem(u,d={}){u=It(u);const{relativeKey:p,driver:y}=r(u);return et(y.getItem,p,d).then(_=>vs(_))},getItems(u,d={}){return a(u,d,p=>p.driver.getItems?et(p.driver.getItems,p.items.map(y=>({key:y.relativeKey,options:y.options})),d).then(y=>y.map(_=>({key:j1(p.base,_.key),value:vs(_.value)}))):Promise.all(p.items.map(y=>et(p.driver.getItem,y.relativeKey,y.options).then(_=>({key:y.key,value:vs(_)})))))},getItemRaw(u,d={}){u=It(u);const{relativeKey:p,driver:y}=r(u);return y.getItemRaw?et(y.getItemRaw,p,d):et(y.getItem,p,d).then(_=>z1(_))},async setItem(u,d,p={}){if(d===void 0)return c.removeItem(u);u=It(u);const{relativeKey:y,driver:_}=r(u);_.setItem&&(await et(_.setItem,y,ys(d),p),_.watch||i("update",u))},async setItems(u,d){await a(u,d,async p=>{if(p.driver.setItems)return et(p.driver.setItems,p.items.map(y=>({key:y.relativeKey,value:ys(y.value),options:y.options})),d);p.driver.setItem&&await Promise.all(p.items.map(y=>et(p.driver.setItem,y.relativeKey,ys(y.value),y.options)))})},async setItemRaw(u,d,p={}){if(d===void 0)return c.removeItem(u,p);u=It(u);const{relativeKey:y,driver:_}=r(u);if(_.setItemRaw)await et(_.setItemRaw,y,d,p);else if(_.setItem)await et(_.setItem,y,F1(d),p);else return;_.watch||i("update",u)},async removeItem(u,d={}){typeof d=="boolean"&&(d={removeMeta:d}),u=It(u);const{relativeKey:p,driver:y}=r(u);y.removeItem&&(await et(y.removeItem,p,d),(d.removeMeta||d.removeMata)&&await et(y.removeItem,p+"$",d),y.watch||i("remove",u))},async getMeta(u,d={}){typeof d=="boolean"&&(d={nativeOnly:d}),u=It(u);const{relativeKey:p,driver:y}=r(u),_=Object.create(null);if(y.getMeta&&Object.assign(_,await et(y.getMeta,p,d)),!d.nativeOnly){const w=await et(y.getItem,p+"$",d).then(D=>vs(D));w&&typeof w=="object"&&(typeof w.atime=="string"&&(w.atime=new Date(w.atime)),typeof w.mtime=="string"&&(w.mtime=new Date(w.mtime)),Object.assign(_,w))}return _},setMeta(u,d,p={}){return this.setItem(u+"$",d,p)},removeMeta(u,d={}){return this.removeItem(u+"$",d)},async getKeys(u,d={}){u=ms(u);const p=n(u,!0);let y=[];const _=[];for(const w of p){const D=await et(w.driver.getKeys,w.relativeBase,d);for(const O of D){const M=w.mountpoint+It(O);y.some(T=>M.startsWith(T))||_.push(M)}y=[w.mountpoint,...y.filter(O=>!O.startsWith(w.mountpoint))]}return u?_.filter(w=>w.startsWith(u)&&w[w.length-1]!=="$"):_.filter(w=>w[w.length-1]!=="$")},async clear(u,d={}){u=ms(u),await Promise.all(n(u,!1).map(async p=>{if(p.driver.clear)return et(p.driver.clear,p.relativeBase,d);if(p.driver.removeItem){const y=await p.driver.getKeys(p.relativeBase||"",d);return Promise.all(y.map(_=>p.driver.removeItem(_,d)))}}))},async dispose(){await Promise.all(Object.values(e.mounts).map(u=>yf(u)))},async watch(u){return await s(),e.watchListeners.push(u),async()=>{e.watchListeners=e.watchListeners.filter(d=>d!==u),e.watchListeners.length===0&&await o()}},async unwatch(){e.watchListeners=[],await o()},mount(u,d){if(u=ms(u),u&&e.mounts[u])throw new Error(`already mounted at ${u}`);return u&&(e.mountpoints.push(u),e.mountpoints.sort((p,y)=>y.length-p.length)),e.mounts[u]=d,e.watching&&Promise.resolve(vf(d,i,u)).then(p=>{e.unwatch[u]=p}).catch(console.error),c},async unmount(u,d=!0){u=ms(u),!(!u||!e.mounts[u])&&(e.watching&&u in e.unwatch&&(e.unwatch[u]?.(),delete e.unwatch[u]),d&&await yf(e.mounts[u]),e.mountpoints=e.mountpoints.filter(p=>p!==u),delete e.mounts[u])},getMount(u=""){u=It(u)+":";const d=r(u);return{driver:d.driver,base:d.base}},getMounts(u="",d={}){return u=It(u),n(u,d.parents).map(y=>({driver:y.driver,base:y.mountpoint}))},keys:(u,d={})=>c.getKeys(u,d),get:(u,d={})=>c.getItem(u,d),set:(u,d,p={})=>c.setItem(u,d,p),has:(u,d={})=>c.hasItem(u,d),del:(u,d={})=>c.removeItem(u,d),remove:(u,d={})=>c.removeItem(u,d)};return c}function vf(t,e,r){return t.watch?t.watch((n,i)=>e(n,r+i)):()=>{}}async function yf(t){typeof t.dispose=="function"&&await et(t.dispose)}function sn(t){return new Promise((e,r)=>{t.oncomplete=t.onsuccess=()=>e(t.result),t.onabort=t.onerror=()=>r(t.error)})}function mf(t,e){const r=indexedDB.open(t);r.onupgradeneeded=()=>r.result.createObjectStore(e);const n=sn(r);return(i,s)=>n.then(o=>s(o.transaction(e,i).objectStore(e)))}let jo;function mi(){return jo||(jo=mf("keyval-store","keyval")),jo}function wf(t,e=mi()){return e("readonly",r=>sn(r.get(t)))}function V1(t,e,r=mi()){return r("readwrite",n=>(n.put(e,t),sn(n.transaction)))}function W1(t,e=mi()){return e("readwrite",r=>(r.delete(t),sn(r.transaction)))}function G1(t=mi()){return t("readwrite",e=>(e.clear(),sn(e.transaction)))}function Y1(t,e){return t.openCursor().onsuccess=function(){this.result&&(e(this.result),this.result.continue())},sn(t.transaction)}function X1(t=mi()){return t("readonly",e=>{if(e.getAllKeys)return sn(e.getAllKeys());const r=[];return Y1(e,n=>r.push(n.key)).then(()=>r)})}const Z1=t=>JSON.stringify(t,(e,r)=>typeof r=="bigint"?r.toString()+"n":r),J1=t=>{const e=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,r=t.replace(e,'$1"$2n"$3');return JSON.parse(r,(n,i)=>typeof i=="string"&&i.match(/^\d+n$/)?BigInt(i.substring(0,i.length-1)):i)};function Bn(t){if(typeof t!="string")throw new Error(`Cannot safe json parse value of type ${typeof t}`);try{return J1(t)}catch{return t}}function on(t){return typeof t=="string"?t:Z1(t)||""}const Q1="idb-keyval";var ep=(t={})=>{const e=t.base&&t.base.length>0?`${t.base}:`:"",r=i=>e+i;let n;return t.dbName&&t.storeName&&(n=mf(t.dbName,t.storeName)),{name:Q1,options:t,async hasItem(i){return!(typeof await wf(r(i),n)>"u")},async getItem(i){return await wf(r(i),n)??null},setItem(i,s){return V1(r(i),s,n)},removeItem(i){return W1(r(i),n)},getKeys(){return X1(n)},clear(){return G1(n)}}};const tp="WALLET_CONNECT_V2_INDEXED_DB",rp="keyvaluestorage";class np{constructor(){this.indexedDb=K1({driver:ep({dbName:tp,storeName:rp})})}async getKeys(){return this.indexedDb.getKeys()}async getEntries(){return(await this.indexedDb.getItems(await this.indexedDb.getKeys())).map(e=>[e.key,e.value])}async getItem(e){const r=await this.indexedDb.getItem(e);if(r!==null)return r}async setItem(e,r){await this.indexedDb.setItem(e,on(r))}async removeItem(e){await this.indexedDb.removeItem(e)}}var qo=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},ws={exports:{}};(function(){let t;function e(){}t=e,t.prototype.getItem=function(r){return this.hasOwnProperty(r)?String(this[r]):null},t.prototype.setItem=function(r,n){this[r]=String(n)},t.prototype.removeItem=function(r){delete this[r]},t.prototype.clear=function(){const r=this;Object.keys(r).forEach(function(n){r[n]=void 0,delete r[n]})},t.prototype.key=function(r){return r=r||0,Object.keys(this)[r]},t.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof qo<"u"&&qo.localStorage?ws.exports=qo.localStorage:typeof window<"u"&&window.localStorage?ws.exports=window.localStorage:ws.exports=new e})();function ip(t){var e;return[t[0],Bn((e=t[1])!=null?e:"")]}class sp{constructor(){this.localStorage=ws.exports}async getKeys(){return Object.keys(this.localStorage)}async getEntries(){return Object.entries(this.localStorage).map(ip)}async getItem(e){const r=this.localStorage.getItem(e);if(r!==null)return Bn(r)}async setItem(e,r){this.localStorage.setItem(e,on(r))}async removeItem(e){this.localStorage.removeItem(e)}}const op="wc_storage_version",_f=1,ap=async(t,e,r)=>{const n=op,i=await e.getItem(n);if(i&&i>=_f){r(e);return}const s=await t.getKeys();if(!s.length){r(e);return}const o=[];for(;s.length;){const a=s.shift();if(!a)continue;const c=a.toLowerCase();if(c.includes("wc@")||c.includes("walletconnect")||c.includes("wc_")||c.includes("wallet_connect")){const u=await t.getItem(a);await e.setItem(a,u),o.push(a)}}await e.setItem(n,_f),r(e),cp(t,o)},cp=async(t,e)=>{e.length&&e.forEach(async r=>{await t.removeItem(r)})};class fp{constructor(){this.initialized=!1,this.setInitialized=r=>{this.storage=r,this.initialized=!0};const e=new sp;this.storage=e;try{const r=new np;ap(e,r,this.setInitialized)}catch{this.initialized=!0}}async getKeys(){return await this.initialize(),this.storage.getKeys()}async getEntries(){return await this.initialize(),this.storage.getEntries()}async getItem(e){return await this.initialize(),this.storage.getItem(e)}async setItem(e,r){return await this.initialize(),this.storage.setItem(e,r)}async removeItem(e){return await this.initialize(),this.storage.removeItem(e)}async initialize(){this.initialized||await new Promise(e=>{const r=setInterval(()=>{this.initialized&&(clearInterval(r),e())},20)})}}function up(t){try{return JSON.stringify(t)}catch{return'"[Circular]"'}}var hp=dp;function dp(t,e,r){var n=r&&r.stringify||up,i=1;if(typeof t=="object"&&t!==null){var s=e.length+i;if(s===1)return t;var o=new Array(s);o[0]=n(t);for(var a=1;a<s;a++)o[a]=n(e[a]);return o.join(" ")}if(typeof t!="string")return t;var c=e.length;if(c===0)return t;for(var u="",d=1-i,p=-1,y=t&&t.length||0,_=0;_<y;){if(t.charCodeAt(_)===37&&_+1<y){switch(p=p>-1?p:0,t.charCodeAt(_+1)){case 100:case 102:if(d>=c||e[d]==null)break;p<_&&(u+=t.slice(p,_)),u+=Number(e[d]),p=_+2,_++;break;case 105:if(d>=c||e[d]==null)break;p<_&&(u+=t.slice(p,_)),u+=Math.floor(Number(e[d])),p=_+2,_++;break;case 79:case 111:case 106:if(d>=c||e[d]===void 0)break;p<_&&(u+=t.slice(p,_));var w=typeof e[d];if(w==="string"){u+="'"+e[d]+"'",p=_+2,_++;break}if(w==="function"){u+=e[d].name||"<anonymous>",p=_+2,_++;break}u+=n(e[d]),p=_+2,_++;break;case 115:if(d>=c)break;p<_&&(u+=t.slice(p,_)),u+=String(e[d]),p=_+2,_++;break;case 37:p<_&&(u+=t.slice(p,_)),u+="%",p=_+2,_++,d--;break}++d}++_}return p===-1?t:(p<y&&(u+=t.slice(p)),u)}const Ef=hp;var Fr=ar;const wi=Ep().console||{},lp={mapHttpRequest:Es,mapHttpResponse:Es,wrapRequestSerializer:Ko,wrapResponseSerializer:Ko,wrapErrorSerializer:Ko,req:Es,res:Es,err:yp};function pp(t,e){return Array.isArray(t)?t.filter(function(n){return n!=="!stdSerializers.err"}):t===!0?Object.keys(e):!1}function ar(t){t=t||{},t.browser=t.browser||{};const e=t.browser.transmit;if(e&&typeof e.send!="function")throw Error("pino: transmit option must have a send function");const r=t.browser.write||wi;t.browser.write&&(t.browser.asObject=!0);const n=t.serializers||{},i=pp(t.browser.serialize,n);let s=t.browser.serialize;Array.isArray(t.browser.serialize)&&t.browser.serialize.indexOf("!stdSerializers.err")>-1&&(s=!1);const o=["error","fatal","warn","info","debug","trace"];typeof r=="function"&&(r.error=r.fatal=r.warn=r.info=r.debug=r.trace=r),t.enabled===!1&&(t.level="silent");const a=t.level||"info",c=Object.create(r);c.log||(c.log=_i),Object.defineProperty(c,"levelVal",{get:d}),Object.defineProperty(c,"level",{get:p,set:y});const u={transmit:e,serialize:i,asObject:t.browser.asObject,levels:o,timestamp:mp(t)};c.levels=ar.levels,c.level=a,c.setMaxListeners=c.getMaxListeners=c.emit=c.addListener=c.on=c.prependListener=c.once=c.prependOnceListener=c.removeListener=c.removeAllListeners=c.listeners=c.listenerCount=c.eventNames=c.write=c.flush=_i,c.serializers=n,c._serialize=i,c._stdErrSerialize=s,c.child=_,e&&(c._logEvent=Ho());function d(){return this.level==="silent"?1/0:this.levels.values[this.level]}function p(){return this._level}function y(w){if(w!=="silent"&&!this.levels.values[w])throw Error("unknown level "+w);this._level=w,Pn(u,c,"error","log"),Pn(u,c,"fatal","error"),Pn(u,c,"warn","error"),Pn(u,c,"info","log"),Pn(u,c,"debug","log"),Pn(u,c,"trace","log")}function _(w,D){if(!w)throw new Error("missing bindings for child Pino");D=D||{},i&&w.serializers&&(D.serializers=w.serializers);const O=D.serializers;if(i&&O){var M=Object.assign({},n,O),T=t.browser.serialize===!0?Object.keys(M):i;delete w.serializers,_s([w],T,M,this._stdErrSerialize)}function B(P){this._childLevel=(P._childLevel|0)+1,this.error=Nn(P,w,"error"),this.fatal=Nn(P,w,"fatal"),this.warn=Nn(P,w,"warn"),this.info=Nn(P,w,"info"),this.debug=Nn(P,w,"debug"),this.trace=Nn(P,w,"trace"),M&&(this.serializers=M,this._serialize=T),e&&(this._logEvent=Ho([].concat(P._logEvent.bindings,w)))}return B.prototype=this,new B(this)}return c}ar.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},ar.stdSerializers=lp,ar.stdTimeFunctions=Object.assign({},{nullTime:xf,epochTime:Sf,unixTime:wp,isoTime:_p});function Pn(t,e,r,n){const i=Object.getPrototypeOf(e);e[r]=e.levelVal>e.levels.values[r]?_i:i[r]?i[r]:wi[r]||wi[n]||_i,bp(t,e,r)}function bp(t,e,r){!t.transmit&&e[r]===_i||(e[r]=function(n){return function(){const s=t.timestamp(),o=new Array(arguments.length),a=Object.getPrototypeOf&&Object.getPrototypeOf(this)===wi?wi:this;for(var c=0;c<o.length;c++)o[c]=arguments[c];if(t.serialize&&!t.asObject&&_s(o,this._serialize,this.serializers,this._stdErrSerialize),t.asObject?n.call(a,gp(this,r,o,s)):n.apply(a,o),t.transmit){const u=t.transmit.level||e.level,d=ar.levels.values[u],p=ar.levels.values[r];if(p<d)return;vp(this,{ts:s,methodLevel:r,methodValue:p,transmitLevel:u,transmitValue:ar.levels.values[t.transmit.level||e.level],send:t.transmit.send,val:e.levelVal},o)}}}(e[r]))}function gp(t,e,r,n){t._serialize&&_s(r,t._serialize,t.serializers,t._stdErrSerialize);const i=r.slice();let s=i[0];const o={};n&&(o.time=n),o.level=ar.levels.values[e];let a=(t._childLevel|0)+1;if(a<1&&(a=1),s!==null&&typeof s=="object"){for(;a--&&typeof i[0]=="object";)Object.assign(o,i.shift());s=i.length?Ef(i.shift(),i):void 0}else typeof s=="string"&&(s=Ef(i.shift(),i));return s!==void 0&&(o.msg=s),o}function _s(t,e,r,n){for(const i in t)if(n&&t[i]instanceof Error)t[i]=ar.stdSerializers.err(t[i]);else if(typeof t[i]=="object"&&!Array.isArray(t[i]))for(const s in t[i])e&&e.indexOf(s)>-1&&s in r&&(t[i][s]=r[s](t[i][s]))}function Nn(t,e,r){return function(){const n=new Array(1+arguments.length);n[0]=e;for(var i=1;i<n.length;i++)n[i]=arguments[i-1];return t[r].apply(this,n)}}function vp(t,e,r){const n=e.send,i=e.ts,s=e.methodLevel,o=e.methodValue,a=e.val,c=t._logEvent.bindings;_s(r,t._serialize||Object.keys(t.serializers),t.serializers,t._stdErrSerialize===void 0?!0:t._stdErrSerialize),t._logEvent.ts=i,t._logEvent.messages=r.filter(function(u){return c.indexOf(u)===-1}),t._logEvent.level.label=s,t._logEvent.level.value=o,n(s,t._logEvent,a),t._logEvent=Ho(c)}function Ho(t){return{ts:0,messages:[],bindings:t||[],level:{label:"",value:0}}}function yp(t){const e={type:t.constructor.name,msg:t.message,stack:t.stack};for(const r in t)e[r]===void 0&&(e[r]=t[r]);return e}function mp(t){return typeof t.timestamp=="function"?t.timestamp:t.timestamp===!1?xf:Sf}function Es(){return{}}function Ko(t){return t}function _i(){}function xf(){return!1}function Sf(){return Date.now()}function wp(){return Math.round(Date.now()/1e3)}function _p(){return new Date(Date.now()).toISOString()}function Ep(){function t(e){return typeof e<"u"&&e}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return t(self)||t(window)||t(this)||{}}}const xp={level:"info"},Ei="custom_context",Vo=1e3*1024;class Sp{constructor(e){this.nodeValue=e,this.sizeInBytes=new TextEncoder().encode(this.nodeValue).length,this.next=null}get value(){return this.nodeValue}get size(){return this.sizeInBytes}}class If{constructor(e){this.head=null,this.tail=null,this.lengthInNodes=0,this.maxSizeInBytes=e,this.sizeInBytes=0}append(e){const r=new Sp(e);if(r.size>this.maxSizeInBytes)throw new Error(`[LinkedList] Value too big to insert into list: ${e} with size ${r.size}`);for(;this.size+r.size>this.maxSizeInBytes;)this.shift();this.head?(this.tail&&(this.tail.next=r),this.tail=r):(this.head=r,this.tail=r),this.lengthInNodes++,this.sizeInBytes+=r.size}shift(){if(!this.head)return;const e=this.head;this.head=this.head.next,this.head||(this.tail=null),this.lengthInNodes--,this.sizeInBytes-=e.size}toArray(){const e=[];let r=this.head;for(;r!==null;)e.push(r.value),r=r.next;return e}get length(){return this.lengthInNodes}get size(){return this.sizeInBytes}toOrderedArray(){return Array.from(this)}[Symbol.iterator](){let e=this.head;return{next:()=>{if(!e)return{done:!0,value:null};const r=e.value;return e=e.next,{done:!1,value:r}}}}}class Af{constructor(e,r=Vo){this.level=e??"error",this.levelValue=Fr.levels.values[this.level],this.MAX_LOG_SIZE_IN_BYTES=r,this.logs=new If(this.MAX_LOG_SIZE_IN_BYTES)}forwardToConsole(e,r){r===Fr.levels.values.error?console.error(e):r===Fr.levels.values.warn?console.warn(e):r===Fr.levels.values.debug?console.debug(e):r===Fr.levels.values.trace?console.trace(e):console.log(e)}appendToLogs(e){this.logs.append(on({timestamp:new Date().toISOString(),log:e}));const r=typeof e=="string"?JSON.parse(e).level:e.level;r>=this.levelValue&&this.forwardToConsole(e,r)}getLogs(){return this.logs}clearLogs(){this.logs=new If(this.MAX_LOG_SIZE_IN_BYTES)}getLogArray(){return Array.from(this.logs)}logsToBlob(e){const r=this.getLogArray();return r.push(on({extraMetadata:e})),new Blob(r,{type:"application/json"})}}class Ip{constructor(e,r=Vo){this.baseChunkLogger=new Af(e,r)}write(e){this.baseChunkLogger.appendToLogs(e)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(e){return this.baseChunkLogger.logsToBlob(e)}downloadLogsBlobInBrowser(e){const r=URL.createObjectURL(this.logsToBlob(e)),n=document.createElement("a");n.href=r,n.download=`walletconnect-logs-${new Date().toISOString()}.txt`,document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(r)}}class Ap{constructor(e,r=Vo){this.baseChunkLogger=new Af(e,r)}write(e){this.baseChunkLogger.appendToLogs(e)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(e){return this.baseChunkLogger.logsToBlob(e)}}var Dp=Object.defineProperty,Op=Object.defineProperties,Mp=Object.getOwnPropertyDescriptors,Df=Object.getOwnPropertySymbols,Tp=Object.prototype.hasOwnProperty,Rp=Object.prototype.propertyIsEnumerable,Of=(t,e,r)=>e in t?Dp(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,xs=(t,e)=>{for(var r in e||(e={}))Tp.call(e,r)&&Of(t,r,e[r]);if(Df)for(var r of Df(e))Rp.call(e,r)&&Of(t,r,e[r]);return t},Ss=(t,e)=>Op(t,Mp(e));function Mf(t){return Ss(xs({},t),{level:t?.level||xp.level})}function Bp(t,e=Ei){return t[e]||""}function Pp(t,e,r=Ei){return t[r]=e,t}function Pt(t,e=Ei){let r="";return typeof t.bindings>"u"?r=Bp(t,e):r=t.bindings().context||"",r}function Np(t,e,r=Ei){const n=Pt(t,r);return n.trim()?`${n}/${e}`:e}function At(t,e,r=Ei){const n=Np(t,e,r),i=t.child({context:n});return Pp(i,n,r)}function Cp(t){var e,r;const n=new Ip((e=t.opts)==null?void 0:e.level,t.maxSizeInBytes);return{logger:Fr(Ss(xs({},t.opts),{level:"trace",browser:Ss(xs({},(r=t.opts)==null?void 0:r.browser),{write:i=>n.write(i)})})),chunkLoggerController:n}}function Lp(t){var e;const r=new Ap((e=t.opts)==null?void 0:e.level,t.maxSizeInBytes);return{logger:Fr(Ss(xs({},t.opts),{level:"trace"})),chunkLoggerController:r}}function $p(t){return typeof t.loggerOverride<"u"&&typeof t.loggerOverride!="string"?{logger:t.loggerOverride,chunkLoggerController:null}:typeof window<"u"?Cp(t):Lp(t)}var Fp=Object.defineProperty,zp=(t,e,r)=>e in t?Fp(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Tf=(t,e,r)=>zp(t,typeof e!="symbol"?e+"":e,r);class Up extends nn{constructor(e){super(),this.opts=e,Tf(this,"protocol","wc"),Tf(this,"version",2)}}var kp=Object.defineProperty,jp=(t,e,r)=>e in t?kp(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,qp=(t,e,r)=>jp(t,typeof e!="symbol"?e+"":e,r);class Hp extends nn{constructor(e,r){super(),this.core=e,this.logger=r,qp(this,"records",new Map)}}class Kp{constructor(e,r){this.logger=e,this.core=r}}class Vp extends nn{constructor(e,r){super(),this.relayer=e,this.logger=r}}class Wp extends nn{constructor(e){super()}}class Gp{constructor(e,r,n,i){this.core=e,this.logger=r,this.name=n}}class Yp extends nn{constructor(e,r){super(),this.relayer=e,this.logger=r}}class Xp extends nn{constructor(e,r){super(),this.core=e,this.logger=r}}class Zp{constructor(e,r,n){this.core=e,this.logger=r,this.store=n}}class Jp{constructor(e,r){this.projectId=e,this.logger=r}}class Qp{constructor(e,r,n){this.core=e,this.logger=r,this.telemetryEnabled=n}}const Wo="wc",Go=2,xi="core",Xt=`${Wo}@2:${xi}:`,Rf={name:xi,logger:"error"},Bf={database:":memory:"},Pf="crypto",Yo="client_ed25519_seed",Nf=G.ONE_DAY,Cf="keychain",Lf="0.3",$f="messages",Ff="0.3",Xo=G.SIX_HOURS,zf="publisher",Uf="irn",kf="error",Zo="wss://relay.walletconnect.org",jf="relayer",ft={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},qf="_subscription",Nt={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},Hf=.1,eb={database:":memory:"},Is="2.19.0",tb=1e4,an={link_mode:"link_mode",relay:"relay"},Kf="0.3",Vf="WALLETCONNECT_CLIENT_ID",Jo="WALLETCONNECT_LINK_MODE_APPS",Dt={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},rb=G.THIRTY_DAYS,Wf="subscription",Gf="0.3",Yf=G.FIVE_SECONDS*1e3,Xf="pairing",Zf="0.3",nb=G.THIRTY_DAYS,Cn={wc_pairingDelete:{req:{ttl:G.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:G.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:G.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:G.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:G.ONE_DAY,prompt:!1,tag:0},res:{ttl:G.ONE_DAY,prompt:!1,tag:0}}},Ln={create:"pairing_create",expire:"pairing_expire",delete:"pairing_delete",ping:"pairing_ping"},kt={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},Jf="history",Qf="0.3",eu="expirer",jt={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},tu="0.3",ib=G.ONE_DAY,ru="verify-api",sb="https://verify.walletconnect.com",nu="https://verify.walletconnect.org",Si=nu,iu=`${Si}/v3`,su=[sb,nu],ou="echo",au="https://echo.walletconnect.com",ob="event-client",cr={pairing_started:"pairing_started",pairing_uri_validation_success:"pairing_uri_validation_success",pairing_uri_not_expired:"pairing_uri_not_expired",store_new_pairing:"store_new_pairing",subscribing_pairing_topic:"subscribing_pairing_topic",subscribe_pairing_topic_success:"subscribe_pairing_topic_success",existing_pairing:"existing_pairing",pairing_not_expired:"pairing_not_expired",emit_inactive_pairing:"emit_inactive_pairing",emit_session_proposal:"emit_session_proposal",subscribing_to_pairing_topic:"subscribing_to_pairing_topic"},Sr={no_wss_connection:"no_wss_connection",no_internet_connection:"no_internet_connection",malformed_pairing_uri:"malformed_pairing_uri",active_pairing_already_exists:"active_pairing_already_exists",subscribe_pairing_topic_failure:"subscribe_pairing_topic_failure",pairing_expired:"pairing_expired",proposal_expired:"proposal_expired",proposal_listener_not_found:"proposal_listener_not_found"},ab={session_approve_started:"session_approve_started",proposal_not_expired:"proposal_not_expired",session_namespaces_validation_success:"session_namespaces_validation_success",create_session_topic:"create_session_topic",subscribing_session_topic:"subscribing_session_topic",subscribe_session_topic_success:"subscribe_session_topic_success",publishing_session_approve:"publishing_session_approve",session_approve_publish_success:"session_approve_publish_success",store_session:"store_session",publishing_session_settle:"publishing_session_settle",session_settle_publish_success:"session_settle_publish_success"},cb={no_internet_connection:"no_internet_connection",no_wss_connection:"no_wss_connection",proposal_expired:"proposal_expired",subscribe_session_topic_failure:"subscribe_session_topic_failure",session_approve_publish_failure:"session_approve_publish_failure",session_settle_publish_failure:"session_settle_publish_failure",session_approve_namespace_validation_failure:"session_approve_namespace_validation_failure",proposal_not_found:"proposal_not_found"},fb={authenticated_session_approve_started:"authenticated_session_approve_started",authenticated_session_not_expired:"authenticated_session_not_expired",chains_caip2_compliant:"chains_caip2_compliant",chains_evm_compliant:"chains_evm_compliant",create_authenticated_session_topic:"create_authenticated_session_topic",cacaos_verified:"cacaos_verified",store_authenticated_session:"store_authenticated_session",subscribing_authenticated_session_topic:"subscribing_authenticated_session_topic",subscribe_authenticated_session_topic_success:"subscribe_authenticated_session_topic_success",publishing_authenticated_session_approve:"publishing_authenticated_session_approve",authenticated_session_approve_publish_success:"authenticated_session_approve_publish_success"},ub={no_internet_connection:"no_internet_connection",no_wss_connection:"no_wss_connection",missing_session_authenticate_request:"missing_session_authenticate_request",session_authenticate_request_expired:"session_authenticate_request_expired",chains_caip2_compliant_failure:"chains_caip2_compliant_failure",chains_evm_compliant_failure:"chains_evm_compliant_failure",invalid_cacao:"invalid_cacao",subscribe_authenticated_session_topic_failure:"subscribe_authenticated_session_topic_failure",authenticated_session_approve_publish_failure:"authenticated_session_approve_publish_failure",authenticated_session_pending_request_not_found:"authenticated_session_pending_request_not_found"},cu=.1,fu="event-client",uu=86400,hu="https://pulse.walletconnect.org/batch";function hb(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function du(t,...e){if(!hb(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function lu(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function db(t,e){du(t);const r=e.outputLen;if(t.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}const $n=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Qo=t=>new DataView(t.buffer,t.byteOffset,t.byteLength);function lb(t){if(typeof t!="string")throw new Error("utf8ToBytes expected string, got "+typeof t);return new Uint8Array(new TextEncoder().encode(t))}function pu(t){return typeof t=="string"&&(t=lb(t)),du(t),t}class pb{clone(){return this._cloneInto()}}function bb(t){const e=n=>t().update(pu(n)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e}function bu(t=32){if($n&&typeof $n.getRandomValues=="function")return $n.getRandomValues(new Uint8Array(t));if($n&&typeof $n.randomBytes=="function")return $n.randomBytes(t);throw new Error("crypto.getRandomValues must be defined")}function gb(t,e,r,n){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,r,n);const i=BigInt(32),s=BigInt(4294967295),o=Number(r>>i&s),a=Number(r&s),c=n?4:0,u=n?0:4;t.setUint32(e+c,o,n),t.setUint32(e+u,a,n)}class vb extends pb{constructor(e,r,n,i){super(),this.blockLen=e,this.outputLen=r,this.padOffset=n,this.isLE=i,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=Qo(this.buffer)}update(e){lu(this);const{view:r,buffer:n,blockLen:i}=this;e=pu(e);const s=e.length;for(let o=0;o<s;){const a=Math.min(i-this.pos,s-o);if(a===i){const c=Qo(e);for(;i<=s-o;o+=i)this.process(c,o);continue}n.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===i&&(this.process(r,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){lu(this),db(e,this),this.finished=!0;const{buffer:r,view:n,blockLen:i,isLE:s}=this;let{pos:o}=this;r[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>i-o&&(this.process(n,0),o=0);for(let p=o;p<i;p++)r[p]=0;gb(n,i-8,BigInt(this.length*8),s),this.process(n,0);const a=Qo(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const u=c/4,d=this.get();if(u>d.length)throw new Error("_sha2: outputLen bigger than state");for(let p=0;p<u;p++)a.setUint32(4*p,d[p],s)}digest(){const{buffer:e,outputLen:r}=this;this.digestInto(e);const n=e.slice(0,r);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:r,buffer:n,length:i,finished:s,destroyed:o,pos:a}=this;return e.length=i,e.pos=a,e.finished=s,e.destroyed=o,i%r&&e.buffer.set(n),e}}const As=BigInt(2**32-1),ea=BigInt(32);function gu(t,e=!1){return e?{h:Number(t&As),l:Number(t>>ea&As)}:{h:Number(t>>ea&As)|0,l:Number(t&As)|0}}function yb(t,e=!1){let r=new Uint32Array(t.length),n=new Uint32Array(t.length);for(let i=0;i<t.length;i++){const{h:s,l:o}=gu(t[i],e);[r[i],n[i]]=[s,o]}return[r,n]}const mb=(t,e)=>BigInt(t>>>0)<<ea|BigInt(e>>>0),wb=(t,e,r)=>t>>>r,_b=(t,e,r)=>t<<32-r|e>>>r,Eb=(t,e,r)=>t>>>r|e<<32-r,xb=(t,e,r)=>t<<32-r|e>>>r,Sb=(t,e,r)=>t<<64-r|e>>>r-32,Ib=(t,e,r)=>t>>>r-32|e<<64-r,Ab=(t,e)=>e,Db=(t,e)=>t,Ob=(t,e,r)=>t<<r|e>>>32-r,Mb=(t,e,r)=>e<<r|t>>>32-r,Tb=(t,e,r)=>e<<r-32|t>>>64-r,Rb=(t,e,r)=>t<<r-32|e>>>64-r;function Bb(t,e,r,n){const i=(e>>>0)+(n>>>0);return{h:t+r+(i/2**32|0)|0,l:i|0}}const Pb=(t,e,r)=>(t>>>0)+(e>>>0)+(r>>>0),Nb=(t,e,r,n)=>e+r+n+(t/2**32|0)|0,Cb=(t,e,r,n)=>(t>>>0)+(e>>>0)+(r>>>0)+(n>>>0),Lb=(t,e,r,n,i)=>e+r+n+i+(t/2**32|0)|0,$b=(t,e,r,n,i)=>(t>>>0)+(e>>>0)+(r>>>0)+(n>>>0)+(i>>>0),Fb=(t,e,r,n,i,s)=>e+r+n+i+s+(t/2**32|0)|0,Q={fromBig:gu,split:yb,toBig:mb,shrSH:wb,shrSL:_b,rotrSH:Eb,rotrSL:xb,rotrBH:Sb,rotrBL:Ib,rotr32H:Ab,rotr32L:Db,rotlSH:Ob,rotlSL:Mb,rotlBH:Tb,rotlBL:Rb,add:Bb,add3L:Pb,add3H:Nb,add4L:Cb,add4H:Lb,add5H:Fb,add5L:$b},[zb,Ub]=Q.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(t=>BigInt(t))),zr=new Uint32Array(80),Ur=new Uint32Array(80);class kb extends vb{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:e,Al:r,Bh:n,Bl:i,Ch:s,Cl:o,Dh:a,Dl:c,Eh:u,El:d,Fh:p,Fl:y,Gh:_,Gl:w,Hh:D,Hl:O}=this;return[e,r,n,i,s,o,a,c,u,d,p,y,_,w,D,O]}set(e,r,n,i,s,o,a,c,u,d,p,y,_,w,D,O){this.Ah=e|0,this.Al=r|0,this.Bh=n|0,this.Bl=i|0,this.Ch=s|0,this.Cl=o|0,this.Dh=a|0,this.Dl=c|0,this.Eh=u|0,this.El=d|0,this.Fh=p|0,this.Fl=y|0,this.Gh=_|0,this.Gl=w|0,this.Hh=D|0,this.Hl=O|0}process(e,r){for(let B=0;B<16;B++,r+=4)zr[B]=e.getUint32(r),Ur[B]=e.getUint32(r+=4);for(let B=16;B<80;B++){const P=zr[B-15]|0,j=Ur[B-15]|0,$=Q.rotrSH(P,j,1)^Q.rotrSH(P,j,8)^Q.shrSH(P,j,7),L=Q.rotrSL(P,j,1)^Q.rotrSL(P,j,8)^Q.shrSL(P,j,7),z=zr[B-2]|0,N=Ur[B-2]|0,K=Q.rotrSH(z,N,19)^Q.rotrBH(z,N,61)^Q.shrSH(z,N,6),S=Q.rotrSL(z,N,19)^Q.rotrBL(z,N,61)^Q.shrSL(z,N,6),f=Q.add4L(L,S,Ur[B-7],Ur[B-16]),l=Q.add4H(f,$,K,zr[B-7],zr[B-16]);zr[B]=l|0,Ur[B]=f|0}let{Ah:n,Al:i,Bh:s,Bl:o,Ch:a,Cl:c,Dh:u,Dl:d,Eh:p,El:y,Fh:_,Fl:w,Gh:D,Gl:O,Hh:M,Hl:T}=this;for(let B=0;B<80;B++){const P=Q.rotrSH(p,y,14)^Q.rotrSH(p,y,18)^Q.rotrBH(p,y,41),j=Q.rotrSL(p,y,14)^Q.rotrSL(p,y,18)^Q.rotrBL(p,y,41),$=p&_^~p&D,L=y&w^~y&O,z=Q.add5L(T,j,L,Ub[B],Ur[B]),N=Q.add5H(z,M,P,$,zb[B],zr[B]),K=z|0,S=Q.rotrSH(n,i,28)^Q.rotrBH(n,i,34)^Q.rotrBH(n,i,39),f=Q.rotrSL(n,i,28)^Q.rotrBL(n,i,34)^Q.rotrBL(n,i,39),l=n&s^n&a^s&a,g=i&o^i&c^o&c;M=D|0,T=O|0,D=_|0,O=w|0,_=p|0,w=y|0,{h:p,l:y}=Q.add(u|0,d|0,N|0,K|0),u=a|0,d=c|0,a=s|0,c=o|0,s=n|0,o=i|0;const b=Q.add3L(K,f,g);n=Q.add3H(b,N,S,l),i=b|0}({h:n,l:i}=Q.add(this.Ah|0,this.Al|0,n|0,i|0)),{h:s,l:o}=Q.add(this.Bh|0,this.Bl|0,s|0,o|0),{h:a,l:c}=Q.add(this.Ch|0,this.Cl|0,a|0,c|0),{h:u,l:d}=Q.add(this.Dh|0,this.Dl|0,u|0,d|0),{h:p,l:y}=Q.add(this.Eh|0,this.El|0,p|0,y|0),{h:_,l:w}=Q.add(this.Fh|0,this.Fl|0,_|0,w|0),{h:D,l:O}=Q.add(this.Gh|0,this.Gl|0,D|0,O|0),{h:M,l:T}=Q.add(this.Hh|0,this.Hl|0,M|0,T|0),this.set(n,i,s,o,a,c,u,d,p,y,_,w,D,O,M,T)}roundClean(){zr.fill(0),Ur.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const jb=bb(()=>new kb);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const ta=BigInt(0),vu=BigInt(1),qb=BigInt(2);function ra(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function na(t){if(!ra(t))throw new Error("Uint8Array expected")}function ia(t,e){if(typeof e!="boolean")throw new Error(t+" boolean expected, got "+e)}const Hb=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function sa(t){na(t);let e="";for(let r=0;r<t.length;r++)e+=Hb[t[r]];return e}function yu(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return t===""?ta:BigInt("0x"+t)}const Ir={_0:48,_9:57,A:65,F:70,a:97,f:102};function mu(t){if(t>=Ir._0&&t<=Ir._9)return t-Ir._0;if(t>=Ir.A&&t<=Ir.F)return t-(Ir.A-10);if(t>=Ir.a&&t<=Ir.f)return t-(Ir.a-10)}function wu(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);const e=t.length,r=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);const n=new Uint8Array(r);for(let i=0,s=0;i<r;i++,s+=2){const o=mu(t.charCodeAt(s)),a=mu(t.charCodeAt(s+1));if(o===void 0||a===void 0){const c=t[s]+t[s+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+s)}n[i]=o*16+a}return n}function Kb(t){return yu(sa(t))}function Ds(t){return na(t),yu(sa(Uint8Array.from(t).reverse()))}function _u(t,e){return wu(t.toString(16).padStart(e*2,"0"))}function oa(t,e){return _u(t,e).reverse()}function Ar(t,e,r){let n;if(typeof e=="string")try{n=wu(e)}catch(s){throw new Error(t+" must be hex string or Uint8Array, cause: "+s)}else if(ra(e))n=Uint8Array.from(e);else throw new Error(t+" must be hex string or Uint8Array");const i=n.length;if(typeof r=="number"&&i!==r)throw new Error(t+" of length "+r+" expected, got "+i);return n}function Eu(...t){let e=0;for(let n=0;n<t.length;n++){const i=t[n];na(i),e+=i.length}const r=new Uint8Array(e);for(let n=0,i=0;n<t.length;n++){const s=t[n];r.set(s,i),i+=s.length}return r}const aa=t=>typeof t=="bigint"&&ta<=t;function Vb(t,e,r){return aa(t)&&aa(e)&&aa(r)&&e<=t&&t<r}function Ii(t,e,r,n){if(!Vb(e,r,n))throw new Error("expected valid "+t+": "+r+" <= n < "+n+", got "+e)}function Wb(t){let e;for(e=0;t>ta;t>>=vu,e+=1);return e}const Gb=t=>(qb<<BigInt(t-1))-vu,Yb={bigint:t=>typeof t=="bigint",function:t=>typeof t=="function",boolean:t=>typeof t=="boolean",string:t=>typeof t=="string",stringOrUint8Array:t=>typeof t=="string"||ra(t),isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>typeof t=="function"&&Number.isSafeInteger(t.outputLen)};function ca(t,e,r={}){const n=(i,s,o)=>{const a=Yb[s];if(typeof a!="function")throw new Error("invalid validator function");const c=t[i];if(!(o&&c===void 0)&&!a(c,t))throw new Error("param "+String(i)+" is invalid. Expected "+s+", got "+c)};for(const[i,s]of Object.entries(e))n(i,s,!1);for(const[i,s]of Object.entries(r))n(i,s,!0);return t}function xu(t){const e=new WeakMap;return(r,...n)=>{const i=e.get(r);if(i!==void 0)return i;const s=t(r,...n);return e.set(r,s),s}}const tt=BigInt(0),Ye=BigInt(1),cn=BigInt(2),Xb=BigInt(3),fa=BigInt(4),Su=BigInt(5),Iu=BigInt(8);function Je(t,e){const r=t%e;return r>=tt?r:e+r}function Zb(t,e,r){if(e<tt)throw new Error("invalid exponent, negatives unsupported");if(r<=tt)throw new Error("invalid modulus");if(r===Ye)return tt;let n=Ye;for(;e>tt;)e&Ye&&(n=n*t%r),t=t*t%r,e>>=Ye;return n}function fr(t,e,r){let n=t;for(;e-- >tt;)n*=n,n%=r;return n}function Au(t,e){if(t===tt)throw new Error("invert: expected non-zero number");if(e<=tt)throw new Error("invert: expected positive modulus, got "+e);let r=Je(t,e),n=e,i=tt,s=Ye;for(;r!==tt;){const o=n/r,a=n%r,c=i-s*o;n=r,r=a,i=s,s=c}if(n!==Ye)throw new Error("invert: does not exist");return Je(i,e)}function Jb(t){const e=(t-Ye)/cn;let r,n,i;for(r=t-Ye,n=0;r%cn===tt;r/=cn,n++);for(i=cn;i<t&&Zb(i,e,t)!==t-Ye;i++)if(i>1e3)throw new Error("Cannot find square root: likely non-prime P");if(n===1){const o=(t+Ye)/fa;return function(a,c){const u=a.pow(c,o);if(!a.eql(a.sqr(u),c))throw new Error("Cannot find square root");return u}}const s=(r+Ye)/cn;return function(o,a){if(o.pow(a,e)===o.neg(o.ONE))throw new Error("Cannot find square root");let c=n,u=o.pow(o.mul(o.ONE,i),r),d=o.pow(a,s),p=o.pow(a,r);for(;!o.eql(p,o.ONE);){if(o.eql(p,o.ZERO))return o.ZERO;let y=1;for(let w=o.sqr(p);y<c&&!o.eql(w,o.ONE);y++)w=o.sqr(w);const _=o.pow(u,Ye<<BigInt(c-y-1));u=o.sqr(_),d=o.mul(d,_),p=o.mul(p,u),c=y}return d}}function Qb(t){if(t%fa===Xb){const e=(t+Ye)/fa;return function(r,n){const i=r.pow(n,e);if(!r.eql(r.sqr(i),n))throw new Error("Cannot find square root");return i}}if(t%Iu===Su){const e=(t-Su)/Iu;return function(r,n){const i=r.mul(n,cn),s=r.pow(i,e),o=r.mul(n,s),a=r.mul(r.mul(o,cn),s),c=r.mul(o,r.sub(a,r.ONE));if(!r.eql(r.sqr(c),n))throw new Error("Cannot find square root");return c}}return Jb(t)}const eg=(t,e)=>(Je(t,e)&Ye)===Ye,tg=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function rg(t){const e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},r=tg.reduce((n,i)=>(n[i]="function",n),e);return ca(t,r)}function ng(t,e,r){if(r<tt)throw new Error("invalid exponent, negatives unsupported");if(r===tt)return t.ONE;if(r===Ye)return e;let n=t.ONE,i=e;for(;r>tt;)r&Ye&&(n=t.mul(n,i)),i=t.sqr(i),r>>=Ye;return n}function ig(t,e){const r=new Array(e.length),n=e.reduce((s,o,a)=>t.is0(o)?s:(r[a]=s,t.mul(s,o)),t.ONE),i=t.inv(n);return e.reduceRight((s,o,a)=>t.is0(o)?s:(r[a]=t.mul(s,r[a]),t.mul(s,o)),i),r}function Du(t,e){const r=e!==void 0?e:t.toString(2).length,n=Math.ceil(r/8);return{nBitLength:r,nByteLength:n}}function Ou(t,e,r=!1,n={}){if(t<=tt)throw new Error("invalid field: expected ORDER > 0, got "+t);const{nBitLength:i,nByteLength:s}=Du(t,e);if(s>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let o;const a=Object.freeze({ORDER:t,isLE:r,BITS:i,BYTES:s,MASK:Gb(i),ZERO:tt,ONE:Ye,create:c=>Je(c,t),isValid:c=>{if(typeof c!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof c);return tt<=c&&c<t},is0:c=>c===tt,isOdd:c=>(c&Ye)===Ye,neg:c=>Je(-c,t),eql:(c,u)=>c===u,sqr:c=>Je(c*c,t),add:(c,u)=>Je(c+u,t),sub:(c,u)=>Je(c-u,t),mul:(c,u)=>Je(c*u,t),pow:(c,u)=>ng(a,c,u),div:(c,u)=>Je(c*Au(u,t),t),sqrN:c=>c*c,addN:(c,u)=>c+u,subN:(c,u)=>c-u,mulN:(c,u)=>c*u,inv:c=>Au(c,t),sqrt:n.sqrt||(c=>(o||(o=Qb(t)),o(a,c))),invertBatch:c=>ig(a,c),cmov:(c,u,d)=>d?u:c,toBytes:c=>r?oa(c,s):_u(c,s),fromBytes:c=>{if(c.length!==s)throw new Error("Field.fromBytes: expected "+s+" bytes, got "+c.length);return r?Ds(c):Kb(c)}});return Object.freeze(a)}const Mu=BigInt(0),Os=BigInt(1);function ua(t,e){const r=e.negate();return t?r:e}function Tu(t,e){if(!Number.isSafeInteger(t)||t<=0||t>e)throw new Error("invalid window size, expected [1.."+e+"], got W="+t)}function ha(t,e){Tu(t,e);const r=Math.ceil(e/t)+1,n=2**(t-1);return{windows:r,windowSize:n}}function sg(t,e){if(!Array.isArray(t))throw new Error("array expected");t.forEach((r,n)=>{if(!(r instanceof e))throw new Error("invalid point at index "+n)})}function og(t,e){if(!Array.isArray(t))throw new Error("array of scalars expected");t.forEach((r,n)=>{if(!e.isValid(r))throw new Error("invalid scalar at index "+n)})}const da=new WeakMap,Ru=new WeakMap;function la(t){return Ru.get(t)||1}function ag(t,e){return{constTimeNegate:ua,hasPrecomputes(r){return la(r)!==1},unsafeLadder(r,n,i=t.ZERO){let s=r;for(;n>Mu;)n&Os&&(i=i.add(s)),s=s.double(),n>>=Os;return i},precomputeWindow(r,n){const{windows:i,windowSize:s}=ha(n,e),o=[];let a=r,c=a;for(let u=0;u<i;u++){c=a,o.push(c);for(let d=1;d<s;d++)c=c.add(a),o.push(c);a=c.double()}return o},wNAF(r,n,i){const{windows:s,windowSize:o}=ha(r,e);let a=t.ZERO,c=t.BASE;const u=BigInt(2**r-1),d=2**r,p=BigInt(r);for(let y=0;y<s;y++){const _=y*o;let w=Number(i&u);i>>=p,w>o&&(w-=d,i+=Os);const D=_,O=_+Math.abs(w)-1,M=y%2!==0,T=w<0;w===0?c=c.add(ua(M,n[D])):a=a.add(ua(T,n[O]))}return{p:a,f:c}},wNAFUnsafe(r,n,i,s=t.ZERO){const{windows:o,windowSize:a}=ha(r,e),c=BigInt(2**r-1),u=2**r,d=BigInt(r);for(let p=0;p<o;p++){const y=p*a;if(i===Mu)break;let _=Number(i&c);if(i>>=d,_>a&&(_-=u,i+=Os),_===0)continue;let w=n[y+Math.abs(_)-1];_<0&&(w=w.negate()),s=s.add(w)}return s},getPrecomputes(r,n,i){let s=da.get(n);return s||(s=this.precomputeWindow(n,r),r!==1&&da.set(n,i(s))),s},wNAFCached(r,n,i){const s=la(r);return this.wNAF(s,this.getPrecomputes(s,r,i),n)},wNAFCachedUnsafe(r,n,i,s){const o=la(r);return o===1?this.unsafeLadder(r,n,s):this.wNAFUnsafe(o,this.getPrecomputes(o,r,i),n,s)},setWindowSize(r,n){Tu(n,e),Ru.set(r,n),da.delete(r)}}}function cg(t,e,r,n){if(sg(r,t),og(n,e),r.length!==n.length)throw new Error("arrays of points and scalars must have equal length");const i=t.ZERO,s=Wb(BigInt(r.length)),o=s>12?s-3:s>4?s-2:s?2:1,a=(1<<o)-1,c=new Array(a+1).fill(i),u=Math.floor((e.BITS-1)/o)*o;let d=i;for(let p=u;p>=0;p-=o){c.fill(i);for(let _=0;_<n.length;_++){const w=n[_],D=Number(w>>BigInt(p)&BigInt(a));c[D]=c[D].add(r[_])}let y=i;for(let _=c.length-1,w=i;_>0;_--)w=w.add(c[_]),y=y.add(w);if(d=d.add(y),p!==0)for(let _=0;_<o;_++)d=d.double()}return d}function fg(t){return rg(t.Fp),ca(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...Du(t.n,t.nBitLength),...t,p:t.Fp.ORDER})}const Zt=BigInt(0),Ot=BigInt(1),Ms=BigInt(2),ug=BigInt(8),hg={zip215:!0};function dg(t){const e=fg(t);return ca(t,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...e})}function lg(t){const e=dg(t),{Fp:r,n,prehash:i,hash:s,randomBytes:o,nByteLength:a,h:c}=e,u=Ms<<BigInt(a*8)-Ot,d=r.create,p=Ou(e.n,e.nBitLength),y=e.uvRatio||((b,v)=>{try{return{isValid:!0,value:r.sqrt(b*r.inv(v))}}catch{return{isValid:!1,value:Zt}}}),_=e.adjustScalarBytes||(b=>b),w=e.domain||((b,v,x)=>{if(ia("phflag",x),v.length||x)throw new Error("Contexts/pre-hash are not supported");return b});function D(b,v){Ii("coordinate "+b,v,Zt,u)}function O(b){if(!(b instanceof B))throw new Error("ExtendedPoint expected")}const M=xu((b,v)=>{const{ex:x,ey:I,ez:m}=b,h=b.is0();v==null&&(v=h?ug:r.inv(m));const E=d(x*v),C=d(I*v),F=d(m*v);if(h)return{x:Zt,y:Ot};if(F!==Ot)throw new Error("invZ was invalid");return{x:E,y:C}}),T=xu(b=>{const{a:v,d:x}=e;if(b.is0())throw new Error("bad point: ZERO");const{ex:I,ey:m,ez:h,et:E}=b,C=d(I*I),F=d(m*m),k=d(h*h),q=d(k*k),W=d(C*v),X=d(k*d(W+F)),Z=d(q+d(x*d(C*F)));if(X!==Z)throw new Error("bad point: equation left != right (1)");const Y=d(I*m),ee=d(h*E);if(Y!==ee)throw new Error("bad point: equation left != right (2)");return!0});class B{constructor(v,x,I,m){this.ex=v,this.ey=x,this.ez=I,this.et=m,D("x",v),D("y",x),D("z",I),D("t",m),Object.freeze(this)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(v){if(v instanceof B)throw new Error("extended point not allowed");const{x,y:I}=v||{};return D("x",x),D("y",I),new B(x,I,Ot,d(x*I))}static normalizeZ(v){const x=r.invertBatch(v.map(I=>I.ez));return v.map((I,m)=>I.toAffine(x[m])).map(B.fromAffine)}static msm(v,x){return cg(B,p,v,x)}_setWindowSize(v){$.setWindowSize(this,v)}assertValidity(){T(this)}equals(v){O(v);const{ex:x,ey:I,ez:m}=this,{ex:h,ey:E,ez:C}=v,F=d(x*C),k=d(h*m),q=d(I*C),W=d(E*m);return F===k&&q===W}is0(){return this.equals(B.ZERO)}negate(){return new B(d(-this.ex),this.ey,this.ez,d(-this.et))}double(){const{a:v}=e,{ex:x,ey:I,ez:m}=this,h=d(x*x),E=d(I*I),C=d(Ms*d(m*m)),F=d(v*h),k=x+I,q=d(d(k*k)-h-E),W=F+E,X=W-C,Z=F-E,Y=d(q*X),ee=d(W*Z),Qe=d(q*Z),te=d(X*W);return new B(Y,ee,te,Qe)}add(v){O(v);const{a:x,d:I}=e,{ex:m,ey:h,ez:E,et:C}=this,{ex:F,ey:k,ez:q,et:W}=v;if(x===BigInt(-1)){const we=d((h-m)*(k+F)),En=d((h+m)*(k-F)),ve=d(En-we);if(ve===Zt)return this.double();const _e=d(E*Ms*W),xn=d(C*Ms*q),Ee=xn+_e,xe=En+we,Sn=xn-_e,le=d(Ee*ve),ye=d(xe*Sn),In=d(Ee*Sn),ie=d(ve*xe);return new B(le,ye,ie,In)}const X=d(m*F),Z=d(h*k),Y=d(C*I*W),ee=d(E*q),Qe=d((m+h)*(F+k)-X-Z),te=ee-Y,ae=ee+Y,St=d(Z-x*X),de=d(Qe*te),Ie=d(ae*St),li=d(Qe*St),Ae=d(te*ae);return new B(de,Ie,Ae,li)}subtract(v){return this.add(v.negate())}wNAF(v){return $.wNAFCached(this,v,B.normalizeZ)}multiply(v){const x=v;Ii("scalar",x,Ot,n);const{p:I,f:m}=this.wNAF(x);return B.normalizeZ([I,m])[0]}multiplyUnsafe(v,x=B.ZERO){const I=v;return Ii("scalar",I,Zt,n),I===Zt?j:this.is0()||I===Ot?this:$.wNAFCachedUnsafe(this,I,B.normalizeZ,x)}isSmallOrder(){return this.multiplyUnsafe(c).is0()}isTorsionFree(){return $.unsafeLadder(this,n).is0()}toAffine(v){return M(this,v)}clearCofactor(){const{h:v}=e;return v===Ot?this:this.multiplyUnsafe(v)}static fromHex(v,x=!1){const{d:I,a:m}=e,h=r.BYTES;v=Ar("pointHex",v,h),ia("zip215",x);const E=v.slice(),C=v[h-1];E[h-1]=C&-129;const F=Ds(E),k=x?u:r.ORDER;Ii("pointHex.y",F,Zt,k);const q=d(F*F),W=d(q-Ot),X=d(I*q-m);let{isValid:Z,value:Y}=y(W,X);if(!Z)throw new Error("Point.fromHex: invalid y coordinate");const ee=(Y&Ot)===Ot,Qe=(C&128)!==0;if(!x&&Y===Zt&&Qe)throw new Error("Point.fromHex: x=0 and x_0=1");return Qe!==ee&&(Y=d(-Y)),B.fromAffine({x:Y,y:F})}static fromPrivateKey(v){return N(v).point}toRawBytes(){const{x:v,y:x}=this.toAffine(),I=oa(x,r.BYTES);return I[I.length-1]|=v&Ot?128:0,I}toHex(){return sa(this.toRawBytes())}}B.BASE=new B(e.Gx,e.Gy,Ot,d(e.Gx*e.Gy)),B.ZERO=new B(Zt,Ot,Ot,Zt);const{BASE:P,ZERO:j}=B,$=ag(B,a*8);function L(b){return Je(b,n)}function z(b){return L(Ds(b))}function N(b){const v=r.BYTES;b=Ar("private key",b,v);const x=Ar("hashed private key",s(b),2*v),I=_(x.slice(0,v)),m=x.slice(v,2*v),h=z(I),E=P.multiply(h),C=E.toRawBytes();return{head:I,prefix:m,scalar:h,point:E,pointBytes:C}}function K(b){return N(b).pointBytes}function S(b=new Uint8Array,...v){const x=Eu(...v);return z(s(w(x,Ar("context",b),!!i)))}function f(b,v,x={}){b=Ar("message",b),i&&(b=i(b));const{prefix:I,scalar:m,pointBytes:h}=N(v),E=S(x.context,I,b),C=P.multiply(E).toRawBytes(),F=S(x.context,C,h,b),k=L(E+F*m);Ii("signature.s",k,Zt,n);const q=Eu(C,oa(k,r.BYTES));return Ar("result",q,r.BYTES*2)}const l=hg;function g(b,v,x,I=l){const{context:m,zip215:h}=I,E=r.BYTES;b=Ar("signature",b,2*E),v=Ar("message",v),x=Ar("publicKey",x,E),h!==void 0&&ia("zip215",h),i&&(v=i(v));const C=Ds(b.slice(E,2*E));let F,k,q;try{F=B.fromHex(x,h),k=B.fromHex(b.slice(0,E),h),q=P.multiplyUnsafe(C)}catch{return!1}if(!h&&F.isSmallOrder())return!1;const W=S(m,k.toRawBytes(),F.toRawBytes(),v);return k.add(F.multiplyUnsafe(W)).subtract(q).clearCofactor().equals(B.ZERO)}return P._setWindowSize(8),{CURVE:e,getPublicKey:K,sign:f,verify:g,ExtendedPoint:B,utils:{getExtendedPublicKey:N,randomPrivateKey:()=>o(r.BYTES),precompute(b=8,v=B.BASE){return v._setWindowSize(b),v.multiply(BigInt(3)),v}}}}BigInt(0),BigInt(1);const pa=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),Bu=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");BigInt(0);const pg=BigInt(1),Pu=BigInt(2);BigInt(3);const bg=BigInt(5),gg=BigInt(8);function vg(t){const e=BigInt(10),r=BigInt(20),n=BigInt(40),i=BigInt(80),s=pa,o=t*t%s*t%s,a=fr(o,Pu,s)*o%s,c=fr(a,pg,s)*t%s,u=fr(c,bg,s)*c%s,d=fr(u,e,s)*u%s,p=fr(d,r,s)*d%s,y=fr(p,n,s)*p%s,_=fr(y,i,s)*y%s,w=fr(_,i,s)*y%s,D=fr(w,e,s)*u%s;return{pow_p_5_8:fr(D,Pu,s)*t%s,b2:o}}function yg(t){return t[0]&=248,t[31]&=127,t[31]|=64,t}function mg(t,e){const r=pa,n=Je(e*e*e,r),i=Je(n*n*e,r),s=vg(t*i).pow_p_5_8;let o=Je(t*n*s,r);const a=Je(e*o*o,r),c=o,u=Je(o*Bu,r),d=a===t,p=a===Je(-t,r),y=a===Je(-t*Bu,r);return d&&(o=c),(p||y)&&(o=u),eg(o,r)&&(o=Je(-o,r)),{isValid:d||p,value:o}}const wg=Ou(pa,void 0,!0),_g={a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:wg,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:gg,Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:jb,randomBytes:bu,adjustScalarBytes:yg,uvRatio:mg},Nu=lg(_g),Eg="EdDSA",xg="JWT",Ts=".",Rs="base64url",Cu="utf8",Lu="utf8",Sg=":",Ig="did",Ag="key",$u="base58btc",Dg="z",Og="K36",Mg=32;function ba(t){return globalThis.Buffer!=null?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}function Fu(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?ba(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}function zu(t,e){e||(e=t.reduce((i,s)=>i+s.length,0));const r=Fu(e);let n=0;for(const i of t)r.set(i,n),n+=i.length;return ba(r)}function Tg(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<t.length;i++){var s=t.charAt(i),o=s.charCodeAt(0);if(r[o]!==255)throw new TypeError(s+" is ambiguous");r[o]=i}var a=t.length,c=t.charAt(0),u=Math.log(a)/Math.log(256),d=Math.log(256)/Math.log(a);function p(w){if(w instanceof Uint8Array||(ArrayBuffer.isView(w)?w=new Uint8Array(w.buffer,w.byteOffset,w.byteLength):Array.isArray(w)&&(w=Uint8Array.from(w))),!(w instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(w.length===0)return"";for(var D=0,O=0,M=0,T=w.length;M!==T&&w[M]===0;)M++,D++;for(var B=(T-M)*d+1>>>0,P=new Uint8Array(B);M!==T;){for(var j=w[M],$=0,L=B-1;(j!==0||$<O)&&L!==-1;L--,$++)j+=256*P[L]>>>0,P[L]=j%a>>>0,j=j/a>>>0;if(j!==0)throw new Error("Non-zero carry");O=$,M++}for(var z=B-O;z!==B&&P[z]===0;)z++;for(var N=c.repeat(D);z<B;++z)N+=t.charAt(P[z]);return N}function y(w){if(typeof w!="string")throw new TypeError("Expected String");if(w.length===0)return new Uint8Array;var D=0;if(w[D]!==" "){for(var O=0,M=0;w[D]===c;)O++,D++;for(var T=(w.length-D)*u+1>>>0,B=new Uint8Array(T);w[D];){var P=r[w.charCodeAt(D)];if(P===255)return;for(var j=0,$=T-1;(P!==0||j<M)&&$!==-1;$--,j++)P+=a*B[$]>>>0,B[$]=P%256>>>0,P=P/256>>>0;if(P!==0)throw new Error("Non-zero carry");M=j,D++}if(w[D]!==" "){for(var L=T-M;L!==T&&B[L]===0;)L++;for(var z=new Uint8Array(O+(T-L)),N=O;L!==T;)z[N++]=B[L++];return z}}}function _(w){var D=y(w);if(D)return D;throw new Error(`Non-${e} character`)}return{encode:p,decodeUnsafe:y,decode:_}}var Rg=Tg,Bg=Rg;const Uu=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},Pg=t=>new TextEncoder().encode(t),Ng=t=>new TextDecoder().decode(t);class Cg{constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class Lg{constructor(e,r,n){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return ku(this,e)}}class $g{constructor(e){this.decoders=e}or(e){return ku(this,e)}decode(e){const r=e[0],n=this.decoders[r];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const ku=(t,e)=>new $g({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});class Fg{constructor(e,r,n,i){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=i,this.encoder=new Cg(e,r,n),this.decoder=new Lg(e,r,i)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const Bs=({name:t,prefix:e,encode:r,decode:n})=>new Fg(t,e,r,n),Ai=({prefix:t,name:e,alphabet:r})=>{const{encode:n,decode:i}=Bg(r,e);return Bs({prefix:t,name:e,encode:n,decode:s=>Uu(i(s))})},zg=(t,e,r,n)=>{const i={};for(let d=0;d<e.length;++d)i[e[d]]=d;let s=t.length;for(;t[s-1]==="=";)--s;const o=new Uint8Array(s*r/8|0);let a=0,c=0,u=0;for(let d=0;d<s;++d){const p=i[t[d]];if(p===void 0)throw new SyntaxError(`Non-${n} character`);c=c<<r|p,a+=r,a>=8&&(a-=8,o[u++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},Ug=(t,e,r)=>{const n=e[e.length-1]==="=",i=(1<<r)-1;let s="",o=0,a=0;for(let c=0;c<t.length;++c)for(a=a<<8|t[c],o+=8;o>r;)o-=r,s+=e[i&a>>o];if(o&&(s+=e[i&a<<r-o]),n)for(;s.length*r&7;)s+="=";return s},ut=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>Bs({prefix:e,name:t,encode(i){return Ug(i,n,r)},decode(i){return zg(i,n,r,t)}}),kg=Bs({prefix:"\0",name:"identity",encode:t=>Ng(t),decode:t=>Pg(t)});var jg=Object.freeze({__proto__:null,identity:kg});const qg=ut({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var Hg=Object.freeze({__proto__:null,base2:qg});const Kg=ut({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var Vg=Object.freeze({__proto__:null,base8:Kg});const Wg=Ai({prefix:"9",name:"base10",alphabet:"0123456789"});var Gg=Object.freeze({__proto__:null,base10:Wg});const Yg=ut({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Xg=ut({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var Zg=Object.freeze({__proto__:null,base16:Yg,base16upper:Xg});const Jg=ut({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Qg=ut({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),e2=ut({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),t2=ut({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),r2=ut({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),n2=ut({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),i2=ut({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),s2=ut({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),o2=ut({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var a2=Object.freeze({__proto__:null,base32:Jg,base32upper:Qg,base32pad:e2,base32padupper:t2,base32hex:r2,base32hexupper:n2,base32hexpad:i2,base32hexpadupper:s2,base32z:o2});const c2=Ai({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),f2=Ai({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var u2=Object.freeze({__proto__:null,base36:c2,base36upper:f2});const h2=Ai({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),d2=Ai({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var l2=Object.freeze({__proto__:null,base58btc:h2,base58flickr:d2});const p2=ut({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),b2=ut({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),g2=ut({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),v2=ut({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var y2=Object.freeze({__proto__:null,base64:p2,base64pad:b2,base64url:g2,base64urlpad:v2});const ju=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),m2=ju.reduce((t,e,r)=>(t[r]=e,t),[]),w2=ju.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function _2(t){return t.reduce((e,r)=>(e+=m2[r],e),"")}function E2(t){const e=[];for(const r of t){const n=w2[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(n)}return new Uint8Array(e)}const x2=Bs({prefix:"\u{1F680}",name:"base256emoji",encode:_2,decode:E2});var S2=Object.freeze({__proto__:null,base256emoji:x2}),I2=Hu,qu=128,A2=127,D2=~A2,O2=Math.pow(2,31);function Hu(t,e,r){e=e||[],r=r||0;for(var n=r;t>=O2;)e[r++]=t&255|qu,t/=128;for(;t&D2;)e[r++]=t&255|qu,t>>>=7;return e[r]=t|0,Hu.bytes=r-n+1,e}var M2=ga,T2=128,Ku=127;function ga(t,n){var r=0,n=n||0,i=0,s=n,o,a=t.length;do{if(s>=a)throw ga.bytes=0,new RangeError("Could not decode varint");o=t[s++],r+=i<28?(o&Ku)<<i:(o&Ku)*Math.pow(2,i),i+=7}while(o>=T2);return ga.bytes=s-n,r}var R2=Math.pow(2,7),B2=Math.pow(2,14),P2=Math.pow(2,21),N2=Math.pow(2,28),C2=Math.pow(2,35),L2=Math.pow(2,42),$2=Math.pow(2,49),F2=Math.pow(2,56),z2=Math.pow(2,63),U2=function(t){return t<R2?1:t<B2?2:t<P2?3:t<N2?4:t<C2?5:t<L2?6:t<$2?7:t<F2?8:t<z2?9:10},k2={encode:I2,decode:M2,encodingLength:U2},Vu=k2;const Wu=(t,e,r=0)=>(Vu.encode(t,e,r),e),Gu=t=>Vu.encodingLength(t),va=(t,e)=>{const r=e.byteLength,n=Gu(t),i=n+Gu(r),s=new Uint8Array(i+r);return Wu(t,s,0),Wu(r,s,n),s.set(e,i),new j2(t,r,e,s)};class j2{constructor(e,r,n,i){this.code=e,this.size=r,this.digest=n,this.bytes=i}}const Yu=({name:t,code:e,encode:r})=>new q2(t,e,r);class q2{constructor(e,r,n){this.name=e,this.code=r,this.encode=n}digest(e){if(e instanceof Uint8Array){const r=this.encode(e);return r instanceof Uint8Array?va(this.code,r):r.then(n=>va(this.code,n))}else throw Error("Unknown type, must be binary type")}}const Xu=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),H2=Yu({name:"sha2-256",code:18,encode:Xu("SHA-256")}),K2=Yu({name:"sha2-512",code:19,encode:Xu("SHA-512")});var V2=Object.freeze({__proto__:null,sha256:H2,sha512:K2});const Zu=0,W2="identity",Ju=Uu;var G2=Object.freeze({__proto__:null,identity:{code:Zu,name:W2,encode:Ju,digest:t=>va(Zu,Ju(t))}});new TextEncoder,new TextDecoder;const Qu={...jg,...Hg,...Vg,...Gg,...Zg,...a2,...u2,...l2,...y2,...S2};({...V2,...G2});function eh(t,e,r,n){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:n}}}const th=eh("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),ya=eh("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);const e=Fu(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),rh={utf8:th,"utf-8":th,hex:Qu.base16,latin1:ya,ascii:ya,binary:ya,...Qu};function Ps(t,e="utf8"){const r=rh[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8"):r.encoder.encode(t).substring(1)}function Fn(t,e="utf8"){const r=rh[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?ba(globalThis.Buffer.from(t,"utf-8")):r.decoder.decode(`${r.prefix}${t}`)}function nh(t){return Bn(Ps(Fn(t,Rs),Cu))}function Ns(t){return Ps(Fn(on(t),Cu),Rs)}function ih(t){const e=Fn(Og,$u),r=Dg+Ps(zu([e,t]),$u);return[Ig,Ag,r].join(Sg)}function Y2(t){return Ps(t,Rs)}function X2(t){return Fn(t,Rs)}function Z2(t){return Fn([Ns(t.header),Ns(t.payload)].join(Ts),Lu)}function J2(t){return[Ns(t.header),Ns(t.payload),Y2(t.signature)].join(Ts)}function ma(t){const e=t.split(Ts),r=nh(e[0]),n=nh(e[1]),i=X2(e[2]),s=Fn(e.slice(0,2).join(Ts),Lu);return{header:r,payload:n,signature:i,data:s}}function sh(t=bu(Mg)){const e=Nu.getPublicKey(t);return{secretKey:zu([t,e]),publicKey:e}}async function Q2(t,e,r,n,i=G.fromMiliseconds(Date.now())){const s={alg:Eg,typ:xg},o=ih(n.publicKey),a=i+r,c={iss:o,sub:t,aud:e,iat:i,exp:a},u=Z2({header:s,payload:c}),d=Nu.sign(u,n.secretKey.slice(0,32));return J2({header:s,payload:c,signature:d})}function ev(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<t.length;i++){var s=t.charAt(i),o=s.charCodeAt(0);if(r[o]!==255)throw new TypeError(s+" is ambiguous");r[o]=i}var a=t.length,c=t.charAt(0),u=Math.log(a)/Math.log(256),d=Math.log(256)/Math.log(a);function p(w){if(w instanceof Uint8Array||(ArrayBuffer.isView(w)?w=new Uint8Array(w.buffer,w.byteOffset,w.byteLength):Array.isArray(w)&&(w=Uint8Array.from(w))),!(w instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(w.length===0)return"";for(var D=0,O=0,M=0,T=w.length;M!==T&&w[M]===0;)M++,D++;for(var B=(T-M)*d+1>>>0,P=new Uint8Array(B);M!==T;){for(var j=w[M],$=0,L=B-1;(j!==0||$<O)&&L!==-1;L--,$++)j+=256*P[L]>>>0,P[L]=j%a>>>0,j=j/a>>>0;if(j!==0)throw new Error("Non-zero carry");O=$,M++}for(var z=B-O;z!==B&&P[z]===0;)z++;for(var N=c.repeat(D);z<B;++z)N+=t.charAt(P[z]);return N}function y(w){if(typeof w!="string")throw new TypeError("Expected String");if(w.length===0)return new Uint8Array;var D=0;if(w[D]!==" "){for(var O=0,M=0;w[D]===c;)O++,D++;for(var T=(w.length-D)*u+1>>>0,B=new Uint8Array(T);w[D];){var P=r[w.charCodeAt(D)];if(P===255)return;for(var j=0,$=T-1;(P!==0||j<M)&&$!==-1;$--,j++)P+=a*B[$]>>>0,B[$]=P%256>>>0,P=P/256>>>0;if(P!==0)throw new Error("Non-zero carry");M=j,D++}if(w[D]!==" "){for(var L=T-M;L!==T&&B[L]===0;)L++;for(var z=new Uint8Array(O+(T-L)),N=O;L!==T;)z[N++]=B[L++];return z}}}function _(w){var D=y(w);if(D)return D;throw new Error(`Non-${e} character`)}return{encode:p,decodeUnsafe:y,decode:_}}var tv=ev,rv=tv;const oh=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},nv=t=>new TextEncoder().encode(t),iv=t=>new TextDecoder().decode(t);class sv{constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class ov{constructor(e,r,n){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return ah(this,e)}}class av{constructor(e){this.decoders=e}or(e){return ah(this,e)}decode(e){const r=e[0],n=this.decoders[r];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const ah=(t,e)=>new av({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});class cv{constructor(e,r,n,i){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=i,this.encoder=new sv(e,r,n),this.decoder=new ov(e,r,i)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const Cs=({name:t,prefix:e,encode:r,decode:n})=>new cv(t,e,r,n),Di=({prefix:t,name:e,alphabet:r})=>{const{encode:n,decode:i}=rv(r,e);return Cs({prefix:t,name:e,encode:n,decode:s=>oh(i(s))})},fv=(t,e,r,n)=>{const i={};for(let d=0;d<e.length;++d)i[e[d]]=d;let s=t.length;for(;t[s-1]==="=";)--s;const o=new Uint8Array(s*r/8|0);let a=0,c=0,u=0;for(let d=0;d<s;++d){const p=i[t[d]];if(p===void 0)throw new SyntaxError(`Non-${n} character`);c=c<<r|p,a+=r,a>=8&&(a-=8,o[u++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},uv=(t,e,r)=>{const n=e[e.length-1]==="=",i=(1<<r)-1;let s="",o=0,a=0;for(let c=0;c<t.length;++c)for(a=a<<8|t[c],o+=8;o>r;)o-=r,s+=e[i&a>>o];if(o&&(s+=e[i&a<<r-o]),n)for(;s.length*r&7;)s+="=";return s},ht=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>Cs({prefix:e,name:t,encode(i){return uv(i,n,r)},decode(i){return fv(i,n,r,t)}}),hv=Cs({prefix:"\0",name:"identity",encode:t=>iv(t),decode:t=>nv(t)});var dv=Object.freeze({__proto__:null,identity:hv});const lv=ht({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var pv=Object.freeze({__proto__:null,base2:lv});const bv=ht({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var gv=Object.freeze({__proto__:null,base8:bv});const vv=Di({prefix:"9",name:"base10",alphabet:"0123456789"});var yv=Object.freeze({__proto__:null,base10:vv});const mv=ht({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),wv=ht({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var _v=Object.freeze({__proto__:null,base16:mv,base16upper:wv});const Ev=ht({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),xv=ht({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Sv=ht({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Iv=ht({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Av=ht({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Dv=ht({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Ov=ht({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Mv=ht({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Tv=ht({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var Rv=Object.freeze({__proto__:null,base32:Ev,base32upper:xv,base32pad:Sv,base32padupper:Iv,base32hex:Av,base32hexupper:Dv,base32hexpad:Ov,base32hexpadupper:Mv,base32z:Tv});const Bv=Di({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Pv=Di({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var Nv=Object.freeze({__proto__:null,base36:Bv,base36upper:Pv});const Cv=Di({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Lv=Di({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var $v=Object.freeze({__proto__:null,base58btc:Cv,base58flickr:Lv});const Fv=ht({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),zv=ht({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Uv=ht({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),kv=ht({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var jv=Object.freeze({__proto__:null,base64:Fv,base64pad:zv,base64url:Uv,base64urlpad:kv});const ch=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),qv=ch.reduce((t,e,r)=>(t[r]=e,t),[]),Hv=ch.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function Kv(t){return t.reduce((e,r)=>(e+=qv[r],e),"")}function Vv(t){const e=[];for(const r of t){const n=Hv[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(n)}return new Uint8Array(e)}const Wv=Cs({prefix:"\u{1F680}",name:"base256emoji",encode:Kv,decode:Vv});var Gv=Object.freeze({__proto__:null,base256emoji:Wv}),Yv=uh,fh=128,Xv=127,Zv=~Xv,Jv=Math.pow(2,31);function uh(t,e,r){e=e||[],r=r||0;for(var n=r;t>=Jv;)e[r++]=t&255|fh,t/=128;for(;t&Zv;)e[r++]=t&255|fh,t>>>=7;return e[r]=t|0,uh.bytes=r-n+1,e}var Qv=wa,e3=128,hh=127;function wa(t,n){var r=0,n=n||0,i=0,s=n,o,a=t.length;do{if(s>=a)throw wa.bytes=0,new RangeError("Could not decode varint");o=t[s++],r+=i<28?(o&hh)<<i:(o&hh)*Math.pow(2,i),i+=7}while(o>=e3);return wa.bytes=s-n,r}var t3=Math.pow(2,7),r3=Math.pow(2,14),n3=Math.pow(2,21),i3=Math.pow(2,28),s3=Math.pow(2,35),o3=Math.pow(2,42),a3=Math.pow(2,49),c3=Math.pow(2,56),f3=Math.pow(2,63),u3=function(t){return t<t3?1:t<r3?2:t<n3?3:t<i3?4:t<s3?5:t<o3?6:t<a3?7:t<c3?8:t<f3?9:10},h3={encode:Yv,decode:Qv,encodingLength:u3},dh=h3;const lh=(t,e,r=0)=>(dh.encode(t,e,r),e),ph=t=>dh.encodingLength(t),_a=(t,e)=>{const r=e.byteLength,n=ph(t),i=n+ph(r),s=new Uint8Array(i+r);return lh(t,s,0),lh(r,s,n),s.set(e,i),new d3(t,r,e,s)};class d3{constructor(e,r,n,i){this.code=e,this.size=r,this.digest=n,this.bytes=i}}const bh=({name:t,code:e,encode:r})=>new l3(t,e,r);class l3{constructor(e,r,n){this.name=e,this.code=r,this.encode=n}digest(e){if(e instanceof Uint8Array){const r=this.encode(e);return r instanceof Uint8Array?_a(this.code,r):r.then(n=>_a(this.code,n))}else throw Error("Unknown type, must be binary type")}}const gh=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),p3=bh({name:"sha2-256",code:18,encode:gh("SHA-256")}),b3=bh({name:"sha2-512",code:19,encode:gh("SHA-512")});var g3=Object.freeze({__proto__:null,sha256:p3,sha512:b3});const vh=0,v3="identity",yh=oh;var y3=Object.freeze({__proto__:null,identity:{code:vh,name:v3,encode:yh,digest:t=>_a(vh,yh(t))}});new TextEncoder,new TextDecoder;const mh={...dv,...pv,...gv,...yv,..._v,...Rv,...Nv,...$v,...jv,...Gv};({...g3,...y3});function wh(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?globalThis.Buffer.allocUnsafe(t):new Uint8Array(t)}function _h(t,e,r,n){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:n}}}const Eh=_h("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),Ea=_h("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);const e=wh(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),xh={utf8:Eh,"utf-8":Eh,hex:mh.base16,latin1:Ea,ascii:Ea,binary:Ea,...mh};function Ct(t,e="utf8"){const r=xh[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t,"utf8"):r.decoder.decode(`${r.prefix}${t}`)}var Sh=function(t,e,r){if(r||arguments.length===2)for(var n=0,i=e.length,s;n<i;n++)(s||!(n in e))&&(s||(s=Array.prototype.slice.call(e,0,n)),s[n]=e[n]);return t.concat(s||Array.prototype.slice.call(e))},m3=function(){function t(e,r,n){this.name=e,this.version=r,this.os=n,this.type="browser"}return t}(),w3=function(){function t(e){this.version=e,this.type="node",this.name="node",this.os=process.platform}return t}(),_3=function(){function t(e,r,n,i){this.name=e,this.version=r,this.os=n,this.bot=i,this.type="bot-device"}return t}(),E3=function(){function t(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return t}(),x3=function(){function t(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return t}(),S3=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,I3=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,Ih=3,A3=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",S3]],Ah=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function D3(t){return t?Dh(t):typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new x3:typeof navigator<"u"?Dh(navigator.userAgent):T3()}function O3(t){return t!==""&&A3.reduce(function(e,r){var n=r[0],i=r[1];if(e)return e;var s=i.exec(t);return!!s&&[n,s]},!1)}function Dh(t){var e=O3(t);if(!e)return null;var r=e[0],n=e[1];if(r==="searchbot")return new E3;var i=n[1]&&n[1].split(".").join("_").split("_").slice(0,3);i?i.length<Ih&&(i=Sh(Sh([],i,!0),R3(Ih-i.length),!0)):i=[];var s=i.join("."),o=M3(t),a=I3.exec(t);return a&&a[1]?new _3(r,s,o,a[1]):new m3(r,s,o)}function M3(t){for(var e=0,r=Ah.length;e<r;e++){var n=Ah[e],i=n[0],s=n[1],o=s.exec(t);if(o)return i}return null}function T3(){var t=typeof process<"u"&&process.version;return t?new w3(process.version.slice(1)):null}function R3(t){for(var e=[],r=0;r<t;r++)e.push("0");return e}var pe={};Object.defineProperty(pe,"__esModule",{value:!0}),pe.getLocalStorage=pe.getLocalStorageOrThrow=pe.getCrypto=pe.getCryptoOrThrow=Oh=pe.getLocation=pe.getLocationOrThrow=xa=pe.getNavigator=pe.getNavigatorOrThrow=Ls=pe.getDocument=pe.getDocumentOrThrow=pe.getFromWindowOrThrow=pe.getFromWindow=void 0;function fn(t){let e;return typeof window<"u"&&typeof window[t]<"u"&&(e=window[t]),e}pe.getFromWindow=fn;function zn(t){const e=fn(t);if(!e)throw new Error(`${t} is not defined in Window`);return e}pe.getFromWindowOrThrow=zn;function B3(){return zn("document")}pe.getDocumentOrThrow=B3;function P3(){return fn("document")}var Ls=pe.getDocument=P3;function N3(){return zn("navigator")}pe.getNavigatorOrThrow=N3;function C3(){return fn("navigator")}var xa=pe.getNavigator=C3;function L3(){return zn("location")}pe.getLocationOrThrow=L3;function $3(){return fn("location")}var Oh=pe.getLocation=$3;function F3(){return zn("crypto")}pe.getCryptoOrThrow=F3;function z3(){return fn("crypto")}pe.getCrypto=z3;function U3(){return zn("localStorage")}pe.getLocalStorageOrThrow=U3;function k3(){return fn("localStorage")}pe.getLocalStorage=k3;var Sa={};Object.defineProperty(Sa,"__esModule",{value:!0});var Mh=Sa.getWindowMetadata=void 0;const Th=pe;function j3(){let t,e;try{t=Th.getDocumentOrThrow(),e=Th.getLocationOrThrow()}catch{return null}function r(){const p=t.getElementsByTagName("link"),y=[];for(let _=0;_<p.length;_++){const w=p[_],D=w.getAttribute("rel");if(D&&D.toLowerCase().indexOf("icon")>-1){const O=w.getAttribute("href");if(O)if(O.toLowerCase().indexOf("https:")===-1&&O.toLowerCase().indexOf("http:")===-1&&O.indexOf("//")!==0){let M=e.protocol+"//"+e.host;if(O.indexOf("/")===0)M+=O;else{const T=e.pathname.split("/");T.pop();const B=T.join("/");M+=B+"/"+O}y.push(M)}else if(O.indexOf("//")===0){const M=e.protocol+O;y.push(M)}else y.push(O)}}return y}function n(...p){const y=t.getElementsByTagName("meta");for(let _=0;_<y.length;_++){const w=y[_],D=["itemprop","property","name"].map(O=>w.getAttribute(O)).filter(O=>O?p.includes(O):!1);if(D.length&&D){const O=w.getAttribute("content");if(O)return O}}return""}function i(){let p=n("name","og:site_name","og:title","twitter:title");return p||(p=t.title),p}function s(){return n("description","og:description","twitter:description","keywords")}const o=i(),a=s(),c=e.origin,u=r();return{description:a,url:c,icons:u,name:o}}Mh=Sa.getWindowMetadata=j3;function $s(t){if(!Number.isSafeInteger(t)||t<0)throw new Error("positive integer expected, got "+t)}function q3(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function Oi(t,...e){if(!q3(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function H3(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");$s(t.outputLen),$s(t.blockLen)}function Un(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function Rh(t,e){Oi(t);const r=e.outputLen;if(t.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}const Fs=BigInt(2**32-1),Bh=BigInt(32);function K3(t,e=!1){return e?{h:Number(t&Fs),l:Number(t>>Bh&Fs)}:{h:Number(t>>Bh&Fs)|0,l:Number(t&Fs)|0}}function V3(t,e=!1){let r=new Uint32Array(t.length),n=new Uint32Array(t.length);for(let i=0;i<t.length;i++){const{h:s,l:o}=K3(t[i],e);[r[i],n[i]]=[s,o]}return[r,n]}const W3=(t,e,r)=>t<<r|e>>>32-r,G3=(t,e,r)=>e<<r|t>>>32-r,Y3=(t,e,r)=>e<<r-32|t>>>64-r,X3=(t,e,r)=>t<<r-32|e>>>64-r,kn=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;function Z3(t){return new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4))}function Ia(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function ur(t,e){return t<<32-e|t>>>e}const Ph=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function J3(t){return t<<24&4278190080|t<<8&16711680|t>>>8&65280|t>>>24&255}function Nh(t){for(let e=0;e<t.length;e++)t[e]=J3(t[e])}function Q3(t){if(typeof t!="string")throw new Error("utf8ToBytes expected string, got "+typeof t);return new Uint8Array(new TextEncoder().encode(t))}function zs(t){return typeof t=="string"&&(t=Q3(t)),Oi(t),t}function ey(...t){let e=0;for(let n=0;n<t.length;n++){const i=t[n];Oi(i),e+=i.length}const r=new Uint8Array(e);for(let n=0,i=0;n<t.length;n++){const s=t[n];r.set(s,i),i+=s.length}return r}class Aa{clone(){return this._cloneInto()}}function Ch(t){const e=n=>t().update(zs(n)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e}function ty(t=32){if(kn&&typeof kn.getRandomValues=="function")return kn.getRandomValues(new Uint8Array(t));if(kn&&typeof kn.randomBytes=="function")return kn.randomBytes(t);throw new Error("crypto.getRandomValues must be defined")}const Lh=[],$h=[],Fh=[],ry=BigInt(0),Mi=BigInt(1),ny=BigInt(2),iy=BigInt(7),sy=BigInt(256),oy=BigInt(113);for(let t=0,e=Mi,r=1,n=0;t<24;t++){[r,n]=[n,(2*r+3*n)%5],Lh.push(2*(5*n+r)),$h.push((t+1)*(t+2)/2%64);let i=ry;for(let s=0;s<7;s++)e=(e<<Mi^(e>>iy)*oy)%sy,e&ny&&(i^=Mi<<(Mi<<BigInt(s))-Mi);Fh.push(i)}const[ay,cy]=V3(Fh,!0),zh=(t,e,r)=>r>32?Y3(t,e,r):W3(t,e,r),Uh=(t,e,r)=>r>32?X3(t,e,r):G3(t,e,r);function fy(t,e=24){const r=new Uint32Array(10);for(let n=24-e;n<24;n++){for(let o=0;o<10;o++)r[o]=t[o]^t[o+10]^t[o+20]^t[o+30]^t[o+40];for(let o=0;o<10;o+=2){const a=(o+8)%10,c=(o+2)%10,u=r[c],d=r[c+1],p=zh(u,d,1)^r[a],y=Uh(u,d,1)^r[a+1];for(let _=0;_<50;_+=10)t[o+_]^=p,t[o+_+1]^=y}let i=t[2],s=t[3];for(let o=0;o<24;o++){const a=$h[o],c=zh(i,s,a),u=Uh(i,s,a),d=Lh[o];i=t[d],s=t[d+1],t[d]=c,t[d+1]=u}for(let o=0;o<50;o+=10){for(let a=0;a<10;a++)r[a]=t[o+a];for(let a=0;a<10;a++)t[o+a]^=~r[(a+2)%10]&r[(a+4)%10]}t[0]^=ay[n],t[1]^=cy[n]}r.fill(0)}class Da extends Aa{constructor(e,r,n,i=!1,s=24){if(super(),this.blockLen=e,this.suffix=r,this.outputLen=n,this.enableXOF=i,this.rounds=s,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,$s(n),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=Z3(this.state)}keccak(){Ph||Nh(this.state32),fy(this.state32,this.rounds),Ph||Nh(this.state32),this.posOut=0,this.pos=0}update(e){Un(this);const{blockLen:r,state:n}=this;e=zs(e);const i=e.length;for(let s=0;s<i;){const o=Math.min(r-this.pos,i-s);for(let a=0;a<o;a++)n[this.pos++]^=e[s++];this.pos===r&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:r,pos:n,blockLen:i}=this;e[n]^=r,(r&128)!==0&&n===i-1&&this.keccak(),e[i-1]^=128,this.keccak()}writeInto(e){Un(this,!1),Oi(e),this.finish();const r=this.state,{blockLen:n}=this;for(let i=0,s=e.length;i<s;){this.posOut>=n&&this.keccak();const o=Math.min(n-this.posOut,s-i);e.set(r.subarray(this.posOut,this.posOut+o),i),this.posOut+=o,i+=o}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return $s(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(Rh(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(e){const{blockLen:r,suffix:n,outputLen:i,rounds:s,enableXOF:o}=this;return e||(e=new Da(r,n,i,o,s)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=s,e.suffix=n,e.outputLen=i,e.enableXOF=o,e.destroyed=this.destroyed,e}}const uy=((t,e,r)=>Ch(()=>new Da(e,t,r)))(1,136,256/8);class hy extends Map{constructor(e){super(),Object.defineProperty(this,"maxSize",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxSize=e}get(e){const r=super.get(e);return super.has(e)&&r!==void 0&&(this.delete(e),super.set(e,r)),r}set(e,r){if(super.set(e,r),this.maxSize&&this.size>this.maxSize){const n=this.keys().next().value;n&&this.delete(n)}return this}}function dy(t,e,r,n){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,r,n);const i=BigInt(32),s=BigInt(4294967295),o=Number(r>>i&s),a=Number(r&s),c=n?4:0,u=n?0:4;t.setUint32(e+c,o,n),t.setUint32(e+u,a,n)}function ly(t,e,r){return t&e^~t&r}function py(t,e,r){return t&e^t&r^e&r}class by extends Aa{constructor(e,r,n,i){super(),this.blockLen=e,this.outputLen=r,this.padOffset=n,this.isLE=i,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=Ia(this.buffer)}update(e){Un(this);const{view:r,buffer:n,blockLen:i}=this;e=zs(e);const s=e.length;for(let o=0;o<s;){const a=Math.min(i-this.pos,s-o);if(a===i){const c=Ia(e);for(;i<=s-o;o+=i)this.process(c,o);continue}n.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===i&&(this.process(r,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){Un(this),Rh(e,this),this.finished=!0;const{buffer:r,view:n,blockLen:i,isLE:s}=this;let{pos:o}=this;r[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>i-o&&(this.process(n,0),o=0);for(let p=o;p<i;p++)r[p]=0;dy(n,i-8,BigInt(this.length*8),s),this.process(n,0);const a=Ia(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const u=c/4,d=this.get();if(u>d.length)throw new Error("_sha2: outputLen bigger than state");for(let p=0;p<u;p++)a.setUint32(4*p,d[p],s)}digest(){const{buffer:e,outputLen:r}=this;this.digestInto(e);const n=e.slice(0,r);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:r,buffer:n,length:i,finished:s,destroyed:o,pos:a}=this;return e.length=i,e.pos=a,e.finished=s,e.destroyed=o,i%r&&e.buffer.set(n),e}}const gy=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),kr=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),jr=new Uint32Array(64);class vy extends by{constructor(){super(64,32,8,!1),this.A=kr[0]|0,this.B=kr[1]|0,this.C=kr[2]|0,this.D=kr[3]|0,this.E=kr[4]|0,this.F=kr[5]|0,this.G=kr[6]|0,this.H=kr[7]|0}get(){const{A:e,B:r,C:n,D:i,E:s,F:o,G:a,H:c}=this;return[e,r,n,i,s,o,a,c]}set(e,r,n,i,s,o,a,c){this.A=e|0,this.B=r|0,this.C=n|0,this.D=i|0,this.E=s|0,this.F=o|0,this.G=a|0,this.H=c|0}process(e,r){for(let p=0;p<16;p++,r+=4)jr[p]=e.getUint32(r,!1);for(let p=16;p<64;p++){const y=jr[p-15],_=jr[p-2],w=ur(y,7)^ur(y,18)^y>>>3,D=ur(_,17)^ur(_,19)^_>>>10;jr[p]=D+jr[p-7]+w+jr[p-16]|0}let{A:n,B:i,C:s,D:o,E:a,F:c,G:u,H:d}=this;for(let p=0;p<64;p++){const y=ur(a,6)^ur(a,11)^ur(a,25),_=d+y+ly(a,c,u)+gy[p]+jr[p]|0,D=(ur(n,2)^ur(n,13)^ur(n,22))+py(n,i,s)|0;d=u,u=c,c=a,a=o+_|0,o=s,s=i,i=n,n=_+D|0}n=n+this.A|0,i=i+this.B|0,s=s+this.C|0,o=o+this.D|0,a=a+this.E|0,c=c+this.F|0,u=u+this.G|0,d=d+this.H|0,this.set(n,i,s,o,a,c,u,d)}roundClean(){jr.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}const yy=Ch(()=>new vy);new hy(128);const my=new Uint8Array([7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8]),kh=new Uint8Array(new Array(16).fill(0).map((t,e)=>e)),wy=kh.map(t=>(9*t+5)%16);let _y=[kh],Ey=[wy];for(let t=0;t<4;t++)for(let e of[_y,Ey])e.push(e[t].map(r=>my[r]));/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Us=BigInt(0),ks=BigInt(1),xy=BigInt(2);function un(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function Ti(t){if(!un(t))throw new Error("Uint8Array expected")}function jn(t,e){if(typeof e!="boolean")throw new Error(t+" boolean expected, got "+e)}const Sy=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function qn(t){Ti(t);let e="";for(let r=0;r<t.length;r++)e+=Sy[t[r]];return e}function Hn(t){const e=t.toString(16);return e.length&1?"0"+e:e}function Oa(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return t===""?Us:BigInt("0x"+t)}const Dr={_0:48,_9:57,A:65,F:70,a:97,f:102};function jh(t){if(t>=Dr._0&&t<=Dr._9)return t-Dr._0;if(t>=Dr.A&&t<=Dr.F)return t-(Dr.A-10);if(t>=Dr.a&&t<=Dr.f)return t-(Dr.a-10)}function Kn(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);const e=t.length,r=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);const n=new Uint8Array(r);for(let i=0,s=0;i<r;i++,s+=2){const o=jh(t.charCodeAt(s)),a=jh(t.charCodeAt(s+1));if(o===void 0||a===void 0){const c=t[s]+t[s+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+s)}n[i]=o*16+a}return n}function hn(t){return Oa(qn(t))}function Ma(t){return Ti(t),Oa(qn(Uint8Array.from(t).reverse()))}function Vn(t,e){return Kn(t.toString(16).padStart(e*2,"0"))}function Ta(t,e){return Vn(t,e).reverse()}function Iy(t){return Kn(Hn(t))}function Jt(t,e,r){let n;if(typeof e=="string")try{n=Kn(e)}catch(s){throw new Error(t+" must be hex string or Uint8Array, cause: "+s)}else if(un(e))n=Uint8Array.from(e);else throw new Error(t+" must be hex string or Uint8Array");const i=n.length;if(typeof r=="number"&&i!==r)throw new Error(t+" of length "+r+" expected, got "+i);return n}function Ri(...t){let e=0;for(let n=0;n<t.length;n++){const i=t[n];Ti(i),e+=i.length}const r=new Uint8Array(e);for(let n=0,i=0;n<t.length;n++){const s=t[n];r.set(s,i),i+=s.length}return r}function Ay(t,e){if(t.length!==e.length)return!1;let r=0;for(let n=0;n<t.length;n++)r|=t[n]^e[n];return r===0}function Dy(t){if(typeof t!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(t))}const Ra=t=>typeof t=="bigint"&&Us<=t;function js(t,e,r){return Ra(t)&&Ra(e)&&Ra(r)&&e<=t&&t<r}function dn(t,e,r,n){if(!js(e,r,n))throw new Error("expected valid "+t+": "+r+" <= n < "+n+", got "+e)}function qh(t){let e;for(e=0;t>Us;t>>=ks,e+=1);return e}function Oy(t,e){return t>>BigInt(e)&ks}function My(t,e,r){return t|(r?ks:Us)<<BigInt(e)}const Ba=t=>(xy<<BigInt(t-1))-ks,Pa=t=>new Uint8Array(t),Hh=t=>Uint8Array.from(t);function Kh(t,e,r){if(typeof t!="number"||t<2)throw new Error("hashLen must be a number");if(typeof e!="number"||e<2)throw new Error("qByteLen must be a number");if(typeof r!="function")throw new Error("hmacFn must be a function");let n=Pa(t),i=Pa(t),s=0;const o=()=>{n.fill(1),i.fill(0),s=0},a=(...p)=>r(i,n,...p),c=(p=Pa())=>{i=a(Hh([0]),p),n=a(),p.length!==0&&(i=a(Hh([1]),p),n=a())},u=()=>{if(s++>=1e3)throw new Error("drbg: tried 1000 values");let p=0;const y=[];for(;p<e;){n=a();const _=n.slice();y.push(_),p+=n.length}return Ri(...y)};return(p,y)=>{o(),c(p);let _;for(;!(_=y(u()));)c();return o(),_}}const Ty={bigint:t=>typeof t=="bigint",function:t=>typeof t=="function",boolean:t=>typeof t=="boolean",string:t=>typeof t=="string",stringOrUint8Array:t=>typeof t=="string"||un(t),isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>typeof t=="function"&&Number.isSafeInteger(t.outputLen)};function Bi(t,e,r={}){const n=(i,s,o)=>{const a=Ty[s];if(typeof a!="function")throw new Error("invalid validator function");const c=t[i];if(!(o&&c===void 0)&&!a(c,t))throw new Error("param "+String(i)+" is invalid. Expected "+s+", got "+c)};for(const[i,s]of Object.entries(e))n(i,s,!1);for(const[i,s]of Object.entries(r))n(i,s,!0);return t}const Ry=()=>{throw new Error("not implemented")};function Na(t){const e=new WeakMap;return(r,...n)=>{const i=e.get(r);if(i!==void 0)return i;const s=t(r,...n);return e.set(r,s),s}}var By=Object.freeze({__proto__:null,isBytes:un,abytes:Ti,abool:jn,bytesToHex:qn,numberToHexUnpadded:Hn,hexToNumber:Oa,hexToBytes:Kn,bytesToNumberBE:hn,bytesToNumberLE:Ma,numberToBytesBE:Vn,numberToBytesLE:Ta,numberToVarBytesBE:Iy,ensureBytes:Jt,concatBytes:Ri,equalBytes:Ay,utf8ToBytes:Dy,inRange:js,aInRange:dn,bitLen:qh,bitGet:Oy,bitSet:My,bitMask:Ba,createHmacDrbg:Kh,validateObject:Bi,notImplemented:Ry,memoized:Na});const Py="0.1.1";function Ny(){return Py}class Et extends Error{constructor(e,r={}){const n=(()=>{if(r.cause instanceof Et){if(r.cause.details)return r.cause.details;if(r.cause.shortMessage)return r.cause.shortMessage}return r.cause?.message?r.cause.message:r.details})(),i=r.cause instanceof Et&&r.cause.docsPath||r.docsPath,o=`https://oxlib.sh${i??""}`,a=[e||"An error occurred.",...r.metaMessages?["",...r.metaMessages]:[],...n||i?["",n?`Details: ${n}`:void 0,i?`See: ${o}`:void 0]:[]].filter(c=>typeof c=="string").join(`
`);super(a,r.cause?{cause:r.cause}:void 0),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"cause",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"BaseError"}),Object.defineProperty(this,"version",{enumerable:!0,configurable:!0,writable:!0,value:`ox@${Ny()}`}),this.cause=r.cause,this.details=n,this.docs=o,this.docsPath=i,this.shortMessage=e}walk(e){return Vh(this,e)}}function Vh(t,e){return e?.(t)?t:t&&typeof t=="object"&&"cause"in t&&t.cause?Vh(t.cause,e):e?null:t}function Cy(t,e){if(Yh(t)>e)throw new qy({givenSize:Yh(t),maxSize:e})}const Or={zero:48,nine:57,A:65,F:70,a:97,f:102};function Wh(t){if(t>=Or.zero&&t<=Or.nine)return t-Or.zero;if(t>=Or.A&&t<=Or.F)return t-(Or.A-10);if(t>=Or.a&&t<=Or.f)return t-(Or.a-10)}function Ly(t,e={}){const{dir:r,size:n=32}=e;if(n===0)return t;if(t.length>n)throw new Hy({size:t.length,targetSize:n,type:"Bytes"});const i=new Uint8Array(n);for(let s=0;s<n;s++){const o=r==="right";i[o?s:n-s-1]=t[o?s:t.length-s-1]}return i}function Ca(t,e){if($a(t)>e)throw new Zy({givenSize:$a(t),maxSize:e})}function Gh(t,e={}){const{dir:r,size:n=32}=e;if(n===0)return t;const i=t.replace("0x","");if(i.length>n*2)throw new Jy({size:Math.ceil(i.length/2),targetSize:n,type:"Hex"});return`0x${i[r==="right"?"padEnd":"padStart"](n*2,"0")}`}const $y=new TextEncoder;function Fy(t){return t instanceof Uint8Array?t:typeof t=="string"?Uy(t):zy(t)}function zy(t){return t instanceof Uint8Array?t:new Uint8Array(t)}function Uy(t,e={}){const{size:r}=e;let n=t;r&&(Ca(t,r),n=La(t,r));let i=n.slice(2);i.length%2&&(i=`0${i}`);const s=i.length/2,o=new Uint8Array(s);for(let a=0,c=0;a<s;a++){const u=Wh(i.charCodeAt(c++)),d=Wh(i.charCodeAt(c++));if(u===void 0||d===void 0)throw new Et(`Invalid byte sequence ("${i[c-2]}${i[c-1]}" in "${i}").`);o[a]=u*16+d}return o}function ky(t,e={}){const{size:r}=e,n=$y.encode(t);return typeof r=="number"?(Cy(n,r),jy(n,r)):n}function jy(t,e){return Ly(t,{dir:"right",size:e})}function Yh(t){return t.length}class qy extends Et{constructor({givenSize:e,maxSize:r}){super(`Size cannot exceed \`${r}\` bytes. Given size: \`${e}\` bytes.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Bytes.SizeOverflowError"})}}class Hy extends Et{constructor({size:e,targetSize:r,type:n}){super(`${n.charAt(0).toUpperCase()}${n.slice(1).toLowerCase()} size (\`${e}\`) exceeds padding size (\`${r}\`).`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Bytes.SizeExceedsPaddingSizeError"})}}const Ky=new TextEncoder,Vy=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function Xh(...t){return`0x${t.reduce((e,r)=>e+r.replace("0x",""),"")}`}function Wy(t,e={}){const r=`0x${Number(t)}`;return typeof e.size=="number"?(Ca(r,e.size),qs(r,e.size)):r}function Zh(t,e={}){let r="";for(let i=0;i<t.length;i++)r+=Vy[t[i]];const n=`0x${r}`;return typeof e.size=="number"?(Ca(n,e.size),La(n,e.size)):n}function Gy(t,e={}){const{signed:r,size:n}=e,i=BigInt(t);let s;n?r?s=(1n<<BigInt(n)*8n-1n)-1n:s=2n**(BigInt(n)*8n)-1n:typeof t=="number"&&(s=BigInt(Number.MAX_SAFE_INTEGER));const o=typeof s=="bigint"&&r?-s-1n:0;if(s&&i>s||i<o){const u=typeof t=="bigint"?"n":"";throw new Xy({max:s?`${s}${u}`:void 0,min:`${o}${u}`,signed:r,size:n,value:`${t}${u}`})}const c=`0x${(r&&i<0?(1n<<BigInt(n*8))+BigInt(i):i).toString(16)}`;return n?qs(c,n):c}function Yy(t,e={}){return Zh(Ky.encode(t),e)}function qs(t,e){return Gh(t,{dir:"left",size:e})}function La(t,e){return Gh(t,{dir:"right",size:e})}function $a(t){return Math.ceil((t.length-2)/2)}class Xy extends Et{constructor({max:e,min:r,signed:n,size:i,value:s}){super(`Number \`${s}\` is not in safe${i?` ${i*8}-bit`:""}${n?" signed":" unsigned"} integer range ${e?`(\`${r}\` to \`${e}\`)`:`(above \`${r}\`)`}`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.IntegerOutOfRangeError"})}}class Zy extends Et{constructor({givenSize:e,maxSize:r}){super(`Size cannot exceed \`${r}\` bytes. Given size: \`${e}\` bytes.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.SizeOverflowError"})}}class Jy extends Et{constructor({size:e,targetSize:r,type:n}){super(`${n.charAt(0).toUpperCase()}${n.slice(1).toLowerCase()} size (\`${e}\`) exceeds padding size (\`${r}\`).`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.SizeExceedsPaddingSizeError"})}}function Qy(t,e={}){const{as:r=typeof t=="string"?"Hex":"Bytes"}=e,n=uy(Fy(t));return r==="Bytes"?n:Zh(n)}class e8 extends Map{constructor(e){super(),Object.defineProperty(this,"maxSize",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxSize=e}get(e){const r=super.get(e);return super.has(e)&&r!==void 0&&(this.delete(e),super.set(e,r)),r}set(e,r){if(super.set(e,r),this.maxSize&&this.size>this.maxSize){const n=this.keys().next().value;n&&this.delete(n)}return this}}const Fa={checksum:new e8(8192)}.checksum,t8=/^0x[a-fA-F0-9]{40}$/;function Jh(t,e={}){const{strict:r=!0}=e;if(!t8.test(t))throw new Qh({address:t,cause:new n8});if(r){if(t.toLowerCase()===t)return;if(r8(t)!==t)throw new Qh({address:t,cause:new i8})}}function r8(t){if(Fa.has(t))return Fa.get(t);Jh(t,{strict:!1});const e=t.substring(2).toLowerCase(),r=Qy(ky(e),{as:"Bytes"}),n=e.split("");for(let s=0;s<40;s+=2)r[s>>1]>>4>=8&&n[s]&&(n[s]=n[s].toUpperCase()),(r[s>>1]&15)>=8&&n[s+1]&&(n[s+1]=n[s+1].toUpperCase());const i=`0x${n.join("")}`;return Fa.set(t,i),i}class Qh extends Et{constructor({address:e,cause:r}){super(`Address "${e}" is invalid.`,{cause:r}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Address.InvalidAddressError"})}}class n8 extends Et{constructor(){super("Address is not a 20 byte (40 hexadecimal character) value."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Address.InvalidInputError"})}}class i8 extends Et{constructor(){super("Address does not match its checksum counterpart."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Address.InvalidChecksumError"})}}const s8=/^(.*)\[([0-9]*)\]$/,o8=/^bytes([1-9]|1[0-9]|2[0-9]|3[0-2])?$/,a8=/^(u?int)(8|16|24|32|40|48|56|64|72|80|88|96|104|112|120|128|136|144|152|160|168|176|184|192|200|208|216|224|232|240|248|256)?$/;function za(t,e){if(t.length!==e.length)throw new f8({expectedLength:t.length,givenLength:e.length});const r=[];for(let n=0;n<t.length;n++){const i=t[n],s=e[n];r.push(za.encode(i,s))}return Xh(...r)}(function(t){function e(r,n,i=!1){if(r==="address"){const c=n;return Jh(c),qs(c.toLowerCase(),i?32:0)}if(r==="string")return Yy(n);if(r==="bytes")return n;if(r==="bool")return qs(Wy(n),i?32:1);const s=r.match(a8);if(s){const[c,u,d="256"]=s,p=Number.parseInt(d)/8;return Gy(n,{size:i?32:p,signed:u==="int"})}const o=r.match(o8);if(o){const[c,u]=o;if(Number.parseInt(u)!==(n.length-2)/2)throw new c8({expectedSize:Number.parseInt(u),value:n});return La(n,i?32:0)}const a=r.match(s8);if(a&&Array.isArray(n)){const[c,u]=a,d=[];for(let p=0;p<n.length;p++)d.push(e(u,n[p],!0));return d.length===0?"0x":Xh(...d)}throw new u8(r)}t.encode=e})(za||(za={}));class c8 extends Et{constructor({expectedSize:e,value:r}){super(`Size of bytes "${r}" (bytes${$a(r)}) does not match expected size (bytes${e}).`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"AbiParameters.BytesSizeMismatchError"})}}class f8 extends Et{constructor({expectedLength:e,givenLength:r}){super(["ABI encoding parameters/values length mismatch.",`Expected length (parameters): ${e}`,`Given length (values): ${r}`].join(`
`)),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"AbiParameters.LengthMismatchError"})}}class u8 extends Et{constructor(e){super(`Type \`${e}\` is not a valid ABI Type.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"AbiParameters.InvalidTypeError"})}}class ed extends Aa{constructor(e,r){super(),this.finished=!1,this.destroyed=!1,H3(e);const n=zs(r);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const i=this.blockLen,s=new Uint8Array(i);s.set(n.length>i?e.create().update(n).digest():n);for(let o=0;o<s.length;o++)s[o]^=54;this.iHash.update(s),this.oHash=e.create();for(let o=0;o<s.length;o++)s[o]^=106;this.oHash.update(s),s.fill(0)}update(e){return Un(this),this.iHash.update(e),this}digestInto(e){Un(this),Oi(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:r,iHash:n,finished:i,destroyed:s,blockLen:o,outputLen:a}=this;return e=e,e.finished=i,e.destroyed=s,e.blockLen=o,e.outputLen=a,e.oHash=r._cloneInto(e.oHash),e.iHash=n._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const td=(t,e,r)=>new ed(t,e).update(r).digest();td.create=(t,e)=>new ed(t,e);const rt=BigInt(0),Xe=BigInt(1),ln=BigInt(2),h8=BigInt(3),Ua=BigInt(4),rd=BigInt(5),nd=BigInt(8);function Mt(t,e){const r=t%e;return r>=rt?r:e+r}function d8(t,e,r){if(e<rt)throw new Error("invalid exponent, negatives unsupported");if(r<=rt)throw new Error("invalid modulus");if(r===Xe)return rt;let n=Xe;for(;e>rt;)e&Xe&&(n=n*t%r),t=t*t%r,e>>=Xe;return n}function qt(t,e,r){let n=t;for(;e-- >rt;)n*=n,n%=r;return n}function ka(t,e){if(t===rt)throw new Error("invert: expected non-zero number");if(e<=rt)throw new Error("invert: expected positive modulus, got "+e);let r=Mt(t,e),n=e,i=rt,s=Xe;for(;r!==rt;){const a=n/r,c=n%r,u=i-s*a;n=r,r=c,i=s,s=u}if(n!==Xe)throw new Error("invert: does not exist");return Mt(i,e)}function l8(t){const e=(t-Xe)/ln;let r,n,i;for(r=t-Xe,n=0;r%ln===rt;r/=ln,n++);for(i=ln;i<t&&d8(i,e,t)!==t-Xe;i++)if(i>1e3)throw new Error("Cannot find square root: likely non-prime P");if(n===1){const o=(t+Xe)/Ua;return function(c,u){const d=c.pow(u,o);if(!c.eql(c.sqr(d),u))throw new Error("Cannot find square root");return d}}const s=(r+Xe)/ln;return function(a,c){if(a.pow(c,e)===a.neg(a.ONE))throw new Error("Cannot find square root");let u=n,d=a.pow(a.mul(a.ONE,i),r),p=a.pow(c,s),y=a.pow(c,r);for(;!a.eql(y,a.ONE);){if(a.eql(y,a.ZERO))return a.ZERO;let _=1;for(let D=a.sqr(y);_<u&&!a.eql(D,a.ONE);_++)D=a.sqr(D);const w=a.pow(d,Xe<<BigInt(u-_-1));d=a.sqr(w),p=a.mul(p,w),y=a.mul(y,d),u=_}return p}}function p8(t){if(t%Ua===h8){const e=(t+Xe)/Ua;return function(n,i){const s=n.pow(i,e);if(!n.eql(n.sqr(s),i))throw new Error("Cannot find square root");return s}}if(t%nd===rd){const e=(t-rd)/nd;return function(n,i){const s=n.mul(i,ln),o=n.pow(s,e),a=n.mul(i,o),c=n.mul(n.mul(a,ln),o),u=n.mul(a,n.sub(c,n.ONE));if(!n.eql(n.sqr(u),i))throw new Error("Cannot find square root");return u}}return l8(t)}const b8=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function g8(t){const e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},r=b8.reduce((n,i)=>(n[i]="function",n),e);return Bi(t,r)}function v8(t,e,r){if(r<rt)throw new Error("invalid exponent, negatives unsupported");if(r===rt)return t.ONE;if(r===Xe)return e;let n=t.ONE,i=e;for(;r>rt;)r&Xe&&(n=t.mul(n,i)),i=t.sqr(i),r>>=Xe;return n}function y8(t,e){const r=new Array(e.length),n=e.reduce((s,o,a)=>t.is0(o)?s:(r[a]=s,t.mul(s,o)),t.ONE),i=t.inv(n);return e.reduceRight((s,o,a)=>t.is0(o)?s:(r[a]=t.mul(s,r[a]),t.mul(s,o)),i),r}function id(t,e){const r=e!==void 0?e:t.toString(2).length,n=Math.ceil(r/8);return{nBitLength:r,nByteLength:n}}function sd(t,e,r=!1,n={}){if(t<=rt)throw new Error("invalid field: expected ORDER > 0, got "+t);const{nBitLength:i,nByteLength:s}=id(t,e);if(s>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let o;const a=Object.freeze({ORDER:t,isLE:r,BITS:i,BYTES:s,MASK:Ba(i),ZERO:rt,ONE:Xe,create:c=>Mt(c,t),isValid:c=>{if(typeof c!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof c);return rt<=c&&c<t},is0:c=>c===rt,isOdd:c=>(c&Xe)===Xe,neg:c=>Mt(-c,t),eql:(c,u)=>c===u,sqr:c=>Mt(c*c,t),add:(c,u)=>Mt(c+u,t),sub:(c,u)=>Mt(c-u,t),mul:(c,u)=>Mt(c*u,t),pow:(c,u)=>v8(a,c,u),div:(c,u)=>Mt(c*ka(u,t),t),sqrN:c=>c*c,addN:(c,u)=>c+u,subN:(c,u)=>c-u,mulN:(c,u)=>c*u,inv:c=>ka(c,t),sqrt:n.sqrt||(c=>(o||(o=p8(t)),o(a,c))),invertBatch:c=>y8(a,c),cmov:(c,u,d)=>d?u:c,toBytes:c=>r?Ta(c,s):Vn(c,s),fromBytes:c=>{if(c.length!==s)throw new Error("Field.fromBytes: expected "+s+" bytes, got "+c.length);return r?Ma(c):hn(c)}});return Object.freeze(a)}function od(t){if(typeof t!="bigint")throw new Error("field order must be bigint");const e=t.toString(2).length;return Math.ceil(e/8)}function ad(t){const e=od(t);return e+Math.ceil(e/2)}function m8(t,e,r=!1){const n=t.length,i=od(e),s=ad(e);if(n<16||n<s||n>1024)throw new Error("expected "+s+"-1024 bytes of input, got "+n);const o=r?Ma(t):hn(t),a=Mt(o,e-Xe)+Xe;return r?Ta(a,i):Vn(a,i)}const cd=BigInt(0),Hs=BigInt(1);function ja(t,e){const r=e.negate();return t?r:e}function fd(t,e){if(!Number.isSafeInteger(t)||t<=0||t>e)throw new Error("invalid window size, expected [1.."+e+"], got W="+t)}function qa(t,e){fd(t,e);const r=Math.ceil(e/t)+1,n=2**(t-1);return{windows:r,windowSize:n}}function w8(t,e){if(!Array.isArray(t))throw new Error("array expected");t.forEach((r,n)=>{if(!(r instanceof e))throw new Error("invalid point at index "+n)})}function _8(t,e){if(!Array.isArray(t))throw new Error("array of scalars expected");t.forEach((r,n)=>{if(!e.isValid(r))throw new Error("invalid scalar at index "+n)})}const Ha=new WeakMap,ud=new WeakMap;function Ka(t){return ud.get(t)||1}function E8(t,e){return{constTimeNegate:ja,hasPrecomputes(r){return Ka(r)!==1},unsafeLadder(r,n,i=t.ZERO){let s=r;for(;n>cd;)n&Hs&&(i=i.add(s)),s=s.double(),n>>=Hs;return i},precomputeWindow(r,n){const{windows:i,windowSize:s}=qa(n,e),o=[];let a=r,c=a;for(let u=0;u<i;u++){c=a,o.push(c);for(let d=1;d<s;d++)c=c.add(a),o.push(c);a=c.double()}return o},wNAF(r,n,i){const{windows:s,windowSize:o}=qa(r,e);let a=t.ZERO,c=t.BASE;const u=BigInt(2**r-1),d=2**r,p=BigInt(r);for(let y=0;y<s;y++){const _=y*o;let w=Number(i&u);i>>=p,w>o&&(w-=d,i+=Hs);const D=_,O=_+Math.abs(w)-1,M=y%2!==0,T=w<0;w===0?c=c.add(ja(M,n[D])):a=a.add(ja(T,n[O]))}return{p:a,f:c}},wNAFUnsafe(r,n,i,s=t.ZERO){const{windows:o,windowSize:a}=qa(r,e),c=BigInt(2**r-1),u=2**r,d=BigInt(r);for(let p=0;p<o;p++){const y=p*a;if(i===cd)break;let _=Number(i&c);if(i>>=d,_>a&&(_-=u,i+=Hs),_===0)continue;let w=n[y+Math.abs(_)-1];_<0&&(w=w.negate()),s=s.add(w)}return s},getPrecomputes(r,n,i){let s=Ha.get(n);return s||(s=this.precomputeWindow(n,r),r!==1&&Ha.set(n,i(s))),s},wNAFCached(r,n,i){const s=Ka(r);return this.wNAF(s,this.getPrecomputes(s,r,i),n)},wNAFCachedUnsafe(r,n,i,s){const o=Ka(r);return o===1?this.unsafeLadder(r,n,s):this.wNAFUnsafe(o,this.getPrecomputes(o,r,i),n,s)},setWindowSize(r,n){fd(n,e),ud.set(r,n),Ha.delete(r)}}}function x8(t,e,r,n){if(w8(r,t),_8(n,e),r.length!==n.length)throw new Error("arrays of points and scalars must have equal length");const i=t.ZERO,s=qh(BigInt(r.length)),o=s>12?s-3:s>4?s-2:s?2:1,a=(1<<o)-1,c=new Array(a+1).fill(i),u=Math.floor((e.BITS-1)/o)*o;let d=i;for(let p=u;p>=0;p-=o){c.fill(i);for(let _=0;_<n.length;_++){const w=n[_],D=Number(w>>BigInt(p)&BigInt(a));c[D]=c[D].add(r[_])}let y=i;for(let _=c.length-1,w=i;_>0;_--)w=w.add(c[_]),y=y.add(w);if(d=d.add(y),p!==0)for(let _=0;_<o;_++)d=d.double()}return d}function hd(t){return g8(t.Fp),Bi(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...id(t.n,t.nBitLength),...t,p:t.Fp.ORDER})}function dd(t){t.lowS!==void 0&&jn("lowS",t.lowS),t.prehash!==void 0&&jn("prehash",t.prehash)}function S8(t){const e=hd(t);Bi(e,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:r,Fp:n,a:i}=e;if(r){if(!n.eql(i,n.ZERO))throw new Error("invalid endomorphism, can only be defined for Koblitz curves that have a=0");if(typeof r!="object"||typeof r.beta!="bigint"||typeof r.splitScalar!="function")throw new Error("invalid endomorphism, expected beta: bigint and splitScalar: function")}return Object.freeze({...e})}const{bytesToNumberBE:I8,hexToBytes:A8}=By;class D8 extends Error{constructor(e=""){super(e)}}const Mr={Err:D8,_tlv:{encode:(t,e)=>{const{Err:r}=Mr;if(t<0||t>256)throw new r("tlv.encode: wrong tag");if(e.length&1)throw new r("tlv.encode: unpadded data");const n=e.length/2,i=Hn(n);if(i.length/2&128)throw new r("tlv.encode: long form length too big");const s=n>127?Hn(i.length/2|128):"";return Hn(t)+s+i+e},decode(t,e){const{Err:r}=Mr;let n=0;if(t<0||t>256)throw new r("tlv.encode: wrong tag");if(e.length<2||e[n++]!==t)throw new r("tlv.decode: wrong tlv");const i=e[n++],s=!!(i&128);let o=0;if(!s)o=i;else{const c=i&127;if(!c)throw new r("tlv.decode(long): indefinite length not supported");if(c>4)throw new r("tlv.decode(long): byte length is too big");const u=e.subarray(n,n+c);if(u.length!==c)throw new r("tlv.decode: length bytes not complete");if(u[0]===0)throw new r("tlv.decode(long): zero leftmost byte");for(const d of u)o=o<<8|d;if(n+=c,o<128)throw new r("tlv.decode(long): not minimal encoding")}const a=e.subarray(n,n+o);if(a.length!==o)throw new r("tlv.decode: wrong value length");return{v:a,l:e.subarray(n+o)}}},_int:{encode(t){const{Err:e}=Mr;if(t<Tr)throw new e("integer: negative integers are not allowed");let r=Hn(t);if(Number.parseInt(r[0],16)&8&&(r="00"+r),r.length&1)throw new e("unexpected DER parsing assertion: unpadded hex");return r},decode(t){const{Err:e}=Mr;if(t[0]&128)throw new e("invalid signature integer: negative");if(t[0]===0&&!(t[1]&128))throw new e("invalid signature integer: unnecessary leading zero");return I8(t)}},toSig(t){const{Err:e,_int:r,_tlv:n}=Mr,i=typeof t=="string"?A8(t):t;Ti(i);const{v:s,l:o}=n.decode(48,i);if(o.length)throw new e("invalid signature: left bytes after parsing");const{v:a,l:c}=n.decode(2,s),{v:u,l:d}=n.decode(2,c);if(d.length)throw new e("invalid signature: left bytes after parsing");return{r:r.decode(a),s:r.decode(u)}},hexFromSig(t){const{_tlv:e,_int:r}=Mr,n=e.encode(2,r.encode(t.r)),i=e.encode(2,r.encode(t.s)),s=n+i;return e.encode(48,s)}},Tr=BigInt(0),nt=BigInt(1);BigInt(2);const ld=BigInt(3);BigInt(4);function O8(t){const e=S8(t),{Fp:r}=e,n=sd(e.n,e.nBitLength),i=e.toBytes||((D,O,M)=>{const T=O.toAffine();return Ri(Uint8Array.from([4]),r.toBytes(T.x),r.toBytes(T.y))}),s=e.fromBytes||(D=>{const O=D.subarray(1),M=r.fromBytes(O.subarray(0,r.BYTES)),T=r.fromBytes(O.subarray(r.BYTES,2*r.BYTES));return{x:M,y:T}});function o(D){const{a:O,b:M}=e,T=r.sqr(D),B=r.mul(T,D);return r.add(r.add(B,r.mul(D,O)),M)}if(!r.eql(r.sqr(e.Gy),o(e.Gx)))throw new Error("bad generator point: equation left != right");function a(D){return js(D,nt,e.n)}function c(D){const{allowedPrivateKeyLengths:O,nByteLength:M,wrapPrivateKey:T,n:B}=e;if(O&&typeof D!="bigint"){if(un(D)&&(D=qn(D)),typeof D!="string"||!O.includes(D.length))throw new Error("invalid private key");D=D.padStart(M*2,"0")}let P;try{P=typeof D=="bigint"?D:hn(Jt("private key",D,M))}catch{throw new Error("invalid private key, expected hex or "+M+" bytes, got "+typeof D)}return T&&(P=Mt(P,B)),dn("private key",P,nt,B),P}function u(D){if(!(D instanceof y))throw new Error("ProjectivePoint expected")}const d=Na((D,O)=>{const{px:M,py:T,pz:B}=D;if(r.eql(B,r.ONE))return{x:M,y:T};const P=D.is0();O==null&&(O=P?r.ONE:r.inv(B));const j=r.mul(M,O),$=r.mul(T,O),L=r.mul(B,O);if(P)return{x:r.ZERO,y:r.ZERO};if(!r.eql(L,r.ONE))throw new Error("invZ was invalid");return{x:j,y:$}}),p=Na(D=>{if(D.is0()){if(e.allowInfinityPoint&&!r.is0(D.py))return;throw new Error("bad point: ZERO")}const{x:O,y:M}=D.toAffine();if(!r.isValid(O)||!r.isValid(M))throw new Error("bad point: x or y not FE");const T=r.sqr(M),B=o(O);if(!r.eql(T,B))throw new Error("bad point: equation left != right");if(!D.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});class y{constructor(O,M,T){if(this.px=O,this.py=M,this.pz=T,O==null||!r.isValid(O))throw new Error("x required");if(M==null||!r.isValid(M))throw new Error("y required");if(T==null||!r.isValid(T))throw new Error("z required");Object.freeze(this)}static fromAffine(O){const{x:M,y:T}=O||{};if(!O||!r.isValid(M)||!r.isValid(T))throw new Error("invalid affine point");if(O instanceof y)throw new Error("projective point not allowed");const B=P=>r.eql(P,r.ZERO);return B(M)&&B(T)?y.ZERO:new y(M,T,r.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(O){const M=r.invertBatch(O.map(T=>T.pz));return O.map((T,B)=>T.toAffine(M[B])).map(y.fromAffine)}static fromHex(O){const M=y.fromAffine(s(Jt("pointHex",O)));return M.assertValidity(),M}static fromPrivateKey(O){return y.BASE.multiply(c(O))}static msm(O,M){return x8(y,n,O,M)}_setWindowSize(O){w.setWindowSize(this,O)}assertValidity(){p(this)}hasEvenY(){const{y:O}=this.toAffine();if(r.isOdd)return!r.isOdd(O);throw new Error("Field doesn't support isOdd")}equals(O){u(O);const{px:M,py:T,pz:B}=this,{px:P,py:j,pz:$}=O,L=r.eql(r.mul(M,$),r.mul(P,B)),z=r.eql(r.mul(T,$),r.mul(j,B));return L&&z}negate(){return new y(this.px,r.neg(this.py),this.pz)}double(){const{a:O,b:M}=e,T=r.mul(M,ld),{px:B,py:P,pz:j}=this;let $=r.ZERO,L=r.ZERO,z=r.ZERO,N=r.mul(B,B),K=r.mul(P,P),S=r.mul(j,j),f=r.mul(B,P);return f=r.add(f,f),z=r.mul(B,j),z=r.add(z,z),$=r.mul(O,z),L=r.mul(T,S),L=r.add($,L),$=r.sub(K,L),L=r.add(K,L),L=r.mul($,L),$=r.mul(f,$),z=r.mul(T,z),S=r.mul(O,S),f=r.sub(N,S),f=r.mul(O,f),f=r.add(f,z),z=r.add(N,N),N=r.add(z,N),N=r.add(N,S),N=r.mul(N,f),L=r.add(L,N),S=r.mul(P,j),S=r.add(S,S),N=r.mul(S,f),$=r.sub($,N),z=r.mul(S,K),z=r.add(z,z),z=r.add(z,z),new y($,L,z)}add(O){u(O);const{px:M,py:T,pz:B}=this,{px:P,py:j,pz:$}=O;let L=r.ZERO,z=r.ZERO,N=r.ZERO;const K=e.a,S=r.mul(e.b,ld);let f=r.mul(M,P),l=r.mul(T,j),g=r.mul(B,$),b=r.add(M,T),v=r.add(P,j);b=r.mul(b,v),v=r.add(f,l),b=r.sub(b,v),v=r.add(M,B);let x=r.add(P,$);return v=r.mul(v,x),x=r.add(f,g),v=r.sub(v,x),x=r.add(T,B),L=r.add(j,$),x=r.mul(x,L),L=r.add(l,g),x=r.sub(x,L),N=r.mul(K,v),L=r.mul(S,g),N=r.add(L,N),L=r.sub(l,N),N=r.add(l,N),z=r.mul(L,N),l=r.add(f,f),l=r.add(l,f),g=r.mul(K,g),v=r.mul(S,v),l=r.add(l,g),g=r.sub(f,g),g=r.mul(K,g),v=r.add(v,g),f=r.mul(l,v),z=r.add(z,f),f=r.mul(x,v),L=r.mul(b,L),L=r.sub(L,f),f=r.mul(b,l),N=r.mul(x,N),N=r.add(N,f),new y(L,z,N)}subtract(O){return this.add(O.negate())}is0(){return this.equals(y.ZERO)}wNAF(O){return w.wNAFCached(this,O,y.normalizeZ)}multiplyUnsafe(O){const{endo:M,n:T}=e;dn("scalar",O,Tr,T);const B=y.ZERO;if(O===Tr)return B;if(this.is0()||O===nt)return this;if(!M||w.hasPrecomputes(this))return w.wNAFCachedUnsafe(this,O,y.normalizeZ);let{k1neg:P,k1:j,k2neg:$,k2:L}=M.splitScalar(O),z=B,N=B,K=this;for(;j>Tr||L>Tr;)j&nt&&(z=z.add(K)),L&nt&&(N=N.add(K)),K=K.double(),j>>=nt,L>>=nt;return P&&(z=z.negate()),$&&(N=N.negate()),N=new y(r.mul(N.px,M.beta),N.py,N.pz),z.add(N)}multiply(O){const{endo:M,n:T}=e;dn("scalar",O,nt,T);let B,P;if(M){const{k1neg:j,k1:$,k2neg:L,k2:z}=M.splitScalar(O);let{p:N,f:K}=this.wNAF($),{p:S,f}=this.wNAF(z);N=w.constTimeNegate(j,N),S=w.constTimeNegate(L,S),S=new y(r.mul(S.px,M.beta),S.py,S.pz),B=N.add(S),P=K.add(f)}else{const{p:j,f:$}=this.wNAF(O);B=j,P=$}return y.normalizeZ([B,P])[0]}multiplyAndAddUnsafe(O,M,T){const B=y.BASE,P=($,L)=>L===Tr||L===nt||!$.equals(B)?$.multiplyUnsafe(L):$.multiply(L),j=P(this,M).add(P(O,T));return j.is0()?void 0:j}toAffine(O){return d(this,O)}isTorsionFree(){const{h:O,isTorsionFree:M}=e;if(O===nt)return!0;if(M)return M(y,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:O,clearCofactor:M}=e;return O===nt?this:M?M(y,this):this.multiplyUnsafe(e.h)}toRawBytes(O=!0){return jn("isCompressed",O),this.assertValidity(),i(y,this,O)}toHex(O=!0){return jn("isCompressed",O),qn(this.toRawBytes(O))}}y.BASE=new y(e.Gx,e.Gy,r.ONE),y.ZERO=new y(r.ZERO,r.ONE,r.ZERO);const _=e.nBitLength,w=E8(y,e.endo?Math.ceil(_/2):_);return{CURVE:e,ProjectivePoint:y,normPrivateKeyToScalar:c,weierstrassEquation:o,isWithinCurveOrder:a}}function M8(t){const e=hd(t);return Bi(e,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...e})}function T8(t){const e=M8(t),{Fp:r,n}=e,i=r.BYTES+1,s=2*r.BYTES+1;function o(g){return Mt(g,n)}function a(g){return ka(g,n)}const{ProjectivePoint:c,normPrivateKeyToScalar:u,weierstrassEquation:d,isWithinCurveOrder:p}=O8({...e,toBytes(g,b,v){const x=b.toAffine(),I=r.toBytes(x.x),m=Ri;return jn("isCompressed",v),v?m(Uint8Array.from([b.hasEvenY()?2:3]),I):m(Uint8Array.from([4]),I,r.toBytes(x.y))},fromBytes(g){const b=g.length,v=g[0],x=g.subarray(1);if(b===i&&(v===2||v===3)){const I=hn(x);if(!js(I,nt,r.ORDER))throw new Error("Point is not on curve");const m=d(I);let h;try{h=r.sqrt(m)}catch(F){const k=F instanceof Error?": "+F.message:"";throw new Error("Point is not on curve"+k)}const E=(h&nt)===nt;return(v&1)===1!==E&&(h=r.neg(h)),{x:I,y:h}}else if(b===s&&v===4){const I=r.fromBytes(x.subarray(0,r.BYTES)),m=r.fromBytes(x.subarray(r.BYTES,2*r.BYTES));return{x:I,y:m}}else{const I=i,m=s;throw new Error("invalid Point, expected length of "+I+", or uncompressed "+m+", got "+b)}}}),y=g=>qn(Vn(g,e.nByteLength));function _(g){const b=n>>nt;return g>b}function w(g){return _(g)?o(-g):g}const D=(g,b,v)=>hn(g.slice(b,v));class O{constructor(b,v,x){this.r=b,this.s=v,this.recovery=x,this.assertValidity()}static fromCompact(b){const v=e.nByteLength;return b=Jt("compactSignature",b,v*2),new O(D(b,0,v),D(b,v,2*v))}static fromDER(b){const{r:v,s:x}=Mr.toSig(Jt("DER",b));return new O(v,x)}assertValidity(){dn("r",this.r,nt,n),dn("s",this.s,nt,n)}addRecoveryBit(b){return new O(this.r,this.s,b)}recoverPublicKey(b){const{r:v,s:x,recovery:I}=this,m=$(Jt("msgHash",b));if(I==null||![0,1,2,3].includes(I))throw new Error("recovery id invalid");const h=I===2||I===3?v+e.n:v;if(h>=r.ORDER)throw new Error("recovery id 2 or 3 invalid");const E=(I&1)===0?"02":"03",C=c.fromHex(E+y(h)),F=a(h),k=o(-m*F),q=o(x*F),W=c.BASE.multiplyAndAddUnsafe(C,k,q);if(!W)throw new Error("point at infinify");return W.assertValidity(),W}hasHighS(){return _(this.s)}normalizeS(){return this.hasHighS()?new O(this.r,o(-this.s),this.recovery):this}toDERRawBytes(){return Kn(this.toDERHex())}toDERHex(){return Mr.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return Kn(this.toCompactHex())}toCompactHex(){return y(this.r)+y(this.s)}}const M={isValidPrivateKey(g){try{return u(g),!0}catch{return!1}},normPrivateKeyToScalar:u,randomPrivateKey:()=>{const g=ad(e.n);return m8(e.randomBytes(g),e.n)},precompute(g=8,b=c.BASE){return b._setWindowSize(g),b.multiply(BigInt(3)),b}};function T(g,b=!0){return c.fromPrivateKey(g).toRawBytes(b)}function B(g){const b=un(g),v=typeof g=="string",x=(b||v)&&g.length;return b?x===i||x===s:v?x===2*i||x===2*s:g instanceof c}function P(g,b,v=!0){if(B(g))throw new Error("first arg must be private key");if(!B(b))throw new Error("second arg must be public key");return c.fromHex(b).multiply(u(g)).toRawBytes(v)}const j=e.bits2int||function(g){if(g.length>8192)throw new Error("input is too large");const b=hn(g),v=g.length*8-e.nBitLength;return v>0?b>>BigInt(v):b},$=e.bits2int_modN||function(g){return o(j(g))},L=Ba(e.nBitLength);function z(g){return dn("num < 2^"+e.nBitLength,g,Tr,L),Vn(g,e.nByteLength)}function N(g,b,v=K){if(["recovered","canonical"].some(Z=>Z in v))throw new Error("sign() legacy options not supported");const{hash:x,randomBytes:I}=e;let{lowS:m,prehash:h,extraEntropy:E}=v;m==null&&(m=!0),g=Jt("msgHash",g),dd(v),h&&(g=Jt("prehashed msgHash",x(g)));const C=$(g),F=u(b),k=[z(F),z(C)];if(E!=null&&E!==!1){const Z=E===!0?I(r.BYTES):E;k.push(Jt("extraEntropy",Z))}const q=Ri(...k),W=C;function X(Z){const Y=j(Z);if(!p(Y))return;const ee=a(Y),Qe=c.BASE.multiply(Y).toAffine(),te=o(Qe.x);if(te===Tr)return;const ae=o(ee*o(W+te*F));if(ae===Tr)return;let St=(Qe.x===te?0:2)|Number(Qe.y&nt),de=ae;return m&&_(ae)&&(de=w(ae),St^=1),new O(te,de,St)}return{seed:q,k2sig:X}}const K={lowS:e.lowS,prehash:!1},S={lowS:e.lowS,prehash:!1};function f(g,b,v=K){const{seed:x,k2sig:I}=N(g,b,v),m=e;return Kh(m.hash.outputLen,m.nByteLength,m.hmac)(x,I)}c.BASE._setWindowSize(8);function l(g,b,v,x=S){const I=g;b=Jt("msgHash",b),v=Jt("publicKey",v);const{lowS:m,prehash:h,format:E}=x;if(dd(x),"strict"in x)throw new Error("options.strict was renamed to lowS");if(E!==void 0&&E!=="compact"&&E!=="der")throw new Error("format must be compact or der");const C=typeof I=="string"||un(I),F=!C&&!E&&typeof I=="object"&&I!==null&&typeof I.r=="bigint"&&typeof I.s=="bigint";if(!C&&!F)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");let k,q;try{if(F&&(k=new O(I.r,I.s)),C){try{E!=="compact"&&(k=O.fromDER(I))}catch(St){if(!(St instanceof Mr.Err))throw St}!k&&E!=="der"&&(k=O.fromCompact(I))}q=c.fromHex(v)}catch{return!1}if(!k||m&&k.hasHighS())return!1;h&&(b=e.hash(b));const{r:W,s:X}=k,Z=$(b),Y=a(X),ee=o(Z*Y),Qe=o(W*Y),te=c.BASE.multiplyAndAddUnsafe(q,ee,Qe)?.toAffine();return te?o(te.x)===W:!1}return{CURVE:e,getPublicKey:T,getSharedSecret:P,sign:f,verify:l,ProjectivePoint:c,Signature:O,utils:M}}function R8(t){return{hash:t,hmac:(e,...r)=>td(t,e,ey(...r)),randomBytes:ty}}function B8(t,e){const r=n=>T8({...t,...R8(n)});return{...r(e),create:r}}const pd=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),bd=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),P8=BigInt(1),Va=BigInt(2),gd=(t,e)=>(t+e/Va)/e;function N8(t){const e=pd,r=BigInt(3),n=BigInt(6),i=BigInt(11),s=BigInt(22),o=BigInt(23),a=BigInt(44),c=BigInt(88),u=t*t*t%e,d=u*u*t%e,p=qt(d,r,e)*d%e,y=qt(p,r,e)*d%e,_=qt(y,Va,e)*u%e,w=qt(_,i,e)*_%e,D=qt(w,s,e)*w%e,O=qt(D,a,e)*D%e,M=qt(O,c,e)*O%e,T=qt(M,a,e)*D%e,B=qt(T,r,e)*d%e,P=qt(B,o,e)*w%e,j=qt(P,n,e)*u%e,$=qt(j,Va,e);if(!Wa.eql(Wa.sqr($),t))throw new Error("Cannot find square root");return $}const Wa=sd(pd,void 0,void 0,{sqrt:N8});B8({a:BigInt(0),b:BigInt(7),Fp:Wa,n:bd,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:t=>{const e=bd,r=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-P8*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),i=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),s=r,o=BigInt("0x100000000000000000000000000000000"),a=gd(s*t,e),c=gd(-n*t,e);let u=Mt(t-a*r-c*i,e),d=Mt(-a*n-c*s,e);const p=u>o,y=d>o;if(p&&(u=e-u),y&&(d=e-d),u>o||d>o)throw new Error("splitScalar: Endomorphism failed, k="+t);return{k1neg:p,k1:u,k2neg:y,k2:d}}}},yy),BigInt(0);function Ga(t,e){e||(e=t.reduce((i,s)=>i+s.length,0));const r=wh(e);let n=0;for(const i of t)r.set(i,n),n+=i.length;return r}function xt(t,e="utf8"){const r=xh[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8"):r.encoder.encode(t).substring(1)}var vd={},C8="elliptic",L8="6.6.1",$8="EC cryptography",F8="lib/elliptic.js",z8=["lib"],U8={lint:"eslint lib test","lint:fix":"npm run lint -- --fix",unit:"istanbul test _mocha --reporter=spec test/index.js",test:"npm run lint && npm run unit",version:"grunt dist && git add dist/"},k8={type:"git",url:"git@github.com:indutny/elliptic"},j8=["EC","Elliptic","curve","Cryptography"],q8="Fedor Indutny <fedor@indutny.com>",H8="MIT",K8={url:"https://github.com/indutny/elliptic/issues"},V8="https://github.com/indutny/elliptic",W8={brfs:"^2.0.2",coveralls:"^3.1.0",eslint:"^7.6.0",grunt:"^1.2.1","grunt-browserify":"^5.3.0","grunt-cli":"^1.3.2","grunt-contrib-connect":"^3.0.0","grunt-contrib-copy":"^1.0.0","grunt-contrib-uglify":"^5.0.0","grunt-mocha-istanbul":"^5.0.2","grunt-saucelabs":"^9.0.1",istanbul:"^0.4.5",mocha:"^8.0.1"},G8={"bn.js":"^4.11.9",brorand:"^1.1.0","hash.js":"^1.0.0","hmac-drbg":"^1.0.1",inherits:"^2.0.4","minimalistic-assert":"^1.0.1","minimalistic-crypto-utils":"^1.0.1"},Y8={name:C8,version:L8,description:$8,main:F8,files:z8,scripts:U8,repository:k8,keywords:j8,author:q8,license:H8,bugs:K8,homepage:V8,devDependencies:W8,dependencies:G8},Lt={},hr={exports:{}},X8={},Z8=Object.freeze({__proto__:null,default:X8}),yd=Bo(Z8);(function(t){(function(e,r){function n(S,f){if(!S)throw new Error(f||"Assertion failed")}function i(S,f){S.super_=f;var l=function(){};l.prototype=f.prototype,S.prototype=new l,S.prototype.constructor=S}function s(S,f,l){if(s.isBN(S))return S;this.negative=0,this.words=null,this.length=0,this.red=null,S!==null&&((f==="le"||f==="be")&&(l=f,f=10),this._init(S||0,f||10,l||"be"))}typeof e=="object"?e.exports=s:r.BN=s,s.BN=s,s.wordSize=26;var o;try{typeof window<"u"&&typeof window.Buffer<"u"?o=window.Buffer:o=yd.Buffer}catch{}s.isBN=function(f){return f instanceof s?!0:f!==null&&typeof f=="object"&&f.constructor.wordSize===s.wordSize&&Array.isArray(f.words)},s.max=function(f,l){return f.cmp(l)>0?f:l},s.min=function(f,l){return f.cmp(l)<0?f:l},s.prototype._init=function(f,l,g){if(typeof f=="number")return this._initNumber(f,l,g);if(typeof f=="object")return this._initArray(f,l,g);l==="hex"&&(l=16),n(l===(l|0)&&l>=2&&l<=36),f=f.toString().replace(/\s+/g,"");var b=0;f[0]==="-"&&(b++,this.negative=1),b<f.length&&(l===16?this._parseHex(f,b,g):(this._parseBase(f,l,b),g==="le"&&this._initArray(this.toArray(),l,g)))},s.prototype._initNumber=function(f,l,g){f<0&&(this.negative=1,f=-f),f<67108864?(this.words=[f&67108863],this.length=1):f<4503599627370496?(this.words=[f&67108863,f/67108864&67108863],this.length=2):(n(f<9007199254740992),this.words=[f&67108863,f/67108864&67108863,1],this.length=3),g==="le"&&this._initArray(this.toArray(),l,g)},s.prototype._initArray=function(f,l,g){if(n(typeof f.length=="number"),f.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(f.length/3),this.words=new Array(this.length);for(var b=0;b<this.length;b++)this.words[b]=0;var v,x,I=0;if(g==="be")for(b=f.length-1,v=0;b>=0;b-=3)x=f[b]|f[b-1]<<8|f[b-2]<<16,this.words[v]|=x<<I&67108863,this.words[v+1]=x>>>26-I&67108863,I+=24,I>=26&&(I-=26,v++);else if(g==="le")for(b=0,v=0;b<f.length;b+=3)x=f[b]|f[b+1]<<8|f[b+2]<<16,this.words[v]|=x<<I&67108863,this.words[v+1]=x>>>26-I&67108863,I+=24,I>=26&&(I-=26,v++);return this.strip()};function a(S,f){var l=S.charCodeAt(f);return l>=65&&l<=70?l-55:l>=97&&l<=102?l-87:l-48&15}function c(S,f,l){var g=a(S,l);return l-1>=f&&(g|=a(S,l-1)<<4),g}s.prototype._parseHex=function(f,l,g){this.length=Math.ceil((f.length-l)/6),this.words=new Array(this.length);for(var b=0;b<this.length;b++)this.words[b]=0;var v=0,x=0,I;if(g==="be")for(b=f.length-1;b>=l;b-=2)I=c(f,l,b)<<v,this.words[x]|=I&67108863,v>=18?(v-=18,x+=1,this.words[x]|=I>>>26):v+=8;else{var m=f.length-l;for(b=m%2===0?l+1:l;b<f.length;b+=2)I=c(f,l,b)<<v,this.words[x]|=I&67108863,v>=18?(v-=18,x+=1,this.words[x]|=I>>>26):v+=8}this.strip()};function u(S,f,l,g){for(var b=0,v=Math.min(S.length,l),x=f;x<v;x++){var I=S.charCodeAt(x)-48;b*=g,I>=49?b+=I-49+10:I>=17?b+=I-17+10:b+=I}return b}s.prototype._parseBase=function(f,l,g){this.words=[0],this.length=1;for(var b=0,v=1;v<=67108863;v*=l)b++;b--,v=v/l|0;for(var x=f.length-g,I=x%b,m=Math.min(x,x-I)+g,h=0,E=g;E<m;E+=b)h=u(f,E,E+b,l),this.imuln(v),this.words[0]+h<67108864?this.words[0]+=h:this._iaddn(h);if(I!==0){var C=1;for(h=u(f,E,f.length,l),E=0;E<I;E++)C*=l;this.imuln(C),this.words[0]+h<67108864?this.words[0]+=h:this._iaddn(h)}this.strip()},s.prototype.copy=function(f){f.words=new Array(this.length);for(var l=0;l<this.length;l++)f.words[l]=this.words[l];f.length=this.length,f.negative=this.negative,f.red=this.red},s.prototype.clone=function(){var f=new s(null);return this.copy(f),f},s.prototype._expand=function(f){for(;this.length<f;)this.words[this.length++]=0;return this},s.prototype.strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},s.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},s.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var d=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],p=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],y=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];s.prototype.toString=function(f,l){f=f||10,l=l|0||1;var g;if(f===16||f==="hex"){g="";for(var b=0,v=0,x=0;x<this.length;x++){var I=this.words[x],m=((I<<b|v)&16777215).toString(16);v=I>>>24-b&16777215,b+=2,b>=26&&(b-=26,x--),v!==0||x!==this.length-1?g=d[6-m.length]+m+g:g=m+g}for(v!==0&&(g=v.toString(16)+g);g.length%l!==0;)g="0"+g;return this.negative!==0&&(g="-"+g),g}if(f===(f|0)&&f>=2&&f<=36){var h=p[f],E=y[f];g="";var C=this.clone();for(C.negative=0;!C.isZero();){var F=C.modn(E).toString(f);C=C.idivn(E),C.isZero()?g=F+g:g=d[h-F.length]+F+g}for(this.isZero()&&(g="0"+g);g.length%l!==0;)g="0"+g;return this.negative!==0&&(g="-"+g),g}n(!1,"Base should be between 2 and 36")},s.prototype.toNumber=function(){var f=this.words[0];return this.length===2?f+=this.words[1]*67108864:this.length===3&&this.words[2]===1?f+=4503599627370496+this.words[1]*67108864:this.length>2&&n(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-f:f},s.prototype.toJSON=function(){return this.toString(16)},s.prototype.toBuffer=function(f,l){return n(typeof o<"u"),this.toArrayLike(o,f,l)},s.prototype.toArray=function(f,l){return this.toArrayLike(Array,f,l)},s.prototype.toArrayLike=function(f,l,g){var b=this.byteLength(),v=g||Math.max(1,b);n(b<=v,"byte array longer than desired length"),n(v>0,"Requested array length <= 0"),this.strip();var x=l==="le",I=new f(v),m,h,E=this.clone();if(x){for(h=0;!E.isZero();h++)m=E.andln(255),E.iushrn(8),I[h]=m;for(;h<v;h++)I[h]=0}else{for(h=0;h<v-b;h++)I[h]=0;for(h=0;!E.isZero();h++)m=E.andln(255),E.iushrn(8),I[v-h-1]=m}return I},Math.clz32?s.prototype._countBits=function(f){return 32-Math.clz32(f)}:s.prototype._countBits=function(f){var l=f,g=0;return l>=4096&&(g+=13,l>>>=13),l>=64&&(g+=7,l>>>=7),l>=8&&(g+=4,l>>>=4),l>=2&&(g+=2,l>>>=2),g+l},s.prototype._zeroBits=function(f){if(f===0)return 26;var l=f,g=0;return(l&8191)===0&&(g+=13,l>>>=13),(l&127)===0&&(g+=7,l>>>=7),(l&15)===0&&(g+=4,l>>>=4),(l&3)===0&&(g+=2,l>>>=2),(l&1)===0&&g++,g},s.prototype.bitLength=function(){var f=this.words[this.length-1],l=this._countBits(f);return(this.length-1)*26+l};function _(S){for(var f=new Array(S.bitLength()),l=0;l<f.length;l++){var g=l/26|0,b=l%26;f[l]=(S.words[g]&1<<b)>>>b}return f}s.prototype.zeroBits=function(){if(this.isZero())return 0;for(var f=0,l=0;l<this.length;l++){var g=this._zeroBits(this.words[l]);if(f+=g,g!==26)break}return f},s.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},s.prototype.toTwos=function(f){return this.negative!==0?this.abs().inotn(f).iaddn(1):this.clone()},s.prototype.fromTwos=function(f){return this.testn(f-1)?this.notn(f).iaddn(1).ineg():this.clone()},s.prototype.isNeg=function(){return this.negative!==0},s.prototype.neg=function(){return this.clone().ineg()},s.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},s.prototype.iuor=function(f){for(;this.length<f.length;)this.words[this.length++]=0;for(var l=0;l<f.length;l++)this.words[l]=this.words[l]|f.words[l];return this.strip()},s.prototype.ior=function(f){return n((this.negative|f.negative)===0),this.iuor(f)},s.prototype.or=function(f){return this.length>f.length?this.clone().ior(f):f.clone().ior(this)},s.prototype.uor=function(f){return this.length>f.length?this.clone().iuor(f):f.clone().iuor(this)},s.prototype.iuand=function(f){var l;this.length>f.length?l=f:l=this;for(var g=0;g<l.length;g++)this.words[g]=this.words[g]&f.words[g];return this.length=l.length,this.strip()},s.prototype.iand=function(f){return n((this.negative|f.negative)===0),this.iuand(f)},s.prototype.and=function(f){return this.length>f.length?this.clone().iand(f):f.clone().iand(this)},s.prototype.uand=function(f){return this.length>f.length?this.clone().iuand(f):f.clone().iuand(this)},s.prototype.iuxor=function(f){var l,g;this.length>f.length?(l=this,g=f):(l=f,g=this);for(var b=0;b<g.length;b++)this.words[b]=l.words[b]^g.words[b];if(this!==l)for(;b<l.length;b++)this.words[b]=l.words[b];return this.length=l.length,this.strip()},s.prototype.ixor=function(f){return n((this.negative|f.negative)===0),this.iuxor(f)},s.prototype.xor=function(f){return this.length>f.length?this.clone().ixor(f):f.clone().ixor(this)},s.prototype.uxor=function(f){return this.length>f.length?this.clone().iuxor(f):f.clone().iuxor(this)},s.prototype.inotn=function(f){n(typeof f=="number"&&f>=0);var l=Math.ceil(f/26)|0,g=f%26;this._expand(l),g>0&&l--;for(var b=0;b<l;b++)this.words[b]=~this.words[b]&67108863;return g>0&&(this.words[b]=~this.words[b]&67108863>>26-g),this.strip()},s.prototype.notn=function(f){return this.clone().inotn(f)},s.prototype.setn=function(f,l){n(typeof f=="number"&&f>=0);var g=f/26|0,b=f%26;return this._expand(g+1),l?this.words[g]=this.words[g]|1<<b:this.words[g]=this.words[g]&~(1<<b),this.strip()},s.prototype.iadd=function(f){var l;if(this.negative!==0&&f.negative===0)return this.negative=0,l=this.isub(f),this.negative^=1,this._normSign();if(this.negative===0&&f.negative!==0)return f.negative=0,l=this.isub(f),f.negative=1,l._normSign();var g,b;this.length>f.length?(g=this,b=f):(g=f,b=this);for(var v=0,x=0;x<b.length;x++)l=(g.words[x]|0)+(b.words[x]|0)+v,this.words[x]=l&67108863,v=l>>>26;for(;v!==0&&x<g.length;x++)l=(g.words[x]|0)+v,this.words[x]=l&67108863,v=l>>>26;if(this.length=g.length,v!==0)this.words[this.length]=v,this.length++;else if(g!==this)for(;x<g.length;x++)this.words[x]=g.words[x];return this},s.prototype.add=function(f){var l;return f.negative!==0&&this.negative===0?(f.negative=0,l=this.sub(f),f.negative^=1,l):f.negative===0&&this.negative!==0?(this.negative=0,l=f.sub(this),this.negative=1,l):this.length>f.length?this.clone().iadd(f):f.clone().iadd(this)},s.prototype.isub=function(f){if(f.negative!==0){f.negative=0;var l=this.iadd(f);return f.negative=1,l._normSign()}else if(this.negative!==0)return this.negative=0,this.iadd(f),this.negative=1,this._normSign();var g=this.cmp(f);if(g===0)return this.negative=0,this.length=1,this.words[0]=0,this;var b,v;g>0?(b=this,v=f):(b=f,v=this);for(var x=0,I=0;I<v.length;I++)l=(b.words[I]|0)-(v.words[I]|0)+x,x=l>>26,this.words[I]=l&67108863;for(;x!==0&&I<b.length;I++)l=(b.words[I]|0)+x,x=l>>26,this.words[I]=l&67108863;if(x===0&&I<b.length&&b!==this)for(;I<b.length;I++)this.words[I]=b.words[I];return this.length=Math.max(this.length,I),b!==this&&(this.negative=1),this.strip()},s.prototype.sub=function(f){return this.clone().isub(f)};function w(S,f,l){l.negative=f.negative^S.negative;var g=S.length+f.length|0;l.length=g,g=g-1|0;var b=S.words[0]|0,v=f.words[0]|0,x=b*v,I=x&67108863,m=x/67108864|0;l.words[0]=I;for(var h=1;h<g;h++){for(var E=m>>>26,C=m&67108863,F=Math.min(h,f.length-1),k=Math.max(0,h-S.length+1);k<=F;k++){var q=h-k|0;b=S.words[q]|0,v=f.words[k]|0,x=b*v+C,E+=x/67108864|0,C=x&67108863}l.words[h]=C|0,m=E|0}return m!==0?l.words[h]=m|0:l.length--,l.strip()}var D=function(f,l,g){var b=f.words,v=l.words,x=g.words,I=0,m,h,E,C=b[0]|0,F=C&8191,k=C>>>13,q=b[1]|0,W=q&8191,X=q>>>13,Z=b[2]|0,Y=Z&8191,ee=Z>>>13,Qe=b[3]|0,te=Qe&8191,ae=Qe>>>13,St=b[4]|0,de=St&8191,Ie=St>>>13,li=b[5]|0,Ae=li&8191,we=li>>>13,En=b[6]|0,ve=En&8191,_e=En>>>13,xn=b[7]|0,Ee=xn&8191,xe=xn>>>13,Sn=b[8]|0,le=Sn&8191,ye=Sn>>>13,In=b[9]|0,ie=In&8191,Re=In>>>13,Xi=v[0]|0,ze=Xi&8191,Be=Xi>>>13,An=v[1]|0,Pe=An&8191,Ne=An>>>13,Eo=v[2]|0,he=Eo&8191,Ce=Eo>>>13,xo=v[3]|0,Ue=xo&8191,De=xo>>>13,Zr=v[4]|0,Oe=Zr&8191,Me=Zr>>>13,pi=v[5]|0,me=pi&8191,ke=pi>>>13,So=v[6]|0,je=So&8191,qe=So>>>13,Io=v[7]|0,Le=Io&8191,Te=Io>>>13,xr=v[8]|0,He=xr&8191,Ke=xr>>>13,Ao=v[9]|0,Ve=Ao&8191,We=Ao>>>13;g.negative=f.negative^l.negative,g.length=19,m=Math.imul(F,ze),h=Math.imul(F,Be),h=h+Math.imul(k,ze)|0,E=Math.imul(k,Be);var Ft=(I+m|0)+((h&8191)<<13)|0;I=(E+(h>>>13)|0)+(Ft>>>26)|0,Ft&=67108863,m=Math.imul(W,ze),h=Math.imul(W,Be),h=h+Math.imul(X,ze)|0,E=Math.imul(X,Be),m=m+Math.imul(F,Pe)|0,h=h+Math.imul(F,Ne)|0,h=h+Math.imul(k,Pe)|0,E=E+Math.imul(k,Ne)|0;var Zi=(I+m|0)+((h&8191)<<13)|0;I=(E+(h>>>13)|0)+(Zi>>>26)|0,Zi&=67108863,m=Math.imul(Y,ze),h=Math.imul(Y,Be),h=h+Math.imul(ee,ze)|0,E=Math.imul(ee,Be),m=m+Math.imul(W,Pe)|0,h=h+Math.imul(W,Ne)|0,h=h+Math.imul(X,Pe)|0,E=E+Math.imul(X,Ne)|0,m=m+Math.imul(F,he)|0,h=h+Math.imul(F,Ce)|0,h=h+Math.imul(k,he)|0,E=E+Math.imul(k,Ce)|0;var Ji=(I+m|0)+((h&8191)<<13)|0;I=(E+(h>>>13)|0)+(Ji>>>26)|0,Ji&=67108863,m=Math.imul(te,ze),h=Math.imul(te,Be),h=h+Math.imul(ae,ze)|0,E=Math.imul(ae,Be),m=m+Math.imul(Y,Pe)|0,h=h+Math.imul(Y,Ne)|0,h=h+Math.imul(ee,Pe)|0,E=E+Math.imul(ee,Ne)|0,m=m+Math.imul(W,he)|0,h=h+Math.imul(W,Ce)|0,h=h+Math.imul(X,he)|0,E=E+Math.imul(X,Ce)|0,m=m+Math.imul(F,Ue)|0,h=h+Math.imul(F,De)|0,h=h+Math.imul(k,Ue)|0,E=E+Math.imul(k,De)|0;var Qi=(I+m|0)+((h&8191)<<13)|0;I=(E+(h>>>13)|0)+(Qi>>>26)|0,Qi&=67108863,m=Math.imul(de,ze),h=Math.imul(de,Be),h=h+Math.imul(Ie,ze)|0,E=Math.imul(Ie,Be),m=m+Math.imul(te,Pe)|0,h=h+Math.imul(te,Ne)|0,h=h+Math.imul(ae,Pe)|0,E=E+Math.imul(ae,Ne)|0,m=m+Math.imul(Y,he)|0,h=h+Math.imul(Y,Ce)|0,h=h+Math.imul(ee,he)|0,E=E+Math.imul(ee,Ce)|0,m=m+Math.imul(W,Ue)|0,h=h+Math.imul(W,De)|0,h=h+Math.imul(X,Ue)|0,E=E+Math.imul(X,De)|0,m=m+Math.imul(F,Oe)|0,h=h+Math.imul(F,Me)|0,h=h+Math.imul(k,Oe)|0,E=E+Math.imul(k,Me)|0;var es=(I+m|0)+((h&8191)<<13)|0;I=(E+(h>>>13)|0)+(es>>>26)|0,es&=67108863,m=Math.imul(Ae,ze),h=Math.imul(Ae,Be),h=h+Math.imul(we,ze)|0,E=Math.imul(we,Be),m=m+Math.imul(de,Pe)|0,h=h+Math.imul(de,Ne)|0,h=h+Math.imul(Ie,Pe)|0,E=E+Math.imul(Ie,Ne)|0,m=m+Math.imul(te,he)|0,h=h+Math.imul(te,Ce)|0,h=h+Math.imul(ae,he)|0,E=E+Math.imul(ae,Ce)|0,m=m+Math.imul(Y,Ue)|0,h=h+Math.imul(Y,De)|0,h=h+Math.imul(ee,Ue)|0,E=E+Math.imul(ee,De)|0,m=m+Math.imul(W,Oe)|0,h=h+Math.imul(W,Me)|0,h=h+Math.imul(X,Oe)|0,E=E+Math.imul(X,Me)|0,m=m+Math.imul(F,me)|0,h=h+Math.imul(F,ke)|0,h=h+Math.imul(k,me)|0,E=E+Math.imul(k,ke)|0;var ts=(I+m|0)+((h&8191)<<13)|0;I=(E+(h>>>13)|0)+(ts>>>26)|0,ts&=67108863,m=Math.imul(ve,ze),h=Math.imul(ve,Be),h=h+Math.imul(_e,ze)|0,E=Math.imul(_e,Be),m=m+Math.imul(Ae,Pe)|0,h=h+Math.imul(Ae,Ne)|0,h=h+Math.imul(we,Pe)|0,E=E+Math.imul(we,Ne)|0,m=m+Math.imul(de,he)|0,h=h+Math.imul(de,Ce)|0,h=h+Math.imul(Ie,he)|0,E=E+Math.imul(Ie,Ce)|0,m=m+Math.imul(te,Ue)|0,h=h+Math.imul(te,De)|0,h=h+Math.imul(ae,Ue)|0,E=E+Math.imul(ae,De)|0,m=m+Math.imul(Y,Oe)|0,h=h+Math.imul(Y,Me)|0,h=h+Math.imul(ee,Oe)|0,E=E+Math.imul(ee,Me)|0,m=m+Math.imul(W,me)|0,h=h+Math.imul(W,ke)|0,h=h+Math.imul(X,me)|0,E=E+Math.imul(X,ke)|0,m=m+Math.imul(F,je)|0,h=h+Math.imul(F,qe)|0,h=h+Math.imul(k,je)|0,E=E+Math.imul(k,qe)|0;var sr=(I+m|0)+((h&8191)<<13)|0;I=(E+(h>>>13)|0)+(sr>>>26)|0,sr&=67108863,m=Math.imul(Ee,ze),h=Math.imul(Ee,Be),h=h+Math.imul(xe,ze)|0,E=Math.imul(xe,Be),m=m+Math.imul(ve,Pe)|0,h=h+Math.imul(ve,Ne)|0,h=h+Math.imul(_e,Pe)|0,E=E+Math.imul(_e,Ne)|0,m=m+Math.imul(Ae,he)|0,h=h+Math.imul(Ae,Ce)|0,h=h+Math.imul(we,he)|0,E=E+Math.imul(we,Ce)|0,m=m+Math.imul(de,Ue)|0,h=h+Math.imul(de,De)|0,h=h+Math.imul(Ie,Ue)|0,E=E+Math.imul(Ie,De)|0,m=m+Math.imul(te,Oe)|0,h=h+Math.imul(te,Me)|0,h=h+Math.imul(ae,Oe)|0,E=E+Math.imul(ae,Me)|0,m=m+Math.imul(Y,me)|0,h=h+Math.imul(Y,ke)|0,h=h+Math.imul(ee,me)|0,E=E+Math.imul(ee,ke)|0,m=m+Math.imul(W,je)|0,h=h+Math.imul(W,qe)|0,h=h+Math.imul(X,je)|0,E=E+Math.imul(X,qe)|0,m=m+Math.imul(F,Le)|0,h=h+Math.imul(F,Te)|0,h=h+Math.imul(k,Le)|0,E=E+Math.imul(k,Te)|0;var rs=(I+m|0)+((h&8191)<<13)|0;I=(E+(h>>>13)|0)+(rs>>>26)|0,rs&=67108863,m=Math.imul(le,ze),h=Math.imul(le,Be),h=h+Math.imul(ye,ze)|0,E=Math.imul(ye,Be),m=m+Math.imul(Ee,Pe)|0,h=h+Math.imul(Ee,Ne)|0,h=h+Math.imul(xe,Pe)|0,E=E+Math.imul(xe,Ne)|0,m=m+Math.imul(ve,he)|0,h=h+Math.imul(ve,Ce)|0,h=h+Math.imul(_e,he)|0,E=E+Math.imul(_e,Ce)|0,m=m+Math.imul(Ae,Ue)|0,h=h+Math.imul(Ae,De)|0,h=h+Math.imul(we,Ue)|0,E=E+Math.imul(we,De)|0,m=m+Math.imul(de,Oe)|0,h=h+Math.imul(de,Me)|0,h=h+Math.imul(Ie,Oe)|0,E=E+Math.imul(Ie,Me)|0,m=m+Math.imul(te,me)|0,h=h+Math.imul(te,ke)|0,h=h+Math.imul(ae,me)|0,E=E+Math.imul(ae,ke)|0,m=m+Math.imul(Y,je)|0,h=h+Math.imul(Y,qe)|0,h=h+Math.imul(ee,je)|0,E=E+Math.imul(ee,qe)|0,m=m+Math.imul(W,Le)|0,h=h+Math.imul(W,Te)|0,h=h+Math.imul(X,Le)|0,E=E+Math.imul(X,Te)|0,m=m+Math.imul(F,He)|0,h=h+Math.imul(F,Ke)|0,h=h+Math.imul(k,He)|0,E=E+Math.imul(k,Ke)|0;var ns=(I+m|0)+((h&8191)<<13)|0;I=(E+(h>>>13)|0)+(ns>>>26)|0,ns&=67108863,m=Math.imul(ie,ze),h=Math.imul(ie,Be),h=h+Math.imul(Re,ze)|0,E=Math.imul(Re,Be),m=m+Math.imul(le,Pe)|0,h=h+Math.imul(le,Ne)|0,h=h+Math.imul(ye,Pe)|0,E=E+Math.imul(ye,Ne)|0,m=m+Math.imul(Ee,he)|0,h=h+Math.imul(Ee,Ce)|0,h=h+Math.imul(xe,he)|0,E=E+Math.imul(xe,Ce)|0,m=m+Math.imul(ve,Ue)|0,h=h+Math.imul(ve,De)|0,h=h+Math.imul(_e,Ue)|0,E=E+Math.imul(_e,De)|0,m=m+Math.imul(Ae,Oe)|0,h=h+Math.imul(Ae,Me)|0,h=h+Math.imul(we,Oe)|0,E=E+Math.imul(we,Me)|0,m=m+Math.imul(de,me)|0,h=h+Math.imul(de,ke)|0,h=h+Math.imul(Ie,me)|0,E=E+Math.imul(Ie,ke)|0,m=m+Math.imul(te,je)|0,h=h+Math.imul(te,qe)|0,h=h+Math.imul(ae,je)|0,E=E+Math.imul(ae,qe)|0,m=m+Math.imul(Y,Le)|0,h=h+Math.imul(Y,Te)|0,h=h+Math.imul(ee,Le)|0,E=E+Math.imul(ee,Te)|0,m=m+Math.imul(W,He)|0,h=h+Math.imul(W,Ke)|0,h=h+Math.imul(X,He)|0,E=E+Math.imul(X,Ke)|0,m=m+Math.imul(F,Ve)|0,h=h+Math.imul(F,We)|0,h=h+Math.imul(k,Ve)|0,E=E+Math.imul(k,We)|0;var is=(I+m|0)+((h&8191)<<13)|0;I=(E+(h>>>13)|0)+(is>>>26)|0,is&=67108863,m=Math.imul(ie,Pe),h=Math.imul(ie,Ne),h=h+Math.imul(Re,Pe)|0,E=Math.imul(Re,Ne),m=m+Math.imul(le,he)|0,h=h+Math.imul(le,Ce)|0,h=h+Math.imul(ye,he)|0,E=E+Math.imul(ye,Ce)|0,m=m+Math.imul(Ee,Ue)|0,h=h+Math.imul(Ee,De)|0,h=h+Math.imul(xe,Ue)|0,E=E+Math.imul(xe,De)|0,m=m+Math.imul(ve,Oe)|0,h=h+Math.imul(ve,Me)|0,h=h+Math.imul(_e,Oe)|0,E=E+Math.imul(_e,Me)|0,m=m+Math.imul(Ae,me)|0,h=h+Math.imul(Ae,ke)|0,h=h+Math.imul(we,me)|0,E=E+Math.imul(we,ke)|0,m=m+Math.imul(de,je)|0,h=h+Math.imul(de,qe)|0,h=h+Math.imul(Ie,je)|0,E=E+Math.imul(Ie,qe)|0,m=m+Math.imul(te,Le)|0,h=h+Math.imul(te,Te)|0,h=h+Math.imul(ae,Le)|0,E=E+Math.imul(ae,Te)|0,m=m+Math.imul(Y,He)|0,h=h+Math.imul(Y,Ke)|0,h=h+Math.imul(ee,He)|0,E=E+Math.imul(ee,Ke)|0,m=m+Math.imul(W,Ve)|0,h=h+Math.imul(W,We)|0,h=h+Math.imul(X,Ve)|0,E=E+Math.imul(X,We)|0;var ss=(I+m|0)+((h&8191)<<13)|0;I=(E+(h>>>13)|0)+(ss>>>26)|0,ss&=67108863,m=Math.imul(ie,he),h=Math.imul(ie,Ce),h=h+Math.imul(Re,he)|0,E=Math.imul(Re,Ce),m=m+Math.imul(le,Ue)|0,h=h+Math.imul(le,De)|0,h=h+Math.imul(ye,Ue)|0,E=E+Math.imul(ye,De)|0,m=m+Math.imul(Ee,Oe)|0,h=h+Math.imul(Ee,Me)|0,h=h+Math.imul(xe,Oe)|0,E=E+Math.imul(xe,Me)|0,m=m+Math.imul(ve,me)|0,h=h+Math.imul(ve,ke)|0,h=h+Math.imul(_e,me)|0,E=E+Math.imul(_e,ke)|0,m=m+Math.imul(Ae,je)|0,h=h+Math.imul(Ae,qe)|0,h=h+Math.imul(we,je)|0,E=E+Math.imul(we,qe)|0,m=m+Math.imul(de,Le)|0,h=h+Math.imul(de,Te)|0,h=h+Math.imul(Ie,Le)|0,E=E+Math.imul(Ie,Te)|0,m=m+Math.imul(te,He)|0,h=h+Math.imul(te,Ke)|0,h=h+Math.imul(ae,He)|0,E=E+Math.imul(ae,Ke)|0,m=m+Math.imul(Y,Ve)|0,h=h+Math.imul(Y,We)|0,h=h+Math.imul(ee,Ve)|0,E=E+Math.imul(ee,We)|0;var os=(I+m|0)+((h&8191)<<13)|0;I=(E+(h>>>13)|0)+(os>>>26)|0,os&=67108863,m=Math.imul(ie,Ue),h=Math.imul(ie,De),h=h+Math.imul(Re,Ue)|0,E=Math.imul(Re,De),m=m+Math.imul(le,Oe)|0,h=h+Math.imul(le,Me)|0,h=h+Math.imul(ye,Oe)|0,E=E+Math.imul(ye,Me)|0,m=m+Math.imul(Ee,me)|0,h=h+Math.imul(Ee,ke)|0,h=h+Math.imul(xe,me)|0,E=E+Math.imul(xe,ke)|0,m=m+Math.imul(ve,je)|0,h=h+Math.imul(ve,qe)|0,h=h+Math.imul(_e,je)|0,E=E+Math.imul(_e,qe)|0,m=m+Math.imul(Ae,Le)|0,h=h+Math.imul(Ae,Te)|0,h=h+Math.imul(we,Le)|0,E=E+Math.imul(we,Te)|0,m=m+Math.imul(de,He)|0,h=h+Math.imul(de,Ke)|0,h=h+Math.imul(Ie,He)|0,E=E+Math.imul(Ie,Ke)|0,m=m+Math.imul(te,Ve)|0,h=h+Math.imul(te,We)|0,h=h+Math.imul(ae,Ve)|0,E=E+Math.imul(ae,We)|0;var Jr=(I+m|0)+((h&8191)<<13)|0;I=(E+(h>>>13)|0)+(Jr>>>26)|0,Jr&=67108863,m=Math.imul(ie,Oe),h=Math.imul(ie,Me),h=h+Math.imul(Re,Oe)|0,E=Math.imul(Re,Me),m=m+Math.imul(le,me)|0,h=h+Math.imul(le,ke)|0,h=h+Math.imul(ye,me)|0,E=E+Math.imul(ye,ke)|0,m=m+Math.imul(Ee,je)|0,h=h+Math.imul(Ee,qe)|0,h=h+Math.imul(xe,je)|0,E=E+Math.imul(xe,qe)|0,m=m+Math.imul(ve,Le)|0,h=h+Math.imul(ve,Te)|0,h=h+Math.imul(_e,Le)|0,E=E+Math.imul(_e,Te)|0,m=m+Math.imul(Ae,He)|0,h=h+Math.imul(Ae,Ke)|0,h=h+Math.imul(we,He)|0,E=E+Math.imul(we,Ke)|0,m=m+Math.imul(de,Ve)|0,h=h+Math.imul(de,We)|0,h=h+Math.imul(Ie,Ve)|0,E=E+Math.imul(Ie,We)|0;var as=(I+m|0)+((h&8191)<<13)|0;I=(E+(h>>>13)|0)+(as>>>26)|0,as&=67108863,m=Math.imul(ie,me),h=Math.imul(ie,ke),h=h+Math.imul(Re,me)|0,E=Math.imul(Re,ke),m=m+Math.imul(le,je)|0,h=h+Math.imul(le,qe)|0,h=h+Math.imul(ye,je)|0,E=E+Math.imul(ye,qe)|0,m=m+Math.imul(Ee,Le)|0,h=h+Math.imul(Ee,Te)|0,h=h+Math.imul(xe,Le)|0,E=E+Math.imul(xe,Te)|0,m=m+Math.imul(ve,He)|0,h=h+Math.imul(ve,Ke)|0,h=h+Math.imul(_e,He)|0,E=E+Math.imul(_e,Ke)|0,m=m+Math.imul(Ae,Ve)|0,h=h+Math.imul(Ae,We)|0,h=h+Math.imul(we,Ve)|0,E=E+Math.imul(we,We)|0;var cs=(I+m|0)+((h&8191)<<13)|0;I=(E+(h>>>13)|0)+(cs>>>26)|0,cs&=67108863,m=Math.imul(ie,je),h=Math.imul(ie,qe),h=h+Math.imul(Re,je)|0,E=Math.imul(Re,qe),m=m+Math.imul(le,Le)|0,h=h+Math.imul(le,Te)|0,h=h+Math.imul(ye,Le)|0,E=E+Math.imul(ye,Te)|0,m=m+Math.imul(Ee,He)|0,h=h+Math.imul(Ee,Ke)|0,h=h+Math.imul(xe,He)|0,E=E+Math.imul(xe,Ke)|0,m=m+Math.imul(ve,Ve)|0,h=h+Math.imul(ve,We)|0,h=h+Math.imul(_e,Ve)|0,E=E+Math.imul(_e,We)|0;var Wt=(I+m|0)+((h&8191)<<13)|0;I=(E+(h>>>13)|0)+(Wt>>>26)|0,Wt&=67108863,m=Math.imul(ie,Le),h=Math.imul(ie,Te),h=h+Math.imul(Re,Le)|0,E=Math.imul(Re,Te),m=m+Math.imul(le,He)|0,h=h+Math.imul(le,Ke)|0,h=h+Math.imul(ye,He)|0,E=E+Math.imul(ye,Ke)|0,m=m+Math.imul(Ee,Ve)|0,h=h+Math.imul(Ee,We)|0,h=h+Math.imul(xe,Ve)|0,E=E+Math.imul(xe,We)|0;var fs=(I+m|0)+((h&8191)<<13)|0;I=(E+(h>>>13)|0)+(fs>>>26)|0,fs&=67108863,m=Math.imul(ie,He),h=Math.imul(ie,Ke),h=h+Math.imul(Re,He)|0,E=Math.imul(Re,Ke),m=m+Math.imul(le,Ve)|0,h=h+Math.imul(le,We)|0,h=h+Math.imul(ye,Ve)|0,E=E+Math.imul(ye,We)|0;var us=(I+m|0)+((h&8191)<<13)|0;I=(E+(h>>>13)|0)+(us>>>26)|0,us&=67108863,m=Math.imul(ie,Ve),h=Math.imul(ie,We),h=h+Math.imul(Re,Ve)|0,E=Math.imul(Re,We);var hs=(I+m|0)+((h&8191)<<13)|0;return I=(E+(h>>>13)|0)+(hs>>>26)|0,hs&=67108863,x[0]=Ft,x[1]=Zi,x[2]=Ji,x[3]=Qi,x[4]=es,x[5]=ts,x[6]=sr,x[7]=rs,x[8]=ns,x[9]=is,x[10]=ss,x[11]=os,x[12]=Jr,x[13]=as,x[14]=cs,x[15]=Wt,x[16]=fs,x[17]=us,x[18]=hs,I!==0&&(x[19]=I,g.length++),g};Math.imul||(D=w);function O(S,f,l){l.negative=f.negative^S.negative,l.length=S.length+f.length;for(var g=0,b=0,v=0;v<l.length-1;v++){var x=b;b=0;for(var I=g&67108863,m=Math.min(v,f.length-1),h=Math.max(0,v-S.length+1);h<=m;h++){var E=v-h,C=S.words[E]|0,F=f.words[h]|0,k=C*F,q=k&67108863;x=x+(k/67108864|0)|0,q=q+I|0,I=q&67108863,x=x+(q>>>26)|0,b+=x>>>26,x&=67108863}l.words[v]=I,g=x,x=b}return g!==0?l.words[v]=g:l.length--,l.strip()}function M(S,f,l){var g=new T;return g.mulp(S,f,l)}s.prototype.mulTo=function(f,l){var g,b=this.length+f.length;return this.length===10&&f.length===10?g=D(this,f,l):b<63?g=w(this,f,l):b<1024?g=O(this,f,l):g=M(this,f,l),g};function T(S,f){this.x=S,this.y=f}T.prototype.makeRBT=function(f){for(var l=new Array(f),g=s.prototype._countBits(f)-1,b=0;b<f;b++)l[b]=this.revBin(b,g,f);return l},T.prototype.revBin=function(f,l,g){if(f===0||f===g-1)return f;for(var b=0,v=0;v<l;v++)b|=(f&1)<<l-v-1,f>>=1;return b},T.prototype.permute=function(f,l,g,b,v,x){for(var I=0;I<x;I++)b[I]=l[f[I]],v[I]=g[f[I]]},T.prototype.transform=function(f,l,g,b,v,x){this.permute(x,f,l,g,b,v);for(var I=1;I<v;I<<=1)for(var m=I<<1,h=Math.cos(2*Math.PI/m),E=Math.sin(2*Math.PI/m),C=0;C<v;C+=m)for(var F=h,k=E,q=0;q<I;q++){var W=g[C+q],X=b[C+q],Z=g[C+q+I],Y=b[C+q+I],ee=F*Z-k*Y;Y=F*Y+k*Z,Z=ee,g[C+q]=W+Z,b[C+q]=X+Y,g[C+q+I]=W-Z,b[C+q+I]=X-Y,q!==m&&(ee=h*F-E*k,k=h*k+E*F,F=ee)}},T.prototype.guessLen13b=function(f,l){var g=Math.max(l,f)|1,b=g&1,v=0;for(g=g/2|0;g;g=g>>>1)v++;return 1<<v+1+b},T.prototype.conjugate=function(f,l,g){if(!(g<=1))for(var b=0;b<g/2;b++){var v=f[b];f[b]=f[g-b-1],f[g-b-1]=v,v=l[b],l[b]=-l[g-b-1],l[g-b-1]=-v}},T.prototype.normalize13b=function(f,l){for(var g=0,b=0;b<l/2;b++){var v=Math.round(f[2*b+1]/l)*8192+Math.round(f[2*b]/l)+g;f[b]=v&67108863,v<67108864?g=0:g=v/67108864|0}return f},T.prototype.convert13b=function(f,l,g,b){for(var v=0,x=0;x<l;x++)v=v+(f[x]|0),g[2*x]=v&8191,v=v>>>13,g[2*x+1]=v&8191,v=v>>>13;for(x=2*l;x<b;++x)g[x]=0;n(v===0),n((v&-8192)===0)},T.prototype.stub=function(f){for(var l=new Array(f),g=0;g<f;g++)l[g]=0;return l},T.prototype.mulp=function(f,l,g){var b=2*this.guessLen13b(f.length,l.length),v=this.makeRBT(b),x=this.stub(b),I=new Array(b),m=new Array(b),h=new Array(b),E=new Array(b),C=new Array(b),F=new Array(b),k=g.words;k.length=b,this.convert13b(f.words,f.length,I,b),this.convert13b(l.words,l.length,E,b),this.transform(I,x,m,h,b,v),this.transform(E,x,C,F,b,v);for(var q=0;q<b;q++){var W=m[q]*C[q]-h[q]*F[q];h[q]=m[q]*F[q]+h[q]*C[q],m[q]=W}return this.conjugate(m,h,b),this.transform(m,h,k,x,b,v),this.conjugate(k,x,b),this.normalize13b(k,b),g.negative=f.negative^l.negative,g.length=f.length+l.length,g.strip()},s.prototype.mul=function(f){var l=new s(null);return l.words=new Array(this.length+f.length),this.mulTo(f,l)},s.prototype.mulf=function(f){var l=new s(null);return l.words=new Array(this.length+f.length),M(this,f,l)},s.prototype.imul=function(f){return this.clone().mulTo(f,this)},s.prototype.imuln=function(f){n(typeof f=="number"),n(f<67108864);for(var l=0,g=0;g<this.length;g++){var b=(this.words[g]|0)*f,v=(b&67108863)+(l&67108863);l>>=26,l+=b/67108864|0,l+=v>>>26,this.words[g]=v&67108863}return l!==0&&(this.words[g]=l,this.length++),this},s.prototype.muln=function(f){return this.clone().imuln(f)},s.prototype.sqr=function(){return this.mul(this)},s.prototype.isqr=function(){return this.imul(this.clone())},s.prototype.pow=function(f){var l=_(f);if(l.length===0)return new s(1);for(var g=this,b=0;b<l.length&&l[b]===0;b++,g=g.sqr());if(++b<l.length)for(var v=g.sqr();b<l.length;b++,v=v.sqr())l[b]!==0&&(g=g.mul(v));return g},s.prototype.iushln=function(f){n(typeof f=="number"&&f>=0);var l=f%26,g=(f-l)/26,b=67108863>>>26-l<<26-l,v;if(l!==0){var x=0;for(v=0;v<this.length;v++){var I=this.words[v]&b,m=(this.words[v]|0)-I<<l;this.words[v]=m|x,x=I>>>26-l}x&&(this.words[v]=x,this.length++)}if(g!==0){for(v=this.length-1;v>=0;v--)this.words[v+g]=this.words[v];for(v=0;v<g;v++)this.words[v]=0;this.length+=g}return this.strip()},s.prototype.ishln=function(f){return n(this.negative===0),this.iushln(f)},s.prototype.iushrn=function(f,l,g){n(typeof f=="number"&&f>=0);var b;l?b=(l-l%26)/26:b=0;var v=f%26,x=Math.min((f-v)/26,this.length),I=67108863^67108863>>>v<<v,m=g;if(b-=x,b=Math.max(0,b),m){for(var h=0;h<x;h++)m.words[h]=this.words[h];m.length=x}if(x!==0)if(this.length>x)for(this.length-=x,h=0;h<this.length;h++)this.words[h]=this.words[h+x];else this.words[0]=0,this.length=1;var E=0;for(h=this.length-1;h>=0&&(E!==0||h>=b);h--){var C=this.words[h]|0;this.words[h]=E<<26-v|C>>>v,E=C&I}return m&&E!==0&&(m.words[m.length++]=E),this.length===0&&(this.words[0]=0,this.length=1),this.strip()},s.prototype.ishrn=function(f,l,g){return n(this.negative===0),this.iushrn(f,l,g)},s.prototype.shln=function(f){return this.clone().ishln(f)},s.prototype.ushln=function(f){return this.clone().iushln(f)},s.prototype.shrn=function(f){return this.clone().ishrn(f)},s.prototype.ushrn=function(f){return this.clone().iushrn(f)},s.prototype.testn=function(f){n(typeof f=="number"&&f>=0);var l=f%26,g=(f-l)/26,b=1<<l;if(this.length<=g)return!1;var v=this.words[g];return!!(v&b)},s.prototype.imaskn=function(f){n(typeof f=="number"&&f>=0);var l=f%26,g=(f-l)/26;if(n(this.negative===0,"imaskn works only with positive numbers"),this.length<=g)return this;if(l!==0&&g++,this.length=Math.min(g,this.length),l!==0){var b=67108863^67108863>>>l<<l;this.words[this.length-1]&=b}return this.strip()},s.prototype.maskn=function(f){return this.clone().imaskn(f)},s.prototype.iaddn=function(f){return n(typeof f=="number"),n(f<67108864),f<0?this.isubn(-f):this.negative!==0?this.length===1&&(this.words[0]|0)<f?(this.words[0]=f-(this.words[0]|0),this.negative=0,this):(this.negative=0,this.isubn(f),this.negative=1,this):this._iaddn(f)},s.prototype._iaddn=function(f){this.words[0]+=f;for(var l=0;l<this.length&&this.words[l]>=67108864;l++)this.words[l]-=67108864,l===this.length-1?this.words[l+1]=1:this.words[l+1]++;return this.length=Math.max(this.length,l+1),this},s.prototype.isubn=function(f){if(n(typeof f=="number"),n(f<67108864),f<0)return this.iaddn(-f);if(this.negative!==0)return this.negative=0,this.iaddn(f),this.negative=1,this;if(this.words[0]-=f,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var l=0;l<this.length&&this.words[l]<0;l++)this.words[l]+=67108864,this.words[l+1]-=1;return this.strip()},s.prototype.addn=function(f){return this.clone().iaddn(f)},s.prototype.subn=function(f){return this.clone().isubn(f)},s.prototype.iabs=function(){return this.negative=0,this},s.prototype.abs=function(){return this.clone().iabs()},s.prototype._ishlnsubmul=function(f,l,g){var b=f.length+g,v;this._expand(b);var x,I=0;for(v=0;v<f.length;v++){x=(this.words[v+g]|0)+I;var m=(f.words[v]|0)*l;x-=m&67108863,I=(x>>26)-(m/67108864|0),this.words[v+g]=x&67108863}for(;v<this.length-g;v++)x=(this.words[v+g]|0)+I,I=x>>26,this.words[v+g]=x&67108863;if(I===0)return this.strip();for(n(I===-1),I=0,v=0;v<this.length;v++)x=-(this.words[v]|0)+I,I=x>>26,this.words[v]=x&67108863;return this.negative=1,this.strip()},s.prototype._wordDiv=function(f,l){var g=this.length-f.length,b=this.clone(),v=f,x=v.words[v.length-1]|0,I=this._countBits(x);g=26-I,g!==0&&(v=v.ushln(g),b.iushln(g),x=v.words[v.length-1]|0);var m=b.length-v.length,h;if(l!=="mod"){h=new s(null),h.length=m+1,h.words=new Array(h.length);for(var E=0;E<h.length;E++)h.words[E]=0}var C=b.clone()._ishlnsubmul(v,1,m);C.negative===0&&(b=C,h&&(h.words[m]=1));for(var F=m-1;F>=0;F--){var k=(b.words[v.length+F]|0)*67108864+(b.words[v.length+F-1]|0);for(k=Math.min(k/x|0,67108863),b._ishlnsubmul(v,k,F);b.negative!==0;)k--,b.negative=0,b._ishlnsubmul(v,1,F),b.isZero()||(b.negative^=1);h&&(h.words[F]=k)}return h&&h.strip(),b.strip(),l!=="div"&&g!==0&&b.iushrn(g),{div:h||null,mod:b}},s.prototype.divmod=function(f,l,g){if(n(!f.isZero()),this.isZero())return{div:new s(0),mod:new s(0)};var b,v,x;return this.negative!==0&&f.negative===0?(x=this.neg().divmod(f,l),l!=="mod"&&(b=x.div.neg()),l!=="div"&&(v=x.mod.neg(),g&&v.negative!==0&&v.iadd(f)),{div:b,mod:v}):this.negative===0&&f.negative!==0?(x=this.divmod(f.neg(),l),l!=="mod"&&(b=x.div.neg()),{div:b,mod:x.mod}):(this.negative&f.negative)!==0?(x=this.neg().divmod(f.neg(),l),l!=="div"&&(v=x.mod.neg(),g&&v.negative!==0&&v.isub(f)),{div:x.div,mod:v}):f.length>this.length||this.cmp(f)<0?{div:new s(0),mod:this}:f.length===1?l==="div"?{div:this.divn(f.words[0]),mod:null}:l==="mod"?{div:null,mod:new s(this.modn(f.words[0]))}:{div:this.divn(f.words[0]),mod:new s(this.modn(f.words[0]))}:this._wordDiv(f,l)},s.prototype.div=function(f){return this.divmod(f,"div",!1).div},s.prototype.mod=function(f){return this.divmod(f,"mod",!1).mod},s.prototype.umod=function(f){return this.divmod(f,"mod",!0).mod},s.prototype.divRound=function(f){var l=this.divmod(f);if(l.mod.isZero())return l.div;var g=l.div.negative!==0?l.mod.isub(f):l.mod,b=f.ushrn(1),v=f.andln(1),x=g.cmp(b);return x<0||v===1&&x===0?l.div:l.div.negative!==0?l.div.isubn(1):l.div.iaddn(1)},s.prototype.modn=function(f){n(f<=67108863);for(var l=(1<<26)%f,g=0,b=this.length-1;b>=0;b--)g=(l*g+(this.words[b]|0))%f;return g},s.prototype.idivn=function(f){n(f<=67108863);for(var l=0,g=this.length-1;g>=0;g--){var b=(this.words[g]|0)+l*67108864;this.words[g]=b/f|0,l=b%f}return this.strip()},s.prototype.divn=function(f){return this.clone().idivn(f)},s.prototype.egcd=function(f){n(f.negative===0),n(!f.isZero());var l=this,g=f.clone();l.negative!==0?l=l.umod(f):l=l.clone();for(var b=new s(1),v=new s(0),x=new s(0),I=new s(1),m=0;l.isEven()&&g.isEven();)l.iushrn(1),g.iushrn(1),++m;for(var h=g.clone(),E=l.clone();!l.isZero();){for(var C=0,F=1;(l.words[0]&F)===0&&C<26;++C,F<<=1);if(C>0)for(l.iushrn(C);C-- >0;)(b.isOdd()||v.isOdd())&&(b.iadd(h),v.isub(E)),b.iushrn(1),v.iushrn(1);for(var k=0,q=1;(g.words[0]&q)===0&&k<26;++k,q<<=1);if(k>0)for(g.iushrn(k);k-- >0;)(x.isOdd()||I.isOdd())&&(x.iadd(h),I.isub(E)),x.iushrn(1),I.iushrn(1);l.cmp(g)>=0?(l.isub(g),b.isub(x),v.isub(I)):(g.isub(l),x.isub(b),I.isub(v))}return{a:x,b:I,gcd:g.iushln(m)}},s.prototype._invmp=function(f){n(f.negative===0),n(!f.isZero());var l=this,g=f.clone();l.negative!==0?l=l.umod(f):l=l.clone();for(var b=new s(1),v=new s(0),x=g.clone();l.cmpn(1)>0&&g.cmpn(1)>0;){for(var I=0,m=1;(l.words[0]&m)===0&&I<26;++I,m<<=1);if(I>0)for(l.iushrn(I);I-- >0;)b.isOdd()&&b.iadd(x),b.iushrn(1);for(var h=0,E=1;(g.words[0]&E)===0&&h<26;++h,E<<=1);if(h>0)for(g.iushrn(h);h-- >0;)v.isOdd()&&v.iadd(x),v.iushrn(1);l.cmp(g)>=0?(l.isub(g),b.isub(v)):(g.isub(l),v.isub(b))}var C;return l.cmpn(1)===0?C=b:C=v,C.cmpn(0)<0&&C.iadd(f),C},s.prototype.gcd=function(f){if(this.isZero())return f.abs();if(f.isZero())return this.abs();var l=this.clone(),g=f.clone();l.negative=0,g.negative=0;for(var b=0;l.isEven()&&g.isEven();b++)l.iushrn(1),g.iushrn(1);do{for(;l.isEven();)l.iushrn(1);for(;g.isEven();)g.iushrn(1);var v=l.cmp(g);if(v<0){var x=l;l=g,g=x}else if(v===0||g.cmpn(1)===0)break;l.isub(g)}while(!0);return g.iushln(b)},s.prototype.invm=function(f){return this.egcd(f).a.umod(f)},s.prototype.isEven=function(){return(this.words[0]&1)===0},s.prototype.isOdd=function(){return(this.words[0]&1)===1},s.prototype.andln=function(f){return this.words[0]&f},s.prototype.bincn=function(f){n(typeof f=="number");var l=f%26,g=(f-l)/26,b=1<<l;if(this.length<=g)return this._expand(g+1),this.words[g]|=b,this;for(var v=b,x=g;v!==0&&x<this.length;x++){var I=this.words[x]|0;I+=v,v=I>>>26,I&=67108863,this.words[x]=I}return v!==0&&(this.words[x]=v,this.length++),this},s.prototype.isZero=function(){return this.length===1&&this.words[0]===0},s.prototype.cmpn=function(f){var l=f<0;if(this.negative!==0&&!l)return-1;if(this.negative===0&&l)return 1;this.strip();var g;if(this.length>1)g=1;else{l&&(f=-f),n(f<=67108863,"Number is too big");var b=this.words[0]|0;g=b===f?0:b<f?-1:1}return this.negative!==0?-g|0:g},s.prototype.cmp=function(f){if(this.negative!==0&&f.negative===0)return-1;if(this.negative===0&&f.negative!==0)return 1;var l=this.ucmp(f);return this.negative!==0?-l|0:l},s.prototype.ucmp=function(f){if(this.length>f.length)return 1;if(this.length<f.length)return-1;for(var l=0,g=this.length-1;g>=0;g--){var b=this.words[g]|0,v=f.words[g]|0;if(b!==v){b<v?l=-1:b>v&&(l=1);break}}return l},s.prototype.gtn=function(f){return this.cmpn(f)===1},s.prototype.gt=function(f){return this.cmp(f)===1},s.prototype.gten=function(f){return this.cmpn(f)>=0},s.prototype.gte=function(f){return this.cmp(f)>=0},s.prototype.ltn=function(f){return this.cmpn(f)===-1},s.prototype.lt=function(f){return this.cmp(f)===-1},s.prototype.lten=function(f){return this.cmpn(f)<=0},s.prototype.lte=function(f){return this.cmp(f)<=0},s.prototype.eqn=function(f){return this.cmpn(f)===0},s.prototype.eq=function(f){return this.cmp(f)===0},s.red=function(f){return new N(f)},s.prototype.toRed=function(f){return n(!this.red,"Already a number in reduction context"),n(this.negative===0,"red works only with positives"),f.convertTo(this)._forceRed(f)},s.prototype.fromRed=function(){return n(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},s.prototype._forceRed=function(f){return this.red=f,this},s.prototype.forceRed=function(f){return n(!this.red,"Already a number in reduction context"),this._forceRed(f)},s.prototype.redAdd=function(f){return n(this.red,"redAdd works only with red numbers"),this.red.add(this,f)},s.prototype.redIAdd=function(f){return n(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,f)},s.prototype.redSub=function(f){return n(this.red,"redSub works only with red numbers"),this.red.sub(this,f)},s.prototype.redISub=function(f){return n(this.red,"redISub works only with red numbers"),this.red.isub(this,f)},s.prototype.redShl=function(f){return n(this.red,"redShl works only with red numbers"),this.red.shl(this,f)},s.prototype.redMul=function(f){return n(this.red,"redMul works only with red numbers"),this.red._verify2(this,f),this.red.mul(this,f)},s.prototype.redIMul=function(f){return n(this.red,"redMul works only with red numbers"),this.red._verify2(this,f),this.red.imul(this,f)},s.prototype.redSqr=function(){return n(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},s.prototype.redISqr=function(){return n(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},s.prototype.redSqrt=function(){return n(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},s.prototype.redInvm=function(){return n(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},s.prototype.redNeg=function(){return n(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},s.prototype.redPow=function(f){return n(this.red&&!f.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,f)};var B={k256:null,p224:null,p192:null,p25519:null};function P(S,f){this.name=S,this.p=new s(f,16),this.n=this.p.bitLength(),this.k=new s(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}P.prototype._tmp=function(){var f=new s(null);return f.words=new Array(Math.ceil(this.n/13)),f},P.prototype.ireduce=function(f){var l=f,g;do this.split(l,this.tmp),l=this.imulK(l),l=l.iadd(this.tmp),g=l.bitLength();while(g>this.n);var b=g<this.n?-1:l.ucmp(this.p);return b===0?(l.words[0]=0,l.length=1):b>0?l.isub(this.p):l.strip!==void 0?l.strip():l._strip(),l},P.prototype.split=function(f,l){f.iushrn(this.n,0,l)},P.prototype.imulK=function(f){return f.imul(this.k)};function j(){P.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}i(j,P),j.prototype.split=function(f,l){for(var g=4194303,b=Math.min(f.length,9),v=0;v<b;v++)l.words[v]=f.words[v];if(l.length=b,f.length<=9){f.words[0]=0,f.length=1;return}var x=f.words[9];for(l.words[l.length++]=x&g,v=10;v<f.length;v++){var I=f.words[v]|0;f.words[v-10]=(I&g)<<4|x>>>22,x=I}x>>>=22,f.words[v-10]=x,x===0&&f.length>10?f.length-=10:f.length-=9},j.prototype.imulK=function(f){f.words[f.length]=0,f.words[f.length+1]=0,f.length+=2;for(var l=0,g=0;g<f.length;g++){var b=f.words[g]|0;l+=b*977,f.words[g]=l&67108863,l=b*64+(l/67108864|0)}return f.words[f.length-1]===0&&(f.length--,f.words[f.length-1]===0&&f.length--),f};function $(){P.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}i($,P);function L(){P.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}i(L,P);function z(){P.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}i(z,P),z.prototype.imulK=function(f){for(var l=0,g=0;g<f.length;g++){var b=(f.words[g]|0)*19+l,v=b&67108863;b>>>=26,f.words[g]=v,l=b}return l!==0&&(f.words[f.length++]=l),f},s._prime=function(f){if(B[f])return B[f];var l;if(f==="k256")l=new j;else if(f==="p224")l=new $;else if(f==="p192")l=new L;else if(f==="p25519")l=new z;else throw new Error("Unknown prime "+f);return B[f]=l,l};function N(S){if(typeof S=="string"){var f=s._prime(S);this.m=f.p,this.prime=f}else n(S.gtn(1),"modulus must be greater than 1"),this.m=S,this.prime=null}N.prototype._verify1=function(f){n(f.negative===0,"red works only with positives"),n(f.red,"red works only with red numbers")},N.prototype._verify2=function(f,l){n((f.negative|l.negative)===0,"red works only with positives"),n(f.red&&f.red===l.red,"red works only with red numbers")},N.prototype.imod=function(f){return this.prime?this.prime.ireduce(f)._forceRed(this):f.umod(this.m)._forceRed(this)},N.prototype.neg=function(f){return f.isZero()?f.clone():this.m.sub(f)._forceRed(this)},N.prototype.add=function(f,l){this._verify2(f,l);var g=f.add(l);return g.cmp(this.m)>=0&&g.isub(this.m),g._forceRed(this)},N.prototype.iadd=function(f,l){this._verify2(f,l);var g=f.iadd(l);return g.cmp(this.m)>=0&&g.isub(this.m),g},N.prototype.sub=function(f,l){this._verify2(f,l);var g=f.sub(l);return g.cmpn(0)<0&&g.iadd(this.m),g._forceRed(this)},N.prototype.isub=function(f,l){this._verify2(f,l);var g=f.isub(l);return g.cmpn(0)<0&&g.iadd(this.m),g},N.prototype.shl=function(f,l){return this._verify1(f),this.imod(f.ushln(l))},N.prototype.imul=function(f,l){return this._verify2(f,l),this.imod(f.imul(l))},N.prototype.mul=function(f,l){return this._verify2(f,l),this.imod(f.mul(l))},N.prototype.isqr=function(f){return this.imul(f,f.clone())},N.prototype.sqr=function(f){return this.mul(f,f)},N.prototype.sqrt=function(f){if(f.isZero())return f.clone();var l=this.m.andln(3);if(n(l%2===1),l===3){var g=this.m.add(new s(1)).iushrn(2);return this.pow(f,g)}for(var b=this.m.subn(1),v=0;!b.isZero()&&b.andln(1)===0;)v++,b.iushrn(1);n(!b.isZero());var x=new s(1).toRed(this),I=x.redNeg(),m=this.m.subn(1).iushrn(1),h=this.m.bitLength();for(h=new s(2*h*h).toRed(this);this.pow(h,m).cmp(I)!==0;)h.redIAdd(I);for(var E=this.pow(h,b),C=this.pow(f,b.addn(1).iushrn(1)),F=this.pow(f,b),k=v;F.cmp(x)!==0;){for(var q=F,W=0;q.cmp(x)!==0;W++)q=q.redSqr();n(W<k);var X=this.pow(E,new s(1).iushln(k-W-1));C=C.redMul(X),E=X.redSqr(),F=F.redMul(E),k=W}return C},N.prototype.invm=function(f){var l=f._invmp(this.m);return l.negative!==0?(l.negative=0,this.imod(l).redNeg()):this.imod(l)},N.prototype.pow=function(f,l){if(l.isZero())return new s(1).toRed(this);if(l.cmpn(1)===0)return f.clone();var g=4,b=new Array(1<<g);b[0]=new s(1).toRed(this),b[1]=f;for(var v=2;v<b.length;v++)b[v]=this.mul(b[v-1],f);var x=b[0],I=0,m=0,h=l.bitLength()%26;for(h===0&&(h=26),v=l.length-1;v>=0;v--){for(var E=l.words[v],C=h-1;C>=0;C--){var F=E>>C&1;if(x!==b[0]&&(x=this.sqr(x)),F===0&&I===0){m=0;continue}I<<=1,I|=F,m++,!(m!==g&&(v!==0||C!==0))&&(x=this.mul(x,b[I]),m=0,I=0)}h=26}return x},N.prototype.convertTo=function(f){var l=f.umod(this.m);return l===f?l.clone():l},N.prototype.convertFrom=function(f){var l=f.clone();return l.red=null,l},s.mont=function(f){return new K(f)};function K(S){N.call(this,S),this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new s(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}i(K,N),K.prototype.convertTo=function(f){return this.imod(f.ushln(this.shift))},K.prototype.convertFrom=function(f){var l=this.imod(f.mul(this.rinv));return l.red=null,l},K.prototype.imul=function(f,l){if(f.isZero()||l.isZero())return f.words[0]=0,f.length=1,f;var g=f.imul(l),b=g.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),v=g.isub(b).iushrn(this.shift),x=v;return v.cmp(this.m)>=0?x=v.isub(this.m):v.cmpn(0)<0&&(x=v.iadd(this.m)),x._forceRed(this)},K.prototype.mul=function(f,l){if(f.isZero()||l.isZero())return new s(0)._forceRed(this);var g=f.mul(l),b=g.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),v=g.isub(b).iushrn(this.shift),x=v;return v.cmp(this.m)>=0?x=v.isub(this.m):v.cmpn(0)<0&&(x=v.iadd(this.m)),x._forceRed(this)},K.prototype.invm=function(f){var l=this.imod(f._invmp(this.m).mul(this.r2));return l._forceRed(this)}})(t,_t)})(hr);var pn=md;function md(t,e){if(!t)throw new Error(e||"Assertion failed")}md.equal=function(e,r,n){if(e!=r)throw new Error(n||"Assertion failed: "+e+" != "+r)};var Ya={};(function(t){var e=t;function r(s,o){if(Array.isArray(s))return s.slice();if(!s)return[];var a=[];if(typeof s!="string"){for(var c=0;c<s.length;c++)a[c]=s[c]|0;return a}if(o==="hex"){s=s.replace(/[^a-z0-9]+/ig,""),s.length%2!==0&&(s="0"+s);for(var c=0;c<s.length;c+=2)a.push(parseInt(s[c]+s[c+1],16))}else for(var c=0;c<s.length;c++){var u=s.charCodeAt(c),d=u>>8,p=u&255;d?a.push(d,p):a.push(p)}return a}e.toArray=r;function n(s){return s.length===1?"0"+s:s}e.zero2=n;function i(s){for(var o="",a=0;a<s.length;a++)o+=n(s[a].toString(16));return o}e.toHex=i,e.encode=function(o,a){return a==="hex"?i(o):o}})(Ya),function(t){var e=t,r=hr.exports,n=pn,i=Ya;e.assert=n,e.toArray=i.toArray,e.zero2=i.zero2,e.toHex=i.toHex,e.encode=i.encode;function s(d,p,y){var _=new Array(Math.max(d.bitLength(),y)+1),w;for(w=0;w<_.length;w+=1)_[w]=0;var D=1<<p+1,O=d.clone();for(w=0;w<_.length;w++){var M,T=O.andln(D-1);O.isOdd()?(T>(D>>1)-1?M=(D>>1)-T:M=T,O.isubn(M)):M=0,_[w]=M,O.iushrn(1)}return _}e.getNAF=s;function o(d,p){var y=[[],[]];d=d.clone(),p=p.clone();for(var _=0,w=0,D;d.cmpn(-_)>0||p.cmpn(-w)>0;){var O=d.andln(3)+_&3,M=p.andln(3)+w&3;O===3&&(O=-1),M===3&&(M=-1);var T;(O&1)===0?T=0:(D=d.andln(7)+_&7,(D===3||D===5)&&M===2?T=-O:T=O),y[0].push(T);var B;(M&1)===0?B=0:(D=p.andln(7)+w&7,(D===3||D===5)&&O===2?B=-M:B=M),y[1].push(B),2*_===T+1&&(_=1-_),2*w===B+1&&(w=1-w),d.iushrn(1),p.iushrn(1)}return y}e.getJSF=o;function a(d,p,y){var _="_"+p;d.prototype[p]=function(){return this[_]!==void 0?this[_]:this[_]=y.call(this)}}e.cachedProperty=a;function c(d){return typeof d=="string"?e.toArray(d,"hex"):d}e.parseBytes=c;function u(d){return new r(d,"hex","le")}e.intFromLE=u}(Lt);var Ks={exports:{}},Xa;Ks.exports=function(e){return Xa||(Xa=new qr(null)),Xa.generate(e)};function qr(t){this.rand=t}if(Ks.exports.Rand=qr,qr.prototype.generate=function(e){return this._rand(e)},qr.prototype._rand=function(e){if(this.rand.getBytes)return this.rand.getBytes(e);for(var r=new Uint8Array(e),n=0;n<r.length;n++)r[n]=this.rand.getByte();return r},typeof self=="object")self.crypto&&self.crypto.getRandomValues?qr.prototype._rand=function(e){var r=new Uint8Array(e);return self.crypto.getRandomValues(r),r}:self.msCrypto&&self.msCrypto.getRandomValues?qr.prototype._rand=function(e){var r=new Uint8Array(e);return self.msCrypto.getRandomValues(r),r}:typeof window=="object"&&(qr.prototype._rand=function(){throw new Error("Not implemented yet")});else try{var wd=yd;if(typeof wd.randomBytes!="function")throw new Error("Not supported");qr.prototype._rand=function(e){return wd.randomBytes(e)}}catch{}var Za={},bn=hr.exports,Pi=Lt,Vs=Pi.getNAF,J8=Pi.getJSF,Ws=Pi.assert;function Hr(t,e){this.type=t,this.p=new bn(e.p,16),this.red=e.prime?bn.red(e.prime):bn.mont(this.p),this.zero=new bn(0).toRed(this.red),this.one=new bn(1).toRed(this.red),this.two=new bn(2).toRed(this.red),this.n=e.n&&new bn(e.n,16),this.g=e.g&&this.pointFromJSON(e.g,e.gRed),this._wnafT1=new Array(4),this._wnafT2=new Array(4),this._wnafT3=new Array(4),this._wnafT4=new Array(4),this._bitLength=this.n?this.n.bitLength():0;var r=this.n&&this.p.div(this.n);!r||r.cmpn(100)>0?this.redN=null:(this._maxwellTrick=!0,this.redN=this.n.toRed(this.red))}var Gs=Hr;Hr.prototype.point=function(){throw new Error("Not implemented")},Hr.prototype.validate=function(){throw new Error("Not implemented")},Hr.prototype._fixedNafMul=function(e,r){Ws(e.precomputed);var n=e._getDoubles(),i=Vs(r,1,this._bitLength),s=(1<<n.step+1)-(n.step%2===0?2:1);s/=3;var o=[],a,c;for(a=0;a<i.length;a+=n.step){c=0;for(var u=a+n.step-1;u>=a;u--)c=(c<<1)+i[u];o.push(c)}for(var d=this.jpoint(null,null,null),p=this.jpoint(null,null,null),y=s;y>0;y--){for(a=0;a<o.length;a++)c=o[a],c===y?p=p.mixedAdd(n.points[a]):c===-y&&(p=p.mixedAdd(n.points[a].neg()));d=d.add(p)}return d.toP()},Hr.prototype._wnafMul=function(e,r){var n=4,i=e._getNAFPoints(n);n=i.wnd;for(var s=i.points,o=Vs(r,n,this._bitLength),a=this.jpoint(null,null,null),c=o.length-1;c>=0;c--){for(var u=0;c>=0&&o[c]===0;c--)u++;if(c>=0&&u++,a=a.dblp(u),c<0)break;var d=o[c];Ws(d!==0),e.type==="affine"?d>0?a=a.mixedAdd(s[d-1>>1]):a=a.mixedAdd(s[-d-1>>1].neg()):d>0?a=a.add(s[d-1>>1]):a=a.add(s[-d-1>>1].neg())}return e.type==="affine"?a.toP():a},Hr.prototype._wnafMulAdd=function(e,r,n,i,s){var o=this._wnafT1,a=this._wnafT2,c=this._wnafT3,u=0,d,p,y;for(d=0;d<i;d++){y=r[d];var _=y._getNAFPoints(e);o[d]=_.wnd,a[d]=_.points}for(d=i-1;d>=1;d-=2){var w=d-1,D=d;if(o[w]!==1||o[D]!==1){c[w]=Vs(n[w],o[w],this._bitLength),c[D]=Vs(n[D],o[D],this._bitLength),u=Math.max(c[w].length,u),u=Math.max(c[D].length,u);continue}var O=[r[w],null,null,r[D]];r[w].y.cmp(r[D].y)===0?(O[1]=r[w].add(r[D]),O[2]=r[w].toJ().mixedAdd(r[D].neg())):r[w].y.cmp(r[D].y.redNeg())===0?(O[1]=r[w].toJ().mixedAdd(r[D]),O[2]=r[w].add(r[D].neg())):(O[1]=r[w].toJ().mixedAdd(r[D]),O[2]=r[w].toJ().mixedAdd(r[D].neg()));var M=[-3,-1,-5,-7,0,7,5,1,3],T=J8(n[w],n[D]);for(u=Math.max(T[0].length,u),c[w]=new Array(u),c[D]=new Array(u),p=0;p<u;p++){var B=T[0][p]|0,P=T[1][p]|0;c[w][p]=M[(B+1)*3+(P+1)],c[D][p]=0,a[w]=O}}var j=this.jpoint(null,null,null),$=this._wnafT4;for(d=u;d>=0;d--){for(var L=0;d>=0;){var z=!0;for(p=0;p<i;p++)$[p]=c[p][d]|0,$[p]!==0&&(z=!1);if(!z)break;L++,d--}if(d>=0&&L++,j=j.dblp(L),d<0)break;for(p=0;p<i;p++){var N=$[p];N!==0&&(N>0?y=a[p][N-1>>1]:N<0&&(y=a[p][-N-1>>1].neg()),y.type==="affine"?j=j.mixedAdd(y):j=j.add(y))}}for(d=0;d<i;d++)a[d]=null;return s?j:j.toP()};function Ht(t,e){this.curve=t,this.type=e,this.precomputed=null}Hr.BasePoint=Ht,Ht.prototype.eq=function(){throw new Error("Not implemented")},Ht.prototype.validate=function(){return this.curve.validate(this)},Hr.prototype.decodePoint=function(e,r){e=Pi.toArray(e,r);var n=this.p.byteLength();if((e[0]===4||e[0]===6||e[0]===7)&&e.length-1===2*n){e[0]===6?Ws(e[e.length-1]%2===0):e[0]===7&&Ws(e[e.length-1]%2===1);var i=this.point(e.slice(1,1+n),e.slice(1+n,1+2*n));return i}else if((e[0]===2||e[0]===3)&&e.length-1===n)return this.pointFromX(e.slice(1,1+n),e[0]===3);throw new Error("Unknown point format")},Ht.prototype.encodeCompressed=function(e){return this.encode(e,!0)},Ht.prototype._encode=function(e){var r=this.curve.p.byteLength(),n=this.getX().toArray("be",r);return e?[this.getY().isEven()?2:3].concat(n):[4].concat(n,this.getY().toArray("be",r))},Ht.prototype.encode=function(e,r){return Pi.encode(this._encode(r),e)},Ht.prototype.precompute=function(e){if(this.precomputed)return this;var r={doubles:null,naf:null,beta:null};return r.naf=this._getNAFPoints(8),r.doubles=this._getDoubles(4,e),r.beta=this._getBeta(),this.precomputed=r,this},Ht.prototype._hasDoubles=function(e){if(!this.precomputed)return!1;var r=this.precomputed.doubles;return r?r.points.length>=Math.ceil((e.bitLength()+1)/r.step):!1},Ht.prototype._getDoubles=function(e,r){if(this.precomputed&&this.precomputed.doubles)return this.precomputed.doubles;for(var n=[this],i=this,s=0;s<r;s+=e){for(var o=0;o<e;o++)i=i.dbl();n.push(i)}return{step:e,points:n}},Ht.prototype._getNAFPoints=function(e){if(this.precomputed&&this.precomputed.naf)return this.precomputed.naf;for(var r=[this],n=(1<<e)-1,i=n===1?null:this.dbl(),s=1;s<n;s++)r[s]=r[s-1].add(i);return{wnd:e,points:r}},Ht.prototype._getBeta=function(){return null},Ht.prototype.dblp=function(e){for(var r=this,n=0;n<e;n++)r=r.dbl();return r};var Wn={exports:{}};typeof Object.create=="function"?Wn.exports=function(e,r){r&&(e.super_=r,e.prototype=Object.create(r.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:Wn.exports=function(e,r){if(r){e.super_=r;var n=function(){};n.prototype=r.prototype,e.prototype=new n,e.prototype.constructor=e}};var Q8=Lt,Fe=hr.exports,Ja=Wn.exports,Gn=Gs,em=Q8.assert;function Kt(t){Gn.call(this,"short",t),this.a=new Fe(t.a,16).toRed(this.red),this.b=new Fe(t.b,16).toRed(this.red),this.tinv=this.two.redInvm(),this.zeroA=this.a.fromRed().cmpn(0)===0,this.threeA=this.a.fromRed().sub(this.p).cmpn(-3)===0,this.endo=this._getEndomorphism(t),this._endoWnafT1=new Array(4),this._endoWnafT2=new Array(4)}Ja(Kt,Gn);var tm=Kt;Kt.prototype._getEndomorphism=function(e){if(!(!this.zeroA||!this.g||!this.n||this.p.modn(3)!==1)){var r,n;if(e.beta)r=new Fe(e.beta,16).toRed(this.red);else{var i=this._getEndoRoots(this.p);r=i[0].cmp(i[1])<0?i[0]:i[1],r=r.toRed(this.red)}if(e.lambda)n=new Fe(e.lambda,16);else{var s=this._getEndoRoots(this.n);this.g.mul(s[0]).x.cmp(this.g.x.redMul(r))===0?n=s[0]:(n=s[1],em(this.g.mul(n).x.cmp(this.g.x.redMul(r))===0))}var o;return e.basis?o=e.basis.map(function(a){return{a:new Fe(a.a,16),b:new Fe(a.b,16)}}):o=this._getEndoBasis(n),{beta:r,lambda:n,basis:o}}},Kt.prototype._getEndoRoots=function(e){var r=e===this.p?this.red:Fe.mont(e),n=new Fe(2).toRed(r).redInvm(),i=n.redNeg(),s=new Fe(3).toRed(r).redNeg().redSqrt().redMul(n),o=i.redAdd(s).fromRed(),a=i.redSub(s).fromRed();return[o,a]},Kt.prototype._getEndoBasis=function(e){for(var r=this.n.ushrn(Math.floor(this.n.bitLength()/2)),n=e,i=this.n.clone(),s=new Fe(1),o=new Fe(0),a=new Fe(0),c=new Fe(1),u,d,p,y,_,w,D,O=0,M,T;n.cmpn(0)!==0;){var B=i.div(n);M=i.sub(B.mul(n)),T=a.sub(B.mul(s));var P=c.sub(B.mul(o));if(!p&&M.cmp(r)<0)u=D.neg(),d=s,p=M.neg(),y=T;else if(p&&++O===2)break;D=M,i=n,n=M,a=s,s=T,c=o,o=P}_=M.neg(),w=T;var j=p.sqr().add(y.sqr()),$=_.sqr().add(w.sqr());return $.cmp(j)>=0&&(_=u,w=d),p.negative&&(p=p.neg(),y=y.neg()),_.negative&&(_=_.neg(),w=w.neg()),[{a:p,b:y},{a:_,b:w}]},Kt.prototype._endoSplit=function(e){var r=this.endo.basis,n=r[0],i=r[1],s=i.b.mul(e).divRound(this.n),o=n.b.neg().mul(e).divRound(this.n),a=s.mul(n.a),c=o.mul(i.a),u=s.mul(n.b),d=o.mul(i.b),p=e.sub(a).sub(c),y=u.add(d).neg();return{k1:p,k2:y}},Kt.prototype.pointFromX=function(e,r){e=new Fe(e,16),e.red||(e=e.toRed(this.red));var n=e.redSqr().redMul(e).redIAdd(e.redMul(this.a)).redIAdd(this.b),i=n.redSqrt();if(i.redSqr().redSub(n).cmp(this.zero)!==0)throw new Error("invalid point");var s=i.fromRed().isOdd();return(r&&!s||!r&&s)&&(i=i.redNeg()),this.point(e,i)},Kt.prototype.validate=function(e){if(e.inf)return!0;var r=e.x,n=e.y,i=this.a.redMul(r),s=r.redSqr().redMul(r).redIAdd(i).redIAdd(this.b);return n.redSqr().redISub(s).cmpn(0)===0},Kt.prototype._endoWnafMulAdd=function(e,r,n){for(var i=this._endoWnafT1,s=this._endoWnafT2,o=0;o<e.length;o++){var a=this._endoSplit(r[o]),c=e[o],u=c._getBeta();a.k1.negative&&(a.k1.ineg(),c=c.neg(!0)),a.k2.negative&&(a.k2.ineg(),u=u.neg(!0)),i[o*2]=c,i[o*2+1]=u,s[o*2]=a.k1,s[o*2+1]=a.k2}for(var d=this._wnafMulAdd(1,i,s,o*2,n),p=0;p<o*2;p++)i[p]=null,s[p]=null;return d};function it(t,e,r,n){Gn.BasePoint.call(this,t,"affine"),e===null&&r===null?(this.x=null,this.y=null,this.inf=!0):(this.x=new Fe(e,16),this.y=new Fe(r,16),n&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}Ja(it,Gn.BasePoint),Kt.prototype.point=function(e,r,n){return new it(this,e,r,n)},Kt.prototype.pointFromJSON=function(e,r){return it.fromJSON(this,e,r)},it.prototype._getBeta=function(){if(this.curve.endo){var e=this.precomputed;if(e&&e.beta)return e.beta;var r=this.curve.point(this.x.redMul(this.curve.endo.beta),this.y);if(e){var n=this.curve,i=function(s){return n.point(s.x.redMul(n.endo.beta),s.y)};e.beta=r,r.precomputed={beta:null,naf:e.naf&&{wnd:e.naf.wnd,points:e.naf.points.map(i)},doubles:e.doubles&&{step:e.doubles.step,points:e.doubles.points.map(i)}}}return r}},it.prototype.toJSON=function(){return this.precomputed?[this.x,this.y,this.precomputed&&{doubles:this.precomputed.doubles&&{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)},naf:this.precomputed.naf&&{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}}]:[this.x,this.y]},it.fromJSON=function(e,r,n){typeof r=="string"&&(r=JSON.parse(r));var i=e.point(r[0],r[1],n);if(!r[2])return i;function s(a){return e.point(a[0],a[1],n)}var o=r[2];return i.precomputed={beta:null,doubles:o.doubles&&{step:o.doubles.step,points:[i].concat(o.doubles.points.map(s))},naf:o.naf&&{wnd:o.naf.wnd,points:[i].concat(o.naf.points.map(s))}},i},it.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+">"},it.prototype.isInfinity=function(){return this.inf},it.prototype.add=function(e){if(this.inf)return e;if(e.inf)return this;if(this.eq(e))return this.dbl();if(this.neg().eq(e))return this.curve.point(null,null);if(this.x.cmp(e.x)===0)return this.curve.point(null,null);var r=this.y.redSub(e.y);r.cmpn(0)!==0&&(r=r.redMul(this.x.redSub(e.x).redInvm()));var n=r.redSqr().redISub(this.x).redISub(e.x),i=r.redMul(this.x.redSub(n)).redISub(this.y);return this.curve.point(n,i)},it.prototype.dbl=function(){if(this.inf)return this;var e=this.y.redAdd(this.y);if(e.cmpn(0)===0)return this.curve.point(null,null);var r=this.curve.a,n=this.x.redSqr(),i=e.redInvm(),s=n.redAdd(n).redIAdd(n).redIAdd(r).redMul(i),o=s.redSqr().redISub(this.x.redAdd(this.x)),a=s.redMul(this.x.redSub(o)).redISub(this.y);return this.curve.point(o,a)},it.prototype.getX=function(){return this.x.fromRed()},it.prototype.getY=function(){return this.y.fromRed()},it.prototype.mul=function(e){return e=new Fe(e,16),this.isInfinity()?this:this._hasDoubles(e)?this.curve._fixedNafMul(this,e):this.curve.endo?this.curve._endoWnafMulAdd([this],[e]):this.curve._wnafMul(this,e)},it.prototype.mulAdd=function(e,r,n){var i=[this,r],s=[e,n];return this.curve.endo?this.curve._endoWnafMulAdd(i,s):this.curve._wnafMulAdd(1,i,s,2)},it.prototype.jmulAdd=function(e,r,n){var i=[this,r],s=[e,n];return this.curve.endo?this.curve._endoWnafMulAdd(i,s,!0):this.curve._wnafMulAdd(1,i,s,2,!0)},it.prototype.eq=function(e){return this===e||this.inf===e.inf&&(this.inf||this.x.cmp(e.x)===0&&this.y.cmp(e.y)===0)},it.prototype.neg=function(e){if(this.inf)return this;var r=this.curve.point(this.x,this.y.redNeg());if(e&&this.precomputed){var n=this.precomputed,i=function(s){return s.neg()};r.precomputed={naf:n.naf&&{wnd:n.naf.wnd,points:n.naf.points.map(i)},doubles:n.doubles&&{step:n.doubles.step,points:n.doubles.points.map(i)}}}return r},it.prototype.toJ=function(){if(this.inf)return this.curve.jpoint(null,null,null);var e=this.curve.jpoint(this.x,this.y,this.curve.one);return e};function dt(t,e,r,n){Gn.BasePoint.call(this,t,"jacobian"),e===null&&r===null&&n===null?(this.x=this.curve.one,this.y=this.curve.one,this.z=new Fe(0)):(this.x=new Fe(e,16),this.y=new Fe(r,16),this.z=new Fe(n,16)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z===this.curve.one}Ja(dt,Gn.BasePoint),Kt.prototype.jpoint=function(e,r,n){return new dt(this,e,r,n)},dt.prototype.toP=function(){if(this.isInfinity())return this.curve.point(null,null);var e=this.z.redInvm(),r=e.redSqr(),n=this.x.redMul(r),i=this.y.redMul(r).redMul(e);return this.curve.point(n,i)},dt.prototype.neg=function(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)},dt.prototype.add=function(e){if(this.isInfinity())return e;if(e.isInfinity())return this;var r=e.z.redSqr(),n=this.z.redSqr(),i=this.x.redMul(r),s=e.x.redMul(n),o=this.y.redMul(r.redMul(e.z)),a=e.y.redMul(n.redMul(this.z)),c=i.redSub(s),u=o.redSub(a);if(c.cmpn(0)===0)return u.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var d=c.redSqr(),p=d.redMul(c),y=i.redMul(d),_=u.redSqr().redIAdd(p).redISub(y).redISub(y),w=u.redMul(y.redISub(_)).redISub(o.redMul(p)),D=this.z.redMul(e.z).redMul(c);return this.curve.jpoint(_,w,D)},dt.prototype.mixedAdd=function(e){if(this.isInfinity())return e.toJ();if(e.isInfinity())return this;var r=this.z.redSqr(),n=this.x,i=e.x.redMul(r),s=this.y,o=e.y.redMul(r).redMul(this.z),a=n.redSub(i),c=s.redSub(o);if(a.cmpn(0)===0)return c.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var u=a.redSqr(),d=u.redMul(a),p=n.redMul(u),y=c.redSqr().redIAdd(d).redISub(p).redISub(p),_=c.redMul(p.redISub(y)).redISub(s.redMul(d)),w=this.z.redMul(a);return this.curve.jpoint(y,_,w)},dt.prototype.dblp=function(e){if(e===0)return this;if(this.isInfinity())return this;if(!e)return this.dbl();var r;if(this.curve.zeroA||this.curve.threeA){var n=this;for(r=0;r<e;r++)n=n.dbl();return n}var i=this.curve.a,s=this.curve.tinv,o=this.x,a=this.y,c=this.z,u=c.redSqr().redSqr(),d=a.redAdd(a);for(r=0;r<e;r++){var p=o.redSqr(),y=d.redSqr(),_=y.redSqr(),w=p.redAdd(p).redIAdd(p).redIAdd(i.redMul(u)),D=o.redMul(y),O=w.redSqr().redISub(D.redAdd(D)),M=D.redISub(O),T=w.redMul(M);T=T.redIAdd(T).redISub(_);var B=d.redMul(c);r+1<e&&(u=u.redMul(_)),o=O,c=B,d=T}return this.curve.jpoint(o,d.redMul(s),c)},dt.prototype.dbl=function(){return this.isInfinity()?this:this.curve.zeroA?this._zeroDbl():this.curve.threeA?this._threeDbl():this._dbl()},dt.prototype._zeroDbl=function(){var e,r,n;if(this.zOne){var i=this.x.redSqr(),s=this.y.redSqr(),o=s.redSqr(),a=this.x.redAdd(s).redSqr().redISub(i).redISub(o);a=a.redIAdd(a);var c=i.redAdd(i).redIAdd(i),u=c.redSqr().redISub(a).redISub(a),d=o.redIAdd(o);d=d.redIAdd(d),d=d.redIAdd(d),e=u,r=c.redMul(a.redISub(u)).redISub(d),n=this.y.redAdd(this.y)}else{var p=this.x.redSqr(),y=this.y.redSqr(),_=y.redSqr(),w=this.x.redAdd(y).redSqr().redISub(p).redISub(_);w=w.redIAdd(w);var D=p.redAdd(p).redIAdd(p),O=D.redSqr(),M=_.redIAdd(_);M=M.redIAdd(M),M=M.redIAdd(M),e=O.redISub(w).redISub(w),r=D.redMul(w.redISub(e)).redISub(M),n=this.y.redMul(this.z),n=n.redIAdd(n)}return this.curve.jpoint(e,r,n)},dt.prototype._threeDbl=function(){var e,r,n;if(this.zOne){var i=this.x.redSqr(),s=this.y.redSqr(),o=s.redSqr(),a=this.x.redAdd(s).redSqr().redISub(i).redISub(o);a=a.redIAdd(a);var c=i.redAdd(i).redIAdd(i).redIAdd(this.curve.a),u=c.redSqr().redISub(a).redISub(a);e=u;var d=o.redIAdd(o);d=d.redIAdd(d),d=d.redIAdd(d),r=c.redMul(a.redISub(u)).redISub(d),n=this.y.redAdd(this.y)}else{var p=this.z.redSqr(),y=this.y.redSqr(),_=this.x.redMul(y),w=this.x.redSub(p).redMul(this.x.redAdd(p));w=w.redAdd(w).redIAdd(w);var D=_.redIAdd(_);D=D.redIAdd(D);var O=D.redAdd(D);e=w.redSqr().redISub(O),n=this.y.redAdd(this.z).redSqr().redISub(y).redISub(p);var M=y.redSqr();M=M.redIAdd(M),M=M.redIAdd(M),M=M.redIAdd(M),r=w.redMul(D.redISub(e)).redISub(M)}return this.curve.jpoint(e,r,n)},dt.prototype._dbl=function(){var e=this.curve.a,r=this.x,n=this.y,i=this.z,s=i.redSqr().redSqr(),o=r.redSqr(),a=n.redSqr(),c=o.redAdd(o).redIAdd(o).redIAdd(e.redMul(s)),u=r.redAdd(r);u=u.redIAdd(u);var d=u.redMul(a),p=c.redSqr().redISub(d.redAdd(d)),y=d.redISub(p),_=a.redSqr();_=_.redIAdd(_),_=_.redIAdd(_),_=_.redIAdd(_);var w=c.redMul(y).redISub(_),D=n.redAdd(n).redMul(i);return this.curve.jpoint(p,w,D)},dt.prototype.trpl=function(){if(!this.curve.zeroA)return this.dbl().add(this);var e=this.x.redSqr(),r=this.y.redSqr(),n=this.z.redSqr(),i=r.redSqr(),s=e.redAdd(e).redIAdd(e),o=s.redSqr(),a=this.x.redAdd(r).redSqr().redISub(e).redISub(i);a=a.redIAdd(a),a=a.redAdd(a).redIAdd(a),a=a.redISub(o);var c=a.redSqr(),u=i.redIAdd(i);u=u.redIAdd(u),u=u.redIAdd(u),u=u.redIAdd(u);var d=s.redIAdd(a).redSqr().redISub(o).redISub(c).redISub(u),p=r.redMul(d);p=p.redIAdd(p),p=p.redIAdd(p);var y=this.x.redMul(c).redISub(p);y=y.redIAdd(y),y=y.redIAdd(y);var _=this.y.redMul(d.redMul(u.redISub(d)).redISub(a.redMul(c)));_=_.redIAdd(_),_=_.redIAdd(_),_=_.redIAdd(_);var w=this.z.redAdd(a).redSqr().redISub(n).redISub(c);return this.curve.jpoint(y,_,w)},dt.prototype.mul=function(e,r){return e=new Fe(e,r),this.curve._wnafMul(this,e)},dt.prototype.eq=function(e){if(e.type==="affine")return this.eq(e.toJ());if(this===e)return!0;var r=this.z.redSqr(),n=e.z.redSqr();if(this.x.redMul(n).redISub(e.x.redMul(r)).cmpn(0)!==0)return!1;var i=r.redMul(this.z),s=n.redMul(e.z);return this.y.redMul(s).redISub(e.y.redMul(i)).cmpn(0)===0},dt.prototype.eqXToP=function(e){var r=this.z.redSqr(),n=e.toRed(this.curve.red).redMul(r);if(this.x.cmp(n)===0)return!0;for(var i=e.clone(),s=this.curve.redN.redMul(r);;){if(i.iadd(this.curve.n),i.cmp(this.curve.p)>=0)return!1;if(n.redIAdd(s),this.x.cmp(n)===0)return!0}},dt.prototype.inspect=function(){return this.isInfinity()?"<EC JPoint Infinity>":"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"},dt.prototype.isInfinity=function(){return this.z.cmpn(0)===0};var Yn=hr.exports,_d=Wn.exports,Ys=Gs,rm=Lt;function Xn(t){Ys.call(this,"mont",t),this.a=new Yn(t.a,16).toRed(this.red),this.b=new Yn(t.b,16).toRed(this.red),this.i4=new Yn(4).toRed(this.red).redInvm(),this.two=new Yn(2).toRed(this.red),this.a24=this.i4.redMul(this.a.redAdd(this.two))}_d(Xn,Ys);var nm=Xn;Xn.prototype.validate=function(e){var r=e.normalize().x,n=r.redSqr(),i=n.redMul(r).redAdd(n.redMul(this.a)).redAdd(r),s=i.redSqrt();return s.redSqr().cmp(i)===0};function st(t,e,r){Ys.BasePoint.call(this,t,"projective"),e===null&&r===null?(this.x=this.curve.one,this.z=this.curve.zero):(this.x=new Yn(e,16),this.z=new Yn(r,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)))}_d(st,Ys.BasePoint),Xn.prototype.decodePoint=function(e,r){return this.point(rm.toArray(e,r),1)},Xn.prototype.point=function(e,r){return new st(this,e,r)},Xn.prototype.pointFromJSON=function(e){return st.fromJSON(this,e)},st.prototype.precompute=function(){},st.prototype._encode=function(){return this.getX().toArray("be",this.curve.p.byteLength())},st.fromJSON=function(e,r){return new st(e,r[0],r[1]||e.one)},st.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},st.prototype.isInfinity=function(){return this.z.cmpn(0)===0},st.prototype.dbl=function(){var e=this.x.redAdd(this.z),r=e.redSqr(),n=this.x.redSub(this.z),i=n.redSqr(),s=r.redSub(i),o=r.redMul(i),a=s.redMul(i.redAdd(this.curve.a24.redMul(s)));return this.curve.point(o,a)},st.prototype.add=function(){throw new Error("Not supported on Montgomery curve")},st.prototype.diffAdd=function(e,r){var n=this.x.redAdd(this.z),i=this.x.redSub(this.z),s=e.x.redAdd(e.z),o=e.x.redSub(e.z),a=o.redMul(n),c=s.redMul(i),u=r.z.redMul(a.redAdd(c).redSqr()),d=r.x.redMul(a.redISub(c).redSqr());return this.curve.point(u,d)},st.prototype.mul=function(e){for(var r=e.clone(),n=this,i=this.curve.point(null,null),s=this,o=[];r.cmpn(0)!==0;r.iushrn(1))o.push(r.andln(1));for(var a=o.length-1;a>=0;a--)o[a]===0?(n=n.diffAdd(i,s),i=i.dbl()):(i=n.diffAdd(i,s),n=n.dbl());return i},st.prototype.mulAdd=function(){throw new Error("Not supported on Montgomery curve")},st.prototype.jumlAdd=function(){throw new Error("Not supported on Montgomery curve")},st.prototype.eq=function(e){return this.getX().cmp(e.getX())===0},st.prototype.normalize=function(){return this.x=this.x.redMul(this.z.redInvm()),this.z=this.curve.one,this},st.prototype.getX=function(){return this.normalize(),this.x.fromRed()};var im=Lt,Rr=hr.exports,Ed=Wn.exports,Xs=Gs,sm=im.assert;function dr(t){this.twisted=(t.a|0)!==1,this.mOneA=this.twisted&&(t.a|0)===-1,this.extended=this.mOneA,Xs.call(this,"edwards",t),this.a=new Rr(t.a,16).umod(this.red.m),this.a=this.a.toRed(this.red),this.c=new Rr(t.c,16).toRed(this.red),this.c2=this.c.redSqr(),this.d=new Rr(t.d,16).toRed(this.red),this.dd=this.d.redAdd(this.d),sm(!this.twisted||this.c.fromRed().cmpn(1)===0),this.oneC=(t.c|0)===1}Ed(dr,Xs);var om=dr;dr.prototype._mulA=function(e){return this.mOneA?e.redNeg():this.a.redMul(e)},dr.prototype._mulC=function(e){return this.oneC?e:this.c.redMul(e)},dr.prototype.jpoint=function(e,r,n,i){return this.point(e,r,n,i)},dr.prototype.pointFromX=function(e,r){e=new Rr(e,16),e.red||(e=e.toRed(this.red));var n=e.redSqr(),i=this.c2.redSub(this.a.redMul(n)),s=this.one.redSub(this.c2.redMul(this.d).redMul(n)),o=i.redMul(s.redInvm()),a=o.redSqrt();if(a.redSqr().redSub(o).cmp(this.zero)!==0)throw new Error("invalid point");var c=a.fromRed().isOdd();return(r&&!c||!r&&c)&&(a=a.redNeg()),this.point(e,a)},dr.prototype.pointFromY=function(e,r){e=new Rr(e,16),e.red||(e=e.toRed(this.red));var n=e.redSqr(),i=n.redSub(this.c2),s=n.redMul(this.d).redMul(this.c2).redSub(this.a),o=i.redMul(s.redInvm());if(o.cmp(this.zero)===0){if(r)throw new Error("invalid point");return this.point(this.zero,e)}var a=o.redSqrt();if(a.redSqr().redSub(o).cmp(this.zero)!==0)throw new Error("invalid point");return a.fromRed().isOdd()!==r&&(a=a.redNeg()),this.point(a,e)},dr.prototype.validate=function(e){if(e.isInfinity())return!0;e.normalize();var r=e.x.redSqr(),n=e.y.redSqr(),i=r.redMul(this.a).redAdd(n),s=this.c2.redMul(this.one.redAdd(this.d.redMul(r).redMul(n)));return i.cmp(s)===0};function be(t,e,r,n,i){Xs.BasePoint.call(this,t,"projective"),e===null&&r===null&&n===null?(this.x=this.curve.zero,this.y=this.curve.one,this.z=this.curve.one,this.t=this.curve.zero,this.zOne=!0):(this.x=new Rr(e,16),this.y=new Rr(r,16),this.z=n?new Rr(n,16):this.curve.one,this.t=i&&new Rr(i,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.t&&!this.t.red&&(this.t=this.t.toRed(this.curve.red)),this.zOne=this.z===this.curve.one,this.curve.extended&&!this.t&&(this.t=this.x.redMul(this.y),this.zOne||(this.t=this.t.redMul(this.z.redInvm()))))}Ed(be,Xs.BasePoint),dr.prototype.pointFromJSON=function(e){return be.fromJSON(this,e)},dr.prototype.point=function(e,r,n,i){return new be(this,e,r,n,i)},be.fromJSON=function(e,r){return new be(e,r[0],r[1],r[2])},be.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},be.prototype.isInfinity=function(){return this.x.cmpn(0)===0&&(this.y.cmp(this.z)===0||this.zOne&&this.y.cmp(this.curve.c)===0)},be.prototype._extDbl=function(){var e=this.x.redSqr(),r=this.y.redSqr(),n=this.z.redSqr();n=n.redIAdd(n);var i=this.curve._mulA(e),s=this.x.redAdd(this.y).redSqr().redISub(e).redISub(r),o=i.redAdd(r),a=o.redSub(n),c=i.redSub(r),u=s.redMul(a),d=o.redMul(c),p=s.redMul(c),y=a.redMul(o);return this.curve.point(u,d,y,p)},be.prototype._projDbl=function(){var e=this.x.redAdd(this.y).redSqr(),r=this.x.redSqr(),n=this.y.redSqr(),i,s,o,a,c,u;if(this.curve.twisted){a=this.curve._mulA(r);var d=a.redAdd(n);this.zOne?(i=e.redSub(r).redSub(n).redMul(d.redSub(this.curve.two)),s=d.redMul(a.redSub(n)),o=d.redSqr().redSub(d).redSub(d)):(c=this.z.redSqr(),u=d.redSub(c).redISub(c),i=e.redSub(r).redISub(n).redMul(u),s=d.redMul(a.redSub(n)),o=d.redMul(u))}else a=r.redAdd(n),c=this.curve._mulC(this.z).redSqr(),u=a.redSub(c).redSub(c),i=this.curve._mulC(e.redISub(a)).redMul(u),s=this.curve._mulC(a).redMul(r.redISub(n)),o=a.redMul(u);return this.curve.point(i,s,o)},be.prototype.dbl=function(){return this.isInfinity()?this:this.curve.extended?this._extDbl():this._projDbl()},be.prototype._extAdd=function(e){var r=this.y.redSub(this.x).redMul(e.y.redSub(e.x)),n=this.y.redAdd(this.x).redMul(e.y.redAdd(e.x)),i=this.t.redMul(this.curve.dd).redMul(e.t),s=this.z.redMul(e.z.redAdd(e.z)),o=n.redSub(r),a=s.redSub(i),c=s.redAdd(i),u=n.redAdd(r),d=o.redMul(a),p=c.redMul(u),y=o.redMul(u),_=a.redMul(c);return this.curve.point(d,p,_,y)},be.prototype._projAdd=function(e){var r=this.z.redMul(e.z),n=r.redSqr(),i=this.x.redMul(e.x),s=this.y.redMul(e.y),o=this.curve.d.redMul(i).redMul(s),a=n.redSub(o),c=n.redAdd(o),u=this.x.redAdd(this.y).redMul(e.x.redAdd(e.y)).redISub(i).redISub(s),d=r.redMul(a).redMul(u),p,y;return this.curve.twisted?(p=r.redMul(c).redMul(s.redSub(this.curve._mulA(i))),y=a.redMul(c)):(p=r.redMul(c).redMul(s.redSub(i)),y=this.curve._mulC(a).redMul(c)),this.curve.point(d,p,y)},be.prototype.add=function(e){return this.isInfinity()?e:e.isInfinity()?this:this.curve.extended?this._extAdd(e):this._projAdd(e)},be.prototype.mul=function(e){return this._hasDoubles(e)?this.curve._fixedNafMul(this,e):this.curve._wnafMul(this,e)},be.prototype.mulAdd=function(e,r,n){return this.curve._wnafMulAdd(1,[this,r],[e,n],2,!1)},be.prototype.jmulAdd=function(e,r,n){return this.curve._wnafMulAdd(1,[this,r],[e,n],2,!0)},be.prototype.normalize=function(){if(this.zOne)return this;var e=this.z.redInvm();return this.x=this.x.redMul(e),this.y=this.y.redMul(e),this.t&&(this.t=this.t.redMul(e)),this.z=this.curve.one,this.zOne=!0,this},be.prototype.neg=function(){return this.curve.point(this.x.redNeg(),this.y,this.z,this.t&&this.t.redNeg())},be.prototype.getX=function(){return this.normalize(),this.x.fromRed()},be.prototype.getY=function(){return this.normalize(),this.y.fromRed()},be.prototype.eq=function(e){return this===e||this.getX().cmp(e.getX())===0&&this.getY().cmp(e.getY())===0},be.prototype.eqXToP=function(e){var r=e.toRed(this.curve.red).redMul(this.z);if(this.x.cmp(r)===0)return!0;for(var n=e.clone(),i=this.curve.redN.redMul(this.z);;){if(n.iadd(this.curve.n),n.cmp(this.curve.p)>=0)return!1;if(r.redIAdd(i),this.x.cmp(r)===0)return!0}},be.prototype.toP=be.prototype.normalize,be.prototype.mixedAdd=be.prototype.add,function(t){var e=t;e.base=Gs,e.short=tm,e.mont=nm,e.edwards=om}(Za);var Zs={},Js={},re={},am=pn,cm=Wn.exports;re.inherits=cm;function fm(t,e){return(t.charCodeAt(e)&64512)!==55296||e<0||e+1>=t.length?!1:(t.charCodeAt(e+1)&64512)===56320}function um(t,e){if(Array.isArray(t))return t.slice();if(!t)return[];var r=[];if(typeof t=="string")if(e){if(e==="hex")for(t=t.replace(/[^a-z0-9]+/ig,""),t.length%2!==0&&(t="0"+t),i=0;i<t.length;i+=2)r.push(parseInt(t[i]+t[i+1],16))}else for(var n=0,i=0;i<t.length;i++){var s=t.charCodeAt(i);s<128?r[n++]=s:s<2048?(r[n++]=s>>6|192,r[n++]=s&63|128):fm(t,i)?(s=65536+((s&1023)<<10)+(t.charCodeAt(++i)&1023),r[n++]=s>>18|240,r[n++]=s>>12&63|128,r[n++]=s>>6&63|128,r[n++]=s&63|128):(r[n++]=s>>12|224,r[n++]=s>>6&63|128,r[n++]=s&63|128)}else for(i=0;i<t.length;i++)r[i]=t[i]|0;return r}re.toArray=um;function hm(t){for(var e="",r=0;r<t.length;r++)e+=Sd(t[r].toString(16));return e}re.toHex=hm;function xd(t){var e=t>>>24|t>>>8&65280|t<<8&16711680|(t&255)<<24;return e>>>0}re.htonl=xd;function dm(t,e){for(var r="",n=0;n<t.length;n++){var i=t[n];e==="little"&&(i=xd(i)),r+=Id(i.toString(16))}return r}re.toHex32=dm;function Sd(t){return t.length===1?"0"+t:t}re.zero2=Sd;function Id(t){return t.length===7?"0"+t:t.length===6?"00"+t:t.length===5?"000"+t:t.length===4?"0000"+t:t.length===3?"00000"+t:t.length===2?"000000"+t:t.length===1?"0000000"+t:t}re.zero8=Id;function lm(t,e,r,n){var i=r-e;am(i%4===0);for(var s=new Array(i/4),o=0,a=e;o<s.length;o++,a+=4){var c;n==="big"?c=t[a]<<24|t[a+1]<<16|t[a+2]<<8|t[a+3]:c=t[a+3]<<24|t[a+2]<<16|t[a+1]<<8|t[a],s[o]=c>>>0}return s}re.join32=lm;function pm(t,e){for(var r=new Array(t.length*4),n=0,i=0;n<t.length;n++,i+=4){var s=t[n];e==="big"?(r[i]=s>>>24,r[i+1]=s>>>16&255,r[i+2]=s>>>8&255,r[i+3]=s&255):(r[i+3]=s>>>24,r[i+2]=s>>>16&255,r[i+1]=s>>>8&255,r[i]=s&255)}return r}re.split32=pm;function bm(t,e){return t>>>e|t<<32-e}re.rotr32=bm;function gm(t,e){return t<<e|t>>>32-e}re.rotl32=gm;function vm(t,e){return t+e>>>0}re.sum32=vm;function ym(t,e,r){return t+e+r>>>0}re.sum32_3=ym;function mm(t,e,r,n){return t+e+r+n>>>0}re.sum32_4=mm;function wm(t,e,r,n,i){return t+e+r+n+i>>>0}re.sum32_5=wm;function _m(t,e,r,n){var i=t[e],s=t[e+1],o=n+s>>>0,a=(o<n?1:0)+r+i;t[e]=a>>>0,t[e+1]=o}re.sum64=_m;function Em(t,e,r,n){var i=e+n>>>0,s=(i<e?1:0)+t+r;return s>>>0}re.sum64_hi=Em;function xm(t,e,r,n){var i=e+n;return i>>>0}re.sum64_lo=xm;function Sm(t,e,r,n,i,s,o,a){var c=0,u=e;u=u+n>>>0,c+=u<e?1:0,u=u+s>>>0,c+=u<s?1:0,u=u+a>>>0,c+=u<a?1:0;var d=t+r+i+o+c;return d>>>0}re.sum64_4_hi=Sm;function Im(t,e,r,n,i,s,o,a){var c=e+n+s+a;return c>>>0}re.sum64_4_lo=Im;function Am(t,e,r,n,i,s,o,a,c,u){var d=0,p=e;p=p+n>>>0,d+=p<e?1:0,p=p+s>>>0,d+=p<s?1:0,p=p+a>>>0,d+=p<a?1:0,p=p+u>>>0,d+=p<u?1:0;var y=t+r+i+o+c+d;return y>>>0}re.sum64_5_hi=Am;function Dm(t,e,r,n,i,s,o,a,c,u){var d=e+n+s+a+u;return d>>>0}re.sum64_5_lo=Dm;function Om(t,e,r){var n=e<<32-r|t>>>r;return n>>>0}re.rotr64_hi=Om;function Mm(t,e,r){var n=t<<32-r|e>>>r;return n>>>0}re.rotr64_lo=Mm;function Tm(t,e,r){return t>>>r}re.shr64_hi=Tm;function Rm(t,e,r){var n=t<<32-r|e>>>r;return n>>>0}re.shr64_lo=Rm;var Zn={},Ad=re,Bm=pn;function Qs(){this.pending=null,this.pendingTotal=0,this.blockSize=this.constructor.blockSize,this.outSize=this.constructor.outSize,this.hmacStrength=this.constructor.hmacStrength,this.padLength=this.constructor.padLength/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}Zn.BlockHash=Qs,Qs.prototype.update=function(e,r){if(e=Ad.toArray(e,r),this.pending?this.pending=this.pending.concat(e):this.pending=e,this.pendingTotal+=e.length,this.pending.length>=this._delta8){e=this.pending;var n=e.length%this._delta8;this.pending=e.slice(e.length-n,e.length),this.pending.length===0&&(this.pending=null),e=Ad.join32(e,0,e.length-n,this.endian);for(var i=0;i<e.length;i+=this._delta32)this._update(e,i,i+this._delta32)}return this},Qs.prototype.digest=function(e){return this.update(this._pad()),Bm(this.pending===null),this._digest(e)},Qs.prototype._pad=function(){var e=this.pendingTotal,r=this._delta8,n=r-(e+this.padLength)%r,i=new Array(n+this.padLength);i[0]=128;for(var s=1;s<n;s++)i[s]=0;if(e<<=3,this.endian==="big"){for(var o=8;o<this.padLength;o++)i[s++]=0;i[s++]=0,i[s++]=0,i[s++]=0,i[s++]=0,i[s++]=e>>>24&255,i[s++]=e>>>16&255,i[s++]=e>>>8&255,i[s++]=e&255}else for(i[s++]=e&255,i[s++]=e>>>8&255,i[s++]=e>>>16&255,i[s++]=e>>>24&255,i[s++]=0,i[s++]=0,i[s++]=0,i[s++]=0,o=8;o<this.padLength;o++)i[s++]=0;return i};var Jn={},lr={},Pm=re,pr=Pm.rotr32;function Nm(t,e,r,n){if(t===0)return Dd(e,r,n);if(t===1||t===3)return Md(e,r,n);if(t===2)return Od(e,r,n)}lr.ft_1=Nm;function Dd(t,e,r){return t&e^~t&r}lr.ch32=Dd;function Od(t,e,r){return t&e^t&r^e&r}lr.maj32=Od;function Md(t,e,r){return t^e^r}lr.p32=Md;function Cm(t){return pr(t,2)^pr(t,13)^pr(t,22)}lr.s0_256=Cm;function Lm(t){return pr(t,6)^pr(t,11)^pr(t,25)}lr.s1_256=Lm;function $m(t){return pr(t,7)^pr(t,18)^t>>>3}lr.g0_256=$m;function Fm(t){return pr(t,17)^pr(t,19)^t>>>10}lr.g1_256=Fm;var Qn=re,zm=Zn,Um=lr,Qa=Qn.rotl32,Ni=Qn.sum32,km=Qn.sum32_5,jm=Um.ft_1,Td=zm.BlockHash,qm=[1518500249,1859775393,2400959708,3395469782];function br(){if(!(this instanceof br))return new br;Td.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.W=new Array(80)}Qn.inherits(br,Td);var Hm=br;br.blockSize=512,br.outSize=160,br.hmacStrength=80,br.padLength=64,br.prototype._update=function(e,r){for(var n=this.W,i=0;i<16;i++)n[i]=e[r+i];for(;i<n.length;i++)n[i]=Qa(n[i-3]^n[i-8]^n[i-14]^n[i-16],1);var s=this.h[0],o=this.h[1],a=this.h[2],c=this.h[3],u=this.h[4];for(i=0;i<n.length;i++){var d=~~(i/20),p=km(Qa(s,5),jm(d,o,a,c),u,n[i],qm[d]);u=c,c=a,a=Qa(o,30),o=s,s=p}this.h[0]=Ni(this.h[0],s),this.h[1]=Ni(this.h[1],o),this.h[2]=Ni(this.h[2],a),this.h[3]=Ni(this.h[3],c),this.h[4]=Ni(this.h[4],u)},br.prototype._digest=function(e){return e==="hex"?Qn.toHex32(this.h,"big"):Qn.split32(this.h,"big")};var ei=re,Km=Zn,ti=lr,Vm=pn,Qt=ei.sum32,Wm=ei.sum32_4,Gm=ei.sum32_5,Ym=ti.ch32,Xm=ti.maj32,Zm=ti.s0_256,Jm=ti.s1_256,Qm=ti.g0_256,e6=ti.g1_256,Rd=Km.BlockHash,t6=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function gr(){if(!(this instanceof gr))return new gr;Rd.call(this),this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.k=t6,this.W=new Array(64)}ei.inherits(gr,Rd);var Bd=gr;gr.blockSize=512,gr.outSize=256,gr.hmacStrength=192,gr.padLength=64,gr.prototype._update=function(e,r){for(var n=this.W,i=0;i<16;i++)n[i]=e[r+i];for(;i<n.length;i++)n[i]=Wm(e6(n[i-2]),n[i-7],Qm(n[i-15]),n[i-16]);var s=this.h[0],o=this.h[1],a=this.h[2],c=this.h[3],u=this.h[4],d=this.h[5],p=this.h[6],y=this.h[7];for(Vm(this.k.length===n.length),i=0;i<n.length;i++){var _=Gm(y,Jm(u),Ym(u,d,p),this.k[i],n[i]),w=Qt(Zm(s),Xm(s,o,a));y=p,p=d,d=u,u=Qt(c,_),c=a,a=o,o=s,s=Qt(_,w)}this.h[0]=Qt(this.h[0],s),this.h[1]=Qt(this.h[1],o),this.h[2]=Qt(this.h[2],a),this.h[3]=Qt(this.h[3],c),this.h[4]=Qt(this.h[4],u),this.h[5]=Qt(this.h[5],d),this.h[6]=Qt(this.h[6],p),this.h[7]=Qt(this.h[7],y)},gr.prototype._digest=function(e){return e==="hex"?ei.toHex32(this.h,"big"):ei.split32(this.h,"big")};var ec=re,Pd=Bd;function Br(){if(!(this instanceof Br))return new Br;Pd.call(this),this.h=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]}ec.inherits(Br,Pd);var r6=Br;Br.blockSize=512,Br.outSize=224,Br.hmacStrength=192,Br.padLength=64,Br.prototype._digest=function(e){return e==="hex"?ec.toHex32(this.h.slice(0,7),"big"):ec.split32(this.h.slice(0,7),"big")};var Tt=re,n6=Zn,i6=pn,vr=Tt.rotr64_hi,yr=Tt.rotr64_lo,Nd=Tt.shr64_hi,Cd=Tt.shr64_lo,Kr=Tt.sum64,tc=Tt.sum64_hi,rc=Tt.sum64_lo,s6=Tt.sum64_4_hi,o6=Tt.sum64_4_lo,a6=Tt.sum64_5_hi,c6=Tt.sum64_5_lo,Ld=n6.BlockHash,f6=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function er(){if(!(this instanceof er))return new er;Ld.call(this),this.h=[1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209],this.k=f6,this.W=new Array(160)}Tt.inherits(er,Ld);var $d=er;er.blockSize=1024,er.outSize=512,er.hmacStrength=192,er.padLength=128,er.prototype._prepareBlock=function(e,r){for(var n=this.W,i=0;i<32;i++)n[i]=e[r+i];for(;i<n.length;i+=2){var s=w6(n[i-4],n[i-3]),o=_6(n[i-4],n[i-3]),a=n[i-14],c=n[i-13],u=y6(n[i-30],n[i-29]),d=m6(n[i-30],n[i-29]),p=n[i-32],y=n[i-31];n[i]=s6(s,o,a,c,u,d,p,y),n[i+1]=o6(s,o,a,c,u,d,p,y)}},er.prototype._update=function(e,r){this._prepareBlock(e,r);var n=this.W,i=this.h[0],s=this.h[1],o=this.h[2],a=this.h[3],c=this.h[4],u=this.h[5],d=this.h[6],p=this.h[7],y=this.h[8],_=this.h[9],w=this.h[10],D=this.h[11],O=this.h[12],M=this.h[13],T=this.h[14],B=this.h[15];i6(this.k.length===n.length);for(var P=0;P<n.length;P+=2){var j=T,$=B,L=g6(y,_),z=v6(y,_),N=u6(y,_,w,D,O),K=h6(y,_,w,D,O,M),S=this.k[P],f=this.k[P+1],l=n[P],g=n[P+1],b=a6(j,$,L,z,N,K,S,f,l,g),v=c6(j,$,L,z,N,K,S,f,l,g);j=p6(i,s),$=b6(i,s),L=d6(i,s,o,a,c),z=l6(i,s,o,a,c,u);var x=tc(j,$,L,z),I=rc(j,$,L,z);T=O,B=M,O=w,M=D,w=y,D=_,y=tc(d,p,b,v),_=rc(p,p,b,v),d=c,p=u,c=o,u=a,o=i,a=s,i=tc(b,v,x,I),s=rc(b,v,x,I)}Kr(this.h,0,i,s),Kr(this.h,2,o,a),Kr(this.h,4,c,u),Kr(this.h,6,d,p),Kr(this.h,8,y,_),Kr(this.h,10,w,D),Kr(this.h,12,O,M),Kr(this.h,14,T,B)},er.prototype._digest=function(e){return e==="hex"?Tt.toHex32(this.h,"big"):Tt.split32(this.h,"big")};function u6(t,e,r,n,i){var s=t&r^~t&i;return s<0&&(s+=4294967296),s}function h6(t,e,r,n,i,s){var o=e&n^~e&s;return o<0&&(o+=4294967296),o}function d6(t,e,r,n,i){var s=t&r^t&i^r&i;return s<0&&(s+=4294967296),s}function l6(t,e,r,n,i,s){var o=e&n^e&s^n&s;return o<0&&(o+=4294967296),o}function p6(t,e){var r=vr(t,e,28),n=vr(e,t,2),i=vr(e,t,7),s=r^n^i;return s<0&&(s+=4294967296),s}function b6(t,e){var r=yr(t,e,28),n=yr(e,t,2),i=yr(e,t,7),s=r^n^i;return s<0&&(s+=4294967296),s}function g6(t,e){var r=vr(t,e,14),n=vr(t,e,18),i=vr(e,t,9),s=r^n^i;return s<0&&(s+=4294967296),s}function v6(t,e){var r=yr(t,e,14),n=yr(t,e,18),i=yr(e,t,9),s=r^n^i;return s<0&&(s+=4294967296),s}function y6(t,e){var r=vr(t,e,1),n=vr(t,e,8),i=Nd(t,e,7),s=r^n^i;return s<0&&(s+=4294967296),s}function m6(t,e){var r=yr(t,e,1),n=yr(t,e,8),i=Cd(t,e,7),s=r^n^i;return s<0&&(s+=4294967296),s}function w6(t,e){var r=vr(t,e,19),n=vr(e,t,29),i=Nd(t,e,6),s=r^n^i;return s<0&&(s+=4294967296),s}function _6(t,e){var r=yr(t,e,19),n=yr(e,t,29),i=Cd(t,e,6),s=r^n^i;return s<0&&(s+=4294967296),s}var nc=re,Fd=$d;function Pr(){if(!(this instanceof Pr))return new Pr;Fd.call(this),this.h=[3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]}nc.inherits(Pr,Fd);var E6=Pr;Pr.blockSize=1024,Pr.outSize=384,Pr.hmacStrength=192,Pr.padLength=128,Pr.prototype._digest=function(e){return e==="hex"?nc.toHex32(this.h.slice(0,12),"big"):nc.split32(this.h.slice(0,12),"big")},Jn.sha1=Hm,Jn.sha224=r6,Jn.sha256=Bd,Jn.sha384=E6,Jn.sha512=$d;var zd={},gn=re,x6=Zn,eo=gn.rotl32,Ud=gn.sum32,Ci=gn.sum32_3,kd=gn.sum32_4,jd=x6.BlockHash;function mr(){if(!(this instanceof mr))return new mr;jd.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.endian="little"}gn.inherits(mr,jd),zd.ripemd160=mr,mr.blockSize=512,mr.outSize=160,mr.hmacStrength=192,mr.padLength=64,mr.prototype._update=function(e,r){for(var n=this.h[0],i=this.h[1],s=this.h[2],o=this.h[3],a=this.h[4],c=n,u=i,d=s,p=o,y=a,_=0;_<80;_++){var w=Ud(eo(kd(n,qd(_,i,s,o),e[A6[_]+r],S6(_)),O6[_]),a);n=a,a=o,o=eo(s,10),s=i,i=w,w=Ud(eo(kd(c,qd(79-_,u,d,p),e[D6[_]+r],I6(_)),M6[_]),y),c=y,y=p,p=eo(d,10),d=u,u=w}w=Ci(this.h[1],s,p),this.h[1]=Ci(this.h[2],o,y),this.h[2]=Ci(this.h[3],a,c),this.h[3]=Ci(this.h[4],n,u),this.h[4]=Ci(this.h[0],i,d),this.h[0]=w},mr.prototype._digest=function(e){return e==="hex"?gn.toHex32(this.h,"little"):gn.split32(this.h,"little")};function qd(t,e,r,n){return t<=15?e^r^n:t<=31?e&r|~e&n:t<=47?(e|~r)^n:t<=63?e&n|r&~n:e^(r|~n)}function S6(t){return t<=15?0:t<=31?1518500249:t<=47?1859775393:t<=63?2400959708:2840853838}function I6(t){return t<=15?1352829926:t<=31?1548603684:t<=47?1836072691:t<=63?2053994217:0}var A6=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],D6=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],O6=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],M6=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11],T6=re,R6=pn;function ri(t,e,r){if(!(this instanceof ri))return new ri(t,e,r);this.Hash=t,this.blockSize=t.blockSize/8,this.outSize=t.outSize/8,this.inner=null,this.outer=null,this._init(T6.toArray(e,r))}var B6=ri;ri.prototype._init=function(e){e.length>this.blockSize&&(e=new this.Hash().update(e).digest()),R6(e.length<=this.blockSize);for(var r=e.length;r<this.blockSize;r++)e.push(0);for(r=0;r<e.length;r++)e[r]^=54;for(this.inner=new this.Hash().update(e),r=0;r<e.length;r++)e[r]^=106;this.outer=new this.Hash().update(e)},ri.prototype.update=function(e,r){return this.inner.update(e,r),this},ri.prototype.digest=function(e){return this.outer.update(this.inner.digest()),this.outer.digest(e)},function(t){var e=t;e.utils=re,e.common=Zn,e.sha=Jn,e.ripemd=zd,e.hmac=B6,e.sha1=e.sha.sha1,e.sha256=e.sha.sha256,e.sha224=e.sha.sha224,e.sha384=e.sha.sha384,e.sha512=e.sha.sha512,e.ripemd160=e.ripemd.ripemd160}(Js);var ic,Hd;function P6(){return Hd||(Hd=1,ic={doubles:{step:4,points:[["e60fce93b59e9ec53011aabc21c23e97b2a31369b87a5ae9c44ee89e2a6dec0a","f7e3507399e595929db99f34f57937101296891e44d23f0be1f32cce69616821"],["8282263212c609d9ea2a6e3e172de238d8c39cabd5ac1ca10646e23fd5f51508","11f8a8098557dfe45e8256e830b60ace62d613ac2f7b17bed31b6eaff6e26caf"],["175e159f728b865a72f99cc6c6fc846de0b93833fd2222ed73fce5b551e5b739","d3506e0d9e3c79eba4ef97a51ff71f5eacb5955add24345c6efa6ffee9fed695"],["363d90d447b00c9c99ceac05b6262ee053441c7e55552ffe526bad8f83ff4640","4e273adfc732221953b445397f3363145b9a89008199ecb62003c7f3bee9de9"],["8b4b5f165df3c2be8c6244b5b745638843e4a781a15bcd1b69f79a55dffdf80c","4aad0a6f68d308b4b3fbd7813ab0da04f9e336546162ee56b3eff0c65fd4fd36"],["723cbaa6e5db996d6bf771c00bd548c7b700dbffa6c0e77bcb6115925232fcda","96e867b5595cc498a921137488824d6e2660a0653779494801dc069d9eb39f5f"],["eebfa4d493bebf98ba5feec812c2d3b50947961237a919839a533eca0e7dd7fa","5d9a8ca3970ef0f269ee7edaf178089d9ae4cdc3a711f712ddfd4fdae1de8999"],["100f44da696e71672791d0a09b7bde459f1215a29b3c03bfefd7835b39a48db0","cdd9e13192a00b772ec8f3300c090666b7ff4a18ff5195ac0fbd5cd62bc65a09"],["e1031be262c7ed1b1dc9227a4a04c017a77f8d4464f3b3852c8acde6e534fd2d","9d7061928940405e6bb6a4176597535af292dd419e1ced79a44f18f29456a00d"],["feea6cae46d55b530ac2839f143bd7ec5cf8b266a41d6af52d5e688d9094696d","e57c6b6c97dce1bab06e4e12bf3ecd5c981c8957cc41442d3155debf18090088"],["da67a91d91049cdcb367be4be6ffca3cfeed657d808583de33fa978bc1ec6cb1","9bacaa35481642bc41f463f7ec9780e5dec7adc508f740a17e9ea8e27a68be1d"],["53904faa0b334cdda6e000935ef22151ec08d0f7bb11069f57545ccc1a37b7c0","5bc087d0bc80106d88c9eccac20d3c1c13999981e14434699dcb096b022771c8"],["8e7bcd0bd35983a7719cca7764ca906779b53a043a9b8bcaeff959f43ad86047","10b7770b2a3da4b3940310420ca9514579e88e2e47fd68b3ea10047e8460372a"],["385eed34c1cdff21e6d0818689b81bde71a7f4f18397e6690a841e1599c43862","283bebc3e8ea23f56701de19e9ebf4576b304eec2086dc8cc0458fe5542e5453"],["6f9d9b803ecf191637c73a4413dfa180fddf84a5947fbc9c606ed86c3fac3a7","7c80c68e603059ba69b8e2a30e45c4d47ea4dd2f5c281002d86890603a842160"],["3322d401243c4e2582a2147c104d6ecbf774d163db0f5e5313b7e0e742d0e6bd","56e70797e9664ef5bfb019bc4ddaf9b72805f63ea2873af624f3a2e96c28b2a0"],["85672c7d2de0b7da2bd1770d89665868741b3f9af7643397721d74d28134ab83","7c481b9b5b43b2eb6374049bfa62c2e5e77f17fcc5298f44c8e3094f790313a6"],["948bf809b1988a46b06c9f1919413b10f9226c60f668832ffd959af60c82a0a","53a562856dcb6646dc6b74c5d1c3418c6d4dff08c97cd2bed4cb7f88d8c8e589"],["6260ce7f461801c34f067ce0f02873a8f1b0e44dfc69752accecd819f38fd8e8","bc2da82b6fa5b571a7f09049776a1ef7ecd292238051c198c1a84e95b2b4ae17"],["e5037de0afc1d8d43d8348414bbf4103043ec8f575bfdc432953cc8d2037fa2d","4571534baa94d3b5f9f98d09fb990bddbd5f5b03ec481f10e0e5dc841d755bda"],["e06372b0f4a207adf5ea905e8f1771b4e7e8dbd1c6a6c5b725866a0ae4fce725","7a908974bce18cfe12a27bb2ad5a488cd7484a7787104870b27034f94eee31dd"],["213c7a715cd5d45358d0bbf9dc0ce02204b10bdde2a3f58540ad6908d0559754","4b6dad0b5ae462507013ad06245ba190bb4850f5f36a7eeddff2c27534b458f2"],["4e7c272a7af4b34e8dbb9352a5419a87e2838c70adc62cddf0cc3a3b08fbd53c","17749c766c9d0b18e16fd09f6def681b530b9614bff7dd33e0b3941817dcaae6"],["fea74e3dbe778b1b10f238ad61686aa5c76e3db2be43057632427e2840fb27b6","6e0568db9b0b13297cf674deccb6af93126b596b973f7b77701d3db7f23cb96f"],["76e64113f677cf0e10a2570d599968d31544e179b760432952c02a4417bdde39","c90ddf8dee4e95cf577066d70681f0d35e2a33d2b56d2032b4b1752d1901ac01"],["c738c56b03b2abe1e8281baa743f8f9a8f7cc643df26cbee3ab150242bcbb891","893fb578951ad2537f718f2eacbfbbbb82314eef7880cfe917e735d9699a84c3"],["d895626548b65b81e264c7637c972877d1d72e5f3a925014372e9f6588f6c14b","febfaa38f2bc7eae728ec60818c340eb03428d632bb067e179363ed75d7d991f"],["b8da94032a957518eb0f6433571e8761ceffc73693e84edd49150a564f676e03","2804dfa44805a1e4d7c99cc9762808b092cc584d95ff3b511488e4e74efdf6e7"],["e80fea14441fb33a7d8adab9475d7fab2019effb5156a792f1a11778e3c0df5d","eed1de7f638e00771e89768ca3ca94472d155e80af322ea9fcb4291b6ac9ec78"],["a301697bdfcd704313ba48e51d567543f2a182031efd6915ddc07bbcc4e16070","7370f91cfb67e4f5081809fa25d40f9b1735dbf7c0a11a130c0d1a041e177ea1"],["90ad85b389d6b936463f9d0512678de208cc330b11307fffab7ac63e3fb04ed4","e507a3620a38261affdcbd9427222b839aefabe1582894d991d4d48cb6ef150"],["8f68b9d2f63b5f339239c1ad981f162ee88c5678723ea3351b7b444c9ec4c0da","662a9f2dba063986de1d90c2b6be215dbbea2cfe95510bfdf23cbf79501fff82"],["e4f3fb0176af85d65ff99ff9198c36091f48e86503681e3e6686fd5053231e11","1e63633ad0ef4f1c1661a6d0ea02b7286cc7e74ec951d1c9822c38576feb73bc"],["8c00fa9b18ebf331eb961537a45a4266c7034f2f0d4e1d0716fb6eae20eae29e","efa47267fea521a1a9dc343a3736c974c2fadafa81e36c54e7d2a4c66702414b"],["e7a26ce69dd4829f3e10cec0a9e98ed3143d084f308b92c0997fddfc60cb3e41","2a758e300fa7984b471b006a1aafbb18d0a6b2c0420e83e20e8a9421cf2cfd51"],["b6459e0ee3662ec8d23540c223bcbdc571cbcb967d79424f3cf29eb3de6b80ef","67c876d06f3e06de1dadf16e5661db3c4b3ae6d48e35b2ff30bf0b61a71ba45"],["d68a80c8280bb840793234aa118f06231d6f1fc67e73c5a5deda0f5b496943e8","db8ba9fff4b586d00c4b1f9177b0e28b5b0e7b8f7845295a294c84266b133120"],["324aed7df65c804252dc0270907a30b09612aeb973449cea4095980fc28d3d5d","648a365774b61f2ff130c0c35aec1f4f19213b0c7e332843967224af96ab7c84"],["4df9c14919cde61f6d51dfdbe5fee5dceec4143ba8d1ca888e8bd373fd054c96","35ec51092d8728050974c23a1d85d4b5d506cdc288490192ebac06cad10d5d"],["9c3919a84a474870faed8a9c1cc66021523489054d7f0308cbfc99c8ac1f98cd","ddb84f0f4a4ddd57584f044bf260e641905326f76c64c8e6be7e5e03d4fc599d"],["6057170b1dd12fdf8de05f281d8e06bb91e1493a8b91d4cc5a21382120a959e5","9a1af0b26a6a4807add9a2daf71df262465152bc3ee24c65e899be932385a2a8"],["a576df8e23a08411421439a4518da31880cef0fba7d4df12b1a6973eecb94266","40a6bf20e76640b2c92b97afe58cd82c432e10a7f514d9f3ee8be11ae1b28ec8"],["7778a78c28dec3e30a05fe9629de8c38bb30d1f5cf9a3a208f763889be58ad71","34626d9ab5a5b22ff7098e12f2ff580087b38411ff24ac563b513fc1fd9f43ac"],["928955ee637a84463729fd30e7afd2ed5f96274e5ad7e5cb09eda9c06d903ac","c25621003d3f42a827b78a13093a95eeac3d26efa8a8d83fc5180e935bcd091f"],["85d0fef3ec6db109399064f3a0e3b2855645b4a907ad354527aae75163d82751","1f03648413a38c0be29d496e582cf5663e8751e96877331582c237a24eb1f962"],["ff2b0dce97eece97c1c9b6041798b85dfdfb6d8882da20308f5404824526087e","493d13fef524ba188af4c4dc54d07936c7b7ed6fb90e2ceb2c951e01f0c29907"],["827fbbe4b1e880ea9ed2b2e6301b212b57f1ee148cd6dd28780e5e2cf856e241","c60f9c923c727b0b71bef2c67d1d12687ff7a63186903166d605b68baec293ec"],["eaa649f21f51bdbae7be4ae34ce6e5217a58fdce7f47f9aa7f3b58fa2120e2b3","be3279ed5bbbb03ac69a80f89879aa5a01a6b965f13f7e59d47a5305ba5ad93d"],["e4a42d43c5cf169d9391df6decf42ee541b6d8f0c9a137401e23632dda34d24f","4d9f92e716d1c73526fc99ccfb8ad34ce886eedfa8d8e4f13a7f7131deba9414"],["1ec80fef360cbdd954160fadab352b6b92b53576a88fea4947173b9d4300bf19","aeefe93756b5340d2f3a4958a7abbf5e0146e77f6295a07b671cdc1cc107cefd"],["146a778c04670c2f91b00af4680dfa8bce3490717d58ba889ddb5928366642be","b318e0ec3354028add669827f9d4b2870aaa971d2f7e5ed1d0b297483d83efd0"],["fa50c0f61d22e5f07e3acebb1aa07b128d0012209a28b9776d76a8793180eef9","6b84c6922397eba9b72cd2872281a68a5e683293a57a213b38cd8d7d3f4f2811"],["da1d61d0ca721a11b1a5bf6b7d88e8421a288ab5d5bba5220e53d32b5f067ec2","8157f55a7c99306c79c0766161c91e2966a73899d279b48a655fba0f1ad836f1"],["a8e282ff0c9706907215ff98e8fd416615311de0446f1e062a73b0610d064e13","7f97355b8db81c09abfb7f3c5b2515888b679a3e50dd6bd6cef7c73111f4cc0c"],["174a53b9c9a285872d39e56e6913cab15d59b1fa512508c022f382de8319497c","ccc9dc37abfc9c1657b4155f2c47f9e6646b3a1d8cb9854383da13ac079afa73"],["959396981943785c3d3e57edf5018cdbe039e730e4918b3d884fdff09475b7ba","2e7e552888c331dd8ba0386a4b9cd6849c653f64c8709385e9b8abf87524f2fd"],["d2a63a50ae401e56d645a1153b109a8fcca0a43d561fba2dbb51340c9d82b151","e82d86fb6443fcb7565aee58b2948220a70f750af484ca52d4142174dcf89405"],["64587e2335471eb890ee7896d7cfdc866bacbdbd3839317b3436f9b45617e073","d99fcdd5bf6902e2ae96dd6447c299a185b90a39133aeab358299e5e9faf6589"],["8481bde0e4e4d885b3a546d3e549de042f0aa6cea250e7fd358d6c86dd45e458","38ee7b8cba5404dd84a25bf39cecb2ca900a79c42b262e556d64b1b59779057e"],["13464a57a78102aa62b6979ae817f4637ffcfed3c4b1ce30bcd6303f6caf666b","69be159004614580ef7e433453ccb0ca48f300a81d0942e13f495a907f6ecc27"],["bc4a9df5b713fe2e9aef430bcc1dc97a0cd9ccede2f28588cada3a0d2d83f366","d3a81ca6e785c06383937adf4b798caa6e8a9fbfa547b16d758d666581f33c1"],["8c28a97bf8298bc0d23d8c749452a32e694b65e30a9472a3954ab30fe5324caa","40a30463a3305193378fedf31f7cc0eb7ae784f0451cb9459e71dc73cbef9482"],["8ea9666139527a8c1dd94ce4f071fd23c8b350c5a4bb33748c4ba111faccae0","620efabbc8ee2782e24e7c0cfb95c5d735b783be9cf0f8e955af34a30e62b945"],["dd3625faef5ba06074669716bbd3788d89bdde815959968092f76cc4eb9a9787","7a188fa3520e30d461da2501045731ca941461982883395937f68d00c644a573"],["f710d79d9eb962297e4f6232b40e8f7feb2bc63814614d692c12de752408221e","ea98e67232d3b3295d3b535532115ccac8612c721851617526ae47a9c77bfc82"]]},naf:{wnd:7,points:[["f9308a019258c31049344f85f89d5229b531c845836f99b08601f113bce036f9","388f7b0f632de8140fe337e62a37f3566500a99934c2231b6cb9fd7584b8e672"],["2f8bde4d1a07209355b4a7250a5c5128e88b84bddc619ab7cba8d569b240efe4","d8ac222636e5e3d6d4dba9dda6c9c426f788271bab0d6840dca87d3aa6ac62d6"],["5cbdf0646e5db4eaa398f365f2ea7a0e3d419b7e0330e39ce92bddedcac4f9bc","6aebca40ba255960a3178d6d861a54dba813d0b813fde7b5a5082628087264da"],["acd484e2f0c7f65309ad178a9f559abde09796974c57e714c35f110dfc27ccbe","cc338921b0a7d9fd64380971763b61e9add888a4375f8e0f05cc262ac64f9c37"],["774ae7f858a9411e5ef4246b70c65aac5649980be5c17891bbec17895da008cb","d984a032eb6b5e190243dd56d7b7b365372db1e2dff9d6a8301d74c9c953c61b"],["f28773c2d975288bc7d1d205c3748651b075fbc6610e58cddeeddf8f19405aa8","ab0902e8d880a89758212eb65cdaf473a1a06da521fa91f29b5cb52db03ed81"],["d7924d4f7d43ea965a465ae3095ff41131e5946f3c85f79e44adbcf8e27e080e","581e2872a86c72a683842ec228cc6defea40af2bd896d3a5c504dc9ff6a26b58"],["defdea4cdb677750a420fee807eacf21eb9898ae79b9768766e4faa04a2d4a34","4211ab0694635168e997b0ead2a93daeced1f4a04a95c0f6cfb199f69e56eb77"],["2b4ea0a797a443d293ef5cff444f4979f06acfebd7e86d277475656138385b6c","85e89bc037945d93b343083b5a1c86131a01f60c50269763b570c854e5c09b7a"],["352bbf4a4cdd12564f93fa332ce333301d9ad40271f8107181340aef25be59d5","321eb4075348f534d59c18259dda3e1f4a1b3b2e71b1039c67bd3d8bcf81998c"],["2fa2104d6b38d11b0230010559879124e42ab8dfeff5ff29dc9cdadd4ecacc3f","2de1068295dd865b64569335bd5dd80181d70ecfc882648423ba76b532b7d67"],["9248279b09b4d68dab21a9b066edda83263c3d84e09572e269ca0cd7f5453714","73016f7bf234aade5d1aa71bdea2b1ff3fc0de2a887912ffe54a32ce97cb3402"],["daed4f2be3a8bf278e70132fb0beb7522f570e144bf615c07e996d443dee8729","a69dce4a7d6c98e8d4a1aca87ef8d7003f83c230f3afa726ab40e52290be1c55"],["c44d12c7065d812e8acf28d7cbb19f9011ecd9e9fdf281b0e6a3b5e87d22e7db","2119a460ce326cdc76c45926c982fdac0e106e861edf61c5a039063f0e0e6482"],["6a245bf6dc698504c89a20cfded60853152b695336c28063b61c65cbd269e6b4","e022cf42c2bd4a708b3f5126f16a24ad8b33ba48d0423b6efd5e6348100d8a82"],["1697ffa6fd9de627c077e3d2fe541084ce13300b0bec1146f95ae57f0d0bd6a5","b9c398f186806f5d27561506e4557433a2cf15009e498ae7adee9d63d01b2396"],["605bdb019981718b986d0f07e834cb0d9deb8360ffb7f61df982345ef27a7479","2972d2de4f8d20681a78d93ec96fe23c26bfae84fb14db43b01e1e9056b8c49"],["62d14dab4150bf497402fdc45a215e10dcb01c354959b10cfe31c7e9d87ff33d","80fc06bd8cc5b01098088a1950eed0db01aa132967ab472235f5642483b25eaf"],["80c60ad0040f27dade5b4b06c408e56b2c50e9f56b9b8b425e555c2f86308b6f","1c38303f1cc5c30f26e66bad7fe72f70a65eed4cbe7024eb1aa01f56430bd57a"],["7a9375ad6167ad54aa74c6348cc54d344cc5dc9487d847049d5eabb0fa03c8fb","d0e3fa9eca8726909559e0d79269046bdc59ea10c70ce2b02d499ec224dc7f7"],["d528ecd9b696b54c907a9ed045447a79bb408ec39b68df504bb51f459bc3ffc9","eecf41253136e5f99966f21881fd656ebc4345405c520dbc063465b521409933"],["49370a4b5f43412ea25f514e8ecdad05266115e4a7ecb1387231808f8b45963","758f3f41afd6ed428b3081b0512fd62a54c3f3afbb5b6764b653052a12949c9a"],["77f230936ee88cbbd73df930d64702ef881d811e0e1498e2f1c13eb1fc345d74","958ef42a7886b6400a08266e9ba1b37896c95330d97077cbbe8eb3c7671c60d6"],["f2dac991cc4ce4b9ea44887e5c7c0bce58c80074ab9d4dbaeb28531b7739f530","e0dedc9b3b2f8dad4da1f32dec2531df9eb5fbeb0598e4fd1a117dba703a3c37"],["463b3d9f662621fb1b4be8fbbe2520125a216cdfc9dae3debcba4850c690d45b","5ed430d78c296c3543114306dd8622d7c622e27c970a1de31cb377b01af7307e"],["f16f804244e46e2a09232d4aff3b59976b98fac14328a2d1a32496b49998f247","cedabd9b82203f7e13d206fcdf4e33d92a6c53c26e5cce26d6579962c4e31df6"],["caf754272dc84563b0352b7a14311af55d245315ace27c65369e15f7151d41d1","cb474660ef35f5f2a41b643fa5e460575f4fa9b7962232a5c32f908318a04476"],["2600ca4b282cb986f85d0f1709979d8b44a09c07cb86d7c124497bc86f082120","4119b88753c15bd6a693b03fcddbb45d5ac6be74ab5f0ef44b0be9475a7e4b40"],["7635ca72d7e8432c338ec53cd12220bc01c48685e24f7dc8c602a7746998e435","91b649609489d613d1d5e590f78e6d74ecfc061d57048bad9e76f302c5b9c61"],["754e3239f325570cdbbf4a87deee8a66b7f2b33479d468fbc1a50743bf56cc18","673fb86e5bda30fb3cd0ed304ea49a023ee33d0197a695d0c5d98093c536683"],["e3e6bd1071a1e96aff57859c82d570f0330800661d1c952f9fe2694691d9b9e8","59c9e0bba394e76f40c0aa58379a3cb6a5a2283993e90c4167002af4920e37f5"],["186b483d056a033826ae73d88f732985c4ccb1f32ba35f4b4cc47fdcf04aa6eb","3b952d32c67cf77e2e17446e204180ab21fb8090895138b4a4a797f86e80888b"],["df9d70a6b9876ce544c98561f4be4f725442e6d2b737d9c91a8321724ce0963f","55eb2dafd84d6ccd5f862b785dc39d4ab157222720ef9da217b8c45cf2ba2417"],["5edd5cc23c51e87a497ca815d5dce0f8ab52554f849ed8995de64c5f34ce7143","efae9c8dbc14130661e8cec030c89ad0c13c66c0d17a2905cdc706ab7399a868"],["290798c2b6476830da12fe02287e9e777aa3fba1c355b17a722d362f84614fba","e38da76dcd440621988d00bcf79af25d5b29c094db2a23146d003afd41943e7a"],["af3c423a95d9f5b3054754efa150ac39cd29552fe360257362dfdecef4053b45","f98a3fd831eb2b749a93b0e6f35cfb40c8cd5aa667a15581bc2feded498fd9c6"],["766dbb24d134e745cccaa28c99bf274906bb66b26dcf98df8d2fed50d884249a","744b1152eacbe5e38dcc887980da38b897584a65fa06cedd2c924f97cbac5996"],["59dbf46f8c94759ba21277c33784f41645f7b44f6c596a58ce92e666191abe3e","c534ad44175fbc300f4ea6ce648309a042ce739a7919798cd85e216c4a307f6e"],["f13ada95103c4537305e691e74e9a4a8dd647e711a95e73cb62dc6018cfd87b8","e13817b44ee14de663bf4bc808341f326949e21a6a75c2570778419bdaf5733d"],["7754b4fa0e8aced06d4167a2c59cca4cda1869c06ebadfb6488550015a88522c","30e93e864e669d82224b967c3020b8fa8d1e4e350b6cbcc537a48b57841163a2"],["948dcadf5990e048aa3874d46abef9d701858f95de8041d2a6828c99e2262519","e491a42537f6e597d5d28a3224b1bc25df9154efbd2ef1d2cbba2cae5347d57e"],["7962414450c76c1689c7b48f8202ec37fb224cf5ac0bfa1570328a8a3d7c77ab","100b610ec4ffb4760d5c1fc133ef6f6b12507a051f04ac5760afa5b29db83437"],["3514087834964b54b15b160644d915485a16977225b8847bb0dd085137ec47ca","ef0afbb2056205448e1652c48e8127fc6039e77c15c2378b7e7d15a0de293311"],["d3cc30ad6b483e4bc79ce2c9dd8bc54993e947eb8df787b442943d3f7b527eaf","8b378a22d827278d89c5e9be8f9508ae3c2ad46290358630afb34db04eede0a4"],["1624d84780732860ce1c78fcbfefe08b2b29823db913f6493975ba0ff4847610","68651cf9b6da903e0914448c6cd9d4ca896878f5282be4c8cc06e2a404078575"],["733ce80da955a8a26902c95633e62a985192474b5af207da6df7b4fd5fc61cd4","f5435a2bd2badf7d485a4d8b8db9fcce3e1ef8e0201e4578c54673bc1dc5ea1d"],["15d9441254945064cf1a1c33bbd3b49f8966c5092171e699ef258dfab81c045c","d56eb30b69463e7234f5137b73b84177434800bacebfc685fc37bbe9efe4070d"],["a1d0fcf2ec9de675b612136e5ce70d271c21417c9d2b8aaaac138599d0717940","edd77f50bcb5a3cab2e90737309667f2641462a54070f3d519212d39c197a629"],["e22fbe15c0af8ccc5780c0735f84dbe9a790badee8245c06c7ca37331cb36980","a855babad5cd60c88b430a69f53a1a7a38289154964799be43d06d77d31da06"],["311091dd9860e8e20ee13473c1155f5f69635e394704eaa74009452246cfa9b3","66db656f87d1f04fffd1f04788c06830871ec5a64feee685bd80f0b1286d8374"],["34c1fd04d301be89b31c0442d3e6ac24883928b45a9340781867d4232ec2dbdf","9414685e97b1b5954bd46f730174136d57f1ceeb487443dc5321857ba73abee"],["f219ea5d6b54701c1c14de5b557eb42a8d13f3abbcd08affcc2a5e6b049b8d63","4cb95957e83d40b0f73af4544cccf6b1f4b08d3c07b27fb8d8c2962a400766d1"],["d7b8740f74a8fbaab1f683db8f45de26543a5490bca627087236912469a0b448","fa77968128d9c92ee1010f337ad4717eff15db5ed3c049b3411e0315eaa4593b"],["32d31c222f8f6f0ef86f7c98d3a3335ead5bcd32abdd94289fe4d3091aa824bf","5f3032f5892156e39ccd3d7915b9e1da2e6dac9e6f26e961118d14b8462e1661"],["7461f371914ab32671045a155d9831ea8793d77cd59592c4340f86cbc18347b5","8ec0ba238b96bec0cbdddcae0aa442542eee1ff50c986ea6b39847b3cc092ff6"],["ee079adb1df1860074356a25aa38206a6d716b2c3e67453d287698bad7b2b2d6","8dc2412aafe3be5c4c5f37e0ecc5f9f6a446989af04c4e25ebaac479ec1c8c1e"],["16ec93e447ec83f0467b18302ee620f7e65de331874c9dc72bfd8616ba9da6b5","5e4631150e62fb40d0e8c2a7ca5804a39d58186a50e497139626778e25b0674d"],["eaa5f980c245f6f038978290afa70b6bd8855897f98b6aa485b96065d537bd99","f65f5d3e292c2e0819a528391c994624d784869d7e6ea67fb18041024edc07dc"],["78c9407544ac132692ee1910a02439958ae04877151342ea96c4b6b35a49f51","f3e0319169eb9b85d5404795539a5e68fa1fbd583c064d2462b675f194a3ddb4"],["494f4be219a1a77016dcd838431aea0001cdc8ae7a6fc688726578d9702857a5","42242a969283a5f339ba7f075e36ba2af925ce30d767ed6e55f4b031880d562c"],["a598a8030da6d86c6bc7f2f5144ea549d28211ea58faa70ebf4c1e665c1fe9b5","204b5d6f84822c307e4b4a7140737aec23fc63b65b35f86a10026dbd2d864e6b"],["c41916365abb2b5d09192f5f2dbeafec208f020f12570a184dbadc3e58595997","4f14351d0087efa49d245b328984989d5caf9450f34bfc0ed16e96b58fa9913"],["841d6063a586fa475a724604da03bc5b92a2e0d2e0a36acfe4c73a5514742881","73867f59c0659e81904f9a1c7543698e62562d6744c169ce7a36de01a8d6154"],["5e95bb399a6971d376026947f89bde2f282b33810928be4ded112ac4d70e20d5","39f23f366809085beebfc71181313775a99c9aed7d8ba38b161384c746012865"],["36e4641a53948fd476c39f8a99fd974e5ec07564b5315d8bf99471bca0ef2f66","d2424b1b1abe4eb8164227b085c9aa9456ea13493fd563e06fd51cf5694c78fc"],["336581ea7bfbbb290c191a2f507a41cf5643842170e914faeab27c2c579f726","ead12168595fe1be99252129b6e56b3391f7ab1410cd1e0ef3dcdcabd2fda224"],["8ab89816dadfd6b6a1f2634fcf00ec8403781025ed6890c4849742706bd43ede","6fdcef09f2f6d0a044e654aef624136f503d459c3e89845858a47a9129cdd24e"],["1e33f1a746c9c5778133344d9299fcaa20b0938e8acff2544bb40284b8c5fb94","60660257dd11b3aa9c8ed618d24edff2306d320f1d03010e33a7d2057f3b3b6"],["85b7c1dcb3cec1b7ee7f30ded79dd20a0ed1f4cc18cbcfcfa410361fd8f08f31","3d98a9cdd026dd43f39048f25a8847f4fcafad1895d7a633c6fed3c35e999511"],["29df9fbd8d9e46509275f4b125d6d45d7fbe9a3b878a7af872a2800661ac5f51","b4c4fe99c775a606e2d8862179139ffda61dc861c019e55cd2876eb2a27d84b"],["a0b1cae06b0a847a3fea6e671aaf8adfdfe58ca2f768105c8082b2e449fce252","ae434102edde0958ec4b19d917a6a28e6b72da1834aff0e650f049503a296cf2"],["4e8ceafb9b3e9a136dc7ff67e840295b499dfb3b2133e4ba113f2e4c0e121e5","cf2174118c8b6d7a4b48f6d534ce5c79422c086a63460502b827ce62a326683c"],["d24a44e047e19b6f5afb81c7ca2f69080a5076689a010919f42725c2b789a33b","6fb8d5591b466f8fc63db50f1c0f1c69013f996887b8244d2cdec417afea8fa3"],["ea01606a7a6c9cdd249fdfcfacb99584001edd28abbab77b5104e98e8e3b35d4","322af4908c7312b0cfbfe369f7a7b3cdb7d4494bc2823700cfd652188a3ea98d"],["af8addbf2b661c8a6c6328655eb96651252007d8c5ea31be4ad196de8ce2131f","6749e67c029b85f52a034eafd096836b2520818680e26ac8f3dfbcdb71749700"],["e3ae1974566ca06cc516d47e0fb165a674a3dabcfca15e722f0e3450f45889","2aeabe7e4531510116217f07bf4d07300de97e4874f81f533420a72eeb0bd6a4"],["591ee355313d99721cf6993ffed1e3e301993ff3ed258802075ea8ced397e246","b0ea558a113c30bea60fc4775460c7901ff0b053d25ca2bdeee98f1a4be5d196"],["11396d55fda54c49f19aa97318d8da61fa8584e47b084945077cf03255b52984","998c74a8cd45ac01289d5833a7beb4744ff536b01b257be4c5767bea93ea57a4"],["3c5d2a1ba39c5a1790000738c9e0c40b8dcdfd5468754b6405540157e017aa7a","b2284279995a34e2f9d4de7396fc18b80f9b8b9fdd270f6661f79ca4c81bd257"],["cc8704b8a60a0defa3a99a7299f2e9c3fbc395afb04ac078425ef8a1793cc030","bdd46039feed17881d1e0862db347f8cf395b74fc4bcdc4e940b74e3ac1f1b13"],["c533e4f7ea8555aacd9777ac5cad29b97dd4defccc53ee7ea204119b2889b197","6f0a256bc5efdf429a2fb6242f1a43a2d9b925bb4a4b3a26bb8e0f45eb596096"],["c14f8f2ccb27d6f109f6d08d03cc96a69ba8c34eec07bbcf566d48e33da6593","c359d6923bb398f7fd4473e16fe1c28475b740dd098075e6c0e8649113dc3a38"],["a6cbc3046bc6a450bac24789fa17115a4c9739ed75f8f21ce441f72e0b90e6ef","21ae7f4680e889bb130619e2c0f95a360ceb573c70603139862afd617fa9b9f"],["347d6d9a02c48927ebfb86c1359b1caf130a3c0267d11ce6344b39f99d43cc38","60ea7f61a353524d1c987f6ecec92f086d565ab687870cb12689ff1e31c74448"],["da6545d2181db8d983f7dcb375ef5866d47c67b1bf31c8cf855ef7437b72656a","49b96715ab6878a79e78f07ce5680c5d6673051b4935bd897fea824b77dc208a"],["c40747cc9d012cb1a13b8148309c6de7ec25d6945d657146b9d5994b8feb1111","5ca560753be2a12fc6de6caf2cb489565db936156b9514e1bb5e83037e0fa2d4"],["4e42c8ec82c99798ccf3a610be870e78338c7f713348bd34c8203ef4037f3502","7571d74ee5e0fb92a7a8b33a07783341a5492144cc54bcc40a94473693606437"],["3775ab7089bc6af823aba2e1af70b236d251cadb0c86743287522a1b3b0dedea","be52d107bcfa09d8bcb9736a828cfa7fac8db17bf7a76a2c42ad961409018cf7"],["cee31cbf7e34ec379d94fb814d3d775ad954595d1314ba8846959e3e82f74e26","8fd64a14c06b589c26b947ae2bcf6bfa0149ef0be14ed4d80f448a01c43b1c6d"],["b4f9eaea09b6917619f6ea6a4eb5464efddb58fd45b1ebefcdc1a01d08b47986","39e5c9925b5a54b07433a4f18c61726f8bb131c012ca542eb24a8ac07200682a"],["d4263dfc3d2df923a0179a48966d30ce84e2515afc3dccc1b77907792ebcc60e","62dfaf07a0f78feb30e30d6295853ce189e127760ad6cf7fae164e122a208d54"],["48457524820fa65a4f8d35eb6930857c0032acc0a4a2de422233eeda897612c4","25a748ab367979d98733c38a1fa1c2e7dc6cc07db2d60a9ae7a76aaa49bd0f77"],["dfeeef1881101f2cb11644f3a2afdfc2045e19919152923f367a1767c11cceda","ecfb7056cf1de042f9420bab396793c0c390bde74b4bbdff16a83ae09a9a7517"],["6d7ef6b17543f8373c573f44e1f389835d89bcbc6062ced36c82df83b8fae859","cd450ec335438986dfefa10c57fea9bcc521a0959b2d80bbf74b190dca712d10"],["e75605d59102a5a2684500d3b991f2e3f3c88b93225547035af25af66e04541f","f5c54754a8f71ee540b9b48728473e314f729ac5308b06938360990e2bfad125"],["eb98660f4c4dfaa06a2be453d5020bc99a0c2e60abe388457dd43fefb1ed620c","6cb9a8876d9cb8520609af3add26cd20a0a7cd8a9411131ce85f44100099223e"],["13e87b027d8514d35939f2e6892b19922154596941888336dc3563e3b8dba942","fef5a3c68059a6dec5d624114bf1e91aac2b9da568d6abeb2570d55646b8adf1"],["ee163026e9fd6fe017c38f06a5be6fc125424b371ce2708e7bf4491691e5764a","1acb250f255dd61c43d94ccc670d0f58f49ae3fa15b96623e5430da0ad6c62b2"],["b268f5ef9ad51e4d78de3a750c2dc89b1e626d43505867999932e5db33af3d80","5f310d4b3c99b9ebb19f77d41c1dee018cf0d34fd4191614003e945a1216e423"],["ff07f3118a9df035e9fad85eb6c7bfe42b02f01ca99ceea3bf7ffdba93c4750d","438136d603e858a3a5c440c38eccbaddc1d2942114e2eddd4740d098ced1f0d8"],["8d8b9855c7c052a34146fd20ffb658bea4b9f69e0d825ebec16e8c3ce2b526a1","cdb559eedc2d79f926baf44fb84ea4d44bcf50fee51d7ceb30e2e7f463036758"],["52db0b5384dfbf05bfa9d472d7ae26dfe4b851ceca91b1eba54263180da32b63","c3b997d050ee5d423ebaf66a6db9f57b3180c902875679de924b69d84a7b375"],["e62f9490d3d51da6395efd24e80919cc7d0f29c3f3fa48c6fff543becbd43352","6d89ad7ba4876b0b22c2ca280c682862f342c8591f1daf5170e07bfd9ccafa7d"],["7f30ea2476b399b4957509c88f77d0191afa2ff5cb7b14fd6d8e7d65aaab1193","ca5ef7d4b231c94c3b15389a5f6311e9daff7bb67b103e9880ef4bff637acaec"],["5098ff1e1d9f14fb46a210fada6c903fef0fb7b4a1dd1d9ac60a0361800b7a00","9731141d81fc8f8084d37c6e7542006b3ee1b40d60dfe5362a5b132fd17ddc0"],["32b78c7de9ee512a72895be6b9cbefa6e2f3c4ccce445c96b9f2c81e2778ad58","ee1849f513df71e32efc3896ee28260c73bb80547ae2275ba497237794c8753c"],["e2cb74fddc8e9fbcd076eef2a7c72b0ce37d50f08269dfc074b581550547a4f7","d3aa2ed71c9dd2247a62df062736eb0baddea9e36122d2be8641abcb005cc4a4"],["8438447566d4d7bedadc299496ab357426009a35f235cb141be0d99cd10ae3a8","c4e1020916980a4da5d01ac5e6ad330734ef0d7906631c4f2390426b2edd791f"],["4162d488b89402039b584c6fc6c308870587d9c46f660b878ab65c82c711d67e","67163e903236289f776f22c25fb8a3afc1732f2b84b4e95dbda47ae5a0852649"],["3fad3fa84caf0f34f0f89bfd2dcf54fc175d767aec3e50684f3ba4a4bf5f683d","cd1bc7cb6cc407bb2f0ca647c718a730cf71872e7d0d2a53fa20efcdfe61826"],["674f2600a3007a00568c1a7ce05d0816c1fb84bf1370798f1c69532faeb1a86b","299d21f9413f33b3edf43b257004580b70db57da0b182259e09eecc69e0d38a5"],["d32f4da54ade74abb81b815ad1fb3b263d82d6c692714bcff87d29bd5ee9f08f","f9429e738b8e53b968e99016c059707782e14f4535359d582fc416910b3eea87"],["30e4e670435385556e593657135845d36fbb6931f72b08cb1ed954f1e3ce3ff6","462f9bce619898638499350113bbc9b10a878d35da70740dc695a559eb88db7b"],["be2062003c51cc3004682904330e4dee7f3dcd10b01e580bf1971b04d4cad297","62188bc49d61e5428573d48a74e1c655b1c61090905682a0d5558ed72dccb9bc"],["93144423ace3451ed29e0fb9ac2af211cb6e84a601df5993c419859fff5df04a","7c10dfb164c3425f5c71a3f9d7992038f1065224f72bb9d1d902a6d13037b47c"],["b015f8044f5fcbdcf21ca26d6c34fb8197829205c7b7d2a7cb66418c157b112c","ab8c1e086d04e813744a655b2df8d5f83b3cdc6faa3088c1d3aea1454e3a1d5f"],["d5e9e1da649d97d89e4868117a465a3a4f8a18de57a140d36b3f2af341a21b52","4cb04437f391ed73111a13cc1d4dd0db1693465c2240480d8955e8592f27447a"],["d3ae41047dd7ca065dbf8ed77b992439983005cd72e16d6f996a5316d36966bb","bd1aeb21ad22ebb22a10f0303417c6d964f8cdd7df0aca614b10dc14d125ac46"],["463e2763d885f958fc66cdd22800f0a487197d0a82e377b49f80af87c897b065","bfefacdb0e5d0fd7df3a311a94de062b26b80c61fbc97508b79992671ef7ca7f"],["7985fdfd127c0567c6f53ec1bb63ec3158e597c40bfe747c83cddfc910641917","603c12daf3d9862ef2b25fe1de289aed24ed291e0ec6708703a5bd567f32ed03"],["74a1ad6b5f76e39db2dd249410eac7f99e74c59cb83d2d0ed5ff1543da7703e9","cc6157ef18c9c63cd6193d83631bbea0093e0968942e8c33d5737fd790e0db08"],["30682a50703375f602d416664ba19b7fc9bab42c72747463a71d0896b22f6da3","553e04f6b018b4fa6c8f39e7f311d3176290d0e0f19ca73f17714d9977a22ff8"],["9e2158f0d7c0d5f26c3791efefa79597654e7a2b2464f52b1ee6c1347769ef57","712fcdd1b9053f09003a3481fa7762e9ffd7c8ef35a38509e2fbf2629008373"],["176e26989a43c9cfeba4029c202538c28172e566e3c4fce7322857f3be327d66","ed8cc9d04b29eb877d270b4878dc43c19aefd31f4eee09ee7b47834c1fa4b1c3"],["75d46efea3771e6e68abb89a13ad747ecf1892393dfc4f1b7004788c50374da8","9852390a99507679fd0b86fd2b39a868d7efc22151346e1a3ca4726586a6bed8"],["809a20c67d64900ffb698c4c825f6d5f2310fb0451c869345b7319f645605721","9e994980d9917e22b76b061927fa04143d096ccc54963e6a5ebfa5f3f8e286c1"],["1b38903a43f7f114ed4500b4eac7083fdefece1cf29c63528d563446f972c180","4036edc931a60ae889353f77fd53de4a2708b26b6f5da72ad3394119daf408f9"]]}}),ic}(function(t){var e=t,r=Js,n=Za,i=Lt,s=i.assert;function o(u){u.type==="short"?this.curve=new n.short(u):u.type==="edwards"?this.curve=new n.edwards(u):this.curve=new n.mont(u),this.g=this.curve.g,this.n=this.curve.n,this.hash=u.hash,s(this.g.validate(),"Invalid curve"),s(this.g.mul(this.n).isInfinity(),"Invalid curve, G*N != O")}e.PresetCurve=o;function a(u,d){Object.defineProperty(e,u,{configurable:!0,enumerable:!0,get:function(){var p=new o(d);return Object.defineProperty(e,u,{configurable:!0,enumerable:!0,value:p}),p}})}a("p192",{type:"short",prime:"p192",p:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff",a:"ffffffff ffffffff ffffffff fffffffe ffffffff fffffffc",b:"64210519 e59c80e7 0fa7e9ab 72243049 feb8deec c146b9b1",n:"ffffffff ffffffff ffffffff 99def836 146bc9b1 b4d22831",hash:r.sha256,gRed:!1,g:["188da80e b03090f6 7cbf20eb 43a18800 f4ff0afd 82ff1012","07192b95 ffc8da78 631011ed 6b24cdd5 73f977a1 1e794811"]}),a("p224",{type:"short",prime:"p224",p:"ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001",a:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff fffffffe",b:"b4050a85 0c04b3ab f5413256 5044b0b7 d7bfd8ba 270b3943 2355ffb4",n:"ffffffff ffffffff ffffffff ffff16a2 e0b8f03e 13dd2945 5c5c2a3d",hash:r.sha256,gRed:!1,g:["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3 56c21122 343280d6 115c1d21","bd376388 b5f723fb 4c22dfe6 cd4375a0 5a074764 44d58199 85007e34"]}),a("p256",{type:"short",prime:null,p:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff ffffffff",a:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff fffffffc",b:"5ac635d8 aa3a93e7 b3ebbd55 769886bc 651d06b0 cc53b0f6 3bce3c3e 27d2604b",n:"ffffffff 00000000 ffffffff ffffffff bce6faad a7179e84 f3b9cac2 fc632551",hash:r.sha256,gRed:!1,g:["6b17d1f2 e12c4247 f8bce6e5 63a440f2 77037d81 2deb33a0 f4a13945 d898c296","4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16 2bce3357 6b315ece cbb64068 37bf51f5"]}),a("p384",{type:"short",prime:null,p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 ffffffff",a:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 fffffffc",b:"b3312fa7 e23ee7e4 988e056b e3f82d19 181d9c6e fe814112 0314088f 5013875a c656398d 8a2ed19d 2a85c8ed d3ec2aef",n:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff c7634d81 f4372ddf 581a0db2 48b0a77a ecec196a ccc52973",hash:r.sha384,gRed:!1,g:["aa87ca22 be8b0537 8eb1c71e f320ad74 6e1d3b62 8ba79b98 59f741e0 82542a38 5502f25d bf55296c 3a545e38 72760ab7","3617de4a 96262c6f 5d9e98bf 9292dc29 f8f41dbd 289a147c e9da3113 b5f0b8c0 0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"]}),a("p521",{type:"short",prime:null,p:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff",a:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffc",b:"00000051 953eb961 8e1c9a1f 929a21a0 b68540ee a2da725b 99b315f3 b8b48991 8ef109e1 56193951 ec7e937b 1652c0bd 3bb1bf07 3573df88 3d2c34f1 ef451fd4 6b503f00",n:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffa 51868783 bf2f966b 7fcc0148 f709a5d0 3bb5c9b8 899c47ae bb6fb71e 91386409",hash:r.sha512,gRed:!1,g:["000000c6 858e06b7 0404e9cd 9e3ecb66 2395b442 9c648139 053fb521 f828af60 6b4d3dba a14b5e77 efe75928 fe1dc127 a2ffa8de 3348b3c1 856a429b f97e7e31 c2e5bd66","00000118 39296a78 9a3bc004 5c8a5fb4 2c7d1bd9 98f54449 579b4468 17afbd17 273e662c 97ee7299 5ef42640 c550b901 3fad0761 353c7086 a272c240 88be9476 9fd16650"]}),a("curve25519",{type:"mont",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"76d06",b:"1",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:r.sha256,gRed:!1,g:["9"]}),a("ed25519",{type:"edwards",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"-1",c:"1",d:"52036cee2b6ffe73 8cc740797779e898 00700a4d4141d8ab 75eb4dca135978a3",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:r.sha256,gRed:!1,g:["216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a","6666666666666666666666666666666666666666666666666666666666666658"]});var c;try{c=P6()}catch{c=void 0}a("secp256k1",{type:"short",prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",hash:r.sha256,beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:!1,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",c]})})(Zs);var N6=Js,vn=Ya,Kd=pn;function Vr(t){if(!(this instanceof Vr))return new Vr(t);this.hash=t.hash,this.predResist=!!t.predResist,this.outLen=this.hash.outSize,this.minEntropy=t.minEntropy||this.hash.hmacStrength,this._reseed=null,this.reseedInterval=null,this.K=null,this.V=null;var e=vn.toArray(t.entropy,t.entropyEnc||"hex"),r=vn.toArray(t.nonce,t.nonceEnc||"hex"),n=vn.toArray(t.pers,t.persEnc||"hex");Kd(e.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._init(e,r,n)}var C6=Vr;Vr.prototype._init=function(e,r,n){var i=e.concat(r).concat(n);this.K=new Array(this.outLen/8),this.V=new Array(this.outLen/8);for(var s=0;s<this.V.length;s++)this.K[s]=0,this.V[s]=1;this._update(i),this._reseed=1,this.reseedInterval=281474976710656},Vr.prototype._hmac=function(){return new N6.hmac(this.hash,this.K)},Vr.prototype._update=function(e){var r=this._hmac().update(this.V).update([0]);e&&(r=r.update(e)),this.K=r.digest(),this.V=this._hmac().update(this.V).digest(),e&&(this.K=this._hmac().update(this.V).update([1]).update(e).digest(),this.V=this._hmac().update(this.V).digest())},Vr.prototype.reseed=function(e,r,n,i){typeof r!="string"&&(i=n,n=r,r=null),e=vn.toArray(e,r),n=vn.toArray(n,i),Kd(e.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._update(e.concat(n||[])),this._reseed=1},Vr.prototype.generate=function(e,r,n,i){if(this._reseed>this.reseedInterval)throw new Error("Reseed is required");typeof r!="string"&&(i=n,n=r,r=null),n&&(n=vn.toArray(n,i||"hex"),this._update(n));for(var s=[];s.length<e;)this.V=this._hmac().update(this.V).digest(),s=s.concat(this.V);var o=s.slice(0,e);return this._update(n),this._reseed++,vn.encode(o,r)};var L6=hr.exports,$6=Lt,sc=$6.assert;function vt(t,e){this.ec=t,this.priv=null,this.pub=null,e.priv&&this._importPrivate(e.priv,e.privEnc),e.pub&&this._importPublic(e.pub,e.pubEnc)}var F6=vt;vt.fromPublic=function(e,r,n){return r instanceof vt?r:new vt(e,{pub:r,pubEnc:n})},vt.fromPrivate=function(e,r,n){return r instanceof vt?r:new vt(e,{priv:r,privEnc:n})},vt.prototype.validate=function(){var e=this.getPublic();return e.isInfinity()?{result:!1,reason:"Invalid public key"}:e.validate()?e.mul(this.ec.curve.n).isInfinity()?{result:!0,reason:null}:{result:!1,reason:"Public key * N != O"}:{result:!1,reason:"Public key is not a point"}},vt.prototype.getPublic=function(e,r){return typeof e=="string"&&(r=e,e=null),this.pub||(this.pub=this.ec.g.mul(this.priv)),r?this.pub.encode(r,e):this.pub},vt.prototype.getPrivate=function(e){return e==="hex"?this.priv.toString(16,2):this.priv},vt.prototype._importPrivate=function(e,r){this.priv=new L6(e,r||16),this.priv=this.priv.umod(this.ec.curve.n)},vt.prototype._importPublic=function(e,r){if(e.x||e.y){this.ec.curve.type==="mont"?sc(e.x,"Need x coordinate"):(this.ec.curve.type==="short"||this.ec.curve.type==="edwards")&&sc(e.x&&e.y,"Need both x and y coordinate"),this.pub=this.ec.curve.point(e.x,e.y);return}this.pub=this.ec.curve.decodePoint(e,r)},vt.prototype.derive=function(e){return e.validate()||sc(e.validate(),"public point not validated"),e.mul(this.priv).getX()},vt.prototype.sign=function(e,r,n){return this.ec.sign(e,this,r,n)},vt.prototype.verify=function(e,r,n){return this.ec.verify(e,r,this,void 0,n)},vt.prototype.inspect=function(){return"<Key priv: "+(this.priv&&this.priv.toString(16,2))+" pub: "+(this.pub&&this.pub.inspect())+" >"};var to=hr.exports,oc=Lt,z6=oc.assert;function ro(t,e){if(t instanceof ro)return t;this._importDER(t,e)||(z6(t.r&&t.s,"Signature without r or s"),this.r=new to(t.r,16),this.s=new to(t.s,16),t.recoveryParam===void 0?this.recoveryParam=null:this.recoveryParam=t.recoveryParam)}var U6=ro;function k6(){this.place=0}function ac(t,e){var r=t[e.place++];if(!(r&128))return r;var n=r&15;if(n===0||n>4||t[e.place]===0)return!1;for(var i=0,s=0,o=e.place;s<n;s++,o++)i<<=8,i|=t[o],i>>>=0;return i<=127?!1:(e.place=o,i)}function Vd(t){for(var e=0,r=t.length-1;!t[e]&&!(t[e+1]&128)&&e<r;)e++;return e===0?t:t.slice(e)}ro.prototype._importDER=function(e,r){e=oc.toArray(e,r);var n=new k6;if(e[n.place++]!==48)return!1;var i=ac(e,n);if(i===!1||i+n.place!==e.length||e[n.place++]!==2)return!1;var s=ac(e,n);if(s===!1||(e[n.place]&128)!==0)return!1;var o=e.slice(n.place,s+n.place);if(n.place+=s,e[n.place++]!==2)return!1;var a=ac(e,n);if(a===!1||e.length!==a+n.place||(e[n.place]&128)!==0)return!1;var c=e.slice(n.place,a+n.place);if(o[0]===0)if(o[1]&128)o=o.slice(1);else return!1;if(c[0]===0)if(c[1]&128)c=c.slice(1);else return!1;return this.r=new to(o),this.s=new to(c),this.recoveryParam=null,!0};function cc(t,e){if(e<128){t.push(e);return}var r=1+(Math.log(e)/Math.LN2>>>3);for(t.push(r|128);--r;)t.push(e>>>(r<<3)&255);t.push(e)}ro.prototype.toDER=function(e){var r=this.r.toArray(),n=this.s.toArray();for(r[0]&128&&(r=[0].concat(r)),n[0]&128&&(n=[0].concat(n)),r=Vd(r),n=Vd(n);!n[0]&&!(n[1]&128);)n=n.slice(1);var i=[2];cc(i,r.length),i=i.concat(r),i.push(2),cc(i,n.length);var s=i.concat(n),o=[48];return cc(o,s.length),o=o.concat(s),oc.encode(o,e)};var tr=hr.exports,Wd=C6,j6=Lt,fc=Zs,q6=Ks.exports,yn=j6.assert,uc=F6,no=U6;function Vt(t){if(!(this instanceof Vt))return new Vt(t);typeof t=="string"&&(yn(Object.prototype.hasOwnProperty.call(fc,t),"Unknown curve "+t),t=fc[t]),t instanceof fc.PresetCurve&&(t={curve:t}),this.curve=t.curve.curve,this.n=this.curve.n,this.nh=this.n.ushrn(1),this.g=this.curve.g,this.g=t.curve.g,this.g.precompute(t.curve.n.bitLength()+1),this.hash=t.hash||t.curve.hash}var H6=Vt;Vt.prototype.keyPair=function(e){return new uc(this,e)},Vt.prototype.keyFromPrivate=function(e,r){return uc.fromPrivate(this,e,r)},Vt.prototype.keyFromPublic=function(e,r){return uc.fromPublic(this,e,r)},Vt.prototype.genKeyPair=function(e){e||(e={});for(var r=new Wd({hash:this.hash,pers:e.pers,persEnc:e.persEnc||"utf8",entropy:e.entropy||q6(this.hash.hmacStrength),entropyEnc:e.entropy&&e.entropyEnc||"utf8",nonce:this.n.toArray()}),n=this.n.byteLength(),i=this.n.sub(new tr(2));;){var s=new tr(r.generate(n));if(!(s.cmp(i)>0))return s.iaddn(1),this.keyFromPrivate(s)}},Vt.prototype._truncateToN=function(e,r,n){var i;if(tr.isBN(e)||typeof e=="number")e=new tr(e,16),i=e.byteLength();else if(typeof e=="object")i=e.length,e=new tr(e,16);else{var s=e.toString();i=s.length+1>>>1,e=new tr(s,16)}typeof n!="number"&&(n=i*8);var o=n-this.n.bitLength();return o>0&&(e=e.ushrn(o)),!r&&e.cmp(this.n)>=0?e.sub(this.n):e},Vt.prototype.sign=function(e,r,n,i){if(typeof n=="object"&&(i=n,n=null),i||(i={}),typeof e!="string"&&typeof e!="number"&&!tr.isBN(e)){yn(typeof e=="object"&&e&&typeof e.length=="number","Expected message to be an array-like, a hex string, or a BN instance"),yn(e.length>>>0===e.length);for(var s=0;s<e.length;s++)yn((e[s]&255)===e[s])}r=this.keyFromPrivate(r,n),e=this._truncateToN(e,!1,i.msgBitLength),yn(!e.isNeg(),"Can not sign a negative message");var o=this.n.byteLength(),a=r.getPrivate().toArray("be",o),c=e.toArray("be",o);yn(new tr(c).eq(e),"Can not sign message");for(var u=new Wd({hash:this.hash,entropy:a,nonce:c,pers:i.pers,persEnc:i.persEnc||"utf8"}),d=this.n.sub(new tr(1)),p=0;;p++){var y=i.k?i.k(p):new tr(u.generate(this.n.byteLength()));if(y=this._truncateToN(y,!0),!(y.cmpn(1)<=0||y.cmp(d)>=0)){var _=this.g.mul(y);if(!_.isInfinity()){var w=_.getX(),D=w.umod(this.n);if(D.cmpn(0)!==0){var O=y.invm(this.n).mul(D.mul(r.getPrivate()).iadd(e));if(O=O.umod(this.n),O.cmpn(0)!==0){var M=(_.getY().isOdd()?1:0)|(w.cmp(D)!==0?2:0);return i.canonical&&O.cmp(this.nh)>0&&(O=this.n.sub(O),M^=1),new no({r:D,s:O,recoveryParam:M})}}}}}},Vt.prototype.verify=function(e,r,n,i,s){s||(s={}),e=this._truncateToN(e,!1,s.msgBitLength),n=this.keyFromPublic(n,i),r=new no(r,"hex");var o=r.r,a=r.s;if(o.cmpn(1)<0||o.cmp(this.n)>=0||a.cmpn(1)<0||a.cmp(this.n)>=0)return!1;var c=a.invm(this.n),u=c.mul(e).umod(this.n),d=c.mul(o).umod(this.n),p;return this.curve._maxwellTrick?(p=this.g.jmulAdd(u,n.getPublic(),d),p.isInfinity()?!1:p.eqXToP(o)):(p=this.g.mulAdd(u,n.getPublic(),d),p.isInfinity()?!1:p.getX().umod(this.n).cmp(o)===0)},Vt.prototype.recoverPubKey=function(t,e,r,n){yn((3&r)===r,"The recovery param is more than two bits"),e=new no(e,n);var i=this.n,s=new tr(t),o=e.r,a=e.s,c=r&1,u=r>>1;if(o.cmp(this.curve.p.umod(this.curve.n))>=0&&u)throw new Error("Unable to find sencond key candinate");u?o=this.curve.pointFromX(o.add(this.curve.n),c):o=this.curve.pointFromX(o,c);var d=e.r.invm(i),p=i.sub(s).mul(d).umod(i),y=a.mul(d).umod(i);return this.g.mulAdd(p,o,y)},Vt.prototype.getKeyRecoveryParam=function(t,e,r,n){if(e=new no(e,n),e.recoveryParam!==null)return e.recoveryParam;for(var i=0;i<4;i++){var s;try{s=this.recoverPubKey(t,e,i)}catch{continue}if(s.eq(r))return i}throw new Error("Unable to find valid recovery factor")};var Li=Lt,Gd=Li.assert,Yd=Li.parseBytes,ni=Li.cachedProperty;function ot(t,e){this.eddsa=t,this._secret=Yd(e.secret),t.isPoint(e.pub)?this._pub=e.pub:this._pubBytes=Yd(e.pub)}ot.fromPublic=function(e,r){return r instanceof ot?r:new ot(e,{pub:r})},ot.fromSecret=function(e,r){return r instanceof ot?r:new ot(e,{secret:r})},ot.prototype.secret=function(){return this._secret},ni(ot,"pubBytes",function(){return this.eddsa.encodePoint(this.pub())}),ni(ot,"pub",function(){return this._pubBytes?this.eddsa.decodePoint(this._pubBytes):this.eddsa.g.mul(this.priv())}),ni(ot,"privBytes",function(){var e=this.eddsa,r=this.hash(),n=e.encodingLength-1,i=r.slice(0,e.encodingLength);return i[0]&=248,i[n]&=127,i[n]|=64,i}),ni(ot,"priv",function(){return this.eddsa.decodeInt(this.privBytes())}),ni(ot,"hash",function(){return this.eddsa.hash().update(this.secret()).digest()}),ni(ot,"messagePrefix",function(){return this.hash().slice(this.eddsa.encodingLength)}),ot.prototype.sign=function(e){return Gd(this._secret,"KeyPair can only verify"),this.eddsa.sign(e,this)},ot.prototype.verify=function(e,r){return this.eddsa.verify(e,r,this)},ot.prototype.getSecret=function(e){return Gd(this._secret,"KeyPair is public only"),Li.encode(this.secret(),e)},ot.prototype.getPublic=function(e){return Li.encode(this.pubBytes(),e)};var K6=ot,V6=hr.exports,io=Lt,Xd=io.assert,so=io.cachedProperty,W6=io.parseBytes;function mn(t,e){this.eddsa=t,typeof e!="object"&&(e=W6(e)),Array.isArray(e)&&(Xd(e.length===t.encodingLength*2,"Signature has invalid size"),e={R:e.slice(0,t.encodingLength),S:e.slice(t.encodingLength)}),Xd(e.R&&e.S,"Signature without R or S"),t.isPoint(e.R)&&(this._R=e.R),e.S instanceof V6&&(this._S=e.S),this._Rencoded=Array.isArray(e.R)?e.R:e.Rencoded,this._Sencoded=Array.isArray(e.S)?e.S:e.Sencoded}so(mn,"S",function(){return this.eddsa.decodeInt(this.Sencoded())}),so(mn,"R",function(){return this.eddsa.decodePoint(this.Rencoded())}),so(mn,"Rencoded",function(){return this.eddsa.encodePoint(this.R())}),so(mn,"Sencoded",function(){return this.eddsa.encodeInt(this.S())}),mn.prototype.toBytes=function(){return this.Rencoded().concat(this.Sencoded())},mn.prototype.toHex=function(){return io.encode(this.toBytes(),"hex").toUpperCase()};var G6=mn,Y6=Js,X6=Zs,ii=Lt,Z6=ii.assert,Zd=ii.parseBytes,Jd=K6,Qd=G6;function Rt(t){if(Z6(t==="ed25519","only tested with ed25519 so far"),!(this instanceof Rt))return new Rt(t);t=X6[t].curve,this.curve=t,this.g=t.g,this.g.precompute(t.n.bitLength()+1),this.pointClass=t.point().constructor,this.encodingLength=Math.ceil(t.n.bitLength()/8),this.hash=Y6.sha512}var J6=Rt;Rt.prototype.sign=function(e,r){e=Zd(e);var n=this.keyFromSecret(r),i=this.hashInt(n.messagePrefix(),e),s=this.g.mul(i),o=this.encodePoint(s),a=this.hashInt(o,n.pubBytes(),e).mul(n.priv()),c=i.add(a).umod(this.curve.n);return this.makeSignature({R:s,S:c,Rencoded:o})},Rt.prototype.verify=function(e,r,n){if(e=Zd(e),r=this.makeSignature(r),r.S().gte(r.eddsa.curve.n)||r.S().isNeg())return!1;var i=this.keyFromPublic(n),s=this.hashInt(r.Rencoded(),i.pubBytes(),e),o=this.g.mul(r.S()),a=r.R().add(i.pub().mul(s));return a.eq(o)},Rt.prototype.hashInt=function(){for(var e=this.hash(),r=0;r<arguments.length;r++)e.update(arguments[r]);return ii.intFromLE(e.digest()).umod(this.curve.n)},Rt.prototype.keyFromPublic=function(e){return Jd.fromPublic(this,e)},Rt.prototype.keyFromSecret=function(e){return Jd.fromSecret(this,e)},Rt.prototype.makeSignature=function(e){return e instanceof Qd?e:new Qd(this,e)},Rt.prototype.encodePoint=function(e){var r=e.getY().toArray("le",this.encodingLength);return r[this.encodingLength-1]|=e.getX().isOdd()?128:0,r},Rt.prototype.decodePoint=function(e){e=ii.parseBytes(e);var r=e.length-1,n=e.slice(0,r).concat(e[r]&-129),i=(e[r]&128)!==0,s=ii.intFromLE(n);return this.curve.pointFromY(s,i)},Rt.prototype.encodeInt=function(e){return e.toArray("le",this.encodingLength)},Rt.prototype.decodeInt=function(e){return ii.intFromLE(e)},Rt.prototype.isPoint=function(e){return e instanceof this.pointClass},function(t){var e=t;e.version=Y8.version,e.utils=Lt,e.rand=Ks.exports,e.curve=Za,e.curves=Zs,e.ec=H6,e.eddsa=J6}(vd);const Q6={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe",batchFetchMessages:"waku_batchFetchMessages"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe",batchFetchMessages:"irn_batchFetchMessages"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe",batchFetchMessages:"iridium_batchFetchMessages"}};var e4=Object.defineProperty,el=Object.getOwnPropertySymbols,t4=Object.prototype.hasOwnProperty,r4=Object.prototype.propertyIsEnumerable,tl=(t,e,r)=>e in t?e4(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,n4=(t,e)=>{for(var r in e||(e={}))t4.call(e,r)&&tl(t,r,e[r]);if(el)for(var r of el(e))r4.call(e,r)&&tl(t,r,e[r]);return t};const i4="ReactNative",rr={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},s4="js";function oo(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function wn(){return!Ls()&&!!xa()&&navigator.product===i4}function o4(){return wn()&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"&&(global==null?void 0:global.Platform.OS)==="android"}function a4(){return wn()&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"&&(global==null?void 0:global.Platform.OS)==="ios"}function ao(){return!oo()&&!!xa()&&!!Ls()}function co(){return wn()?rr.reactNative:oo()?rr.node:ao()?rr.browser:rr.unknown}function rl(){var t;try{return wn()&&typeof global<"u"&&typeof(global==null?void 0:global.Application)<"u"?(t=global.Application)==null?void 0:t.applicationId:void 0}catch{return}}function c4(t,e){const r=new URLSearchParams(t);for(const n of Object.keys(e).sort())if(e.hasOwnProperty(n)){const i=e[n];i!==void 0&&r.set(n,i)}return r.toString()}function f4(){return Mh()||{name:"",description:"",url:"",icons:[""]}}function u4(){if(co()===rr.reactNative&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"){const{OS:r,Version:n}=global.Platform;return[r,n].join("-")}const t=D3();if(t===null)return"unknown";const e=t.os?t.os.replace(" ","").toLowerCase():"unknown";return t.type==="browser"?[e,t.name,t.version].join("-"):[e,t.version].join("-")}function h4(){var t;const e=co();return e===rr.browser?[e,((t=Oh())==null?void 0:t.host)||"unknown"].join(":"):e}function nl(t,e,r){const n=u4(),i=h4();return[[t,e].join("-"),[s4,r].join("-"),n,i].join("/")}function d4({protocol:t,version:e,relayUrl:r,sdkVersion:n,auth:i,projectId:s,useOnCloseEvent:o,bundleId:a,packageName:c}){const u=r.split("?"),d=nl(t,e,n),p={auth:i,ua:d,projectId:s,useOnCloseEvent:o||void 0,packageName:c||void 0,bundleId:a||void 0},y=c4(u[1]||"",p);return u[0]+"?"+y}function il(t){return Object.fromEntries(t.entries())}function sl(t){return new Map(Object.entries(t))}function l4(t=G.FIVE_MINUTES,e){const r=G.toMiliseconds(t||G.FIVE_MINUTES);let n,i,s,o;return{resolve:a=>{s&&n&&(clearTimeout(s),n(a),o=Promise.resolve(a))},reject:a=>{s&&i&&(clearTimeout(s),i(a))},done:()=>new Promise((a,c)=>{if(o)return a(o);s=setTimeout(()=>{const u=new Error(e);o=Promise.reject(u),c(u)},r),n=a,i=c})}}function Wr(t,e,r){return new Promise(async(n,i)=>{const s=setTimeout(()=>i(new Error(r)),e);try{const o=await t;n(o)}catch(o){i(o)}clearTimeout(s)})}function ol(t,e){if(typeof e=="string"&&e.startsWith(`${t}:`))return e;if(t.toLowerCase()==="topic"){if(typeof e!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${e}`}else if(t.toLowerCase()==="id"){if(typeof e!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${e}`}throw new Error(`Unknown expirer target type: ${t}`)}function p4(t){return ol("topic",t)}function b4(t){return ol("id",t)}function g4(t){const[e,r]=t.split(":"),n={id:void 0,topic:void 0};if(e==="topic"&&typeof r=="string")n.topic=r;else if(e==="id"&&Number.isInteger(Number(r)))n.id=Number(r);else throw new Error(`Invalid target, expected id:number or topic:string, got ${e}:${r}`);return n}function $i(t,e){return G.fromMiliseconds((e||Date.now())+G.toMiliseconds(t))}function al(t){return Date.now()>=G.toMiliseconds(t)}function hc(t,e){return`${t}${e?`:${e}`:""}`}function cl(){return typeof crypto<"u"&&crypto!=null&&crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/gu,t=>{const e=Math.random()*16|0;return(t==="x"?e:e&3|8).toString(16)})}function fl(){return typeof process<"u"&&process.env.IS_VITEST==="true"}function ul(t){return Buffer.from(t,"base64").toString("utf-8")}function v4(t){return new Promise(e=>setTimeout(e,t))}function Fi(t){if(!Number.isSafeInteger(t)||t<0)throw new Error("positive integer expected, got "+t)}function y4(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function fo(t,...e){if(!y4(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function dc(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");Fi(t.outputLen),Fi(t.blockLen)}function si(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function hl(t,e){fo(t);const r=e.outputLen;if(t.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}const uo=BigInt(2**32-1),dl=BigInt(32);function m4(t,e=!1){return e?{h:Number(t&uo),l:Number(t>>dl&uo)}:{h:Number(t>>dl&uo)|0,l:Number(t&uo)|0}}function w4(t,e=!1){let r=new Uint32Array(t.length),n=new Uint32Array(t.length);for(let i=0;i<t.length;i++){const{h:s,l:o}=m4(t[i],e);[r[i],n[i]]=[s,o]}return[r,n]}const _4=(t,e,r)=>t<<r|e>>>32-r,E4=(t,e,r)=>e<<r|t>>>32-r,x4=(t,e,r)=>e<<r-32|t>>>64-r,S4=(t,e,r)=>t<<r-32|e>>>64-r,oi=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;function I4(t){return new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4))}function lc(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function wr(t,e){return t<<32-e|t>>>e}const ll=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function A4(t){return t<<24&4278190080|t<<8&16711680|t>>>8&65280|t>>>24&255}function pl(t){for(let e=0;e<t.length;e++)t[e]=A4(t[e])}function D4(t){if(typeof t!="string")throw new Error("utf8ToBytes expected string, got "+typeof t);return new Uint8Array(new TextEncoder().encode(t))}function ai(t){return typeof t=="string"&&(t=D4(t)),fo(t),t}class pc{clone(){return this._cloneInto()}}function bl(t){const e=n=>t().update(ai(n)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e}function zi(t=32){if(oi&&typeof oi.getRandomValues=="function")return oi.getRandomValues(new Uint8Array(t));if(oi&&typeof oi.randomBytes=="function")return oi.randomBytes(t);throw new Error("crypto.getRandomValues must be defined")}const gl=[],vl=[],yl=[],O4=BigInt(0),Ui=BigInt(1),M4=BigInt(2),T4=BigInt(7),R4=BigInt(256),B4=BigInt(113);for(let t=0,e=Ui,r=1,n=0;t<24;t++){[r,n]=[n,(2*r+3*n)%5],gl.push(2*(5*n+r)),vl.push((t+1)*(t+2)/2%64);let i=O4;for(let s=0;s<7;s++)e=(e<<Ui^(e>>T4)*B4)%R4,e&M4&&(i^=Ui<<(Ui<<BigInt(s))-Ui);yl.push(i)}const[P4,N4]=w4(yl,!0),ml=(t,e,r)=>r>32?x4(t,e,r):_4(t,e,r),wl=(t,e,r)=>r>32?S4(t,e,r):E4(t,e,r);function C4(t,e=24){const r=new Uint32Array(10);for(let n=24-e;n<24;n++){for(let o=0;o<10;o++)r[o]=t[o]^t[o+10]^t[o+20]^t[o+30]^t[o+40];for(let o=0;o<10;o+=2){const a=(o+8)%10,c=(o+2)%10,u=r[c],d=r[c+1],p=ml(u,d,1)^r[a],y=wl(u,d,1)^r[a+1];for(let _=0;_<50;_+=10)t[o+_]^=p,t[o+_+1]^=y}let i=t[2],s=t[3];for(let o=0;o<24;o++){const a=vl[o],c=ml(i,s,a),u=wl(i,s,a),d=gl[o];i=t[d],s=t[d+1],t[d]=c,t[d+1]=u}for(let o=0;o<50;o+=10){for(let a=0;a<10;a++)r[a]=t[o+a];for(let a=0;a<10;a++)t[o+a]^=~r[(a+2)%10]&r[(a+4)%10]}t[0]^=P4[n],t[1]^=N4[n]}r.fill(0)}class bc extends pc{constructor(e,r,n,i=!1,s=24){if(super(),this.blockLen=e,this.suffix=r,this.outputLen=n,this.enableXOF=i,this.rounds=s,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,Fi(n),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=I4(this.state)}keccak(){ll||pl(this.state32),C4(this.state32,this.rounds),ll||pl(this.state32),this.posOut=0,this.pos=0}update(e){si(this);const{blockLen:r,state:n}=this;e=ai(e);const i=e.length;for(let s=0;s<i;){const o=Math.min(r-this.pos,i-s);for(let a=0;a<o;a++)n[this.pos++]^=e[s++];this.pos===r&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:r,pos:n,blockLen:i}=this;e[n]^=r,(r&128)!==0&&n===i-1&&this.keccak(),e[i-1]^=128,this.keccak()}writeInto(e){si(this,!1),fo(e),this.finish();const r=this.state,{blockLen:n}=this;for(let i=0,s=e.length;i<s;){this.posOut>=n&&this.keccak();const o=Math.min(n-this.posOut,s-i);e.set(r.subarray(this.posOut,this.posOut+o),i),this.posOut+=o,i+=o}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return Fi(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(hl(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(e){const{blockLen:r,suffix:n,outputLen:i,rounds:s,enableXOF:o}=this;return e||(e=new bc(r,n,i,o,s)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=s,e.suffix=n,e.outputLen=i,e.enableXOF=o,e.destroyed=this.destroyed,e}}((t,e,r)=>bl(()=>new bc(e,t,r)))(1,136,256/8);function gc(t){if(!Number.isSafeInteger(t)||t<0)throw new Error("positive integer expected, got "+t)}function _l(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function $t(t,...e){if(!_l(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function El(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function L4(t,e){$t(t);const r=e.outputLen;if(t.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}function xl(t){if(typeof t!="boolean")throw new Error(`boolean expected, not ${t}`)}const Gr=t=>new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4)),$4=t=>new DataView(t.buffer,t.byteOffset,t.byteLength);if(!(new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68))throw new Error("Non little-endian hardware is not supported");function F4(t){if(typeof t!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(t))}function vc(t){if(typeof t=="string")t=F4(t);else if(_l(t))t=yc(t);else throw new Error("Uint8Array expected, got "+typeof t);return t}function z4(t,e){if(e==null||typeof e!="object")throw new Error("options must be defined");return Object.assign(t,e)}function U4(t,e){if(t.length!==e.length)return!1;let r=0;for(let n=0;n<t.length;n++)r|=t[n]^e[n];return r===0}const k4=(t,e)=>{function r(n,...i){if($t(n),t.nonceLength!==void 0){const u=i[0];if(!u)throw new Error("nonce / iv required");t.varSizeNonce?$t(u):$t(u,t.nonceLength)}const s=t.tagLength;s&&i[1]!==void 0&&$t(i[1]);const o=e(n,...i),a=(u,d)=>{if(d!==void 0){if(u!==2)throw new Error("cipher output not supported");$t(d)}};let c=!1;return{encrypt(u,d){if(c)throw new Error("cannot encrypt() twice with same key + nonce");return c=!0,$t(u),a(o.encrypt.length,d),o.encrypt(u,d)},decrypt(u,d){if($t(u),s&&u.length<s)throw new Error("invalid ciphertext length: smaller than tagLength="+s);return a(o.decrypt.length,d),o.decrypt(u,d)}}}return Object.assign(r,t),r};function Sl(t,e,r=!0){if(e===void 0)return new Uint8Array(t);if(e.length!==t)throw new Error("invalid output length, expected "+t+", got: "+e.length);if(r&&!j4(e))throw new Error("invalid output, must be aligned");return e}function Il(t,e,r,n){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,r,n);const i=BigInt(32),s=BigInt(4294967295),o=Number(r>>i&s),a=Number(r&s),c=n?4:0,u=n?0:4;t.setUint32(e+c,o,n),t.setUint32(e+u,a,n)}function j4(t){return t.byteOffset%4===0}function yc(t){return Uint8Array.from(t)}function ci(...t){for(let e=0;e<t.length;e++)t[e].fill(0)}const Al=t=>Uint8Array.from(t.split("").map(e=>e.charCodeAt(0))),q4=Al("expand 16-byte k"),H4=Al("expand 32-byte k"),K4=Gr(q4),V4=Gr(H4);function se(t,e){return t<<e|t>>>32-e}function mc(t){return t.byteOffset%4===0}const ho=64,W4=16,Dl=2**32-1,Ol=new Uint32Array;function G4(t,e,r,n,i,s,o,a){const c=i.length,u=new Uint8Array(ho),d=Gr(u),p=mc(i)&&mc(s),y=p?Gr(i):Ol,_=p?Gr(s):Ol;for(let w=0;w<c;o++){if(t(e,r,n,d,o,a),o>=Dl)throw new Error("arx: counter overflow");const D=Math.min(ho,c-w);if(p&&D===ho){const O=w/4;if(w%4!==0)throw new Error("arx: invalid block position");for(let M=0,T;M<W4;M++)T=O+M,_[T]=y[T]^d[M];w+=ho;continue}for(let O=0,M;O<D;O++)M=w+O,s[M]=i[M]^u[O];w+=D}}function Y4(t,e){const{allowShortKeys:r,extendNonceFn:n,counterLength:i,counterRight:s,rounds:o}=z4({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},e);if(typeof t!="function")throw new Error("core must be a function");return gc(i),gc(o),xl(s),xl(r),(a,c,u,d,p=0)=>{$t(a),$t(c),$t(u);const y=u.length;if(d===void 0&&(d=new Uint8Array(y)),$t(d),gc(p),p<0||p>=Dl)throw new Error("arx: counter overflow");if(d.length<y)throw new Error(`arx: output (${d.length}) is shorter than data (${y})`);const _=[];let w=a.length,D,O;if(w===32)_.push(D=yc(a)),O=V4;else if(w===16&&r)D=new Uint8Array(32),D.set(a),D.set(a,16),O=K4,_.push(D);else throw new Error(`arx: invalid 32-byte key, got length=${w}`);mc(c)||_.push(c=yc(c));const M=Gr(D);if(n){if(c.length!==24)throw new Error("arx: extended nonce must be 24 bytes");n(O,M,Gr(c.subarray(0,16)),M),c=c.subarray(16)}const T=16-i;if(T!==c.length)throw new Error(`arx: nonce must be ${T} or 16 bytes`);if(T!==12){const P=new Uint8Array(12);P.set(c,s?0:12-c.length),c=P,_.push(c)}const B=Gr(c);return G4(t,O,M,B,u,d,p,o),ci(..._),d}}const lt=(t,e)=>t[e++]&255|(t[e++]&255)<<8;class X4{constructor(e){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,e=vc(e),$t(e,32);const r=lt(e,0),n=lt(e,2),i=lt(e,4),s=lt(e,6),o=lt(e,8),a=lt(e,10),c=lt(e,12),u=lt(e,14);this.r[0]=r&8191,this.r[1]=(r>>>13|n<<3)&8191,this.r[2]=(n>>>10|i<<6)&7939,this.r[3]=(i>>>7|s<<9)&8191,this.r[4]=(s>>>4|o<<12)&255,this.r[5]=o>>>1&8190,this.r[6]=(o>>>14|a<<2)&8191,this.r[7]=(a>>>11|c<<5)&8065,this.r[8]=(c>>>8|u<<8)&8191,this.r[9]=u>>>5&127;for(let d=0;d<8;d++)this.pad[d]=lt(e,16+2*d)}process(e,r,n=!1){const i=n?0:2048,{h:s,r:o}=this,a=o[0],c=o[1],u=o[2],d=o[3],p=o[4],y=o[5],_=o[6],w=o[7],D=o[8],O=o[9],M=lt(e,r+0),T=lt(e,r+2),B=lt(e,r+4),P=lt(e,r+6),j=lt(e,r+8),$=lt(e,r+10),L=lt(e,r+12),z=lt(e,r+14);let N=s[0]+(M&8191),K=s[1]+((M>>>13|T<<3)&8191),S=s[2]+((T>>>10|B<<6)&8191),f=s[3]+((B>>>7|P<<9)&8191),l=s[4]+((P>>>4|j<<12)&8191),g=s[5]+(j>>>1&8191),b=s[6]+((j>>>14|$<<2)&8191),v=s[7]+(($>>>11|L<<5)&8191),x=s[8]+((L>>>8|z<<8)&8191),I=s[9]+(z>>>5|i),m=0,h=m+N*a+K*(5*O)+S*(5*D)+f*(5*w)+l*(5*_);m=h>>>13,h&=8191,h+=g*(5*y)+b*(5*p)+v*(5*d)+x*(5*u)+I*(5*c),m+=h>>>13,h&=8191;let E=m+N*c+K*a+S*(5*O)+f*(5*D)+l*(5*w);m=E>>>13,E&=8191,E+=g*(5*_)+b*(5*y)+v*(5*p)+x*(5*d)+I*(5*u),m+=E>>>13,E&=8191;let C=m+N*u+K*c+S*a+f*(5*O)+l*(5*D);m=C>>>13,C&=8191,C+=g*(5*w)+b*(5*_)+v*(5*y)+x*(5*p)+I*(5*d),m+=C>>>13,C&=8191;let F=m+N*d+K*u+S*c+f*a+l*(5*O);m=F>>>13,F&=8191,F+=g*(5*D)+b*(5*w)+v*(5*_)+x*(5*y)+I*(5*p),m+=F>>>13,F&=8191;let k=m+N*p+K*d+S*u+f*c+l*a;m=k>>>13,k&=8191,k+=g*(5*O)+b*(5*D)+v*(5*w)+x*(5*_)+I*(5*y),m+=k>>>13,k&=8191;let q=m+N*y+K*p+S*d+f*u+l*c;m=q>>>13,q&=8191,q+=g*a+b*(5*O)+v*(5*D)+x*(5*w)+I*(5*_),m+=q>>>13,q&=8191;let W=m+N*_+K*y+S*p+f*d+l*u;m=W>>>13,W&=8191,W+=g*c+b*a+v*(5*O)+x*(5*D)+I*(5*w),m+=W>>>13,W&=8191;let X=m+N*w+K*_+S*y+f*p+l*d;m=X>>>13,X&=8191,X+=g*u+b*c+v*a+x*(5*O)+I*(5*D),m+=X>>>13,X&=8191;let Z=m+N*D+K*w+S*_+f*y+l*p;m=Z>>>13,Z&=8191,Z+=g*d+b*u+v*c+x*a+I*(5*O),m+=Z>>>13,Z&=8191;let Y=m+N*O+K*D+S*w+f*_+l*y;m=Y>>>13,Y&=8191,Y+=g*p+b*d+v*u+x*c+I*a,m+=Y>>>13,Y&=8191,m=(m<<2)+m|0,m=m+h|0,h=m&8191,m=m>>>13,E+=m,s[0]=h,s[1]=E,s[2]=C,s[3]=F,s[4]=k,s[5]=q,s[6]=W,s[7]=X,s[8]=Z,s[9]=Y}finalize(){const{h:e,pad:r}=this,n=new Uint16Array(10);let i=e[1]>>>13;e[1]&=8191;for(let a=2;a<10;a++)e[a]+=i,i=e[a]>>>13,e[a]&=8191;e[0]+=i*5,i=e[0]>>>13,e[0]&=8191,e[1]+=i,i=e[1]>>>13,e[1]&=8191,e[2]+=i,n[0]=e[0]+5,i=n[0]>>>13,n[0]&=8191;for(let a=1;a<10;a++)n[a]=e[a]+i,i=n[a]>>>13,n[a]&=8191;n[9]-=8192;let s=(i^1)-1;for(let a=0;a<10;a++)n[a]&=s;s=~s;for(let a=0;a<10;a++)e[a]=e[a]&s|n[a];e[0]=(e[0]|e[1]<<13)&65535,e[1]=(e[1]>>>3|e[2]<<10)&65535,e[2]=(e[2]>>>6|e[3]<<7)&65535,e[3]=(e[3]>>>9|e[4]<<4)&65535,e[4]=(e[4]>>>12|e[5]<<1|e[6]<<14)&65535,e[5]=(e[6]>>>2|e[7]<<11)&65535,e[6]=(e[7]>>>5|e[8]<<8)&65535,e[7]=(e[8]>>>8|e[9]<<5)&65535;let o=e[0]+r[0];e[0]=o&65535;for(let a=1;a<8;a++)o=(e[a]+r[a]|0)+(o>>>16)|0,e[a]=o&65535;ci(n)}update(e){El(this);const{buffer:r,blockLen:n}=this;e=vc(e);const i=e.length;for(let s=0;s<i;){const o=Math.min(n-this.pos,i-s);if(o===n){for(;n<=i-s;s+=n)this.process(e,s);continue}r.set(e.subarray(s,s+o),this.pos),this.pos+=o,s+=o,this.pos===n&&(this.process(r,0,!1),this.pos=0)}return this}destroy(){ci(this.h,this.r,this.buffer,this.pad)}digestInto(e){El(this),L4(e,this),this.finished=!0;const{buffer:r,h:n}=this;let{pos:i}=this;if(i){for(r[i++]=1;i<16;i++)r[i]=0;this.process(r,0,!0)}this.finalize();let s=0;for(let o=0;o<8;o++)e[s++]=n[o]>>>0,e[s++]=n[o]>>>8;return e}digest(){const{buffer:e,outputLen:r}=this;this.digestInto(e);const n=e.slice(0,r);return this.destroy(),n}}function Z4(t){const e=(n,i)=>t(i).update(vc(n)).digest(),r=t(new Uint8Array(32));return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=n=>t(n),e}const J4=Z4(t=>new X4(t));function Q4(t,e,r,n,i,s=20){let o=t[0],a=t[1],c=t[2],u=t[3],d=e[0],p=e[1],y=e[2],_=e[3],w=e[4],D=e[5],O=e[6],M=e[7],T=i,B=r[0],P=r[1],j=r[2],$=o,L=a,z=c,N=u,K=d,S=p,f=y,l=_,g=w,b=D,v=O,x=M,I=T,m=B,h=P,E=j;for(let F=0;F<s;F+=2)$=$+K|0,I=se(I^$,16),g=g+I|0,K=se(K^g,12),$=$+K|0,I=se(I^$,8),g=g+I|0,K=se(K^g,7),L=L+S|0,m=se(m^L,16),b=b+m|0,S=se(S^b,12),L=L+S|0,m=se(m^L,8),b=b+m|0,S=se(S^b,7),z=z+f|0,h=se(h^z,16),v=v+h|0,f=se(f^v,12),z=z+f|0,h=se(h^z,8),v=v+h|0,f=se(f^v,7),N=N+l|0,E=se(E^N,16),x=x+E|0,l=se(l^x,12),N=N+l|0,E=se(E^N,8),x=x+E|0,l=se(l^x,7),$=$+S|0,E=se(E^$,16),v=v+E|0,S=se(S^v,12),$=$+S|0,E=se(E^$,8),v=v+E|0,S=se(S^v,7),L=L+f|0,I=se(I^L,16),x=x+I|0,f=se(f^x,12),L=L+f|0,I=se(I^L,8),x=x+I|0,f=se(f^x,7),z=z+l|0,m=se(m^z,16),g=g+m|0,l=se(l^g,12),z=z+l|0,m=se(m^z,8),g=g+m|0,l=se(l^g,7),N=N+K|0,h=se(h^N,16),b=b+h|0,K=se(K^b,12),N=N+K|0,h=se(h^N,8),b=b+h|0,K=se(K^b,7);let C=0;n[C++]=o+$|0,n[C++]=a+L|0,n[C++]=c+z|0,n[C++]=u+N|0,n[C++]=d+K|0,n[C++]=p+S|0,n[C++]=y+f|0,n[C++]=_+l|0,n[C++]=w+g|0,n[C++]=D+b|0,n[C++]=O+v|0,n[C++]=M+x|0,n[C++]=T+I|0,n[C++]=B+m|0,n[C++]=P+h|0,n[C++]=j+E|0}const e5=Y4(Q4,{counterRight:!1,counterLength:4,allowShortKeys:!1}),t5=new Uint8Array(16),Ml=(t,e)=>{t.update(e);const r=e.length%16;r&&t.update(t5.subarray(r))},r5=new Uint8Array(32);function Tl(t,e,r,n,i){const s=t(e,r,r5),o=J4.create(s);i&&Ml(o,i),Ml(o,n);const a=new Uint8Array(16),c=$4(a);Il(c,0,BigInt(i?i.length:0),!0),Il(c,8,BigInt(n.length),!0),o.update(a);const u=o.digest();return ci(s,a),u}const n5=t=>(e,r,n)=>({encrypt(i,s){const o=i.length;s=Sl(o+16,s,!1),s.set(i);const a=s.subarray(0,-16);t(e,r,a,a,1);const c=Tl(t,e,r,a,n);return s.set(c,o),ci(c),s},decrypt(i,s){s=Sl(i.length-16,s,!1);const o=i.subarray(0,-16),a=i.subarray(-16),c=Tl(t,e,r,o,n);if(!U4(a,c))throw new Error("invalid tag");return s.set(i.subarray(0,-16)),t(e,r,s,s,1),ci(c),s}}),Rl=k4({blockSize:64,nonceLength:12,tagLength:16},n5(e5));class Bl extends pc{constructor(e,r){super(),this.finished=!1,this.destroyed=!1,dc(e);const n=ai(r);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const i=this.blockLen,s=new Uint8Array(i);s.set(n.length>i?e.create().update(n).digest():n);for(let o=0;o<s.length;o++)s[o]^=54;this.iHash.update(s),this.oHash=e.create();for(let o=0;o<s.length;o++)s[o]^=106;this.oHash.update(s),s.fill(0)}update(e){return si(this),this.iHash.update(e),this}digestInto(e){si(this),fo(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:r,iHash:n,finished:i,destroyed:s,blockLen:o,outputLen:a}=this;return e=e,e.finished=i,e.destroyed=s,e.blockLen=o,e.outputLen=a,e.oHash=r._cloneInto(e.oHash),e.iHash=n._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const wc=(t,e,r)=>new Bl(t,e).update(r).digest();wc.create=(t,e)=>new Bl(t,e);function i5(t,e,r){return dc(t),r===void 0&&(r=new Uint8Array(t.outputLen)),wc(t,ai(r),ai(e))}const _c=new Uint8Array([0]),Pl=new Uint8Array;function s5(t,e,r,n=32){if(dc(t),Fi(n),n>255*t.outputLen)throw new Error("Length should be <= 255*HashLen");const i=Math.ceil(n/t.outputLen);r===void 0&&(r=Pl);const s=new Uint8Array(i*t.outputLen),o=wc.create(t,e),a=o._cloneInto(),c=new Uint8Array(o.outputLen);for(let u=0;u<i;u++)_c[0]=u+1,a.update(u===0?Pl:c).update(r).update(_c).digestInto(c),s.set(c,t.outputLen*u),o._cloneInto(a);return o.destroy(),a.destroy(),c.fill(0),_c.fill(0),s.slice(0,n)}const o5=(t,e,r,n,i)=>s5(t,i5(t,e,r),n,i);function a5(t,e,r,n){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,r,n);const i=BigInt(32),s=BigInt(4294967295),o=Number(r>>i&s),a=Number(r&s),c=n?4:0,u=n?0:4;t.setUint32(e+c,o,n),t.setUint32(e+u,a,n)}function c5(t,e,r){return t&e^~t&r}function f5(t,e,r){return t&e^t&r^e&r}class u5 extends pc{constructor(e,r,n,i){super(),this.blockLen=e,this.outputLen=r,this.padOffset=n,this.isLE=i,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=lc(this.buffer)}update(e){si(this);const{view:r,buffer:n,blockLen:i}=this;e=ai(e);const s=e.length;for(let o=0;o<s;){const a=Math.min(i-this.pos,s-o);if(a===i){const c=lc(e);for(;i<=s-o;o+=i)this.process(c,o);continue}n.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===i&&(this.process(r,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){si(this),hl(e,this),this.finished=!0;const{buffer:r,view:n,blockLen:i,isLE:s}=this;let{pos:o}=this;r[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>i-o&&(this.process(n,0),o=0);for(let p=o;p<i;p++)r[p]=0;a5(n,i-8,BigInt(this.length*8),s),this.process(n,0);const a=lc(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const u=c/4,d=this.get();if(u>d.length)throw new Error("_sha2: outputLen bigger than state");for(let p=0;p<u;p++)a.setUint32(4*p,d[p],s)}digest(){const{buffer:e,outputLen:r}=this;this.digestInto(e);const n=e.slice(0,r);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:r,buffer:n,length:i,finished:s,destroyed:o,pos:a}=this;return e.length=i,e.pos=a,e.finished=s,e.destroyed=o,i%r&&e.buffer.set(n),e}}const h5=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Yr=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Xr=new Uint32Array(64);class d5 extends u5{constructor(){super(64,32,8,!1),this.A=Yr[0]|0,this.B=Yr[1]|0,this.C=Yr[2]|0,this.D=Yr[3]|0,this.E=Yr[4]|0,this.F=Yr[5]|0,this.G=Yr[6]|0,this.H=Yr[7]|0}get(){const{A:e,B:r,C:n,D:i,E:s,F:o,G:a,H:c}=this;return[e,r,n,i,s,o,a,c]}set(e,r,n,i,s,o,a,c){this.A=e|0,this.B=r|0,this.C=n|0,this.D=i|0,this.E=s|0,this.F=o|0,this.G=a|0,this.H=c|0}process(e,r){for(let p=0;p<16;p++,r+=4)Xr[p]=e.getUint32(r,!1);for(let p=16;p<64;p++){const y=Xr[p-15],_=Xr[p-2],w=wr(y,7)^wr(y,18)^y>>>3,D=wr(_,17)^wr(_,19)^_>>>10;Xr[p]=D+Xr[p-7]+w+Xr[p-16]|0}let{A:n,B:i,C:s,D:o,E:a,F:c,G:u,H:d}=this;for(let p=0;p<64;p++){const y=wr(a,6)^wr(a,11)^wr(a,25),_=d+y+c5(a,c,u)+h5[p]+Xr[p]|0,w=(wr(n,2)^wr(n,13)^wr(n,22))+f5(n,i,s)|0;d=u,u=c,c=a,a=o+_|0,o=s,s=i,i=n,n=_+w|0}n=n+this.A|0,i=i+this.B|0,s=s+this.C|0,o=o+this.D|0,a=a+this.E|0,c=c+this.F|0,u=u+this.G|0,d=d+this.H|0,this.set(n,i,s,o,a,c,u,d)}roundClean(){Xr.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}const lo=bl(()=>new d5);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Nl=BigInt(0);function Ec(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function Cl(t){if(!Ec(t))throw new Error("Uint8Array expected")}const l5=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function p5(t){Cl(t);let e="";for(let r=0;r<t.length;r++)e+=l5[t[r]];return e}function b5(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return t===""?Nl:BigInt("0x"+t)}const Nr={_0:48,_9:57,A:65,F:70,a:97,f:102};function Ll(t){if(t>=Nr._0&&t<=Nr._9)return t-Nr._0;if(t>=Nr.A&&t<=Nr.F)return t-(Nr.A-10);if(t>=Nr.a&&t<=Nr.f)return t-(Nr.a-10)}function $l(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);const e=t.length,r=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);const n=new Uint8Array(r);for(let i=0,s=0;i<r;i++,s+=2){const o=Ll(t.charCodeAt(s)),a=Ll(t.charCodeAt(s+1));if(o===void 0||a===void 0){const c=t[s]+t[s+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+s)}n[i]=o*16+a}return n}function Fl(t){return Cl(t),b5(p5(Uint8Array.from(t).reverse()))}function g5(t,e){return $l(t.toString(16).padStart(e*2,"0"))}function v5(t,e){return g5(t,e).reverse()}function zl(t,e,r){let n;if(typeof e=="string")try{n=$l(e)}catch(s){throw new Error(t+" must be hex string or Uint8Array, cause: "+s)}else if(Ec(e))n=Uint8Array.from(e);else throw new Error(t+" must be hex string or Uint8Array");const i=n.length;if(typeof r=="number"&&i!==r)throw new Error(t+" of length "+r+" expected, got "+i);return n}const xc=t=>typeof t=="bigint"&&Nl<=t;function y5(t,e,r){return xc(t)&&xc(e)&&xc(r)&&e<=t&&t<r}function Ul(t,e,r,n){if(!y5(e,r,n))throw new Error("expected valid "+t+": "+r+" <= n < "+n+", got "+e)}const m5={bigint:t=>typeof t=="bigint",function:t=>typeof t=="function",boolean:t=>typeof t=="boolean",string:t=>typeof t=="string",stringOrUint8Array:t=>typeof t=="string"||Ec(t),isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>typeof t=="function"&&Number.isSafeInteger(t.outputLen)};function w5(t,e,r={}){const n=(i,s,o)=>{const a=m5[s];if(typeof a!="function")throw new Error("invalid validator function");const c=t[i];if(!(o&&c===void 0)&&!a(c,t))throw new Error("param "+String(i)+" is invalid. Expected "+s+", got "+c)};for(const[i,s]of Object.entries(e))n(i,s,!1);for(const[i,s]of Object.entries(r))n(i,s,!0);return t}const fi=BigInt(0),po=BigInt(1);function kl(t,e){const r=t%e;return r>=fi?r:e+r}function _5(t,e,r){if(e<fi)throw new Error("invalid exponent, negatives unsupported");if(r<=fi)throw new Error("invalid modulus");if(r===po)return fi;let n=po;for(;e>fi;)e&po&&(n=n*t%r),t=t*t%r,e>>=po;return n}function nr(t,e,r){let n=t;for(;e-- >fi;)n*=n,n%=r;return n}BigInt(0),BigInt(1),BigInt(0),BigInt(1),BigInt(2),BigInt(8);const ui=BigInt(0),Sc=BigInt(1);function E5(t){return w5(t,{a:"bigint"},{montgomeryBits:"isSafeInteger",nByteLength:"isSafeInteger",adjustScalarBytes:"function",domain:"function",powPminus2:"function",Gu:"bigint"}),Object.freeze(n4({},t))}function x5(t){const e=E5(t),{P:r}=e,n=T=>kl(T,r),i=e.montgomeryBits,s=Math.ceil(i/8),o=e.nByteLength,a=e.adjustScalarBytes||(T=>T),c=e.powPminus2||(T=>_5(T,r-BigInt(2),r));function u(T,B,P){const j=n(T*(B-P));return B=n(B-j),P=n(P+j),[B,P]}const d=(e.a-BigInt(2))/BigInt(4);function p(T,B){Ul("u",T,ui,r),Ul("scalar",B,ui,r);const P=B,j=T;let $=Sc,L=ui,z=T,N=Sc,K=ui,S;for(let l=BigInt(i-1);l>=ui;l--){const g=P>>l&Sc;K^=g,S=u(K,$,z),$=S[0],z=S[1],S=u(K,L,N),L=S[0],N=S[1],K=g;const b=$+L,v=n(b*b),x=$-L,I=n(x*x),m=v-I,h=z+N,E=z-N,C=n(E*b),F=n(h*x),k=C+F,q=C-F;z=n(k*k),N=n(j*n(q*q)),$=n(v*I),L=n(m*(v+n(d*m)))}S=u(K,$,z),$=S[0],z=S[1],S=u(K,L,N),L=S[0],N=S[1];const f=c(L);return n($*f)}function y(T){return v5(n(T),s)}function _(T){const B=zl("u coordinate",T,s);return o===32&&(B[31]&=127),Fl(B)}function w(T){const B=zl("scalar",T),P=B.length;if(P!==s&&P!==o){let j=""+s+" or "+o;throw new Error("invalid scalar, expected "+j+" bytes, got "+P)}return Fl(a(B))}function D(T,B){const P=_(B),j=w(T),$=p(P,j);if($===ui)throw new Error("invalid private or public key received");return y($)}const O=y(e.Gu);function M(T){return D(T,O)}return{scalarMult:D,scalarMultBase:M,getSharedSecret:(T,B)=>D(T,B),getPublicKey:T=>M(T),utils:{randomPrivateKey:()=>e.randomBytes(e.nByteLength)},GuBytes:O}}const Ic=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949");BigInt(0);const S5=BigInt(1),jl=BigInt(2),I5=BigInt(3),A5=BigInt(5);BigInt(8);function D5(t){const e=BigInt(10),r=BigInt(20),n=BigInt(40),i=BigInt(80),s=Ic,o=t*t%s*t%s,a=nr(o,jl,s)*o%s,c=nr(a,S5,s)*t%s,u=nr(c,A5,s)*c%s,d=nr(u,e,s)*u%s,p=nr(d,r,s)*d%s,y=nr(p,n,s)*p%s,_=nr(y,i,s)*y%s,w=nr(_,i,s)*y%s,D=nr(w,e,s)*u%s;return{pow_p_5_8:nr(D,jl,s)*t%s,b2:o}}function O5(t){return t[0]&=248,t[31]&=127,t[31]|=64,t}const Ac=x5({P:Ic,a:BigInt(486662),montgomeryBits:255,nByteLength:32,Gu:BigInt(9),powPminus2:t=>{const e=Ic,{pow_p_5_8:r,b2:n}=D5(t);return kl(nr(r,I5,e)*n,e)},adjustScalarBytes:O5,randomBytes:zi}),ql="base10",yt="base16",bo="base64pad",ki="utf8",Hl=0,hi=1,go=2,M5=0,Kl=1,ji=12,Dc=32;function T5(){const t=Ac.utils.randomPrivateKey(),e=Ac.getPublicKey(t);return{privateKey:xt(t,yt),publicKey:xt(e,yt)}}function Oc(){const t=zi(Dc);return xt(t,yt)}function R5(t,e){const r=Ac.getSharedSecret(Ct(t,yt),Ct(e,yt)),n=o5(lo,r,void 0,void 0,Dc);return xt(n,yt)}function B5(t){const e=lo(Ct(t,yt));return xt(e,yt)}function Mc(t){const e=lo(Ct(t,ki));return xt(e,yt)}function Vl(t){return Ct(`${t}`,ql)}function _n(t){return Number(xt(t,ql))}function P5(t){const e=Vl(typeof t.type<"u"?t.type:Hl);if(_n(e)===hi&&typeof t.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const r=typeof t.senderPublicKey<"u"?Ct(t.senderPublicKey,yt):void 0,n=typeof t.iv<"u"?Ct(t.iv,yt):zi(ji),i=Ct(t.symKey,yt),s=Rl(i,n).encrypt(Ct(t.message,ki));return Wl({type:e,sealed:s,iv:n,senderPublicKey:r,encoding:t.encoding})}function N5(t){const e=Ct(t.symKey,yt),{sealed:r,iv:n}=qi(t),i=Rl(e,n).decrypt(r);if(i===null)throw new Error("Failed to decrypt");return xt(i,ki)}function C5(t,e){const r=Vl(go),n=zi(ji),i=Ct(t,ki);return Wl({type:r,sealed:i,iv:n,encoding:e})}function L5(t,e){const{sealed:r}=qi({encoded:t,encoding:e});return xt(r,ki)}function Wl(t){const{encoding:e=bo}=t;if(_n(t.type)===go)return xt(Ga([t.type,t.sealed]),e);if(_n(t.type)===hi){if(typeof t.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return xt(Ga([t.type,t.senderPublicKey,t.iv,t.sealed]),e)}return xt(Ga([t.type,t.iv,t.sealed]),e)}function qi(t){const{encoded:e,encoding:r=bo}=t,n=Ct(e,r),i=n.slice(M5,Kl),s=Kl;if(_n(i)===hi){const u=s+Dc,d=u+ji,p=n.slice(s,u),y=n.slice(u,d),_=n.slice(d);return{type:i,sealed:_,iv:y,senderPublicKey:p}}if(_n(i)===go){const u=n.slice(s),d=zi(ji);return{type:i,sealed:u,iv:d}}const o=s+ji,a=n.slice(s,o),c=n.slice(o);return{type:i,sealed:c,iv:a}}function $5(t,e){const r=qi({encoded:t,encoding:e?.encoding});return Gl({type:_n(r.type),senderPublicKey:typeof r.senderPublicKey<"u"?xt(r.senderPublicKey,yt):void 0,receiverPublicKey:e?.receiverPublicKey})}function Gl(t){const e=t?.type||Hl;if(e===hi){if(typeof t?.senderPublicKey>"u")throw new Error("missing sender public key");if(typeof t?.receiverPublicKey>"u")throw new Error("missing receiver public key")}return{type:e,senderPublicKey:t?.senderPublicKey,receiverPublicKey:t?.receiverPublicKey}}function Yl(t){return t.type===hi&&typeof t.senderPublicKey=="string"&&typeof t.receiverPublicKey=="string"}function Xl(t){return t.type===go}function F5(t){return new vd.ec("p256").keyFromPublic({x:Buffer.from(t.x,"base64").toString("hex"),y:Buffer.from(t.y,"base64").toString("hex")},"hex")}function z5(t){let e=t.replace(/-/g,"+").replace(/_/g,"/");const r=e.length%4;return r>0&&(e+="=".repeat(4-r)),e}function U5(t){return Buffer.from(z5(t),"base64")}function k5(t,e){const[r,n,i]=t.split("."),s=U5(i);if(s.length!==64)throw new Error("Invalid signature length");const o=s.slice(0,32).toString("hex"),a=s.slice(32,64).toString("hex"),c=`${r}.${n}`,u=lo(c),d=F5(e),p=xt(u,yt);if(!d.verify(p,{r:o,s:a}))throw new Error("Invalid signature");return ma(t).payload}const j5="irn";function vo(t){return t?.relay||{protocol:j5}}function Hi(t){const e=Q6[t];if(typeof e>"u")throw new Error(`Relay Protocol not supported: ${t}`);return e}function q5(t,e="-"){const r={},n="relay"+e;return Object.keys(t).forEach(i=>{if(i.startsWith(n)){const s=i.replace(n,""),o=t[i];r[s]=o}}),r}function Zl(t){if(!t.includes("wc:")){const u=ul(t);u!=null&&u.includes("wc:")&&(t=u)}t=t.includes("wc://")?t.replace("wc://",""):t,t=t.includes("wc:")?t.replace("wc:",""):t;const e=t.indexOf(":"),r=t.indexOf("?")!==-1?t.indexOf("?"):void 0,n=t.substring(0,e),i=t.substring(e+1,r).split("@"),s=typeof r<"u"?t.substring(r):"",o=new URLSearchParams(s),a={};o.forEach((u,d)=>{a[d]=u});const c=typeof a.methods=="string"?a.methods.split(","):void 0;return{protocol:n,topic:H5(i[0]),version:parseInt(i[1],10),symKey:a.symKey,relay:q5(a),methods:c,expiryTimestamp:a.expiryTimestamp?parseInt(a.expiryTimestamp,10):void 0}}function H5(t){return t.startsWith("//")?t.substring(2):t}function K5(t,e="-"){const r="relay",n={};return Object.keys(t).forEach(i=>{const s=i,o=r+e+s;t[s]&&(n[o]=t[s])}),n}function Jl(t){const e=new URLSearchParams,r=K5(t.relay);Object.keys(r).sort().forEach(i=>{e.set(i,r[i])}),e.set("symKey",t.symKey),t.expiryTimestamp&&e.set("expiryTimestamp",t.expiryTimestamp.toString()),t.methods&&e.set("methods",t.methods.join(","));const n=e.toString();return`${t.protocol}:${t.topic}@${t.version}?${n}`}const V5={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},W5={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function ce(t,e){const{message:r,code:n}=W5[t];return{message:e?`${r} ${e}`:r,code:n}}function Ki(t,e){const{message:r,code:n}=V5[t];return{message:e?`${r} ${e}`:r,code:n}}function yo(t){return typeof t>"u"}function Ql(t,e){return e&&yo(t)?!0:typeof t=="string"&&!!t.trim().length}function G5(t){function e(r){try{return typeof new URL(r)<"u"}catch{return!1}}try{if(Ql(t,!1)){if(e(t))return!0;const r=ul(t);return e(r)}}catch{}return!1}function Y5(t){var e;return(e=t?.proposer)==null?void 0:e.publicKey}function X5(t){return t?.topic}function Tc(t){return typeof t<"u"&&typeof t!==null}function e0(){const t=co();return new Promise(e=>{switch(t){case rr.browser:e(Z5());break;case rr.reactNative:e(J5());break;case rr.node:e(Q5());break;default:e(!0)}})}function Z5(){return ao()&&navigator?.onLine}async function J5(){if(wn()&&typeof global<"u"&&global!=null&&global.NetInfo){const t=await(global==null?void 0:global.NetInfo.fetch());return t?.isConnected}return!0}function Q5(){return!0}function ew(t){switch(co()){case rr.browser:tw(t);break;case rr.reactNative:rw(t);break}}function tw(t){!wn()&&ao()&&(window.addEventListener("online",()=>t(!0)),window.addEventListener("offline",()=>t(!1)))}function rw(t){wn()&&typeof global<"u"&&global!=null&&global.NetInfo&&global?.NetInfo.addEventListener(e=>t(e?.isConnected))}var nw=Object.defineProperty,iw=(t,e,r)=>e in t?nw(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,_r=(t,e,r)=>iw(t,typeof e!="symbol"?e+"":e,r);class t0{constructor(e,r){this.core=e,this.logger=r,_r(this,"keychain",new Map),_r(this,"name",Cf),_r(this,"version",Lf),_r(this,"initialized",!1),_r(this,"storagePrefix",Xt),_r(this,"init",async()=>{if(!this.initialized){const n=await this.getKeyChain();typeof n<"u"&&(this.keychain=n),this.initialized=!0}}),_r(this,"has",n=>(this.isInitialized(),this.keychain.has(n))),_r(this,"set",async(n,i)=>{this.isInitialized(),this.keychain.set(n,i),await this.persist()}),_r(this,"get",n=>{this.isInitialized();const i=this.keychain.get(n);if(typeof i>"u"){const{message:s}=ce("NO_MATCHING_KEY",`${this.name}: ${n}`);throw new Error(s)}return i}),_r(this,"del",async n=>{this.isInitialized(),this.keychain.delete(n),await this.persist()}),this.core=e,this.logger=At(r,this.name)}get context(){return Pt(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(e){await this.core.storage.setItem(this.storageKey,il(e))}async getKeyChain(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?sl(e):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:e}=ce("NOT_INITIALIZED",this.name);throw new Error(e)}}}var sw=Object.defineProperty,ow=(t,e,r)=>e in t?sw(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,pt=(t,e,r)=>ow(t,typeof e!="symbol"?e+"":e,r);class r0{constructor(e,r,n){this.core=e,this.logger=r,pt(this,"name",Pf),pt(this,"keychain"),pt(this,"randomSessionIdentifier",Oc()),pt(this,"initialized",!1),pt(this,"init",async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)}),pt(this,"hasKeys",i=>(this.isInitialized(),this.keychain.has(i))),pt(this,"getClientId",async()=>{this.isInitialized();const i=await this.getClientSeed(),s=sh(i);return ih(s.publicKey)}),pt(this,"generateKeyPair",()=>{this.isInitialized();const i=T5();return this.setPrivateKey(i.publicKey,i.privateKey)}),pt(this,"signJWT",async i=>{this.isInitialized();const s=await this.getClientSeed(),o=sh(s),a=this.randomSessionIdentifier;return await Q2(a,i,Nf,o)}),pt(this,"generateSharedKey",(i,s,o)=>{this.isInitialized();const a=this.getPrivateKey(i),c=R5(a,s);return this.setSymKey(c,o)}),pt(this,"setSymKey",async(i,s)=>{this.isInitialized();const o=s||B5(i);return await this.keychain.set(o,i),o}),pt(this,"deleteKeyPair",async i=>{this.isInitialized(),await this.keychain.del(i)}),pt(this,"deleteSymKey",async i=>{this.isInitialized(),await this.keychain.del(i)}),pt(this,"encode",async(i,s,o)=>{this.isInitialized();const a=Gl(o),c=on(s);if(Xl(a))return C5(c,o?.encoding);if(Yl(a)){const y=a.senderPublicKey,_=a.receiverPublicKey;i=await this.generateSharedKey(y,_)}const u=this.getSymKey(i),{type:d,senderPublicKey:p}=a;return P5({type:d,symKey:u,message:c,senderPublicKey:p,encoding:o?.encoding})}),pt(this,"decode",async(i,s,o)=>{this.isInitialized();const a=$5(s,o);if(Xl(a)){const c=L5(s,o?.encoding);return Bn(c)}if(Yl(a)){const c=a.receiverPublicKey,u=a.senderPublicKey;i=await this.generateSharedKey(c,u)}try{const c=this.getSymKey(i),u=N5({symKey:c,encoded:s,encoding:o?.encoding});return Bn(u)}catch(c){this.logger.error(`Failed to decode message from topic: '${i}', clientId: '${await this.getClientId()}'`),this.logger.error(c)}}),pt(this,"getPayloadType",(i,s=bo)=>{const o=qi({encoded:i,encoding:s});return _n(o.type)}),pt(this,"getPayloadSenderPublicKey",(i,s=bo)=>{const o=qi({encoded:i,encoding:s});return o.senderPublicKey?xt(o.senderPublicKey,yt):void 0}),this.core=e,this.logger=At(r,this.name),this.keychain=n||new t0(this.core,this.logger)}get context(){return Pt(this.logger)}async setPrivateKey(e,r){return await this.keychain.set(e,r),e}getPrivateKey(e){return this.keychain.get(e)}async getClientSeed(){let e="";try{e=this.keychain.get(Yo)}catch{e=Oc(),await this.keychain.set(Yo,e)}return Ct(e,"base16")}getSymKey(e){return this.keychain.get(e)}isInitialized(){if(!this.initialized){const{message:e}=ce("NOT_INITIALIZED",this.name);throw new Error(e)}}}var aw=Object.defineProperty,cw=(t,e,r)=>e in t?aw(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Er=(t,e,r)=>cw(t,typeof e!="symbol"?e+"":e,r);class n0 extends Kp{constructor(e,r){super(e,r),this.logger=e,this.core=r,Er(this,"messages",new Map),Er(this,"name",$f),Er(this,"version",Ff),Er(this,"initialized",!1),Er(this,"storagePrefix",Xt),Er(this,"init",async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const n=await this.getRelayerMessages();typeof n<"u"&&(this.messages=n),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(n){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(n)}finally{this.initialized=!0}}}),Er(this,"set",async(n,i)=>{this.isInitialized();const s=Mc(i);let o=this.messages.get(n);return typeof o>"u"&&(o={}),typeof o[s]<"u"||(o[s]=i,this.messages.set(n,o),await this.persist()),s}),Er(this,"get",n=>{this.isInitialized();let i=this.messages.get(n);return typeof i>"u"&&(i={}),i}),Er(this,"has",(n,i)=>{this.isInitialized();const s=this.get(n),o=Mc(i);return typeof s[o]<"u"}),Er(this,"del",async n=>{this.isInitialized(),this.messages.delete(n),await this.persist()}),this.logger=At(e,this.name),this.core=r}get context(){return Pt(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setRelayerMessages(e){await this.core.storage.setItem(this.storageKey,il(e))}async getRelayerMessages(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?sl(e):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:e}=ce("NOT_INITIALIZED",this.name);throw new Error(e)}}}const fw="PARSE_ERROR",uw="INVALID_REQUEST",hw="METHOD_NOT_FOUND",dw="INVALID_PARAMS",i0="INTERNAL_ERROR",Rc="SERVER_ERROR",lw=[-32700,-32600,-32601,-32602,-32603],Vi={[fw]:{code:-32700,message:"Parse error"},[uw]:{code:-32600,message:"Invalid Request"},[hw]:{code:-32601,message:"Method not found"},[dw]:{code:-32602,message:"Invalid params"},[i0]:{code:-32603,message:"Internal error"},[Rc]:{code:-32e3,message:"Server error"}},s0=Rc;function pw(t){return lw.includes(t)}function o0(t){return Object.keys(Vi).includes(t)?Vi[t]:Vi[s0]}function bw(t){const e=Object.values(Vi).find(r=>r.code===t);return e||Vi[s0]}function gw(t,e,r){return t.message.includes("getaddrinfo ENOTFOUND")||t.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${r} RPC url at ${e}`):t}var a0={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var Bc=function(t,e){return Bc=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},Bc(t,e)};function vw(t,e){Bc(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var Pc=function(){return Pc=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Pc.apply(this,arguments)};function yw(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}function mw(t,e,r,n){var i=arguments.length,s=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,r):n,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,r,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,r,s):o(e,r))||s);return i>3&&s&&Object.defineProperty(e,r,s),s}function ww(t,e){return function(r,n){e(r,n,t)}}function _w(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function Ew(t,e,r,n){function i(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function a(d){try{u(n.next(d))}catch(p){o(p)}}function c(d){try{u(n.throw(d))}catch(p){o(p)}}function u(d){d.done?s(d.value):i(d.value).then(a,c)}u((n=n.apply(t,e||[])).next())})}function xw(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(u){return function(d){return c([u,d])}}function c(u){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(s=u[0]&2?i.return:u[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,u[1])).done)return s;switch(i=0,s&&(u=[u[0]&2,s.value]),u[0]){case 0:case 1:s=u;break;case 4:return r.label++,{value:u[1],done:!1};case 5:r.label++,i=u[1],u=[0];continue;case 7:u=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(u[0]===6||u[0]===2)){r=0;continue}if(u[0]===3&&(!s||u[1]>s[0]&&u[1]<s[3])){r.label=u[1];break}if(u[0]===6&&r.label<s[1]){r.label=s[1],s=u;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(u);break}s[2]&&r.ops.pop(),r.trys.pop();continue}u=e.call(t,r)}catch(d){u=[6,d],i=0}finally{n=s=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}function Sw(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}function Iw(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function Nc(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function c0(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),i,s=[],o;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(a){o={error:a}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return s}function Aw(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(c0(arguments[e]));return t}function Dw(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var n=Array(t),i=0,e=0;e<r;e++)for(var s=arguments[e],o=0,a=s.length;o<a;o++,i++)n[i]=s[o];return n}function Wi(t){return this instanceof Wi?(this.v=t,this):new Wi(t)}function Ow(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(t,e||[]),i,s=[];return i={},o("next"),o("throw"),o("return"),i[Symbol.asyncIterator]=function(){return this},i;function o(y){n[y]&&(i[y]=function(_){return new Promise(function(w,D){s.push([y,_,w,D])>1||a(y,_)})})}function a(y,_){try{c(n[y](_))}catch(w){p(s[0][3],w)}}function c(y){y.value instanceof Wi?Promise.resolve(y.value.v).then(u,d):p(s[0][2],y)}function u(y){a("next",y)}function d(y){a("throw",y)}function p(y,_){y(_),s.shift(),s.length&&a(s[0][0],s[0][1])}}function Mw(t){var e,r;return e={},n("next"),n("throw",function(i){throw i}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(i,s){e[i]=t[i]?function(o){return(r=!r)?{value:Wi(t[i](o)),done:i==="return"}:s?s(o):o}:s}}function Tw(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof Nc=="function"?Nc(t):t[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(s){r[s]=t[s]&&function(o){return new Promise(function(a,c){o=t[s](o),i(a,c,o.done,o.value)})}}function i(s,o,a,c){Promise.resolve(c).then(function(u){s({value:u,done:a})},o)}}function Rw(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function Bw(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function Pw(t){return t&&t.__esModule?t:{default:t}}function Nw(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function Cw(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}var Lw=Object.freeze({__proto__:null,__extends:vw,get __assign(){return Pc},__rest:yw,__decorate:mw,__param:ww,__metadata:_w,__awaiter:Ew,__generator:xw,__createBinding:Sw,__exportStar:Iw,__values:Nc,__read:c0,__spread:Aw,__spreadArrays:Dw,__await:Wi,__asyncGenerator:Ow,__asyncDelegator:Mw,__asyncValues:Tw,__makeTemplateObject:Rw,__importStar:Bw,__importDefault:Pw,__classPrivateFieldGet:Nw,__classPrivateFieldSet:Cw}),$w=Bo(Lw),Cr={},f0;function Fw(){if(f0)return Cr;f0=1,Object.defineProperty(Cr,"__esModule",{value:!0}),Cr.isBrowserCryptoAvailable=Cr.getSubtleCrypto=Cr.getBrowerCrypto=void 0;function t(){return _t?.crypto||_t?.msCrypto||{}}Cr.getBrowerCrypto=t;function e(){const n=t();return n.subtle||n.webkitSubtle}Cr.getSubtleCrypto=e;function r(){return!!t()&&!!e()}return Cr.isBrowserCryptoAvailable=r,Cr}var Lr={},u0;function zw(){if(u0)return Lr;u0=1,Object.defineProperty(Lr,"__esModule",{value:!0}),Lr.isBrowser=Lr.isNode=Lr.isReactNative=void 0;function t(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}Lr.isReactNative=t;function e(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}Lr.isNode=e;function r(){return!t()&&!e()}return Lr.isBrowser=r,Lr}(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=$w;e.__exportStar(Fw(),t),e.__exportStar(zw(),t)})(a0);function h0(t=3){const e=Date.now()*Math.pow(10,t),r=Math.floor(Math.random()*Math.pow(10,t));return e+r}function Cc(t=6){return BigInt(h0(t))}function Lc(t,e,r){return{id:r||h0(),jsonrpc:"2.0",method:t,params:e}}function d0(t,e){return{id:t,jsonrpc:"2.0",result:e}}function l0(t,e,r){return{id:t,jsonrpc:"2.0",error:Uw(e,r)}}function Uw(t,e){return typeof t>"u"?o0(i0):(typeof t=="string"&&(t=Object.assign(Object.assign({},o0(Rc)),{message:t})),typeof e<"u"&&(t.data=e),pw(t.code)&&(t=bw(t.code)),t)}class kw{}class jw extends kw{constructor(){super()}}class qw extends jw{constructor(e){super()}}const Hw="^wss?:";function Kw(t){const e=t.match(new RegExp(/^\w+:/,"gi"));if(!(!e||!e.length))return e[0]}function Vw(t,e){const r=Kw(t);return typeof r>"u"?!1:new RegExp(e).test(r)}function p0(t){return Vw(t,Hw)}function Ww(t){return new RegExp("wss?://localhost(:d{2,5})?").test(t)}function b0(t){return typeof t=="object"&&"id"in t&&"jsonrpc"in t&&t.jsonrpc==="2.0"}function g0(t){return b0(t)&&"method"in t}function $c(t){return b0(t)&&(v0(t)||mo(t))}function v0(t){return"result"in t}function mo(t){return"error"in t}class Gw extends qw{constructor(e){super(e),this.events=new Ut.exports.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(e),this.connection.connected&&this.registerEventListeners()}async connect(e=this.connection){await this.open(e)}async disconnect(){await this.close()}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async request(e,r){return this.requestStrict(Lc(e.method,e.params||[],e.id||Cc().toString()),r)}async requestStrict(e,r){return new Promise(async(n,i)=>{if(!this.connection.connected)try{await this.open()}catch(s){i(s)}this.events.on(`${e.id}`,s=>{mo(s)?i(s.error):n(s.result)});try{await this.connection.send(e,r)}catch(s){i(s)}})}setConnection(e=this.connection){return e}onPayload(e){this.events.emit("payload",e),$c(e)?this.events.emit(`${e.id}`,e):this.events.emit("message",{type:e.method,data:e.params})}onClose(e){e&&e.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${e.code} ${e.reason?`(${e.reason})`:""}`)),this.events.emit("disconnect")}async open(e=this.connection){this.connection===e&&this.connection.connected||(this.connection.connected&&this.close(),typeof e=="string"&&(await this.connection.open(e),e=this.connection),this.connection=this.setConnection(e),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",e=>this.onPayload(e)),this.connection.on("close",e=>this.onClose(e)),this.connection.on("error",e=>this.events.emit("error",e)),this.connection.on("register_error",e=>this.onClose()),this.hasRegisteredEventListeners=!0)}}const Yw=()=>typeof WebSocket<"u"?WebSocket:typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:require("ws"),Xw=()=>typeof WebSocket<"u"||typeof global<"u"&&typeof global.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u",y0=t=>t.split("?")[0],m0=10,Zw=Yw();class Jw{constructor(e){if(this.url=e,this.events=new Ut.exports.EventEmitter,this.registering=!1,!p0(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);this.url=e}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async open(e=this.url){await this.register(e)}async close(){return new Promise((e,r)=>{if(typeof this.socket>"u"){r(new Error("Connection already closed"));return}this.socket.onclose=n=>{this.onClose(n),e()},this.socket.close()})}async send(e){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(on(e))}catch(r){this.onError(e.id,r)}}register(e=this.url){if(!p0(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((n,i)=>{this.events.once("register_error",s=>{this.resetMaxListeners(),i(s)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return i(new Error("WebSocket connection is missing or invalid"));n(this.socket)})})}return this.url=e,this.registering=!0,new Promise((r,n)=>{const i=a0.isReactNative()?void 0:{rejectUnauthorized:!Ww(e)},s=new Zw(e,[],i);Xw()?s.onerror=o=>{const a=o;n(this.emitError(a.error))}:s.on("error",o=>{n(this.emitError(o))}),s.onopen=()=>{this.onOpen(s),r(s)}})}onOpen(e){e.onmessage=r=>this.onPayload(r),e.onclose=r=>this.onClose(r),this.socket=e,this.registering=!1,this.events.emit("open")}onClose(e){this.socket=void 0,this.registering=!1,this.events.emit("close",e)}onPayload(e){if(typeof e.data>"u")return;const r=typeof e.data=="string"?Bn(e.data):e.data;this.events.emit("payload",r)}onError(e,r){const n=this.parseError(r),i=n.message||n.toString(),s=l0(e,i);this.events.emit("payload",s)}parseError(e,r=this.url){return gw(e,y0(r),"WS")}resetMaxListeners(){this.events.getMaxListeners()>m0&&this.events.setMaxListeners(m0)}emitError(e){const r=this.parseError(new Error(e?.message||`WebSocket connection failed for host: ${y0(this.url)}`));return this.events.emit("register_error",r),r}}var Qw=Object.defineProperty,e9=Object.defineProperties,t9=Object.getOwnPropertyDescriptors,w0=Object.getOwnPropertySymbols,r9=Object.prototype.hasOwnProperty,n9=Object.prototype.propertyIsEnumerable,Fc=(t,e,r)=>e in t?Qw(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,wo=(t,e)=>{for(var r in e||(e={}))r9.call(e,r)&&Fc(t,r,e[r]);if(w0)for(var r of w0(e))n9.call(e,r)&&Fc(t,r,e[r]);return t},zc=(t,e)=>e9(t,t9(e)),ir=(t,e,r)=>Fc(t,typeof e!="symbol"?e+"":e,r);class i9 extends Vp{constructor(e,r){super(e,r),this.relayer=e,this.logger=r,ir(this,"events",new Ut.exports.EventEmitter),ir(this,"name",zf),ir(this,"queue",new Map),ir(this,"publishTimeout",G.toMiliseconds(G.ONE_MINUTE)),ir(this,"initialPublishTimeout",G.toMiliseconds(G.ONE_SECOND*15)),ir(this,"needsTransportRestart",!1),ir(this,"publish",async(n,i,s)=>{var o;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:n,message:i,opts:s}});const a=s?.ttl||Xo,c=vo(s),u=s?.prompt||!1,d=s?.tag||0,p=s?.id||Cc().toString(),y={topic:n,message:i,opts:{ttl:a,relay:c,prompt:u,tag:d,id:p,attestation:s?.attestation,tvf:s?.tvf}},_=`Failed to publish payload, please try again. id:${p} tag:${d}`;try{const w=new Promise(async D=>{const O=({id:T})=>{y.opts.id===T&&(this.removeRequestFromQueue(T),this.relayer.events.removeListener(ft.publish,O),D(y))};this.relayer.events.on(ft.publish,O);const M=Wr(new Promise((T,B)=>{this.rpcPublish({topic:n,message:i,ttl:a,prompt:u,tag:d,id:p,attestation:s?.attestation,tvf:s?.tvf}).then(T).catch(P=>{this.logger.warn(P,P?.message),B(P)})}),this.initialPublishTimeout,`Failed initial publish, retrying.... id:${p} tag:${d}`);try{await M,this.events.removeListener(ft.publish,O)}catch(T){this.queue.set(p,zc(wo({},y),{attempt:1})),this.logger.warn(T,T?.message)}});this.logger.trace({type:"method",method:"publish",params:{id:p,topic:n,message:i,opts:s}}),await Wr(w,this.publishTimeout,_)}catch(w){if(this.logger.debug("Failed to Publish Payload"),this.logger.error(w),(o=s?.internal)!=null&&o.throwOnFailedPublish)throw w}finally{this.queue.delete(p)}}),ir(this,"on",(n,i)=>{this.events.on(n,i)}),ir(this,"once",(n,i)=>{this.events.once(n,i)}),ir(this,"off",(n,i)=>{this.events.off(n,i)}),ir(this,"removeListener",(n,i)=>{this.events.removeListener(n,i)}),this.relayer=e,this.logger=At(r,this.name),this.registerEventListeners()}get context(){return Pt(this.logger)}async rpcPublish(e){var r,n,i,s;const{topic:o,message:a,ttl:c=Xo,prompt:u,tag:d,id:p,attestation:y,tvf:_}=e,w={method:Hi(vo().protocol).publish,params:wo({topic:o,message:a,ttl:c,prompt:u,tag:d,attestation:y},_),id:p};yo((r=w.params)==null?void 0:r.prompt)&&((n=w.params)==null||delete n.prompt),yo((i=w.params)==null?void 0:i.tag)&&((s=w.params)==null||delete s.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:w});const D=await this.relayer.request(w);return this.relayer.events.emit(ft.publish,e),this.logger.debug("Successfully Published Payload"),D}removeRequestFromQueue(e){this.queue.delete(e)}checkQueue(){this.queue.forEach(async(e,r)=>{const n=e.attempt+1;this.queue.set(r,zc(wo({},e),{attempt:n}));const{topic:i,message:s,opts:o,attestation:a}=e;this.logger.warn({},`Publisher: queue->publishing: ${e.opts.id}, tag: ${e.opts.tag}, attempt: ${n}`),await this.rpcPublish(zc(wo({},e),{topic:i,message:s,ttl:o.ttl,prompt:o.prompt,tag:o.tag,id:o.id,attestation:a,tvf:o.tvf})),this.logger.warn({},`Publisher: queue->published: ${e.opts.id}`)})}registerEventListeners(){this.relayer.core.heartbeat.on(Rn.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(ft.connection_stalled);return}this.checkQueue()}),this.relayer.on(ft.message_ack,e=>{this.removeRequestFromQueue(e.id.toString())})}}var s9=Object.defineProperty,o9=(t,e,r)=>e in t?s9(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,di=(t,e,r)=>o9(t,typeof e!="symbol"?e+"":e,r);class a9{constructor(){di(this,"map",new Map),di(this,"set",(e,r)=>{const n=this.get(e);this.exists(e,r)||this.map.set(e,[...n,r])}),di(this,"get",e=>this.map.get(e)||[]),di(this,"exists",(e,r)=>this.get(e).includes(r)),di(this,"delete",(e,r)=>{if(typeof r>"u"){this.map.delete(e);return}if(!this.map.has(e))return;const n=this.get(e);if(!this.exists(e,r))return;const i=n.filter(s=>s!==r);if(!i.length){this.map.delete(e);return}this.map.set(e,i)}),di(this,"clear",()=>{this.map.clear()})}get topics(){return Array.from(this.map.keys())}}var c9=Object.defineProperty,f9=Object.defineProperties,u9=Object.getOwnPropertyDescriptors,_0=Object.getOwnPropertySymbols,h9=Object.prototype.hasOwnProperty,d9=Object.prototype.propertyIsEnumerable,Uc=(t,e,r)=>e in t?c9(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Gi=(t,e)=>{for(var r in e||(e={}))h9.call(e,r)&&Uc(t,r,e[r]);if(_0)for(var r of _0(e))d9.call(e,r)&&Uc(t,r,e[r]);return t},kc=(t,e)=>f9(t,u9(e)),ue=(t,e,r)=>Uc(t,typeof e!="symbol"?e+"":e,r);class E0 extends Yp{constructor(e,r){super(e,r),this.relayer=e,this.logger=r,ue(this,"subscriptions",new Map),ue(this,"topicMap",new a9),ue(this,"events",new Ut.exports.EventEmitter),ue(this,"name",Wf),ue(this,"version",Gf),ue(this,"pending",new Map),ue(this,"cached",[]),ue(this,"initialized",!1),ue(this,"pendingSubscriptionWatchLabel","pending_sub_watch_label"),ue(this,"pollingInterval",20),ue(this,"storagePrefix",Xt),ue(this,"subscribeTimeout",G.toMiliseconds(G.ONE_MINUTE)),ue(this,"initialSubscribeTimeout",G.toMiliseconds(G.ONE_SECOND*15)),ue(this,"clientId"),ue(this,"batchSubscribeTopicsLimit",500),ue(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),await this.restore()),this.initialized=!0}),ue(this,"subscribe",async(n,i)=>{this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:i}});try{const s=vo(i),o={topic:n,relay:s,transportType:i?.transportType};this.pending.set(n,o);const a=await this.rpcSubscribe(n,s,i);return typeof a=="string"&&(this.onSubscribe(a,o),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:i}})),a}catch(s){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(s),s}}),ue(this,"unsubscribe",async(n,i)=>{this.isInitialized(),typeof i?.id<"u"?await this.unsubscribeById(n,i.id,i):await this.unsubscribeByTopic(n,i)}),ue(this,"isSubscribed",async n=>{if(this.topics.includes(n))return!0;const i=`${this.pendingSubscriptionWatchLabel}_${n}`;return await new Promise((s,o)=>{const a=new G.Watch;a.start(i);const c=setInterval(()=>{(!this.pending.has(n)&&this.topics.includes(n)||this.cached.some(u=>u.topic===n))&&(clearInterval(c),a.stop(i),s(!0)),a.elapsed(i)>=Yf&&(clearInterval(c),a.stop(i),o(new Error("Subscription resolution timeout")))},this.pollingInterval)}).catch(()=>!1)}),ue(this,"on",(n,i)=>{this.events.on(n,i)}),ue(this,"once",(n,i)=>{this.events.once(n,i)}),ue(this,"off",(n,i)=>{this.events.off(n,i)}),ue(this,"removeListener",(n,i)=>{this.events.removeListener(n,i)}),ue(this,"start",async()=>{await this.onConnect()}),ue(this,"stop",async()=>{await this.onDisconnect()}),ue(this,"restart",async()=>{await this.restore(),await this.onRestart()}),ue(this,"checkPending",async()=>{if(this.pending.size===0&&(!this.initialized||!this.relayer.connected))return;const n=[];this.pending.forEach(i=>{n.push(i)}),await this.batchSubscribe(n)}),ue(this,"registerEventListeners",()=>{this.relayer.core.heartbeat.on(Rn.pulse,async()=>{await this.checkPending()}),this.events.on(Dt.created,async n=>{const i=Dt.created;this.logger.info(`Emitting ${i}`),this.logger.debug({type:"event",event:i,data:n}),await this.persist()}),this.events.on(Dt.deleted,async n=>{const i=Dt.deleted;this.logger.info(`Emitting ${i}`),this.logger.debug({type:"event",event:i,data:n}),await this.persist()})}),this.relayer=e,this.logger=At(r,this.name),this.clientId=""}get context(){return Pt(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}get hasAnyTopics(){return this.topicMap.topics.length>0||this.pending.size>0||this.cached.length>0||this.subscriptions.size>0}hasSubscription(e,r){let n=!1;try{n=this.getSubscription(e).topic===r}catch{}return n}reset(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(e,r){const n=this.topicMap.get(e);await Promise.all(n.map(async i=>await this.unsubscribeById(e,i,r)))}async unsubscribeById(e,r,n){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:r,opts:n}});try{const i=vo(n);await this.restartToComplete({topic:e,id:r,relay:i}),await this.rpcUnsubscribe(e,r,i);const s=Ki("USER_DISCONNECTED",`${this.name}, ${e}`);await this.onUnsubscribe(e,r,s),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:r,opts:n}})}catch(i){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(i),i}}async rpcSubscribe(e,r,n){var i;(!n||n?.transportType===an.relay)&&await this.restartToComplete({topic:e,id:e,relay:r});const s={method:Hi(r.protocol).subscribe,params:{topic:e}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});const o=(i=n?.internal)==null?void 0:i.throwOnFailedPublish;try{const a=await this.getSubscriptionId(e);if(n?.transportType===an.link_mode)return setTimeout(()=>{(this.relayer.connected||this.relayer.connecting)&&this.relayer.request(s).catch(d=>this.logger.warn(d))},G.toMiliseconds(G.ONE_SECOND)),a;const c=new Promise(async d=>{const p=y=>{y.topic===e&&(this.events.removeListener(Dt.created,p),d(y.id))};this.events.on(Dt.created,p);try{const y=await Wr(new Promise((_,w)=>{this.relayer.request(s).catch(D=>{this.logger.warn(D,D?.message),w(D)}).then(_)}),this.initialSubscribeTimeout,`Subscribing to ${e} failed, please try again`);this.events.removeListener(Dt.created,p),d(y)}catch{}}),u=await Wr(c,this.subscribeTimeout,`Subscribing to ${e} failed, please try again`);if(!u&&o)throw new Error(`Subscribing to ${e} failed, please try again`);return u?a:null}catch(a){if(this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(ft.connection_stalled),o)throw a}return null}async rpcBatchSubscribe(e){if(!e.length)return;const r=e[0].relay,n={method:Hi(r.protocol).batchSubscribe,params:{topics:e.map(i=>i.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});try{await await Wr(new Promise(i=>{this.relayer.request(n).catch(s=>this.logger.warn(s)).then(i)}),this.subscribeTimeout,"rpcBatchSubscribe failed, please try again")}catch{this.relayer.events.emit(ft.connection_stalled)}}async rpcBatchFetchMessages(e){if(!e.length)return;const r=e[0].relay,n={method:Hi(r.protocol).batchFetchMessages,params:{topics:e.map(s=>s.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});let i;try{i=await await Wr(new Promise((s,o)=>{this.relayer.request(n).catch(a=>{this.logger.warn(a),o(a)}).then(s)}),this.subscribeTimeout,"rpcBatchFetchMessages failed, please try again")}catch{this.relayer.events.emit(ft.connection_stalled)}return i}rpcUnsubscribe(e,r,n){const i={method:Hi(n.protocol).unsubscribe,params:{topic:e,id:r}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:i}),this.relayer.request(i)}onSubscribe(e,r){this.setSubscription(e,kc(Gi({},r),{id:e})),this.pending.delete(r.topic)}onBatchSubscribe(e){e.length&&e.forEach(r=>{this.setSubscription(r.id,Gi({},r)),this.pending.delete(r.topic)})}async onUnsubscribe(e,r,n){this.events.removeAllListeners(r),this.hasSubscription(r,e)&&this.deleteSubscription(r,n),await this.relayer.messages.del(e)}async setRelayerSubscriptions(e){await this.relayer.core.storage.setItem(this.storageKey,e)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(e,r){this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:r}),this.addSubscription(e,r)}addSubscription(e,r){this.subscriptions.set(e,Gi({},r)),this.topicMap.set(r.topic,e),this.events.emit(Dt.created,r)}getSubscription(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});const r=this.subscriptions.get(e);if(!r){const{message:n}=ce("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(n)}return r}deleteSubscription(e,r){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:r});const n=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(n.topic,e),this.events.emit(Dt.deleted,kc(Gi({},n),{reason:r}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(Dt.sync)}async onRestart(){if(this.cached.length){const e=[...this.cached],r=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let n=0;n<r;n++){const i=e.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(i)}}this.events.emit(Dt.resubscribed)}async restore(){try{const e=await this.getRelayerSubscriptions();if(typeof e>"u"||!e.length)return;if(this.subscriptions.size){const{message:r}=ce("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(e){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(e)}}async batchSubscribe(e){e.length&&(await this.rpcBatchSubscribe(e),this.onBatchSubscribe(await Promise.all(e.map(async r=>kc(Gi({},r),{id:await this.getSubscriptionId(r.topic)})))))}async batchFetchMessages(e){if(!e.length)return;this.logger.trace(`Fetching batch messages for ${e.length} subscriptions`);const r=await this.rpcBatchFetchMessages(e);r&&r.messages&&(await v4(G.toMiliseconds(G.ONE_SECOND)),await this.relayer.handleBatchMessageEvents(r.messages))}async onConnect(){await this.restart(),this.reset()}onDisconnect(){this.onDisable()}isInitialized(){if(!this.initialized){const{message:e}=ce("NOT_INITIALIZED",this.name);throw new Error(e)}}async restartToComplete(e){!this.relayer.connected&&!this.relayer.connecting&&(this.cached.push(e),await this.relayer.transportOpen())}async getClientId(){return this.clientId||(this.clientId=await this.relayer.core.crypto.getClientId()),this.clientId}async getSubscriptionId(e){return Mc(e+await this.getClientId())}}var l9=Object.defineProperty,x0=Object.getOwnPropertySymbols,p9=Object.prototype.hasOwnProperty,b9=Object.prototype.propertyIsEnumerable,jc=(t,e,r)=>e in t?l9(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,S0=(t,e)=>{for(var r in e||(e={}))p9.call(e,r)&&jc(t,r,e[r]);if(x0)for(var r of x0(e))b9.call(e,r)&&jc(t,r,e[r]);return t},oe=(t,e,r)=>jc(t,typeof e!="symbol"?e+"":e,r);class I0 extends Wp{constructor(e){super(e),oe(this,"protocol","wc"),oe(this,"version",2),oe(this,"core"),oe(this,"logger"),oe(this,"events",new Ut.exports.EventEmitter),oe(this,"provider"),oe(this,"messages"),oe(this,"subscriber"),oe(this,"publisher"),oe(this,"name",jf),oe(this,"transportExplicitlyClosed",!1),oe(this,"initialized",!1),oe(this,"connectionAttemptInProgress",!1),oe(this,"relayUrl"),oe(this,"projectId"),oe(this,"packageName"),oe(this,"bundleId"),oe(this,"hasExperiencedNetworkDisruption",!1),oe(this,"pingTimeout"),oe(this,"heartBeatTimeout",G.toMiliseconds(G.THIRTY_SECONDS+G.FIVE_SECONDS)),oe(this,"reconnectTimeout"),oe(this,"connectPromise"),oe(this,"reconnectInProgress",!1),oe(this,"requestsInFlight",[]),oe(this,"connectTimeout",G.toMiliseconds(G.ONE_SECOND*15)),oe(this,"request",async r=>{var n,i;this.logger.debug("Publishing Request Payload");const s=r.id||Cc().toString();await this.toEstablishConnection();try{this.logger.trace({id:s,method:r.method,topic:(n=r.params)==null?void 0:n.topic},"relayer.request - publishing...");const o=`${s}:${((i=r.params)==null?void 0:i.tag)||""}`;this.requestsInFlight.push(o);const a=await this.provider.request(r);return this.requestsInFlight=this.requestsInFlight.filter(c=>c!==o),a}catch(o){throw this.logger.debug(`Failed to Publish Request: ${s}`),o}}),oe(this,"resetPingTimeout",()=>{if(oo())try{clearTimeout(this.pingTimeout),this.pingTimeout=setTimeout(()=>{var r,n,i;this.logger.debug({},"pingTimeout: Connection stalled, terminating..."),(i=(n=(r=this.provider)==null?void 0:r.connection)==null?void 0:n.socket)==null||i.terminate()},this.heartBeatTimeout)}catch(r){this.logger.warn(r,r?.message)}}),oe(this,"onPayloadHandler",r=>{this.onProviderPayload(r),this.resetPingTimeout()}),oe(this,"onConnectHandler",()=>{this.logger.warn({},"Relayer connected \u{1F6DC}"),this.startPingTimeout(),this.events.emit(ft.connect)}),oe(this,"onDisconnectHandler",()=>{this.logger.warn({},"Relayer disconnected \u{1F6D1}"),this.requestsInFlight=[],this.onProviderDisconnect()}),oe(this,"onProviderErrorHandler",r=>{this.logger.fatal(`Fatal socket error: ${r.message}`),this.events.emit(ft.error,r),this.logger.fatal("Fatal socket error received, closing transport"),this.transportClose()}),oe(this,"registerProviderListeners",()=>{this.provider.on(Nt.payload,this.onPayloadHandler),this.provider.on(Nt.connect,this.onConnectHandler),this.provider.on(Nt.disconnect,this.onDisconnectHandler),this.provider.on(Nt.error,this.onProviderErrorHandler)}),this.core=e.core,this.logger=typeof e.logger<"u"&&typeof e.logger!="string"?At(e.logger,this.name):Fr(Mf({level:e.logger||kf})),this.messages=new n0(this.logger,e.core),this.subscriber=new E0(this,this.logger),this.publisher=new i9(this,this.logger),this.relayUrl=e?.relayUrl||Zo,this.projectId=e.projectId,o4()?this.packageName=rl():a4()&&(this.bundleId=rl()),this.provider={}}async init(){if(this.logger.trace("Initialized"),this.registerEventListeners(),await Promise.all([this.messages.init(),this.subscriber.init()]),this.initialized=!0,this.subscriber.hasAnyTopics)try{await this.transportOpen()}catch(e){this.logger.warn(e,e?.message)}}get context(){return Pt(this.logger)}get connected(){var e,r,n;return((n=(r=(e=this.provider)==null?void 0:e.connection)==null?void 0:r.socket)==null?void 0:n.readyState)===1||!1}get connecting(){var e,r,n;return((n=(r=(e=this.provider)==null?void 0:e.connection)==null?void 0:r.socket)==null?void 0:n.readyState)===0||this.connectPromise!==void 0||!1}async publish(e,r,n){this.isInitialized(),await this.publisher.publish(e,r,n),await this.recordMessageEvent({topic:e,message:r,publishedAt:Date.now(),transportType:an.relay})}async subscribe(e,r){var n,i,s;this.isInitialized(),(!(r!=null&&r.transportType)||r?.transportType==="relay")&&await this.toEstablishConnection();const o=typeof((n=r?.internal)==null?void 0:n.throwOnFailedPublish)>"u"?!0:(i=r?.internal)==null?void 0:i.throwOnFailedPublish;let a=((s=this.subscriber.topicMap.get(e))==null?void 0:s[0])||"",c;const u=d=>{d.topic===e&&(this.subscriber.off(Dt.created,u),c())};return await Promise.all([new Promise(d=>{c=d,this.subscriber.on(Dt.created,u)}),new Promise(async(d,p)=>{a=await this.subscriber.subscribe(e,S0({internal:{throwOnFailedPublish:o}},r)).catch(y=>{o&&p(y)})||a,d()})]),a}async unsubscribe(e,r){this.isInitialized(),await this.subscriber.unsubscribe(e,r)}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async transportDisconnect(){this.provider.disconnect&&(this.hasExperiencedNetworkDisruption||this.connected)?await Wr(this.provider.disconnect(),2e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.onProviderDisconnect()}async transportClose(){this.transportExplicitlyClosed=!0,await this.transportDisconnect()}async transportOpen(e){if(!this.subscriber.hasAnyTopics){this.logger.warn("Starting WS connection skipped because the client has no topics to work with.");return}if(this.connectPromise?(this.logger.debug({},"Waiting for existing connection attempt to resolve..."),await this.connectPromise,this.logger.debug({},"Existing connection attempt resolved")):(this.connectPromise=new Promise(async(r,n)=>{await this.connect(e).then(r).catch(n).finally(()=>{this.connectPromise=void 0})}),await this.connectPromise),!this.connected)throw new Error(`Couldn't establish socket connection to the relay server: ${this.relayUrl}`)}async restartTransport(e){this.logger.debug({},"Restarting transport..."),!this.connectionAttemptInProgress&&(this.relayUrl=e||this.relayUrl,await this.confirmOnlineStateOrThrow(),await this.transportClose(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await e0())throw new Error("No internet connection detected. Please restart your network and try again.")}async handleBatchMessageEvents(e){if(e?.length===0){this.logger.trace("Batch message events is empty. Ignoring...");return}const r=e.sort((n,i)=>n.publishedAt-i.publishedAt);this.logger.debug(`Batch of ${r.length} message events sorted`);for(const n of r)try{await this.onMessageEvent(n)}catch(i){this.logger.warn(i,"Error while processing batch message event: "+i?.message)}this.logger.trace(`Batch of ${r.length} message events processed`)}async onLinkMessageEvent(e,r){const{topic:n}=e;if(!r.sessionExists){const i=$i(G.FIVE_MINUTES),s={topic:n,expiry:i,relay:{protocol:"irn"},active:!1};await this.core.pairing.pairings.set(n,s)}this.events.emit(ft.message,e),await this.recordMessageEvent(e)}async connect(e){await this.confirmOnlineStateOrThrow(),e&&e!==this.relayUrl&&(this.relayUrl=e,await this.transportDisconnect()),this.connectionAttemptInProgress=!0,this.transportExplicitlyClosed=!1;let r=1;for(;r<6;){try{if(this.transportExplicitlyClosed)break;this.logger.debug({},`Connecting to ${this.relayUrl}, attempt: ${r}...`),await this.createProvider(),await new Promise(async(n,i)=>{const s=()=>{i(new Error("Connection interrupted while trying to subscribe"))};this.provider.once(Nt.disconnect,s),await Wr(new Promise((o,a)=>{this.provider.connect().then(o).catch(a)}),this.connectTimeout,`Socket stalled when trying to connect to ${this.relayUrl}`).catch(o=>{i(o)}).finally(()=>{this.provider.off(Nt.disconnect,s),clearTimeout(this.reconnectTimeout)}),await new Promise(async(o,a)=>{const c=()=>{a(new Error("Connection interrupted while trying to subscribe"))};this.provider.once(Nt.disconnect,c),await this.subscriber.start().then(o).catch(a).finally(()=>{this.provider.off(Nt.disconnect,c)})}),this.hasExperiencedNetworkDisruption=!1,n()})}catch(n){await this.subscriber.stop();const i=n;this.logger.warn({},i.message),this.hasExperiencedNetworkDisruption=!0}finally{this.connectionAttemptInProgress=!1}if(this.connected){this.logger.debug({},`Connected to ${this.relayUrl} successfully on attempt: ${r}`);break}await new Promise(n=>setTimeout(n,G.toMiliseconds(r*1))),r++}}startPingTimeout(){var e,r,n,i,s;if(oo())try{(r=(e=this.provider)==null?void 0:e.connection)!=null&&r.socket&&((s=(i=(n=this.provider)==null?void 0:n.connection)==null?void 0:i.socket)==null||s.on("ping",()=>{this.resetPingTimeout()})),this.resetPingTimeout()}catch(o){this.logger.warn(o,o?.message)}}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();const e=await this.core.crypto.signJWT(this.relayUrl);this.provider=new Gw(new Jw(d4({sdkVersion:Is,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:e,useOnCloseEvent:!0,bundleId:this.bundleId,packageName:this.packageName}))),this.registerProviderListeners()}async recordMessageEvent(e){const{topic:r,message:n}=e;await this.messages.set(r,n)}async shouldIgnoreMessageEvent(e){const{topic:r,message:n}=e;if(!n||n.length===0)return this.logger.warn(`Ignoring invalid/empty message: ${n}`),!0;if(!await this.subscriber.isSubscribed(r))return this.logger.warn(`Ignoring message for non-subscribed topic ${r}`),!0;const i=this.messages.has(r,n);return i&&this.logger.warn(`Ignoring duplicate message: ${n}`),i}async onProviderPayload(e){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:e}),g0(e)){if(!e.method.endsWith(qf))return;const r=e.params,{topic:n,message:i,publishedAt:s,attestation:o}=r.data,a={topic:n,message:i,publishedAt:s,transportType:an.relay,attestation:o};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(S0({type:"event",event:r.id},a)),this.events.emit(r.id,a),await this.acknowledgePayload(e),await this.onMessageEvent(a)}else $c(e)&&this.events.emit(ft.message_ack,e)}async onMessageEvent(e){await this.shouldIgnoreMessageEvent(e)||(this.events.emit(ft.message,e),await this.recordMessageEvent(e))}async acknowledgePayload(e){const r=d0(e.id,!0);await this.provider.connection.send(r)}unregisterProviderListeners(){this.provider.off(Nt.payload,this.onPayloadHandler),this.provider.off(Nt.connect,this.onConnectHandler),this.provider.off(Nt.disconnect,this.onDisconnectHandler),this.provider.off(Nt.error,this.onProviderErrorHandler),clearTimeout(this.pingTimeout)}async registerEventListeners(){let e=await e0();ew(async r=>{e!==r&&(e=r,r?await this.transportOpen().catch(n=>this.logger.error(n,n?.message)):(this.hasExperiencedNetworkDisruption=!0,await this.transportDisconnect(),this.transportExplicitlyClosed=!1))})}async onProviderDisconnect(){clearTimeout(this.pingTimeout),this.events.emit(ft.disconnect),this.connectionAttemptInProgress=!1,!this.reconnectInProgress&&(this.reconnectInProgress=!0,await this.subscriber.stop(),this.subscriber.hasAnyTopics&&(this.transportExplicitlyClosed||(this.reconnectTimeout=setTimeout(async()=>{await this.transportOpen().catch(e=>this.logger.error(e,e?.message)),this.reconnectTimeout=void 0,this.reconnectInProgress=!1},G.toMiliseconds(Hf)))))}isInitialized(){if(!this.initialized){const{message:e}=ce("NOT_INITIALIZED",this.name);throw new Error(e)}}async toEstablishConnection(){await this.confirmOnlineStateOrThrow(),!this.connected&&await this.connect()}}var qc={exports:{}};(function(t,e){var r=200,n="__lodash_hash_undefined__",i=1,s=2,o=9007199254740991,a="[object Arguments]",c="[object Array]",u="[object AsyncFunction]",d="[object Boolean]",p="[object Date]",y="[object Error]",_="[object Function]",w="[object GeneratorFunction]",D="[object Map]",O="[object Number]",M="[object Null]",T="[object Object]",B="[object Promise]",P="[object Proxy]",j="[object RegExp]",$="[object Set]",L="[object String]",z="[object Symbol]",N="[object Undefined]",K="[object WeakMap]",S="[object ArrayBuffer]",f="[object DataView]",l="[object Float32Array]",g="[object Float64Array]",b="[object Int8Array]",v="[object Int16Array]",x="[object Int32Array]",I="[object Uint8Array]",m="[object Uint8ClampedArray]",h="[object Uint16Array]",E="[object Uint32Array]",C=/[\\^$.*+?()[\]{}|]/g,F=/^\[object .+?Constructor\]$/,k=/^(?:0|[1-9]\d*)$/,q={};q[l]=q[g]=q[b]=q[v]=q[x]=q[I]=q[m]=q[h]=q[E]=!0,q[a]=q[c]=q[S]=q[d]=q[f]=q[p]=q[y]=q[_]=q[D]=q[O]=q[T]=q[j]=q[$]=q[L]=q[K]=!1;var W=typeof _t=="object"&&_t&&_t.Object===Object&&_t,X=typeof self=="object"&&self&&self.Object===Object&&self,Z=W||X||Function("return this")(),Y=e&&!e.nodeType&&e,ee=Y&&!0&&t&&!t.nodeType&&t,Qe=ee&&ee.exports===Y,te=Qe&&W.process,ae=function(){try{return te&&te.binding&&te.binding("util")}catch{}}(),St=ae&&ae.isTypedArray;function de(A,R){for(var U=-1,V=A==null?0:A.length,Se=0,J=[];++U<V;){var Ge=A[U];R(Ge,U,A)&&(J[Se++]=Ge)}return J}function Ie(A,R){for(var U=-1,V=R.length,Se=A.length;++U<V;)A[Se+U]=R[U];return A}function li(A,R){for(var U=-1,V=A==null?0:A.length;++U<V;)if(R(A[U],U,A))return!0;return!1}function Ae(A,R){for(var U=-1,V=Array(A);++U<A;)V[U]=R(U);return V}function we(A){return function(R){return A(R)}}function En(A,R){return A.has(R)}function ve(A,R){return A?.[R]}function _e(A){var R=-1,U=Array(A.size);return A.forEach(function(V,Se){U[++R]=[Se,V]}),U}function xn(A,R){return function(U){return A(R(U))}}function Ee(A){var R=-1,U=Array(A.size);return A.forEach(function(V){U[++R]=V}),U}var xe=Array.prototype,Sn=Function.prototype,le=Object.prototype,ye=Z["__core-js_shared__"],In=Sn.toString,ie=le.hasOwnProperty,Re=function(){var A=/[^.]+$/.exec(ye&&ye.keys&&ye.keys.IE_PROTO||"");return A?"Symbol(src)_1."+A:""}(),Xi=le.toString,ze=RegExp("^"+In.call(ie).replace(C,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Be=Qe?Z.Buffer:void 0,An=Z.Symbol,Pe=Z.Uint8Array,Ne=le.propertyIsEnumerable,Eo=xe.splice,he=An?An.toStringTag:void 0,Ce=Object.getOwnPropertySymbols,xo=Be?Be.isBuffer:void 0,Ue=xn(Object.keys,Object),De=bi(Z,"DataView"),Zr=bi(Z,"Map"),Oe=bi(Z,"Promise"),Me=bi(Z,"Set"),pi=bi(Z,"WeakMap"),me=bi(Object,"create"),ke=Dn(De),So=Dn(Zr),je=Dn(Oe),qe=Dn(Me),Io=Dn(pi),Le=An?An.prototype:void 0,Te=Le?Le.valueOf:void 0;function xr(A){var R=-1,U=A==null?0:A.length;for(this.clear();++R<U;){var V=A[R];this.set(V[0],V[1])}}function He(){this.__data__=me?me(null):{},this.size=0}function Ke(A){var R=this.has(A)&&delete this.__data__[A];return this.size-=R?1:0,R}function Ao(A){var R=this.__data__;if(me){var U=R[A];return U===n?void 0:U}return ie.call(R,A)?R[A]:void 0}function Ve(A){var R=this.__data__;return me?R[A]!==void 0:ie.call(R,A)}function We(A,R){var U=this.__data__;return this.size+=this.has(A)?0:1,U[A]=me&&R===void 0?n:R,this}xr.prototype.clear=He,xr.prototype.delete=Ke,xr.prototype.get=Ao,xr.prototype.has=Ve,xr.prototype.set=We;function Ft(A){var R=-1,U=A==null?0:A.length;for(this.clear();++R<U;){var V=A[R];this.set(V[0],V[1])}}function Zi(){this.__data__=[],this.size=0}function Ji(A){var R=this.__data__,U=Do(R,A);if(U<0)return!1;var V=R.length-1;return U==V?R.pop():Eo.call(R,U,1),--this.size,!0}function Qi(A){var R=this.__data__,U=Do(R,A);return U<0?void 0:R[U][1]}function es(A){return Do(this.__data__,A)>-1}function ts(A,R){var U=this.__data__,V=Do(U,A);return V<0?(++this.size,U.push([A,R])):U[V][1]=R,this}Ft.prototype.clear=Zi,Ft.prototype.delete=Ji,Ft.prototype.get=Qi,Ft.prototype.has=es,Ft.prototype.set=ts;function sr(A){var R=-1,U=A==null?0:A.length;for(this.clear();++R<U;){var V=A[R];this.set(V[0],V[1])}}function rs(){this.size=0,this.__data__={hash:new xr,map:new(Zr||Ft),string:new xr}}function ns(A){var R=Oo(this,A).delete(A);return this.size-=R?1:0,R}function is(A){return Oo(this,A).get(A)}function ss(A){return Oo(this,A).has(A)}function os(A,R){var U=Oo(this,A),V=U.size;return U.set(A,R),this.size+=U.size==V?0:1,this}sr.prototype.clear=rs,sr.prototype.delete=ns,sr.prototype.get=is,sr.prototype.has=ss,sr.prototype.set=os;function Jr(A){var R=-1,U=A==null?0:A.length;for(this.__data__=new sr;++R<U;)this.add(A[R])}function as(A){return this.__data__.set(A,n),this}function cs(A){return this.__data__.has(A)}Jr.prototype.add=Jr.prototype.push=as,Jr.prototype.has=cs;function Wt(A){var R=this.__data__=new Ft(A);this.size=R.size}function fs(){this.__data__=new Ft,this.size=0}function us(A){var R=this.__data__,U=R.delete(A);return this.size=R.size,U}function hs(A){return this.__data__.get(A)}function $9(A){return this.__data__.has(A)}function F9(A,R){var U=this.__data__;if(U instanceof Ft){var V=U.__data__;if(!Zr||V.length<r-1)return V.push([A,R]),this.size=++U.size,this;U=this.__data__=new sr(V)}return U.set(A,R),this.size=U.size,this}Wt.prototype.clear=fs,Wt.prototype.delete=us,Wt.prototype.get=hs,Wt.prototype.has=$9,Wt.prototype.set=F9;function z9(A,R){var U=Mo(A),V=!U&&e7(A),Se=!U&&!V&&Wc(A),J=!U&&!V&&!Se&&W0(A),Ge=U||V||Se||J,ct=Ge?Ae(A.length,String):[],gt=ct.length;for(var $e in A)(R||ie.call(A,$e))&&!(Ge&&($e=="length"||Se&&($e=="offset"||$e=="parent")||J&&($e=="buffer"||$e=="byteLength"||$e=="byteOffset")||Y9($e,gt)))&&ct.push($e);return ct}function Do(A,R){for(var U=A.length;U--;)if(q0(A[U][0],R))return U;return-1}function U9(A,R,U){var V=R(A);return Mo(A)?V:Ie(V,U(A))}function ds(A){return A==null?A===void 0?N:M:he&&he in Object(A)?W9(A):Q9(A)}function z0(A){return ls(A)&&ds(A)==a}function U0(A,R,U,V,Se){return A===R?!0:A==null||R==null||!ls(A)&&!ls(R)?A!==A&&R!==R:k9(A,R,U,V,U0,Se)}function k9(A,R,U,V,Se,J){var Ge=Mo(A),ct=Mo(R),gt=Ge?c:Qr(A),$e=ct?c:Qr(R);gt=gt==a?T:gt,$e=$e==a?T:$e;var zt=gt==T,or=$e==T,wt=gt==$e;if(wt&&Wc(A)){if(!Wc(R))return!1;Ge=!0,zt=!1}if(wt&&!zt)return J||(J=new Wt),Ge||W0(A)?k0(A,R,U,V,Se,J):K9(A,R,gt,U,V,Se,J);if(!(U&i)){var Gt=zt&&ie.call(A,"__wrapped__"),Yt=or&&ie.call(R,"__wrapped__");if(Gt||Yt){var en=Gt?A.value():A,$r=Yt?R.value():R;return J||(J=new Wt),Se(en,$r,U,V,J)}}return wt?(J||(J=new Wt),V9(A,R,U,V,Se,J)):!1}function j9(A){if(!V0(A)||Z9(A))return!1;var R=H0(A)?ze:F;return R.test(Dn(A))}function q9(A){return ls(A)&&K0(A.length)&&!!q[ds(A)]}function H9(A){if(!J9(A))return Ue(A);var R=[];for(var U in Object(A))ie.call(A,U)&&U!="constructor"&&R.push(U);return R}function k0(A,R,U,V,Se,J){var Ge=U&i,ct=A.length,gt=R.length;if(ct!=gt&&!(Ge&&gt>ct))return!1;var $e=J.get(A);if($e&&J.get(R))return $e==R;var zt=-1,or=!0,wt=U&s?new Jr:void 0;for(J.set(A,R),J.set(R,A);++zt<ct;){var Gt=A[zt],Yt=R[zt];if(V)var en=Ge?V(Yt,Gt,zt,R,A,J):V(Gt,Yt,zt,A,R,J);if(en!==void 0){if(en)continue;or=!1;break}if(wt){if(!li(R,function($r,On){if(!En(wt,On)&&(Gt===$r||Se(Gt,$r,U,V,J)))return wt.push(On)})){or=!1;break}}else if(!(Gt===Yt||Se(Gt,Yt,U,V,J))){or=!1;break}}return J.delete(A),J.delete(R),or}function K9(A,R,U,V,Se,J,Ge){switch(U){case f:if(A.byteLength!=R.byteLength||A.byteOffset!=R.byteOffset)return!1;A=A.buffer,R=R.buffer;case S:return!(A.byteLength!=R.byteLength||!J(new Pe(A),new Pe(R)));case d:case p:case O:return q0(+A,+R);case y:return A.name==R.name&&A.message==R.message;case j:case L:return A==R+"";case D:var ct=_e;case $:var gt=V&i;if(ct||(ct=Ee),A.size!=R.size&&!gt)return!1;var $e=Ge.get(A);if($e)return $e==R;V|=s,Ge.set(A,R);var zt=k0(ct(A),ct(R),V,Se,J,Ge);return Ge.delete(A),zt;case z:if(Te)return Te.call(A)==Te.call(R)}return!1}function V9(A,R,U,V,Se,J){var Ge=U&i,ct=j0(A),gt=ct.length,$e=j0(R),zt=$e.length;if(gt!=zt&&!Ge)return!1;for(var or=gt;or--;){var wt=ct[or];if(!(Ge?wt in R:ie.call(R,wt)))return!1}var Gt=J.get(A);if(Gt&&J.get(R))return Gt==R;var Yt=!0;J.set(A,R),J.set(R,A);for(var en=Ge;++or<gt;){wt=ct[or];var $r=A[wt],On=R[wt];if(V)var G0=Ge?V(On,$r,wt,R,A,J):V($r,On,wt,A,R,J);if(!(G0===void 0?$r===On||Se($r,On,U,V,J):G0)){Yt=!1;break}en||(en=wt=="constructor")}if(Yt&&!en){var To=A.constructor,Ro=R.constructor;To!=Ro&&"constructor"in A&&"constructor"in R&&!(typeof To=="function"&&To instanceof To&&typeof Ro=="function"&&Ro instanceof Ro)&&(Yt=!1)}return J.delete(A),J.delete(R),Yt}function j0(A){return U9(A,n7,G9)}function Oo(A,R){var U=A.__data__;return X9(R)?U[typeof R=="string"?"string":"hash"]:U.map}function bi(A,R){var U=ve(A,R);return j9(U)?U:void 0}function W9(A){var R=ie.call(A,he),U=A[he];try{A[he]=void 0;var V=!0}catch{}var Se=Xi.call(A);return V&&(R?A[he]=U:delete A[he]),Se}var G9=Ce?function(A){return A==null?[]:(A=Object(A),de(Ce(A),function(R){return Ne.call(A,R)}))}:i7,Qr=ds;(De&&Qr(new De(new ArrayBuffer(1)))!=f||Zr&&Qr(new Zr)!=D||Oe&&Qr(Oe.resolve())!=B||Me&&Qr(new Me)!=$||pi&&Qr(new pi)!=K)&&(Qr=function(A){var R=ds(A),U=R==T?A.constructor:void 0,V=U?Dn(U):"";if(V)switch(V){case ke:return f;case So:return D;case je:return B;case qe:return $;case Io:return K}return R});function Y9(A,R){return R=R??o,!!R&&(typeof A=="number"||k.test(A))&&A>-1&&A%1==0&&A<R}function X9(A){var R=typeof A;return R=="string"||R=="number"||R=="symbol"||R=="boolean"?A!=="__proto__":A===null}function Z9(A){return!!Re&&Re in A}function J9(A){var R=A&&A.constructor,U=typeof R=="function"&&R.prototype||le;return A===U}function Q9(A){return Xi.call(A)}function Dn(A){if(A!=null){try{return In.call(A)}catch{}try{return A+""}catch{}}return""}function q0(A,R){return A===R||A!==A&&R!==R}var e7=z0(function(){return arguments}())?z0:function(A){return ls(A)&&ie.call(A,"callee")&&!Ne.call(A,"callee")},Mo=Array.isArray;function t7(A){return A!=null&&K0(A.length)&&!H0(A)}var Wc=xo||s7;function r7(A,R){return U0(A,R)}function H0(A){if(!V0(A))return!1;var R=ds(A);return R==_||R==w||R==u||R==P}function K0(A){return typeof A=="number"&&A>-1&&A%1==0&&A<=o}function V0(A){var R=typeof A;return A!=null&&(R=="object"||R=="function")}function ls(A){return A!=null&&typeof A=="object"}var W0=St?we(St):q9;function n7(A){return t7(A)?z9(A):H9(A)}function i7(){return[]}function s7(){return!1}t.exports=r7})(qc,qc.exports);var g9=qc.exports,v9=Object.defineProperty,A0=Object.getOwnPropertySymbols,y9=Object.prototype.hasOwnProperty,m9=Object.prototype.propertyIsEnumerable,Hc=(t,e,r)=>e in t?v9(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,D0=(t,e)=>{for(var r in e||(e={}))y9.call(e,r)&&Hc(t,r,e[r]);if(A0)for(var r of A0(e))m9.call(e,r)&&Hc(t,r,e[r]);return t},Bt=(t,e,r)=>Hc(t,typeof e!="symbol"?e+"":e,r);class O0 extends Gp{constructor(e,r,n,i=Xt,s=void 0){super(e,r,n,i),this.core=e,this.logger=r,this.name=n,Bt(this,"map",new Map),Bt(this,"version",Kf),Bt(this,"cached",[]),Bt(this,"initialized",!1),Bt(this,"getKey"),Bt(this,"storagePrefix",Xt),Bt(this,"recentlyDeleted",[]),Bt(this,"recentlyDeletedLimit",200),Bt(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(o=>{this.getKey&&o!==null&&!yo(o)?this.map.set(this.getKey(o),o):Y5(o)?this.map.set(o.id,o):X5(o)&&this.map.set(o.topic,o)}),this.cached=[],this.initialized=!0)}),Bt(this,"set",async(o,a)=>{this.isInitialized(),this.map.has(o)?await this.update(o,a):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:o,value:a}),this.map.set(o,a),await this.persist())}),Bt(this,"get",o=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:o}),this.getData(o))),Bt(this,"getAll",o=>(this.isInitialized(),o?this.values.filter(a=>Object.keys(o).every(c=>g9(a[c],o[c]))):this.values)),Bt(this,"update",async(o,a)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:o,update:a});const c=D0(D0({},this.getData(o)),a);this.map.set(o,c),await this.persist()}),Bt(this,"delete",async(o,a)=>{this.isInitialized(),this.map.has(o)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:o,reason:a}),this.map.delete(o),this.addToRecentlyDeleted(o),await this.persist())}),this.logger=At(r,this.name),this.storagePrefix=i,this.getKey=s}get context(){return Pt(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}addToRecentlyDeleted(e){this.recentlyDeleted.push(e),this.recentlyDeleted.length>=this.recentlyDeletedLimit&&this.recentlyDeleted.splice(0,this.recentlyDeletedLimit/2)}async setDataStore(e){await this.core.storage.setItem(this.storageKey,e)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(e){const r=this.map.get(e);if(!r){if(this.recentlyDeleted.includes(e)){const{message:i}=ce("MISSING_OR_INVALID",`Record was recently deleted - ${this.name}: ${e}`);throw this.logger.error(i),new Error(i)}const{message:n}=ce("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(n),new Error(n)}return r}async persist(){await this.setDataStore(this.values)}async restore(){try{const e=await this.getDataStore();if(typeof e>"u"||!e.length)return;if(this.map.size){const{message:r}=ce("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(e){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(e)}}isInitialized(){if(!this.initialized){const{message:e}=ce("NOT_INITIALIZED",this.name);throw new Error(e)}}}var w9=Object.defineProperty,_9=(t,e,r)=>e in t?w9(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,ne=(t,e,r)=>_9(t,typeof e!="symbol"?e+"":e,r);class M0{constructor(e,r){this.core=e,this.logger=r,ne(this,"name",Xf),ne(this,"version",Zf),ne(this,"events",new Ut.exports),ne(this,"pairings"),ne(this,"initialized",!1),ne(this,"storagePrefix",Xt),ne(this,"ignoredPayloadTypes",[hi]),ne(this,"registeredMethods",[]),ne(this,"init",async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))}),ne(this,"register",({methods:n})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...n])]}),ne(this,"create",async n=>{this.isInitialized();const i=Oc(),s=await this.core.crypto.setSymKey(i),o=$i(G.FIVE_MINUTES),a={protocol:Uf},c={topic:s,expiry:o,relay:a,active:!1,methods:n?.methods},u=Jl({protocol:this.core.protocol,version:this.core.version,topic:s,symKey:i,relay:a,expiryTimestamp:o,methods:n?.methods});return this.events.emit(Ln.create,c),this.core.expirer.set(s,o),await this.pairings.set(s,c),await this.core.relayer.subscribe(s,{transportType:n?.transportType}),{topic:s,uri:u}}),ne(this,"pair",async n=>{this.isInitialized();const i=this.core.eventClient.createEvent({properties:{topic:n?.uri,trace:[cr.pairing_started]}});this.isValidPair(n,i);const{topic:s,symKey:o,relay:a,expiryTimestamp:c,methods:u}=Zl(n.uri);i.props.properties.topic=s,i.addTrace(cr.pairing_uri_validation_success),i.addTrace(cr.pairing_uri_not_expired);let d;if(this.pairings.keys.includes(s)){if(d=this.pairings.get(s),i.addTrace(cr.existing_pairing),d.active)throw i.setError(Sr.active_pairing_already_exists),new Error(`Pairing already exists: ${s}. Please try again with a new connection URI.`);i.addTrace(cr.pairing_not_expired)}const p=c||$i(G.FIVE_MINUTES),y={topic:s,relay:a,expiry:p,active:!1,methods:u};this.core.expirer.set(s,p),await this.pairings.set(s,y),i.addTrace(cr.store_new_pairing),n.activatePairing&&await this.activate({topic:s}),this.events.emit(Ln.create,y),i.addTrace(cr.emit_inactive_pairing),this.core.crypto.keychain.has(s)||await this.core.crypto.setSymKey(o,s),i.addTrace(cr.subscribing_pairing_topic);try{await this.core.relayer.confirmOnlineStateOrThrow()}catch{i.setError(Sr.no_internet_connection)}try{await this.core.relayer.subscribe(s,{relay:a})}catch(_){throw i.setError(Sr.subscribe_pairing_topic_failure),_}return i.addTrace(cr.subscribe_pairing_topic_success),y}),ne(this,"activate",async({topic:n})=>{this.isInitialized();const i=$i(G.FIVE_MINUTES);this.core.expirer.set(n,i),await this.pairings.update(n,{active:!0,expiry:i})}),ne(this,"ping",async n=>{this.isInitialized(),await this.isValidPing(n),this.logger.warn("ping() is deprecated and will be removed in the next major release.");const{topic:i}=n;if(this.pairings.keys.includes(i)){const s=await this.sendRequest(i,"wc_pairingPing",{}),{done:o,resolve:a,reject:c}=l4();this.events.once(hc("pairing_ping",s),({error:u})=>{u?c(u):a()}),await o()}}),ne(this,"updateExpiry",async({topic:n,expiry:i})=>{this.isInitialized(),await this.pairings.update(n,{expiry:i})}),ne(this,"updateMetadata",async({topic:n,metadata:i})=>{this.isInitialized(),await this.pairings.update(n,{peerMetadata:i})}),ne(this,"getPairings",()=>(this.isInitialized(),this.pairings.values)),ne(this,"disconnect",async n=>{this.isInitialized(),await this.isValidDisconnect(n);const{topic:i}=n;this.pairings.keys.includes(i)&&(await this.sendRequest(i,"wc_pairingDelete",Ki("USER_DISCONNECTED")),await this.deletePairing(i))}),ne(this,"formatUriFromPairing",n=>{this.isInitialized();const{topic:i,relay:s,expiry:o,methods:a}=n,c=this.core.crypto.keychain.get(i);return Jl({protocol:this.core.protocol,version:this.core.version,topic:i,symKey:c,relay:s,expiryTimestamp:o,methods:a})}),ne(this,"sendRequest",async(n,i,s)=>{const o=Lc(i,s),a=await this.core.crypto.encode(n,o),c=Cn[i].req;return this.core.history.set(n,o),this.core.relayer.publish(n,a,c),o.id}),ne(this,"sendResult",async(n,i,s)=>{const o=d0(n,s),a=await this.core.crypto.encode(i,o),c=(await this.core.history.get(i,n)).request.method,u=Cn[c].res;await this.core.relayer.publish(i,a,u),await this.core.history.resolve(o)}),ne(this,"sendError",async(n,i,s)=>{const o=l0(n,s),a=await this.core.crypto.encode(i,o),c=(await this.core.history.get(i,n)).request.method,u=Cn[c]?Cn[c].res:Cn.unregistered_method.res;await this.core.relayer.publish(i,a,u),await this.core.history.resolve(o)}),ne(this,"deletePairing",async(n,i)=>{await this.core.relayer.unsubscribe(n),await Promise.all([this.pairings.delete(n,Ki("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(n),i?Promise.resolve():this.core.expirer.del(n)])}),ne(this,"cleanup",async()=>{const n=this.pairings.getAll().filter(i=>al(i.expiry));await Promise.all(n.map(i=>this.deletePairing(i.topic)))}),ne(this,"onRelayEventRequest",n=>{const{topic:i,payload:s}=n;switch(s.method){case"wc_pairingPing":return this.onPairingPingRequest(i,s);case"wc_pairingDelete":return this.onPairingDeleteRequest(i,s);default:return this.onUnknownRpcMethodRequest(i,s)}}),ne(this,"onRelayEventResponse",async n=>{const{topic:i,payload:s}=n,o=(await this.core.history.get(i,s.id)).request.method;switch(o){case"wc_pairingPing":return this.onPairingPingResponse(i,s);default:return this.onUnknownRpcMethodResponse(o)}}),ne(this,"onPairingPingRequest",async(n,i)=>{const{id:s}=i;try{this.isValidPing({topic:n}),await this.sendResult(s,n,!0),this.events.emit(Ln.ping,{id:s,topic:n})}catch(o){await this.sendError(s,n,o),this.logger.error(o)}}),ne(this,"onPairingPingResponse",(n,i)=>{const{id:s}=i;setTimeout(()=>{v0(i)?this.events.emit(hc("pairing_ping",s),{}):mo(i)&&this.events.emit(hc("pairing_ping",s),{error:i.error})},500)}),ne(this,"onPairingDeleteRequest",async(n,i)=>{const{id:s}=i;try{this.isValidDisconnect({topic:n}),await this.deletePairing(n),this.events.emit(Ln.delete,{id:s,topic:n})}catch(o){await this.sendError(s,n,o),this.logger.error(o)}}),ne(this,"onUnknownRpcMethodRequest",async(n,i)=>{const{id:s,method:o}=i;try{if(this.registeredMethods.includes(o))return;const a=Ki("WC_METHOD_UNSUPPORTED",o);await this.sendError(s,n,a),this.logger.error(a)}catch(a){await this.sendError(s,n,a),this.logger.error(a)}}),ne(this,"onUnknownRpcMethodResponse",n=>{this.registeredMethods.includes(n)||this.logger.error(Ki("WC_METHOD_UNSUPPORTED",n))}),ne(this,"isValidPair",(n,i)=>{var s;if(!Tc(n)){const{message:a}=ce("MISSING_OR_INVALID",`pair() params: ${n}`);throw i.setError(Sr.malformed_pairing_uri),new Error(a)}if(!G5(n.uri)){const{message:a}=ce("MISSING_OR_INVALID",`pair() uri: ${n.uri}`);throw i.setError(Sr.malformed_pairing_uri),new Error(a)}const o=Zl(n?.uri);if(!((s=o?.relay)!=null&&s.protocol)){const{message:a}=ce("MISSING_OR_INVALID","pair() uri#relay-protocol");throw i.setError(Sr.malformed_pairing_uri),new Error(a)}if(!(o!=null&&o.symKey)){const{message:a}=ce("MISSING_OR_INVALID","pair() uri#symKey");throw i.setError(Sr.malformed_pairing_uri),new Error(a)}if(o!=null&&o.expiryTimestamp&&G.toMiliseconds(o?.expiryTimestamp)<Date.now()){i.setError(Sr.pairing_expired);const{message:a}=ce("EXPIRED","pair() URI has expired. Please try again with a new connection URI.");throw new Error(a)}}),ne(this,"isValidPing",async n=>{if(!Tc(n)){const{message:s}=ce("MISSING_OR_INVALID",`ping() params: ${n}`);throw new Error(s)}const{topic:i}=n;await this.isValidPairingTopic(i)}),ne(this,"isValidDisconnect",async n=>{if(!Tc(n)){const{message:s}=ce("MISSING_OR_INVALID",`disconnect() params: ${n}`);throw new Error(s)}const{topic:i}=n;await this.isValidPairingTopic(i)}),ne(this,"isValidPairingTopic",async n=>{if(!Ql(n,!1)){const{message:i}=ce("MISSING_OR_INVALID",`pairing topic should be a string: ${n}`);throw new Error(i)}if(!this.pairings.keys.includes(n)){const{message:i}=ce("NO_MATCHING_KEY",`pairing topic doesn't exist: ${n}`);throw new Error(i)}if(al(this.pairings.get(n).expiry)){await this.deletePairing(n);const{message:i}=ce("EXPIRED",`pairing topic: ${n}`);throw new Error(i)}}),this.core=e,this.logger=At(r,this.name),this.pairings=new O0(this.core,this.logger,this.name,this.storagePrefix)}get context(){return Pt(this.logger)}isInitialized(){if(!this.initialized){const{message:e}=ce("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.core.relayer.on(ft.message,async e=>{const{topic:r,message:n,transportType:i}=e;if(!this.pairings.keys.includes(r)||i===an.link_mode||this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(n)))return;const s=await this.core.crypto.decode(r,n);try{g0(s)?(this.core.history.set(r,s),this.onRelayEventRequest({topic:r,payload:s})):$c(s)&&(await this.core.history.resolve(s),await this.onRelayEventResponse({topic:r,payload:s}),this.core.history.delete(r,s.id))}catch(o){this.logger.error(o)}})}registerExpirerEvents(){this.core.expirer.on(jt.expired,async e=>{const{topic:r}=g4(e.target);r&&this.pairings.keys.includes(r)&&(await this.deletePairing(r,!0),this.events.emit(Ln.expire,{topic:r}))})}}var E9=Object.defineProperty,x9=(t,e,r)=>e in t?E9(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,bt=(t,e,r)=>x9(t,typeof e!="symbol"?e+"":e,r);class T0 extends Hp{constructor(e,r){super(e,r),this.core=e,this.logger=r,bt(this,"records",new Map),bt(this,"events",new Ut.exports.EventEmitter),bt(this,"name",Jf),bt(this,"version",Qf),bt(this,"cached",[]),bt(this,"initialized",!1),bt(this,"storagePrefix",Xt),bt(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.records.set(n.id,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)}),bt(this,"set",(n,i,s)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:n,request:i,chainId:s}),this.records.has(i.id))return;const o={id:i.id,topic:n,request:{method:i.method,params:i.params||null},chainId:s,expiry:$i(G.THIRTY_DAYS)};this.records.set(o.id,o),this.persist(),this.events.emit(kt.created,o)}),bt(this,"resolve",async n=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:n}),!this.records.has(n.id))return;const i=await this.getRecord(n.id);typeof i.response>"u"&&(i.response=mo(n)?{error:n.error}:{result:n.result},this.records.set(i.id,i),this.persist(),this.events.emit(kt.updated,i))}),bt(this,"get",async(n,i)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:n,id:i}),await this.getRecord(i))),bt(this,"delete",(n,i)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:i}),this.values.forEach(s=>{if(s.topic===n){if(typeof i<"u"&&s.id!==i)return;this.records.delete(s.id),this.events.emit(kt.deleted,s)}}),this.persist()}),bt(this,"exists",async(n,i)=>(this.isInitialized(),this.records.has(i)?(await this.getRecord(i)).topic===n:!1)),bt(this,"on",(n,i)=>{this.events.on(n,i)}),bt(this,"once",(n,i)=>{this.events.once(n,i)}),bt(this,"off",(n,i)=>{this.events.off(n,i)}),bt(this,"removeListener",(n,i)=>{this.events.removeListener(n,i)}),this.logger=At(r,this.name)}get context(){return Pt(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const e=[];return this.values.forEach(r=>{if(typeof r.response<"u")return;const n={topic:r.topic,request:Lc(r.request.method,r.request.params,r.id),chainId:r.chainId};return e.push(n)}),e}async setJsonRpcRecords(e){await this.core.storage.setItem(this.storageKey,e)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(e){this.isInitialized();const r=this.records.get(e);if(!r){const{message:n}=ce("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(n)}return r}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(kt.sync)}async restore(){try{const e=await this.getJsonRpcRecords();if(typeof e>"u"||!e.length)return;if(this.records.size){const{message:r}=ce("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}}registerEventListeners(){this.events.on(kt.created,e=>{const r=kt.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e})}),this.events.on(kt.updated,e=>{const r=kt.updated;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e})}),this.events.on(kt.deleted,e=>{const r=kt.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e})}),this.core.heartbeat.on(Rn.pulse,()=>{this.cleanup()})}cleanup(){try{this.isInitialized();let e=!1;this.records.forEach(r=>{G.toMiliseconds(r.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${r.id}`),this.records.delete(r.id),this.events.emit(kt.deleted,r,!1),e=!0)}),e&&this.persist()}catch(e){this.logger.warn(e)}}isInitialized(){if(!this.initialized){const{message:e}=ce("NOT_INITIALIZED",this.name);throw new Error(e)}}}var S9=Object.defineProperty,I9=(t,e,r)=>e in t?S9(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,mt=(t,e,r)=>I9(t,typeof e!="symbol"?e+"":e,r);class R0 extends Xp{constructor(e,r){super(e,r),this.core=e,this.logger=r,mt(this,"expirations",new Map),mt(this,"events",new Ut.exports.EventEmitter),mt(this,"name",eu),mt(this,"version",tu),mt(this,"cached",[]),mt(this,"initialized",!1),mt(this,"storagePrefix",Xt),mt(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.expirations.set(n.target,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)}),mt(this,"has",n=>{try{const i=this.formatTarget(n);return typeof this.getExpiration(i)<"u"}catch{return!1}}),mt(this,"set",(n,i)=>{this.isInitialized();const s=this.formatTarget(n),o={target:s,expiry:i};this.expirations.set(s,o),this.checkExpiry(s,o),this.events.emit(jt.created,{target:s,expiration:o})}),mt(this,"get",n=>{this.isInitialized();const i=this.formatTarget(n);return this.getExpiration(i)}),mt(this,"del",n=>{if(this.isInitialized(),this.has(n)){const i=this.formatTarget(n),s=this.getExpiration(i);this.expirations.delete(i),this.events.emit(jt.deleted,{target:i,expiration:s})}}),mt(this,"on",(n,i)=>{this.events.on(n,i)}),mt(this,"once",(n,i)=>{this.events.once(n,i)}),mt(this,"off",(n,i)=>{this.events.off(n,i)}),mt(this,"removeListener",(n,i)=>{this.events.removeListener(n,i)}),this.logger=At(r,this.name)}get context(){return Pt(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(e){if(typeof e=="string")return p4(e);if(typeof e=="number")return b4(e);const{message:r}=ce("UNKNOWN_TYPE",`Target type: ${typeof e}`);throw new Error(r)}async setExpirations(e){await this.core.storage.setItem(this.storageKey,e)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(jt.sync)}async restore(){try{const e=await this.getExpirations();if(typeof e>"u"||!e.length)return;if(this.expirations.size){const{message:r}=ce("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(e){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(e)}}getExpiration(e){const r=this.expirations.get(e);if(!r){const{message:n}=ce("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.warn(n),new Error(n)}return r}checkExpiry(e,r){const{expiry:n}=r;G.toMiliseconds(n)-Date.now()<=0&&this.expire(e,r)}expire(e,r){this.expirations.delete(e),this.events.emit(jt.expired,{target:e,expiration:r})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((e,r)=>this.checkExpiry(r,e))}registerEventListeners(){this.core.heartbeat.on(Rn.pulse,()=>this.checkExpirations()),this.events.on(jt.created,e=>{const r=jt.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()}),this.events.on(jt.expired,e=>{const r=jt.expired;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()}),this.events.on(jt.deleted,e=>{const r=jt.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=ce("NOT_INITIALIZED",this.name);throw new Error(e)}}}var A9=Object.defineProperty,D9=(t,e,r)=>e in t?A9(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Ze=(t,e,r)=>D9(t,typeof e!="symbol"?e+"":e,r);class B0 extends Zp{constructor(e,r,n){super(e,r,n),this.core=e,this.logger=r,this.store=n,Ze(this,"name",ru),Ze(this,"abortController"),Ze(this,"isDevEnv"),Ze(this,"verifyUrlV3",iu),Ze(this,"storagePrefix",Xt),Ze(this,"version",Go),Ze(this,"publicKey"),Ze(this,"fetchPromise"),Ze(this,"init",async()=>{var i;this.isDevEnv||(this.publicKey=await this.store.getItem(this.storeKey),this.publicKey&&G.toMiliseconds((i=this.publicKey)==null?void 0:i.expiresAt)<Date.now()&&(this.logger.debug("verify v2 public key expired"),await this.removePublicKey()))}),Ze(this,"register",async i=>{if(!ao()||this.isDevEnv)return;const s=window.location.origin,{id:o,decryptedId:a}=i,c=`${this.verifyUrlV3}/attestation?projectId=${this.core.projectId}&origin=${s}&id=${o}&decryptedId=${a}`;try{const u=Ls(),d=this.startAbortTimer(G.ONE_SECOND*5),p=await new Promise((y,_)=>{const w=()=>{window.removeEventListener("message",O),u.body.removeChild(D),_("attestation aborted")};this.abortController.signal.addEventListener("abort",w);const D=u.createElement("iframe");D.src=c,D.style.display="none",D.addEventListener("error",w,{signal:this.abortController.signal});const O=M=>{if(M.data&&typeof M.data=="string")try{const T=JSON.parse(M.data);if(T.type==="verify_attestation"){if(ma(T.attestation).payload.id!==o)return;clearInterval(d),u.body.removeChild(D),this.abortController.signal.removeEventListener("abort",w),window.removeEventListener("message",O),y(T.attestation===null?"":T.attestation)}}catch(T){this.logger.warn(T)}};u.body.appendChild(D),window.addEventListener("message",O,{signal:this.abortController.signal})});return this.logger.debug("jwt attestation",p),p}catch(u){this.logger.warn(u)}return""}),Ze(this,"resolve",async i=>{if(this.isDevEnv)return"";const{attestationId:s,hash:o,encryptedId:a}=i;if(s===""){this.logger.debug("resolve: attestationId is empty, skipping");return}if(s){if(ma(s).payload.id!==a)return;const u=await this.isValidJwtAttestation(s);if(u){if(!u.isVerified){this.logger.warn("resolve: jwt attestation: origin url not verified");return}return u}}if(!o)return;const c=this.getVerifyUrl(i?.verifyUrl);return this.fetchAttestation(o,c)}),Ze(this,"fetchAttestation",async(i,s)=>{this.logger.debug(`resolving attestation: ${i} from url: ${s}`);const o=this.startAbortTimer(G.ONE_SECOND*5),a=await fetch(`${s}/attestation/${i}?v2Supported=true`,{signal:this.abortController.signal});return clearTimeout(o),a.status===200?await a.json():void 0}),Ze(this,"getVerifyUrl",i=>{let s=i||Si;return su.includes(s)||(this.logger.info(`verify url: ${s}, not included in trusted list, assigning default: ${Si}`),s=Si),s}),Ze(this,"fetchPublicKey",async()=>{try{this.logger.debug(`fetching public key from: ${this.verifyUrlV3}`);const i=this.startAbortTimer(G.FIVE_SECONDS),s=await fetch(`${this.verifyUrlV3}/public-key`,{signal:this.abortController.signal});return clearTimeout(i),await s.json()}catch(i){this.logger.warn(i)}}),Ze(this,"persistPublicKey",async i=>{this.logger.debug("persisting public key to local storage",i),await this.store.setItem(this.storeKey,i),this.publicKey=i}),Ze(this,"removePublicKey",async()=>{this.logger.debug("removing verify v2 public key from storage"),await this.store.removeItem(this.storeKey),this.publicKey=void 0}),Ze(this,"isValidJwtAttestation",async i=>{const s=await this.getPublicKey();try{if(s)return this.validateAttestation(i,s)}catch(a){this.logger.error(a),this.logger.warn("error validating attestation")}const o=await this.fetchAndPersistPublicKey();try{if(o)return this.validateAttestation(i,o)}catch(a){this.logger.error(a),this.logger.warn("error validating attestation")}}),Ze(this,"getPublicKey",async()=>this.publicKey?this.publicKey:await this.fetchAndPersistPublicKey()),Ze(this,"fetchAndPersistPublicKey",async()=>{if(this.fetchPromise)return await this.fetchPromise,this.publicKey;this.fetchPromise=new Promise(async s=>{const o=await this.fetchPublicKey();o&&(await this.persistPublicKey(o),s(o))});const i=await this.fetchPromise;return this.fetchPromise=void 0,i}),Ze(this,"validateAttestation",(i,s)=>{const o=k5(i,s.publicKey),a={hasExpired:G.toMiliseconds(o.exp)<Date.now(),payload:o};if(a.hasExpired)throw this.logger.warn("resolve: jwt attestation expired"),new Error("JWT attestation expired");return{origin:a.payload.origin,isScam:a.payload.isScam,isVerified:a.payload.isVerified}}),this.logger=At(r,this.name),this.abortController=new AbortController,this.isDevEnv=fl(),this.init()}get storeKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//verify:public:key"}get context(){return Pt(this.logger)}startAbortTimer(e){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),G.toMiliseconds(e))}}var O9=Object.defineProperty,M9=(t,e,r)=>e in t?O9(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,P0=(t,e,r)=>M9(t,typeof e!="symbol"?e+"":e,r);class N0 extends Jp{constructor(e,r){super(e,r),this.projectId=e,this.logger=r,P0(this,"context",ou),P0(this,"registerDeviceToken",async n=>{const{clientId:i,token:s,notificationType:o,enableEncrypted:a=!1}=n,c=`${au}/${this.projectId}/clients`;await fetch(c,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:i,type:o,token:s,always_raw:a})})}),this.logger=At(r,this.context)}}var T9=Object.defineProperty,C0=Object.getOwnPropertySymbols,R9=Object.prototype.hasOwnProperty,B9=Object.prototype.propertyIsEnumerable,Kc=(t,e,r)=>e in t?T9(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Yi=(t,e)=>{for(var r in e||(e={}))R9.call(e,r)&&Kc(t,r,e[r]);if(C0)for(var r of C0(e))B9.call(e,r)&&Kc(t,r,e[r]);return t},at=(t,e,r)=>Kc(t,typeof e!="symbol"?e+"":e,r);class L0 extends Qp{constructor(e,r,n=!0){super(e,r,n),this.core=e,this.logger=r,at(this,"context",fu),at(this,"storagePrefix",Xt),at(this,"storageVersion",cu),at(this,"events",new Map),at(this,"shouldPersist",!1),at(this,"init",async()=>{if(!fl())try{const i={eventId:cl(),timestamp:Date.now(),domain:this.getAppDomain(),props:{event:"INIT",type:"",properties:{client_id:await this.core.crypto.getClientId(),user_agent:nl(this.core.relayer.protocol,this.core.relayer.version,Is)}}};await this.sendEvent([i])}catch(i){this.logger.warn(i)}}),at(this,"createEvent",i=>{const{event:s="ERROR",type:o="",properties:{topic:a,trace:c}}=i,u=cl(),d=this.core.projectId||"",p=Date.now(),y=Yi({eventId:u,timestamp:p,props:{event:s,type:o,properties:{topic:a,trace:c}},bundleId:d,domain:this.getAppDomain()},this.setMethods(u));return this.telemetryEnabled&&(this.events.set(u,y),this.shouldPersist=!0),y}),at(this,"getEvent",i=>{const{eventId:s,topic:o}=i;if(s)return this.events.get(s);const a=Array.from(this.events.values()).find(c=>c.props.properties.topic===o);if(a)return Yi(Yi({},a),this.setMethods(a.eventId))}),at(this,"deleteEvent",i=>{const{eventId:s}=i;this.events.delete(s),this.shouldPersist=!0}),at(this,"setEventListeners",()=>{this.core.heartbeat.on(Rn.pulse,async()=>{this.shouldPersist&&await this.persist(),this.events.forEach(i=>{G.fromMiliseconds(Date.now())-G.fromMiliseconds(i.timestamp)>uu&&(this.events.delete(i.eventId),this.shouldPersist=!0)})})}),at(this,"setMethods",i=>({addTrace:s=>this.addTrace(i,s),setError:s=>this.setError(i,s)})),at(this,"addTrace",(i,s)=>{const o=this.events.get(i);o&&(o.props.properties.trace.push(s),this.events.set(i,o),this.shouldPersist=!0)}),at(this,"setError",(i,s)=>{const o=this.events.get(i);o&&(o.props.type=s,o.timestamp=Date.now(),this.events.set(i,o),this.shouldPersist=!0)}),at(this,"persist",async()=>{await this.core.storage.setItem(this.storageKey,Array.from(this.events.values())),this.shouldPersist=!1}),at(this,"restore",async()=>{try{const i=await this.core.storage.getItem(this.storageKey)||[];if(!i.length)return;i.forEach(s=>{this.events.set(s.eventId,Yi(Yi({},s),this.setMethods(s.eventId)))})}catch(i){this.logger.warn(i)}}),at(this,"submit",async()=>{if(!this.telemetryEnabled||this.events.size===0)return;const i=[];for(const[s,o]of this.events)o.props.type&&i.push(o);if(i.length!==0)try{if((await this.sendEvent(i)).ok)for(const s of i)this.events.delete(s.eventId),this.shouldPersist=!0}catch(s){this.logger.warn(s)}}),at(this,"sendEvent",async i=>{const s=this.getAppDomain()?"":"&sp=desktop";return await fetch(`${hu}?projectId=${this.core.projectId}&st=events_sdk&sv=js-${Is}${s}`,{method:"POST",body:JSON.stringify(i)})}),at(this,"getAppDomain",()=>f4().url),this.logger=At(r,this.context),this.telemetryEnabled=n,n?this.restore().then(async()=>{await this.submit(),this.setEventListeners()}):this.persist()}get storageKey(){return this.storagePrefix+this.storageVersion+this.core.customStoragePrefix+"//"+this.context}}var P9=Object.defineProperty,$0=Object.getOwnPropertySymbols,N9=Object.prototype.hasOwnProperty,C9=Object.prototype.propertyIsEnumerable,Vc=(t,e,r)=>e in t?P9(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,F0=(t,e)=>{for(var r in e||(e={}))N9.call(e,r)&&Vc(t,r,e[r]);if($0)for(var r of $0(e))C9.call(e,r)&&Vc(t,r,e[r]);return t},ge=(t,e,r)=>Vc(t,typeof e!="symbol"?e+"":e,r);class _o extends Up{constructor(e){var r;super(e),ge(this,"protocol",Wo),ge(this,"version",Go),ge(this,"name",xi),ge(this,"relayUrl"),ge(this,"projectId"),ge(this,"customStoragePrefix"),ge(this,"events",new Ut.exports.EventEmitter),ge(this,"logger"),ge(this,"heartbeat"),ge(this,"relayer"),ge(this,"crypto"),ge(this,"storage"),ge(this,"history"),ge(this,"expirer"),ge(this,"pairing"),ge(this,"verify"),ge(this,"echoClient"),ge(this,"linkModeSupportedApps"),ge(this,"eventClient"),ge(this,"initialized",!1),ge(this,"logChunkController"),ge(this,"on",(o,a)=>this.events.on(o,a)),ge(this,"once",(o,a)=>this.events.once(o,a)),ge(this,"off",(o,a)=>this.events.off(o,a)),ge(this,"removeListener",(o,a)=>this.events.removeListener(o,a)),ge(this,"dispatchEnvelope",({topic:o,message:a,sessionExists:c})=>{if(!o||!a)return;const u={topic:o,message:a,publishedAt:Date.now(),transportType:an.link_mode};this.relayer.onLinkMessageEvent(u,{sessionExists:c})}),this.projectId=e?.projectId,this.relayUrl=e?.relayUrl||Zo,this.customStoragePrefix=e!=null&&e.customStoragePrefix?`:${e.customStoragePrefix}`:"";const n=Mf({level:typeof e?.logger=="string"&&e.logger?e.logger:Rf.logger,name:xi}),{logger:i,chunkLoggerController:s}=$p({opts:n,maxSizeInBytes:e?.maxLogBlobSizeInBytes,loggerOverride:e?.logger});this.logChunkController=s,(r=this.logChunkController)!=null&&r.downloadLogsBlobInBrowser&&(window.downloadLogsBlobInBrowser=async()=>{var o,a;(o=this.logChunkController)!=null&&o.downloadLogsBlobInBrowser&&((a=this.logChunkController)==null||a.downloadLogsBlobInBrowser({clientId:await this.crypto.getClientId()}))}),this.logger=At(i,this.name),this.heartbeat=new Uo,this.crypto=new r0(this,this.logger,e?.keychain),this.history=new T0(this,this.logger),this.expirer=new R0(this,this.logger),this.storage=e!=null&&e.storage?e.storage:new fp(F0(F0({},Bf),e?.storageOptions)),this.relayer=new I0({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new M0(this,this.logger),this.verify=new B0(this,this.logger,this.storage),this.echoClient=new N0(this.projectId||"",this.logger),this.linkModeSupportedApps=[],this.eventClient=new L0(this,this.logger,e?.telemetryEnabled)}static async init(e){const r=new _o(e);await r.initialize();const n=await r.crypto.getClientId();return await r.storage.setItem(Vf,n),r}get context(){return Pt(this.logger)}async start(){this.initialized||await this.initialize()}async getLogsBlob(){var e;return(e=this.logChunkController)==null?void 0:e.logsToBlob({clientId:await this.crypto.getClientId()})}async addLinkModeSupportedApp(e){this.linkModeSupportedApps.includes(e)||(this.linkModeSupportedApps.push(e),await this.storage.setItem(Jo,this.linkModeSupportedApps))}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.linkModeSupportedApps=await this.storage.getItem(Jo)||[],this.initialized=!0,this.logger.info("Core Initialization Success")}catch(e){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,e),this.logger.error(e.message),e}}}const L9=_o;H.CORE_CONTEXT=xi,H.CORE_DEFAULT=Rf,H.CORE_PROTOCOL=Wo,H.CORE_STORAGE_OPTIONS=Bf,H.CORE_STORAGE_PREFIX=Xt,H.CORE_VERSION=Go,H.CRYPTO_CLIENT_SEED=Yo,H.CRYPTO_CONTEXT=Pf,H.CRYPTO_JWT_TTL=Nf,H.Core=L9,H.Crypto=r0,H.ECHO_CONTEXT=ou,H.ECHO_URL=au,H.EVENTS_CLIENT_API_URL=hu,H.EVENTS_STORAGE_CLEANUP_INTERVAL=uu,H.EVENTS_STORAGE_CONTEXT=fu,H.EVENTS_STORAGE_VERSION=cu,H.EVENT_CLIENT_AUTHENTICATE_ERRORS=ub,H.EVENT_CLIENT_AUTHENTICATE_TRACES=fb,H.EVENT_CLIENT_CONTEXT=ob,H.EVENT_CLIENT_PAIRING_ERRORS=Sr,H.EVENT_CLIENT_PAIRING_TRACES=cr,H.EVENT_CLIENT_SESSION_ERRORS=cb,H.EVENT_CLIENT_SESSION_TRACES=ab,H.EXPIRER_CONTEXT=eu,H.EXPIRER_DEFAULT_TTL=ib,H.EXPIRER_EVENTS=jt,H.EXPIRER_STORAGE_VERSION=tu,H.EchoClient=N0,H.EventClient=L0,H.Expirer=R0,H.HISTORY_CONTEXT=Jf,H.HISTORY_EVENTS=kt,H.HISTORY_STORAGE_VERSION=Qf,H.JsonRpcHistory=T0,H.KEYCHAIN_CONTEXT=Cf,H.KEYCHAIN_STORAGE_VERSION=Lf,H.KeyChain=t0,H.MESSAGES_CONTEXT=$f,H.MESSAGES_STORAGE_VERSION=Ff,H.MessageTracker=n0,H.PAIRING_CONTEXT=Xf,H.PAIRING_DEFAULT_TTL=nb,H.PAIRING_EVENTS=Ln,H.PAIRING_RPC_OPTS=Cn,H.PAIRING_STORAGE_VERSION=Zf,H.PENDING_SUB_RESOLUTION_TIMEOUT=Yf,H.PUBLISHER_CONTEXT=zf,H.PUBLISHER_DEFAULT_TTL=Xo,H.Pairing=M0,H.RELAYER_CONTEXT=jf,H.RELAYER_DEFAULT_LOGGER=kf,H.RELAYER_DEFAULT_PROTOCOL=Uf,H.RELAYER_DEFAULT_RELAY_URL=Zo,H.RELAYER_EVENTS=ft,H.RELAYER_PROVIDER_EVENTS=Nt,H.RELAYER_RECONNECT_TIMEOUT=Hf,H.RELAYER_SDK_VERSION=Is,H.RELAYER_STORAGE_OPTIONS=eb,H.RELAYER_SUBSCRIBER_SUFFIX=qf,H.RELAYER_TRANSPORT_CUTOFF=tb,H.Relayer=I0,H.STORE_STORAGE_VERSION=Kf,H.SUBSCRIBER_CONTEXT=Wf,H.SUBSCRIBER_DEFAULT_TTL=rb,H.SUBSCRIBER_EVENTS=Dt,H.SUBSCRIBER_STORAGE_VERSION=Gf,H.Store=O0,H.Subscriber=E0,H.TRANSPORT_TYPES=an,H.TRUSTED_VERIFY_URLS=su,H.VERIFY_CONTEXT=ru,H.VERIFY_SERVER=Si,H.VERIFY_SERVER_V3=iu,H.Verify=B0,H.WALLETCONNECT_CLIENT_ID=Vf,H.WALLETCONNECT_LINK_MODE_APPS=Jo,H.default=_o,Object.defineProperty(H,"__esModule",{value:!0})});
//# sourceMappingURL=index.umd.js.map
